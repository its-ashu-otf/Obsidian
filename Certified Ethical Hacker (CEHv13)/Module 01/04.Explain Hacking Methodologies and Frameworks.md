## CEH Hacking Methodology (CHM)

![[Pasted image 20241225234927.png]]

The **CEH Hacking Methodology (CHM)**, focusing on the stages of ethical hacking. 

---
The CEH (Certified Ethical Hacker) framework outlines the various phases involved in hacking. Here's a breakdown of the key phases:

1. **Phase 1: Reconnaissance**  
    This is the preparatory phase where attackers gather as much information as possible about the target. The goal is to create a profile of the target organization, including details like IP address range, network infrastructure, and employee information. This phase can be divided into two types:
    
    - **Passive Reconnaissance**: The attacker does not interact directly with the target. Instead, they gather information from publicly available sources (e.g., websites, news releases, Whois queries).
    - **Active Reconnaissance**: The attacker interacts directly with the target system to detect open ports, hosts, operating systems, and applications.
2. **Phase 2: Vulnerability Scanning**  
    In this phase, attackers scan the target network to identify security vulnerabilities. The goal is to assess the target’s systems and identify weaknesses that could be exploited in further attacks. Vulnerabilities are categorized, and the information gathered is used to perform additional exploitation.
    
3. **Phase 3: Gaining Access**  
    After identifying vulnerabilities, attackers attempt to gain access to the target system. This could involve exploiting weaknesses such as buffer overflows, password cracking, or other vulnerabilities in the system. Once access is gained, the attacker often escalates their privileges to gain full control over the system.
    
    - **Escalating Privileges**: Once an attacker gains access with a low-privilege account, they may attempt to increase their access level to an administrator or root level, which allows them to perform protected operations and further exploit the system.
4. **Phase 4: Maintaining Access**  
    Once an attacker has gained control of a system, they work to maintain access to the system. This may involve installing backdoors, using rootkits, or other methods to keep control over the system. The attacker may also use this system as a launchpad for further attacks on other systems.
    
5. **Phase 5: Clearing Tracks**  
    To avoid detection, attackers will attempt to erase evidence of their activities. This could involve deleting logs or modifying system configurations to hide their presence on the system. This phase is crucial for maintaining stealth and preventing the target organization from discovering the breach.
    

Each phase plays a crucial role in a hacker's attempt to compromise a system, and understanding these phases helps ethical hackers identify vulnerabilities and defend against such attacks.

## Cyber Kill Chain Methodology
![[Pasted image 20241121214409.png]]

The **Cyber Kill Chain Methodology**—a step-by-step framework used to understand and prevent cyber intrusion activities. 
The Cyber Kill Chain framework, developed by **Lockheed Martin** (2022), explains how attackers move through networks to identify vulnerabilities that they can then exploit. Attackers use the steps in the Cyber Kill Chain when conducting offensive operations in cyberspace against their targets. If you’re responsible for defending a network, this model can help you understand the stages of a cyberattack and the measures you can take to prevent or intercept each step.

---

### 1. **Reconnaissance**

**Definition**: Gathering information about the target to identify potential vulnerabilities.

- **Techniques**:
    - **Passive Reconnaissance**: Using tools like _Shodan_, _Google Dorking_, or social media to collect publicly available information.
    - **Active Reconnaissance**: Scanning the network with tools like _Nmap_ to find open ports or services.
- **Examples**:
    - Identifying a company’s domain and subdomains using _Sublist3r_.
    - Collecting employee details via LinkedIn to craft phishing emails.

---

### 2. **Weaponization**

**Definition**: Creating a malicious payload, such as a backdoor or malware, designed to exploit a target's vulnerability.

- **Techniques**:
    - Using frameworks like _Metasploit_ to craft malicious exploits.
    - Embedding malware in seemingly legitimate documents or applications using tools like _MSFVenom_.
- **Examples**:
    - Crafting a malicious PDF that exploits an Adobe Reader vulnerability (e.g., CVE-2019-14586).
    - Creating a trojanized Excel file with embedded macros to execute a reverse shell.

---

### 3. **Delivery**

**Definition**: Transmitting the weaponized payload to the target.

- **Techniques**:
    - **Phishing**: Sending emails with malicious attachments or links.
    - **USB Drops**: Planting infected USB drives in public spaces.
    - **Drive-by Downloads**: Hosting malicious code on compromised websites.
- **Examples**:
    - Sending a spear-phishing email containing a link to a malicious Word document.
    - Hosting malware on a fake login page that mimics a legitimate service.

---

### 4. **Exploitation**

**Definition**: Triggering the vulnerability to execute the malicious payload on the target system.

- **Techniques**:
    - Exploiting outdated software (e.g., Apache Struts vulnerability CVE-2017-5638).
    - Leveraging privilege escalation techniques to gain deeper access.
- **Examples**:
    - Exploiting an unpatched Windows SMB service using the EternalBlue vulnerability (CVE-2017-0144).
    - Executing a cross-site scripting (XSS) attack to inject malicious JavaScript into a web application.

---

### 5. **Installation**

**Definition**: Installing malicious software or scripts on the target system to establish persistence.

- **Techniques**:
    - Deploying backdoors or trojans like _RATs_ (Remote Access Trojans).
    - Installing keyloggers or rootkits to monitor activities or maintain stealth.
- **Examples**:
    - Installing a _Meterpreter_ session through Metasploit for remote access.
    - Deploying a persistent web shell like _China Chopper_ on a compromised server.

---

### 6. **Command and Control (C2)**

**Definition**: Establishing a communication channel to remotely control the compromised system.

- **Techniques**:
    - Using C2 frameworks like _Cobalt Strike_ or _Empire_.
    - Communicating via DNS tunneling, HTTP, or HTTPS to bypass network firewalls.
- **Examples**:
    - Setting up a C2 server to manage multiple compromised hosts using encrypted traffic.
    - Using tools like _ngrok_ to tunnel C2 traffic and evade detection.

---

### 7. **Actions on Objectives**

**Definition**: Performing final actions to achieve the attacker's goal, such as exfiltrating data, sabotaging systems, or disrupting services.

- **Techniques**:
    - **Data Exfiltration**: Using tools like _Rclone_ or _WinSCP_ to transfer sensitive data.
    - **Ransomware Deployment**: Encrypting files and demanding payment for decryption keys.
    - **System Sabotage**: Deleting critical files or deploying destructive malware like _Wiper_.
- **Examples**:
    - Stealing customer data from a database for resale on the dark web.
    - Encrypting a company’s data and demanding cryptocurrency as ransom.

---

### Preventive Strategies

Each stage of the Cyber Kill Chain provides opportunities for defense:

- **Reconnaissance**: Employ web application firewalls (WAFs) and monitor external network activity.
- **Weaponization**: Use email filters and sandboxing to detect malicious attachments.
- **Delivery**: Train employees to recognize phishing attacks.
- **Exploitation**: Patch vulnerabilities promptly and deploy endpoint protection systems.
- **Installation**: Use intrusion detection systems (IDS) to block malicious installations.
- **Command and Control**: Monitor outbound traffic and block known C2 IP addresses/domains.
- **Actions on Objectives**: Encrypt sensitive data and perform regular backups.

---

The Cyber Kill Chain helps security professionals analyse, prevent, and respond to attacks effectively.

