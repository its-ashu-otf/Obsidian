## CEH Hacking Methodology (CHM)

![[Pasted image 20241106165535.png]]

The **CEH Hacking Methodology (CHM)**, focusing on the stages of ethical hacking. Here's an elaboration with real-world examples:

---

### 1. **Footprinting**

**Definition**: Gathering as much information about the target as possible.

- **Examples**:
    - **DNS Footprinting**: Using tools like _nslookup_ or _dig_ to gather DNS records.
    - **Social Media Profiling**: Collecting information about a company or individual from LinkedIn, Twitter, etc.
    - **Google Dorking**: Using advanced search operators to find sensitive information like login pages or exposed documents.
    - **Whois Lookup**: Identifying domain ownership and registration details.

---

### 2. **Scanning**

**Definition**: Actively probing the target to discover open ports, services, and vulnerabilities.

- **Examples**:
    - **Port Scanning**: Using tools like _Nmap_ to find open ports (e.g., Port 80 for HTTP or 3389 for RDP).
    - **Network Mapping**: Creating a topology of the network using tools like _Zenmap_ or _Netdiscover_.
    - **Vulnerability Scanning**: Scanning for vulnerabilities using _Nessus_ or _OpenVAS_.

---

### 3. **Enumeration**

**Definition**: Extracting detailed information from the target, such as user accounts or shared resources.

- **Examples**:
    - **SMB Enumeration**: Using tools like _Enum4linux_ or _Metasploit_ to list shared folders on a Windows server.
    - **SNMP Enumeration**: Extracting network configuration using SNMP tools like _snmpwalk_.
    - **Active Directory Enumeration**: Enumerating users and groups in an AD environment using tools like _BloodHound_.

---

### 4. **Vulnerability Analysis**

**Definition**: Identifying weaknesses in the system that can be exploited.

- **Examples**:
    - **CVE Search**: Looking up known vulnerabilities in the National Vulnerability Database.
    - **Exploiting Misconfigurations**: Identifying weak passwords or default credentials.
    - **Using Exploit Databases**: Finding exploits in platforms like _Exploit-DB_ for discovered vulnerabilities.

---

### 5. **System Hacking**

- **Gaining Access**
    
    - **Cracking Passwords**: Brute-forcing or dictionary attacks using tools like _John the Ripper_ or _Hydra_.
    - **Exploitation**: Using an exploit from _Metasploit_ to gain access (e.g., exploiting EternalBlue for SMB).
- **Escalating Privileges**
    
    - **Examples**:
        - Exploiting _Sudo Misconfigurations_ on Linux to gain root.
        - Using _Mimikatz_ to extract plaintext passwords from memory in Windows.
- **Maintaining Access**
    
    - **Examples**:
        - Installing a backdoor like a web shell (e.g., _China Chopper_).
        - Creating a new admin account for persistence.
- **Clearing Logs**
    
    - **Examples**:
        - Using `wevtutil` on Windows to clear event logs.
        - Modifying or deleting logs in Linux using `shred` or editing log files.

---

This methodology highlights the step-by-step process ethical hackers use to assess and improve security.

## Cyber Kill Chain Methodology
![[Pasted image 20241121214409.png]]

The **Cyber Kill Chain Methodology**—a step-by-step framework used to understand and prevent cyber intrusion activities. 
The Cyber Kill Chain framework, developed by **Lockheed Martin** (2022), explains how attackers move through networks to identify vulnerabilities that they can then exploit. Attackers use the steps in the Cyber Kill Chain when conducting offensive operations in cyberspace against their targets. If you’re responsible for defending a network, this model can help you understand the stages of a cyberattack and the measures you can take to prevent or intercept each step.

---

### 1. **Reconnaissance**

**Definition**: Gathering information about the target to identify potential vulnerabilities.

- **Techniques**:
    - **Passive Reconnaissance**: Using tools like _Shodan_, _Google Dorking_, or social media to collect publicly available information.
    - **Active Reconnaissance**: Scanning the network with tools like _Nmap_ to find open ports or services.
- **Examples**:
    - Identifying a company’s domain and subdomains using _Sublist3r_.
    - Collecting employee details via LinkedIn to craft phishing emails.

---

### 2. **Weaponization**

**Definition**: Creating a malicious payload, such as a backdoor or malware, designed to exploit a target's vulnerability.

- **Techniques**:
    - Using frameworks like _Metasploit_ to craft malicious exploits.
    - Embedding malware in seemingly legitimate documents or applications using tools like _MSFVenom_.
- **Examples**:
    - Crafting a malicious PDF that exploits an Adobe Reader vulnerability (e.g., CVE-2019-14586).
    - Creating a trojanized Excel file with embedded macros to execute a reverse shell.

---

### 3. **Delivery**

**Definition**: Transmitting the weaponized payload to the target.

- **Techniques**:
    - **Phishing**: Sending emails with malicious attachments or links.
    - **USB Drops**: Planting infected USB drives in public spaces.
    - **Drive-by Downloads**: Hosting malicious code on compromised websites.
- **Examples**:
    - Sending a spear-phishing email containing a link to a malicious Word document.
    - Hosting malware on a fake login page that mimics a legitimate service.

---

### 4. **Exploitation**

**Definition**: Triggering the vulnerability to execute the malicious payload on the target system.

- **Techniques**:
    - Exploiting outdated software (e.g., Apache Struts vulnerability CVE-2017-5638).
    - Leveraging privilege escalation techniques to gain deeper access.
- **Examples**:
    - Exploiting an unpatched Windows SMB service using the EternalBlue vulnerability (CVE-2017-0144).
    - Executing a cross-site scripting (XSS) attack to inject malicious JavaScript into a web application.

---

### 5. **Installation**

**Definition**: Installing malicious software or scripts on the target system to establish persistence.

- **Techniques**:
    - Deploying backdoors or trojans like _RATs_ (Remote Access Trojans).
    - Installing keyloggers or rootkits to monitor activities or maintain stealth.
- **Examples**:
    - Installing a _Meterpreter_ session through Metasploit for remote access.
    - Deploying a persistent web shell like _China Chopper_ on a compromised server.

---

### 6. **Command and Control (C2)**

**Definition**: Establishing a communication channel to remotely control the compromised system.

- **Techniques**:
    - Using C2 frameworks like _Cobalt Strike_ or _Empire_.
    - Communicating via DNS tunneling, HTTP, or HTTPS to bypass network firewalls.
- **Examples**:
    - Setting up a C2 server to manage multiple compromised hosts using encrypted traffic.
    - Using tools like _ngrok_ to tunnel C2 traffic and evade detection.

---

### 7. **Actions on Objectives**

**Definition**: Performing final actions to achieve the attacker's goal, such as exfiltrating data, sabotaging systems, or disrupting services.

- **Techniques**:
    - **Data Exfiltration**: Using tools like _Rclone_ or _WinSCP_ to transfer sensitive data.
    - **Ransomware Deployment**: Encrypting files and demanding payment for decryption keys.
    - **System Sabotage**: Deleting critical files or deploying destructive malware like _Wiper_.
- **Examples**:
    - Stealing customer data from a database for resale on the dark web.
    - Encrypting a company’s data and demanding cryptocurrency as ransom.

---

### Preventive Strategies

Each stage of the Cyber Kill Chain provides opportunities for defense:

- **Reconnaissance**: Employ web application firewalls (WAFs) and monitor external network activity.
- **Weaponization**: Use email filters and sandboxing to detect malicious attachments.
- **Delivery**: Train employees to recognize phishing attacks.
- **Exploitation**: Patch vulnerabilities promptly and deploy endpoint protection systems.
- **Installation**: Use intrusion detection systems (IDS) to block malicious installations.
- **Command and Control**: Monitor outbound traffic and block known C2 IP addresses/domains.
- **Actions on Objectives**: Encrypt sensitive data and perform regular backups.

---

The Cyber Kill Chain helps security professionals analyze, prevent, and respond to attacks effectively.