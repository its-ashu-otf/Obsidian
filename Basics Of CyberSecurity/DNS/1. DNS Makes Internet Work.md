## What is DNS? (The Contacts app of the Internet)
A DNS (Domain Name System) is like a phonebook for the internet. It helps you find websites and online services by matching their human-readable domain names to their numerical IP addresses.

Think of it this way: when you want to visit a website, you typically type in its domain name (like "www.example.com") rather than its IP address (a series of numbers like "93.184.216.34"). The DNS system translates that domain name into the corresponding IP address, allowing your browser to connect to the correct server and display the website.

 DNS translates domain names to [IP addresses](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/) so browsers can load Internet resources.

Each device connected to the Internet has a unique IP address which other machines use to find the device. DNS servers eliminate the need for humans to memorize IP addresses such as 192.168.1.1 (in IPv4), or more complex newer alphanumeric IP addresses such as 2400:cb00:2048:1::c629:d7a2 (in IPv6).

For example:

* You type in "www.google.com" in your browser.
* The DNS system looks up the IP address associated with "www.google.com".
* It finds the IP address "173.194.222.104" and returns it to your browser.
* Your browser uses that IP address to connect to Google's servers, and you see the website.

Without a DNS system, you'd need to know the exact IP address of every website you want to visit, which would be very cumbersome! The DNS makes it easy for humans to access websites using simple domain names.

![[Pasted image 20240828214334.png]]

### Stub Resolver
A stub resolver is a small program that acts as an intermediary between your application (or the operating system) and the Domain Name System (DNS).


When you ask for a domain name (like "example.com") to be resolved into its IP address, your application sends this request to the stub resolver. The stub resolver then takes care of sending the request to a DNS server, getting the answer back, and providing it to your application.

> [!NOTE] NOTE:
> The **stub resolver** is actually a component that's part of the client machine (like your computer or phone).

Think of the stub resolver as a messenger:

1. Your application says: "Hey, I need the IP address for example.com."
2. The stub resolver says: "Okay, I'll take care of that." (sends a request to the DNS server)
3. The DNS server responds with the answer.
4. The stub resolver says: "Here's the result!" (gives the answer back to your application)

The term "stub" implies that this is a minimal program that just performs this specific function - it doesn't have any other features or capabilities.

In modern operating systems, the stub resolver is often provided by the system itself, so you don't usually need to think about it. However, in certain situations (like embedded systems or custom applications), you might need to implement your own stub resolver.

### How does DNS Caching Works?
Caching plays a crucial role in a stub resolver's functionality!

When the stub resolver receives a request from your application, it not only sends the query to the DNS server but also checks its cache for a recent result. If the requested domain name is already cached (i.e., the stub resolver remembers a previous answer), it will:

1. Return the cached answer directly to your application.
2. Possibly update the cache with the current answer, so that future requests can be served more quickly.

This caching mechanism improves performance by reducing the number of times the stub resolver needs to ask the DNS server for information. If the requested domain name is not in the cache (or if it's too old), the stub resolver will:

1. Send a new query to the DNS server.
2. Cache the response, so that future requests can be served quickly.

Caching helps with:

* **Reduced latency**: By serving cached results, your application gets answers more quickly.
* **Lower network traffic**: The stub resolver doesn't need to send as many queries to the DNS server, which reduces overall network usage.

However, caching also introduces some trade-offs:

* **Cache staleness**: If the stub resolver caches a result that's outdated (e.g., due to recent changes in the domain name), it might return incorrect information.
* **Cache size limitations**: As more and more domains are cached, cache size constraints may become an issue.

To mitigate these concerns, modern stub resolvers often employ techniques like:

* **Time-to-live (TTL)**: The DNS server specifies how long a result should be cached, which helps maintain freshness.
* **Least-recently-used (LRU) eviction**: When the cache is full and a new entry needs to be added, the least recently used entry might be evicted.

These caching strategies help balance performance gains with accuracy and resource management.

##  There are 4 DNS servers involved in loading a webpage:
You've described the four types of DNS servers involved in loading a webpage:

1. **DNS Recursor**: The first point of contact between the client machine and the DNS hierarchy. It receives queries from clients, like web browsers, and then recursively asks other DNS servers to resolve the query.

Think of it as a librarian who's asked to find a specific book (IP address). They'll search their own collection, but if they don't have it, they'll ask another librarian (recursive query).

2. **Root Nameserver**: The top-most level of the DNS hierarchy. It serves as an index that points to different TLDs (Top-Level Domains), which are like specific sections in a library.

Example: If you search for "example.com", the root nameserver would point you towards the ".com" TLD server.

3. **TLD Nameserver (Authoritative Server)**: The next level down from the root nameserver. It's responsible for hosting the records for a specific Top-Level Domain, like ".com".

In your example, the TLD server is "com", which means it hosts all the records related to ".com" domain names.

4. **Authoritative Nameserver**: This is the final level of the DNS hierarchy. It's responsible for hosting the actual records (IP addresses) for a specific domain name.

For example, if you search for "example.com", the authoritative nameserver for "example.com" would return the IP address associated with that domain name to the DNS recursor.

Here's an example of how this works:

* Web browser (client machine) -> asks DNS Recursor (librarian) for "example.com"
* DNS Recursor -> asks Root Nameserver (index) for ".com" TLD server
* Root Nameserver -> points to ".com" TLD Server (specific rack)
* TLD Server -> looks up and finds the Authoritative Nameserver for "example.com"
* Authoritative Nameserver -> returns IP address to DNS Recursor
* DNS Recursor -> returns IP address to web browser

This is a simplified explanation, but it should give you an idea of how these four types of DNS servers work together to resolve domain names and load websites!

#### Summary of Above

The **stub resolver** is actually a component that's part of the client machine (like your computer or phone). It's not one of the four DNS servers I mentioned earlier.

Here's how it fits into the picture:

1. Your web browser (client application) asks for a domain name, like "example.com", to be resolved.
2. The **stub resolver** on your machine receives this request and sends it to the **DNS Recursor** (the first point of contact).
3. The DNS Recursor then recursively queries other DNS servers (Root Nameserver, TLD Server, and Authoritative Nameserver) as described earlier.

In other words, the stub resolver is a "front-end" that interacts with your client application (web browser), while the DNS Recursor is the "back-end" that actually performs the recursive query to resolve the domain name.

Think of it like this:

- The stub resolver is like an API or an interface that allows your web browser to communicate with the rest of the DNS system.
- The DNS Recursor, Root Nameserver, TLD Server, and Authoritative Nameserver are all part of the underlying infrastructure that resolves domain names.

So, in summary: the stub resolver is a component on your client machine that interacts with your application (like web browser), while the four DNS servers I mentioned earlier are involved in resolving the actual domain name.
## DNS Hierarchy: The Mafia Bosses of the Internet
The **DNS Hierarchy** is a hierarchical structure that organizes the Domain Name System (DNS) into layers, making it easier to manage and resolve domain names.

Here's an overview of the DNS Hierarchy:

1. **Root Zone**: The top-most level of the DNS hierarchy is the Root Zone, which contains all the top-level domains (TLDs). Think of it as a huge library with books labeled by TLDs (e.g., .com, .org, .net).
2. **Top-Level Domains (TLDs)**: The second level down from the Root Zone are the TLDs. These are broad categories that group domains together (e.g., .com, .org, .edu). Each TLD has its own set of servers and records.
3. **Second-Level Domains**: Under each TLD is a layer of second-level domains (SLDs), which are further sub-divided into third-level domains (TLDs). For example:
	* .com
	* .org
	* .net

These SLDs can be thought of as "sub-libraries" within the main library (Root Zone).

4. **Authoritative Name Servers**: The final level of the DNS hierarchy is the Authoritative Name Server, which contains the actual records for a specific domain name (e.g., example.com). These servers are responsible for hosting and resolving domain names.

Here's an example to illustrate the DNS Hierarchy:

* Root Zone: `.com`, `.org`, `.net`
	+ .com
		- example.com (Authoritative Name Server)
			- ip-address (actual record)

In this example, when you enter `example.com` in your web browser, here's how it gets resolved through the DNS Hierarchy:

1. The stub resolver sends a query to the DNS Recursor.
2. The DNS Recursor contacts the Root Zone and asks for the TLD Server responsible for `.com`.
3. The Root Zone directs the DNS Recursor to the .com TLD Server.
4. The .com TLD Server points the DNS Recursor to the Authoritative Name Server for `example.com`.
5. The Authoritative Name Server returns the actual record (IP address) associated with `example.com`.

The DNS Hierarchy makes it possible to manage a vast number of domain names and provide efficient resolution services.

Here's a simple diagram to visualize the DNS Hierarchy:
```
 Root Zone
  |
  |--- .com TLD Server
  |       |
  |       |--- example.com Authoritative Name Server
  |       |       |
  |       |       |--- ip-address (actual record)
```
This is a simplified representation, but it should give you an idea of how the DNS Hierarchy works!