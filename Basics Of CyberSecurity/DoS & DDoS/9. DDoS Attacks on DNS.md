## What is a DNS Flood?

Domain Name System ([DNS](https://www.cloudflare.com/learning/ddos/glossary/domain-name-system-dns/)) servers are the “phonebooks” of the Internet; they are the path through which Internet devices are able to lookup specific web servers in order to access Internet content. A DNS flood is a type of [distributed denial-of-service attack (DDoS)](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/) where an attacker floods a particular domain’s DNS servers in an attempt to disrupt DNS resolution for that [domain](https://www.cloudflare.com/learning/dns/glossary/what-is-a-domain-name/). If a user is unable to find the phonebook, it cannot lookup the address in order to make the call for a particular resource. By disrupting DNS resolution, a DNS flood attack will compromise a website, API, or web application's ability respond to legitimate traffic. DNS flood attacks can be difficult to distinguish from normal heavy traffic because the large volume of traffic often comes from a multitude of unique locations, querying for real records on the domain, mimicking legitimate traffic.

## How does a DNS flood attack work?

![DNS Flood DDoS Attack Diagram](https://cf-assets.www.cloudflare.com/slt3lc6tev37/36x0QwH3pnMZIE0F0foIoB/0fa53ce6f40961f6b85fdbd338d4fd04/dns-flood-ddos-attack-diagram-2.svg)

The function of the Domain Name System is to translate between easy to remember names (e.g. example.com) and hard to remember addresses of website servers (e.g. 192.168.0.1), so successfully attacking DNS infrastructure makes the Internet unusable for most people. DNS flood attacks constitute a relatively new type of DNS-based attack that has proliferated with the rise of high bandwidth [Internet of Things (IoT)](https://www.cloudflare.com/learning/ddos/glossary/internet-of-things-iot/) [botnets](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-botnet/) like [Mirai](https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/). DNS flood attacks use the high bandwidth connections of IP cameras, DVR boxes and other IoT devices to directly overwhelm the DNS servers of major providers. The volume of requests from IoT devices overwhelms the DNS provider’s services and prevents legitimate users from accessing the provider's DNS servers.

DNS flood attacks differ from [DNS amplification attacks](https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/). Unlike DNS floods, DNS amplification attacks reflect and amplify traffic off unsecured DNS servers in order to hide the origin of the attack and increase its effectiveness. DNS amplification attacks use devices with smaller bandwidth connections to make numerous requests to unsecured [DNS servers](https://www.cloudflare.com/learning/dns/dns-server-types/). The devices make many small requests for very large [DNS records](https://www.cloudflare.com/learning/dns/dns-records/), but when making the requests, the attacker forges the return address to be that of the intended victim. The amplification allows the attacker to take out larger targets with only limited attack resources.

## How can a DNS Flood attack be mitigated?

DNS floods represent a change from traditional amplification-based attack methods. With easily accessible high bandwidth botnets, attackers can now target large organizations. Until compromised IoT devices can be updated or replaced, the only way to withstand these types of attacks is to use a very large and highly distributed DNS system that can monitor, absorb, and block the attack traffic in realtime. Learn about how Cloudflare's [DDoS Protection](https://www.cloudflare.com/ddos/) protects against DNS flood attacks.

## What is a DNS amplification attack?

This [DDoS attack](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/) is a reflection-based volumetric distributed denial-of-service (DDoS) attack in which an attacker leverages the functionality of open [DNS](https://www.cloudflare.com/learning/ddos/glossary/domain-name-system-dns/) resolvers in order to overwhelm a target server or network with an amplified amount of traffic, rendering the server and its surrounding infrastructure inaccessible.

## How does a DNS amplification attack work?

All amplification attacks exploit a disparity in bandwidth consumption between an attacker and the targeted web resource. When the disparity in cost is magnified across many requests, the resulting volume of traffic can disrupt network infrastructure. By sending small queries that result in large responses, the malicious user is able to get more from less. By multiplying this magnification by having each [bot](https://www.cloudflare.com/learning/bots/what-is-a-bot/) in a [botnet](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-botnet/) make similar requests, the attacker is both obfuscated from detection and reaping the benefits of greatly increased attack traffic.

A single bot in a DNS amplification attack can be thought of in the context of a malicious teenager calling a restaurant and saying “I’ll have one of everything, please call me back and tell me my whole order.” When the restaurant asks for a callback number, the number given is the targeted victim’s phone number. The target then receives a call from the restaurant with a lot of information that they didn’t request.

As a result of each bot making requests to open [DNS resolvers](https://www.cloudflare.com/learning/dns/dns-server-types/) with a [spoofed IP address](https://www.cloudflare.com/learning/ddos/glossary/ip-spoofing/), which has been changed to the real source [IP address](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/) of the targeted victim, the target then receives a response from the DNS resolvers. In order to create a large amount of traffic, the attacker structures the request in a way that generates as large a response from the DNS resolvers as possible. As a result, the target receives an amplification of the attacker’s initial traffic, and their network becomes clogged with the spurious traffic, causing a [denial-of-service](https://www.cloudflare.com/learning/ddos/glossary/denial-of-service/).

![DNS Amplification DDoS Attack Diagram](https://cf-assets.www.cloudflare.com/slt3lc6tev37/2JmKP07Mi6jYbACILN84VI/9a91d91ecc1f414aa89ae001dbfce393/Learning_Center_DDoS_Diagrams_clean.png)

A DNS amplification can be broken down into four steps:

1. The attacker uses a compromised endpoint to send [UDP](https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/) packets with spoofed IP addresses to a DNS recursor. The spoofed address on the packets points to the real IP address of the victim.
2. Each one of the UDP packets makes a request to a DNS resolver, often passing an argument such as “ANY” in order to receive the largest response possible.
3. After receiving the requests, the DNS resolver, which is trying to be helpful by responding, sends a large response to the spoofed IP address.
4. The IP address of the target receives the response and the surrounding network infrastructure becomes overwhelmed with the deluge of traffic, resulting in a denial-of-service.

While a few requests is not enough to take down network infrastructure, when this sequence is multiplied across multiple requests and DNS resolvers, the amplification of data the target receives can be substantial. Explore more [technical details on reflection attacks](https://blog.cloudflare.com/reflections-on-reflections/).

## How is a DNS amplification attack mitigated?

For an individual or company running a website or service, mitigation options are limited. This comes from the fact that the individual’s server, while it might be the target, is not where the main effect of a volumetric attack is felt. Due to the high amount of traffic generated, the infrastructure surrounding the server feels the impact. The Internet Service Provider (ISP) or other upstream infrastructure providers may not be able to handle the incoming traffic without becoming overwhelmed. As a result, the ISP may [blackhole](https://www.cloudflare.com/learning/ddos/glossary/ddos-blackhole-routing/) all traffic to the targeted victim’s IP address, protecting itself and taking the target’s site off-line. Mitigation strategies, aside from offsite protective services like Cloudflare DDoS protection, are mostly preventative Internet infrastructure solutions.

**Reduce the total number of open DNS resolvers**

An essential component of DNS amplification attacks is access to open DNS resolvers. By having poorly configured DNS resolvers exposed to the Internet, all an attacker needs to do to utilize a DNS resolver is to discover it. Ideally, DNS resolvers should only provide their services to devices that originate within a trusted domain. In the case of reflection based attacks, the open DNS resolvers will respond to queries from anywhere on the Internet, allowing the potential for exploitation. Restricting a DNS resolver so that it will only respond to queries from trusted sources makes the server a poor vehicle for any type of amplification attack.

**Source IP verification – stop spoofed packets leaving network**

Because the UDP requests being sent by the attacker’s botnet must have a source IP address spoofed to the victim’s IP address, a key component in reducing the effectiveness of UDP-based amplification attacks is for Internet service providers (ISPs) to reject any internal traffic with spoofed IP addresses. If a packet is being sent from inside the network with a source address that makes it appear like it originated outside the network, it’s likely a spoofed packet and can be dropped. Cloudflare highly recommends that all providers implement ingress filtering, and at times will reach out to ISPs who are unknowingly taking part in DDoS attacks and help them realize their vulnerability.