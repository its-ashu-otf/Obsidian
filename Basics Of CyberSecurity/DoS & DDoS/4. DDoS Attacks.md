## What is an ACK flood DDoS attack?

An ACK flood attack is when an attacker attempts to overload a server with [TCP](https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/) ACK packets. Like other [DDoS attacks](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/), the goal of an ACK flood is to deny service to other users by slowing down or crashing the target using junk data. The targeted server has to process each ACK packet received, which uses so much computing power that it is unable to serve legitimate users.

Imagine a prank caller filling up someone's voicemail box with fake messages so that voicemails from real callers cannot get through. Now imagine that every one of those fake messages says, "Hi, I'm calling to say I received your message." This is somewhat like what happens in an ACK flood DDoS attack.

## What is an ACK packet?

ACK is short for "acknowledgement." An ACK packet is any TCP packet that acknowledges receiving a message or series of packets. The technical definition of an ACK packet is a TCP packet with the "ACK" flag set in the header.

![TCP Handshake](https://www.cloudflare.com/img/learning/cdn/tls-ssl/tcp-handshake-diagram.png "TCP Handshake")

ACK packets are part of the TCP handshake, a series of three steps that start a conversation between any two connected devices on the Internet (just as people may greet each other with a handshake in real life before initiating conversation). The three steps of the TCP handshake are:

1. SYN
2. SYN ACK
3. ACK

The device that opens the connection – say, a user's laptop – starts the three-way handshake by sending a SYN (short for "synchronize") packet. The device at the other end of the connection – suppose it's a server that hosts an online shopping website – replies with a SYN ACK packet. Finally, the user's laptop sends an ACK packet, and the three-way handshake is complete. This process ensures that both devices are online and ready to receive additional packets that, in this example, would allow the user to load the website.

However, this is not the only time ACK packets are used. The TCP protocol requires that connected devices acknowledge they have received all packets in order. Suppose a user visits a webpage that hosts an image. The image is broken up into data packets and sent to the user's browser. Once the entire image arrives, the user's device sends an ACK packet to the host server to confirm that not one pixel is missing. Without this ACK packet, the host server has to send the image again.

Since an ACK packet is any TCP packet with the ACK flag set in the header, the ACK can be part of a different message the laptop sends to the server. If the user fills out a form and submits data to the server, the laptop can make one of those packets the ACK packet for the image. It doesn't need to be a separate packet.

## How does an ACK flood attack work?

ACK flood attacks target devices that need to process every packet that they receive. [Firewalls](https://www.cloudflare.com/learning/security/what-is-a-firewall/) and servers are the most likely targets for an ACK flood. Load balancers, routers, and switches are not susceptible to these attacks.

Legitimate and illegitimate ACK packets look essentially the same, making ACK floods difficult to stop without using a [content delivery network (CDN)](https://www.cloudflare.com/learning/cdn/what-is-a-cdn/) to filter out unnecessary ACK packets. Although they look similar, packets used in an ACK DDoS attack do not contain the main part of a data packet, also known as a payload. In order to appear legitimate, they only have to include the ACK flag in the TCP header.

ACK floods are layer 4 (transport layer) DDoS attacks. [Learn about layer 4 and the OSI model](https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/).

## How does a SYN ACK flood attack work?

A SYN ACK flood DDoS attack is slightly different from an ACK attack, although the basic idea is still the same: to overwhelm the target with too many packets.

Remember how a TCP three-way handshake works: The second step in the handshake is the SYN ACK packet. Usually a server sends this SYN ACK packet in response to a SYN packet from a client device. In a SYN ACK DDoS attack, the attacker floods the target with SYN ACK packets. These packets are not part of a three-way handshake at all; their only purpose is to disrupt the target's normal operations.

It is also possible for an attacker to use SYN packets in a [SYN flood DDoS attack](https://www.cloudflare.com/learning/ddos/syn-flood-ddos-attack/).

## What is a SYN flood attack?

A SYN flood (half-open attack) is a type of [denial-of-service (DDoS) attack](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/) which aims to make a server unavailable to legitimate traffic by consuming all available server resources. By repeatedly sending initial connection request (SYN) packets, the attacker is able to overwhelm all available ports on a targeted server machine, causing the targeted device to respond to legitimate traffic sluggishly or not at all.

## How does a SYN flood attack work?

SYN flood attacks work by exploiting the handshake process of a [TCP](https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/) connection. Under normal conditions, TCP connection exhibits three distinct processes in order to make a connection.

1. First, the client sends a SYN packet to the server in order to initiate the connection.
2. The server then responds to that initial packet with a SYN/ACK packet, in order to acknowledge the communication.
3. Finally, the client returns an ACK packet to acknowledge the receipt of the packet from the server. After completing this sequence of packet sending and receiving, the TCP connection is open and able to send and receive data.

![TCP Three-way handshake diagram](https://www.cloudflare.com/img/learning/ddos/syn-flood-ddos-attack/syn-flood-attack-ddos-attack-diagram-1.png "TCP Three-way handshake diagram")

To create [denial-of-service](https://www.cloudflare.com/learning/ddos/glossary/denial-of-service/), an attacker exploits the fact that after an initial SYN packet has been received, the server will respond back with one or more SYN/ACK packets and wait for the final step in the handshake. Here’s how it works:

1. The attacker sends a high volume of SYN packets to the targeted server, often with [spoofed](https://www.cloudflare.com/learning/ddos/glossary/ip-spoofing/) IP addresses.
2. The server then responds to each one of the connection requests and leaves an open port ready to receive the response.
3. While the server waits for the final ACK packet, which never arrives, the attacker continues to send more SYN packets. The arrival of each new SYN packet causes the server to temporarily maintain a new open port connection for a certain length of time, and once all the available ports have been utilized the server is unable to function normally.

![SYN flood DDoS attack animation](https://www.cloudflare.com/img/learning/ddos/syn-flood-ddos-attack/syn-flood-attack-ddos-attack-diagram-2.png "SYN flood DDoS attack animation")

In networking, when a server is leaving a connection open but the machine on the other side of the connection is not, the connection is considered half-open. In this type of DDoS attack, the targeted server is continuously leaving open connections and waiting for each connection to timeout before the ports become available again. The result is that this type of attack can be considered a “half-open attack”.

#### A SYN flood can occur in three different ways:

1. **Direct attack:** A SYN flood where the [IP address](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/) is not spoofed is known as a direct attack. In this attack, the attacker does not mask their IP address at all. As a result of the attacker using a single source device with a real IP address to create the attack, the attacker is highly vulnerable to discovery and mitigation. In order to create the half-open state on the targeted machine, the hacker prevents their machine from responding to the server’s SYN-ACK packets. This is often achieved by [firewall](https://www.cloudflare.com/learning/security/what-is-a-firewall/) rules that stop outgoing packets other than SYN packets or by filtering out any incoming SYN-ACK packets before they reach the malicious user's machine. In practice this method is used rarely (if ever), as mitigation is fairly straightforward – just block the IP address of each malicious system. If the attacker is using a [botnet](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-botnet/) such as the [Mirai botnet](https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/) they won’t care about masking the IP of the infected device.
2. **Spoofed Attack:** A malicious user can also spoof the IP address on each SYN packet they send in order to inhibit mitigation efforts and make their identity more difficult to discover. While the packets may be spoofed, those packets can potentially be traced back to their source. It’s difficult to do this sort of detective work but it’s not impossible, especially if Internet service providers (ISPs) are willing to help.
3. **Distributed attack (DDoS):** If an attack is created using a botnet the likelihood of tracking the attack back to its source is low. For an added level of obfuscation, an attacker may have each distributed device also spoof the IP addresses from which it sends packets. If the attacker is using a botnet such as the Mirai botnet, they generally won’t care about masking the IP of the infected device.

By using a SYN flood attack, a bad actor can attempt to create [denial-of-service](https://www.cloudflare.com/learning/ddos/glossary/denial-of-service/) in a target device or service with substantially less traffic than other DDoS attacks. Instead of volumetric attacks, which aim to saturate the network infrastructure surrounding the target, SYN attacks only need to be larger than the available backlog in the target’s operating system. If the attacker is able to determine the size of the backlog and how long each connection will be left open before timing out, the attacker can target the exact parameters needed to disable the system, thereby reducing the total traffic to the minimum necessary amount to create denial-of-service.

## How is a SYN flood attack mitigated?

SYN flood vulnerability has been known for a long time and a number of mitigation pathways have been utilized. A few approaches include:

#### Increasing Backlog queue

Each operating system on a targeted device has a certain number of half-open connections that it will allow. One response to high volumes of SYN packets is to increase the maximum number of possible half-open connections the operating system will allow. In order to successfully increase the maximum backlog, the system must reserve additional memory resources to deal with all the new requests. If the system does not have enough memory to be able to handle the increased backlog queue size, system performance will be negatively impacted, but that still may be better than denial-of-service.

#### Recycling the Oldest Half-Open TCP connection

Another mitigation strategy involves overwriting the oldest half-open connection once the backlog has been filled. This strategy requires that the legitimate connections can be fully established in less time than the backlog can be filled with malicious SYN packets. This particular defense fails when the attack volume is increased, or if the backlog size is too small to be practical.

#### SYN cookies

This strategy involves the creation of a cookie by the server. In order to avoid the risk of dropping connections when the backlog has been filled, the server responds to each connection request with a SYN-ACK packet but then drops the SYN request from the backlog, removing the request from memory and leaving the port open and ready to make a new connection. If the connection is a legitimate request, and a final ACK packet is sent from the client machine back to the server, the server will then reconstruct (with some limitations) the SYN backlog queue entry. While this mitigation effort does lose some information about the TCP connection, it is better than allowing denial-of-service to occur to legitimate users as a result of an attack.

