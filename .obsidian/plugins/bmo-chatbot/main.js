/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  DEFAULT_SETTINGS: () => DEFAULT_SETTINGS,
  checkActiveFile: () => checkActiveFile,
  default: () => BMOGPT15,
  defaultFrontMatter: () => defaultFrontMatter,
  updateFrontMatter: () => updateFrontMatter,
  updateProfile: () => updateProfile,
  updateSettingsFromFrontMatter: () => updateSettingsFromFrontMatter
});
module.exports = __toCommonJS(main_exports);
var import_obsidian27 = require("obsidian");

// src/view.ts
var import_obsidian7 = require("obsidian");

// src/components/chat/Commands.ts
var import_obsidian6 = require("obsidian");

// src/utils/ColorConverter.ts
function colorToHex(colorValue) {
  if (colorValue.startsWith("hsl")) {
    const match = colorValue.match(/(\d+(\.\d+)?)%?/g);
    if (match === null || match.length < 3) {
      throw new Error("Invalid HSL value");
    }
    const h = parseInt(match[0]) / 360;
    const s = parseInt(match[1]) / 100;
    const l = parseInt(match[2]) / 100;
    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
    const p = 2 * l - q;
    const r = hue2rgb(p, q, h + 1 / 3);
    const g2 = hue2rgb(p, q, h);
    const b = hue2rgb(p, q, h - 1 / 3);
    const toHex = function(c) {
      const hex2 = Math.round(c * 255).toString(16);
      return hex2.length === 1 ? "0" + hex2 : hex2;
    };
    const hex = "#" + toHex(r) + toHex(g2) + toHex(b);
    return hex;
  } else if (colorValue.startsWith("rgb")) {
    const sep = colorValue.indexOf(",") > -1 ? "," : " ";
    const rgbArray = colorValue.substr(4).split(")")[0].split(sep);
    let r = (+rgbArray[0]).toString(16), g2 = (+rgbArray[1]).toString(16), b = (+rgbArray[2]).toString(16);
    if (r.length == 1)
      r = "0" + r;
    if (g2.length == 1)
      g2 = "0" + g2;
    if (b.length == 1)
      b = "0" + b;
    return "#" + r + g2 + b;
  } else {
    return colorValue;
  }
}
function hue2rgb(p, q, t) {
  if (t < 0)
    t += 1;
  if (t > 1)
    t -= 1;
  if (t < 1 / 6)
    return p + (q - p) * 6 * t;
  if (t < 1 / 2)
    return q;
  if (t < 2 / 3)
    return p + (q - p) * (2 / 3 - t) * 6;
  return p;
}
var isValidHexColor = (color) => {
  const hexColorRegex = /^[0-9A-Fa-f]{6}$/;
  return hexColorRegex.test(color);
};

// src/components/FetchModelResponse.ts
var import_obsidian4 = require("obsidian");

// src/components/chat/Buttons.ts
var import_obsidian = require("obsidian");

// src/components/editor/ReferenceCurrentNote.ts
var referenceCurrentNoteContent = "";
async function getActiveFileContent(plugin, settings) {
  const dotElement = document.querySelector(".dotIndicator");
  referenceCurrentNoteContent = "";
  if (settings.general.enableReferenceCurrentNote === true) {
    if (dotElement) {
      dotElement.style.backgroundColor = "#da2c2c";
      referenceCurrentNoteContent = "";
    }
    const activeFile = plugin.app.workspace.getActiveFile();
    if ((activeFile == null ? void 0 : activeFile.extension) === "md") {
      if (dotElement) {
        dotElement.style.backgroundColor = "green";
      }
      const content = await plugin.app.vault.read(activeFile);
      const clearYamlContent = content.replace(/---[\s\S]+?---/, "").trim();
      referenceCurrentNoteContent = "\n\nAdditional Note:\n\n" + clearYamlContent + "\n\n";
    }
  }
  return referenceCurrentNoteContent;
}
function getCurrentNoteContent() {
  return referenceCurrentNoteContent;
}

// src/components/chat/Buttons.ts
function regenerateUserButton(plugin, settings) {
  const regenerateButton = document.createElement("button");
  regenerateButton.textContent = "regenerate";
  (0, import_obsidian.setIcon)(regenerateButton, "refresh-ccw");
  regenerateButton.classList.add("regenerate-button");
  regenerateButton.title = "regenerate";
  let lastClickedElement = null;
  regenerateButton.addEventListener("click", async function(event) {
    event.stopPropagation();
    lastClickedElement = event.target;
    while (lastClickedElement && !lastClickedElement.classList.contains("userMessage")) {
      lastClickedElement = lastClickedElement.parentElement;
    }
    let index2 = -1;
    if (lastClickedElement) {
      const userMessages = Array.from(document.querySelectorAll("#messageContainer .userMessage"));
      index2 = userMessages.indexOf(lastClickedElement) * 2;
    }
    if (index2 !== -1) {
      deleteMessage(plugin, index2 + 1);
      if (OPENAI_MODELS.includes(settings.general.model) || settings.APIConnections.openAI.openAIBaseModels.includes(settings.general.model)) {
        try {
          if (settings.APIConnections.openAI.enableStream) {
            await fetchOpenAIAPIResponseStream(plugin, settings, index2);
          } else {
            await fetchOpenAIAPIResponse(plugin, settings, index2);
          }
        } catch (error) {
          new import_obsidian.Notice("Error occurred while fetching completion: " + error.message);
          console.log(error.message);
        }
      } else if (settings.OllamaConnection.RESTAPIURL && settings.OllamaConnection.ollamaModels.includes(settings.general.model)) {
        if (settings.OllamaConnection.enableStream) {
          await fetchOllamaResponseStream(plugin, settings, index2);
        } else {
          await fetchOllamaResponse(plugin, settings, index2);
        }
      } else if (settings.RESTAPIURLConnection.RESTAPIURLModels.includes(settings.general.model)) {
        if (settings.RESTAPIURLConnection.enableStream) {
          await fetchRESTAPIURLResponseStream(plugin, settings, index2);
        } else {
          await fetchRESTAPIURLResponse(plugin, settings, index2);
        }
      } else if (settings.APIConnections.openRouter.openRouterModels.includes(settings.general.model)) {
        if (settings.APIConnections.openRouter.enableStream) {
          await fetchOpenRouterResponseStream(plugin, settings, index2);
        } else {
          await fetchOpenRouterResponse(plugin, settings, index2);
        }
      } else if (settings.APIConnections.mistral.mistralModels.includes(settings.general.model)) {
        try {
          if (settings.APIConnections.mistral.enableStream) {
            await fetchMistralResponseStream(plugin, settings, index2);
          } else {
            await fetchMistralResponse(plugin, settings, index2);
          }
        } catch (error) {
          console.error("Mistral Error:", error);
        }
      } else if (settings.APIConnections.googleGemini.geminiModels.includes(settings.general.model)) {
        try {
          if (settings.APIConnections.googleGemini.enableStream) {
            await fetchGoogleGeminiResponseStream(plugin, settings, index2);
          } else {
            await fetchGoogleGeminiResponse(plugin, settings, index2);
          }
        } catch (error) {
          console.error("Google Gemini Error:", error);
        }
      } else if (ANTHROPIC_MODELS.includes(settings.general.model)) {
        try {
          await fetchAnthropicResponse(plugin, settings, index2);
        } catch (error) {
          console.error("Anthropic Error:", error);
        }
      }
    } else {
      new import_obsidian.Notice("No models detected.");
    }
  });
  return regenerateButton;
}
function displayUserEditButton(plugin, settings, userPre) {
  const editButton = document.createElement("button");
  editButton.textContent = "edit";
  (0, import_obsidian.setIcon)(editButton, "edit");
  editButton.classList.add("edit-button");
  editButton.title = "edit";
  let lastClickedElement = null;
  editButton.addEventListener("click", function(event) {
    var _a2;
    const editContainer = document.createElement("div");
    editContainer.classList.add("edit-container");
    const textArea = document.createElement("textarea");
    textArea.classList.add("edit-textarea");
    textArea.value = (_a2 = userPre.textContent) != null ? _a2 : "";
    editContainer.appendChild(textArea);
    const textareaEditButton = document.createElement("button");
    textareaEditButton.textContent = "Edit";
    textareaEditButton.classList.add("textarea-edit-button");
    textareaEditButton.title = "edit";
    const cancelButton = document.createElement("button");
    cancelButton.textContent = "Cancel";
    cancelButton.classList.add("textarea-cancel-button");
    cancelButton.title = "cancel";
    event.stopPropagation();
    lastClickedElement = event.target;
    while (lastClickedElement && !lastClickedElement.classList.contains("userMessage")) {
      lastClickedElement = lastClickedElement.parentElement;
    }
    textareaEditButton.addEventListener("click", async function() {
      userPre.textContent = textArea.value.trim();
      editContainer.replaceWith(userPre);
      if (lastClickedElement) {
        const userMessages = Array.from(document.querySelectorAll("#messageContainer .userMessage"));
        const index2 = userMessages.indexOf(lastClickedElement) * 2;
        if (index2 !== -1) {
          messageHistory[index2].content = textArea.value.trim();
          deleteMessage(plugin, index2 + 1);
          const regex = /(!?)\[\[(.*?)\]\]/g;
          let matches;
          let inputModified = messageHistory[index2].content;
          const replacements = /* @__PURE__ */ new Map();
          while ((matches = regex.exec(messageHistory[index2].content)) !== null) {
            const exclamation = matches[1];
            const linktext = matches[2];
            const [path, subpath] = linktext.split("#");
            const file = plugin.app.metadataCache.getFirstLinkpathDest(path, "");
            if (file && file instanceof import_obsidian.TFile) {
              try {
                const filePath = file.path;
                const fileExtension = filePath.split(".").pop();
                if (fileExtension !== "md") {
                  const isImageFile = /\.(jpg|jpeg|png|gif|webp|bmp|tiff|tif|svg)$/i.test(filePath);
                  if (!plugin.settings.OllamaConnection.ollamaModels.includes(plugin.settings.general.model)) {
                    replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
                  } else if (plugin.settings.OllamaConnection.ollamaModels.includes(plugin.settings.general.model)) {
                    if (!isImageFile) {
                      replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
                    }
                  }
                  continue;
                }
                const content = await plugin.app.vault.read(file);
                let contentToInsert = content;
                if (subpath) {
                  const lines = content.split("\n");
                  let inSubpath = false;
                  const subpathContent = [];
                  let subpathLevel = 0;
                  for (const line of lines) {
                    if (line.startsWith("#")) {
                      const match = line.match(/^#+/);
                      const headingLevel = match ? match[0].length : 0;
                      if (inSubpath) {
                        if (headingLevel <= subpathLevel) {
                          break;
                        }
                      }
                      if (!inSubpath && line.toLowerCase().includes(subpath.toLowerCase())) {
                        inSubpath = true;
                        subpathLevel = headingLevel;
                      }
                    }
                    if (inSubpath) {
                      subpathContent.push(line);
                    }
                  }
                  contentToInsert = subpathContent.join("\n");
                }
                replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>${contentToInsert}</note-rendered>`);
              } catch (err) {
                console.error(`Failed to read the content of "${path}": ${err}`);
              }
            } else {
              replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>File cannot be read.</note-rendered>`);
            }
          }
          for (const [original, replacement] of replacements) {
            inputModified = inputModified.split(original).join(replacement);
          }
          inputModified = inputModified.replace(/(<note-rendered>File cannot be read.<\/note-rendered>)+/g, "<note-rendered>File cannot be read.</note-rendered>");
          messageHistory[index2].content = inputModified;
          if (settings.OllamaConnection.RESTAPIURL && settings.OllamaConnection.ollamaModels.includes(settings.general.model)) {
            if (settings.OllamaConnection.enableStream) {
              await fetchOllamaResponseStream(plugin, settings, index2);
            } else {
              await fetchOllamaResponse(plugin, settings, index2);
            }
          } else if (settings.RESTAPIURLConnection.RESTAPIURLModels.includes(settings.general.model)) {
            if (settings.RESTAPIURLConnection.enableStream) {
              await fetchRESTAPIURLResponseStream(plugin, settings, index2);
            } else {
              await fetchRESTAPIURLResponse(plugin, settings, index2);
            }
          } else if (ANTHROPIC_MODELS.includes(settings.general.model)) {
            try {
              await fetchAnthropicResponse(plugin, settings, index2);
            } catch (error) {
              console.error("Anthropic Error:", error);
            }
          } else if (settings.APIConnections.googleGemini.geminiModels.includes(settings.general.model)) {
            try {
              if (settings.APIConnections.googleGemini.enableStream) {
                await fetchGoogleGeminiResponseStream(plugin, settings, index2);
              } else {
                await fetchGoogleGeminiResponse(plugin, settings, index2);
              }
            } catch (error) {
              console.error("Google GeminiError:", error);
            }
          } else if (settings.APIConnections.mistral.mistralModels.includes(settings.general.model)) {
            try {
              if (settings.APIConnections.mistral.enableStream) {
                await fetchMistralResponseStream(plugin, settings, index2);
              } else {
                await fetchMistralResponse(plugin, settings, index2);
              }
            } catch (error) {
              console.error("Mistral Error:", error);
            }
          } else if (OPENAI_MODELS.includes(settings.general.model) || settings.APIConnections.openAI.openAIBaseModels.includes(settings.general.model)) {
            try {
              if (settings.APIConnections.openAI.enableStream) {
                await fetchOpenAIAPIResponseStream(plugin, settings, index2);
              } else {
                await fetchOpenAIAPIResponse(plugin, settings, index2);
              }
            } catch (error) {
              new import_obsidian.Notice("Error occurred while fetching completion: " + error.message);
              console.log(error.message);
            }
          } else if (settings.APIConnections.openRouter.openRouterModels.includes(settings.general.model)) {
            if (settings.APIConnections.openRouter.enableStream) {
              await fetchOpenRouterResponseStream(plugin, settings, index2);
            } else {
              await fetchOpenRouterResponse(plugin, settings, index2);
            }
          }
        } else {
          new import_obsidian.Notice("No models detected.");
        }
      }
    });
    cancelButton.addEventListener("click", function() {
      editContainer.replaceWith(userPre);
    });
    editContainer.appendChild(textareaEditButton);
    editContainer.appendChild(cancelButton);
    if (userPre.parentNode !== null) {
      userPre.parentNode.replaceChild(editContainer, userPre);
    }
  });
  return editButton;
}
function displayBotEditButton(plugin, message) {
  const editButton = document.createElement("button");
  editButton.textContent = "edit";
  (0, import_obsidian.setIcon)(editButton, "edit");
  editButton.classList.add("edit-button");
  editButton.title = "edit";
  let lastClickedElement = null;
  editButton.addEventListener("click", function(event) {
    const editContainer = document.createElement("div");
    editContainer.classList.add("edit-container");
    const textArea = document.createElement("textarea");
    textArea.classList.add("edit-textarea");
    textArea.value = message;
    const textareaEditButton = document.createElement("button");
    textareaEditButton.textContent = "Edit";
    textareaEditButton.classList.add("textarea-edit-button");
    textareaEditButton.title = "edit";
    const cancelButton = document.createElement("button");
    cancelButton.textContent = "Cancel";
    cancelButton.classList.add("textarea-cancel-button");
    cancelButton.title = "cancel";
    editContainer.appendChild(textArea);
    event.stopPropagation();
    lastClickedElement = event.target;
    while (lastClickedElement && !lastClickedElement.classList.contains("botMessage")) {
      lastClickedElement = lastClickedElement.parentElement;
    }
    let messageBlock = lastClickedElement == null ? void 0 : lastClickedElement.querySelector(".messageBlock");
    if (messageBlock) {
      messageBlock.innerHTML = "";
      messageBlock.appendChild(editContainer);
    } else {
      console.log("messageBlock not found.");
    }
    textareaEditButton.addEventListener("click", async function() {
      message = textArea.value;
      editContainer.remove();
      messageBlock == null ? void 0 : messageBlock.remove();
      messageBlock = document.createElement("div");
      messageBlock.className = "messageBlock";
      lastClickedElement == null ? void 0 : lastClickedElement.appendChild(messageBlock);
      await import_obsidian.MarkdownRenderer.render(plugin.app, message, messageBlock, "/", plugin);
      addParagraphBreaks(messageBlock);
      const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
      copyCodeBlocks.forEach((copyCodeBlock) => {
        copyCodeBlock.textContent = "Copy";
        (0, import_obsidian.setIcon)(copyCodeBlock, "copy");
      });
      if (lastClickedElement) {
        const allMessages = Array.from(document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage"));
        const index2 = allMessages.indexOf(lastClickedElement);
        if (index2 !== -1) {
          const regex = /(!?)\[\[(.*?)\]\]/g;
          let matches;
          let inputModified = textArea.value;
          const replacements = /* @__PURE__ */ new Map();
          while ((matches = regex.exec(textArea.value)) !== null) {
            const exclamation = matches[1];
            const linktext = matches[2];
            const [path, subpath] = linktext.split("#");
            const file = plugin.app.metadataCache.getFirstLinkpathDest(path, "");
            if (file && file instanceof import_obsidian.TFile) {
              try {
                const filePath = file.path;
                const fileExtension = filePath.split(".").pop();
                if (fileExtension !== "md") {
                  const isImageFile = /\.(jpg|jpeg|png|gif|webp|bmp|tiff|tif|svg)$/i.test(filePath);
                  if (!plugin.settings.OllamaConnection.ollamaModels.includes(plugin.settings.general.model)) {
                    replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
                  } else if (plugin.settings.OllamaConnection.ollamaModels.includes(plugin.settings.general.model)) {
                    if (!isImageFile) {
                      replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
                    }
                  }
                  continue;
                }
                const content = await plugin.app.vault.read(file);
                let contentToInsert = content;
                if (subpath) {
                  const lines = content.split("\n");
                  let inSubpath = false;
                  const subpathContent = [];
                  let subpathLevel = 0;
                  for (const line of lines) {
                    if (line.startsWith("#")) {
                      const match = line.match(/^#+/);
                      const headingLevel = match ? match[0].length : 0;
                      if (inSubpath) {
                        if (headingLevel <= subpathLevel) {
                          break;
                        }
                      }
                      if (!inSubpath && line.toLowerCase().includes(subpath.toLowerCase())) {
                        inSubpath = true;
                        subpathLevel = headingLevel;
                      }
                    }
                    if (inSubpath) {
                      subpathContent.push(line);
                    }
                  }
                  contentToInsert = subpathContent.join("\n");
                }
                replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>${contentToInsert}</note-rendered>`);
              } catch (err) {
                console.error(`Failed to read the content of "${path}": ${err}`);
              }
            } else {
              replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>File cannot be read.</note-rendered>`);
            }
          }
          for (const [original, replacement] of replacements) {
            inputModified = inputModified.split(original).join(replacement);
          }
          inputModified = inputModified.replace(/(<note-rendered>File cannot be read.<\/note-rendered>)+/g, "<note-rendered>File cannot be read.</note-rendered>");
          messageHistory[index2].content = inputModified;
          const jsonString = JSON.stringify(messageHistory, null, 4);
          try {
            await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), jsonString);
          } catch (error) {
            console.error("Error writing to message history file:", error);
          }
        } else {
          new import_obsidian.Notice("No models detected.");
        }
      }
    });
    cancelButton.addEventListener("click", async function() {
      editContainer.remove();
      messageBlock == null ? void 0 : messageBlock.remove();
      messageBlock = document.createElement("div");
      messageBlock.className = "messageBlock";
      lastClickedElement == null ? void 0 : lastClickedElement.appendChild(messageBlock);
      const regexRenderedBlock = /<block-rendered>[\s\S]*?<\/block-rendered>/g;
      message = message.replace(regexRenderedBlock, "").trim();
      const regexRenderedNote = /<note-rendered>[\s\S]*?<\/note-rendered>/g;
      message = message.replace(regexRenderedNote, "").trim();
      await import_obsidian.MarkdownRenderer.render(plugin.app, message, messageBlock, "/", plugin);
      addParagraphBreaks(messageBlock);
      const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
      copyCodeBlocks.forEach((copyCodeBlock) => {
        copyCodeBlock.textContent = "Copy";
        (0, import_obsidian.setIcon)(copyCodeBlock, "copy");
      });
    });
    editContainer.appendChild(textareaEditButton);
    editContainer.appendChild(cancelButton);
  });
  return editButton;
}
function displayUserCopyButton(userPre) {
  const copyButton = document.createElement("button");
  copyButton.textContent = "copy";
  (0, import_obsidian.setIcon)(copyButton, "copy");
  copyButton.classList.add("copy-button");
  copyButton.title = "copy";
  copyButton.addEventListener("click", function() {
    const messageText = userPre.textContent;
    if (messageText !== null) {
      copyMessageToClipboard(messageText);
      new import_obsidian.Notice("Copied user message.");
    } else {
      console.error("Message content is null. Cannot copy.");
    }
  });
  return copyButton;
}
function displayBotCopyButton(settings, message) {
  const copyButton = document.createElement("button");
  copyButton.textContent = "copy";
  (0, import_obsidian.setIcon)(copyButton, "copy");
  copyButton.classList.add("copy-button");
  copyButton.title = "copy";
  copyButton.addEventListener("click", function() {
    if (message !== null) {
      copyMessageToClipboard(message);
      new import_obsidian.Notice("Copied bot message.");
    } else {
      console.error("Message content is null. Cannot copy.");
    }
  });
  return copyButton;
}
function copyMessageToClipboard(message) {
  navigator.clipboard.writeText(message).then(function() {
  }).catch(function(err) {
    console.error("Unable to copy message: ", err);
  });
}
function displayAppendButton(plugin, settings, message) {
  const appendButton = document.createElement("button");
  appendButton.textContent = "append";
  (0, import_obsidian.setIcon)(appendButton, "plus-square");
  appendButton.classList.add("append-button");
  appendButton.title = "append";
  const messageText = message;
  appendButton.addEventListener("click", async function(event) {
    var _a2, _b;
    if (((_a2 = checkActiveFile) == null ? void 0 : _a2.extension) === "md") {
      if (checkActiveFile !== lastCursorPositionFile) {
        getActiveFileContent(plugin, settings);
        const existingContent = await plugin.app.vault.read(checkActiveFile);
        const updatedContent = existingContent + "\n" + messageText;
        plugin.app.vault.modify(checkActiveFile, updatedContent);
      } else {
        (_b = activeEditor) == null ? void 0 : _b.replaceRange(messageText, lastCursorPosition);
      }
      event.stopPropagation();
      new import_obsidian.Notice("Appended response.");
    } else {
      new import_obsidian.Notice("No active Markdown file detected.");
    }
  });
  return appendButton;
}
function displayTrashButton(plugin) {
  const trashButton = document.createElement("button");
  trashButton.textContent = "trash";
  (0, import_obsidian.setIcon)(trashButton, "trash");
  trashButton.classList.add("trash-button");
  trashButton.title = "trash";
  let lastClickedElement = null;
  trashButton.addEventListener("click", function(event) {
    event.stopPropagation();
    lastClickedElement = event.target;
    while (lastClickedElement && !lastClickedElement.classList.contains("userMessage")) {
      lastClickedElement = lastClickedElement.parentElement;
    }
    if (lastClickedElement) {
      const userMessages = Array.from(document.querySelectorAll("#messageContainer .userMessage"));
      const index2 = userMessages.indexOf(lastClickedElement) * 2;
      if (index2 !== -1) {
        const modal = new import_obsidian.Modal(plugin.app);
        modal.contentEl.innerHTML = `
                <div class="modal-content">
                    <h2>Delete Message Block.</h2>
                    <p>Are you sure you want to delete this message block?</p>
                    <button id="confirmDelete">Confirm Delete</button>
                </div>
                `;
        const confirmDeleteButton = modal.contentEl.querySelector("#confirmDelete");
        confirmDeleteButton == null ? void 0 : confirmDeleteButton.addEventListener("click", async function() {
          deleteMessage(plugin, index2);
          new import_obsidian.Notice("Message deleted.");
          modal.close();
        });
        modal.open();
      }
    }
  });
  return trashButton;
}
async function deleteMessage(plugin, index2) {
  const messageContainer = document.querySelector("#messageContainer");
  const divElements = messageContainer == null ? void 0 : messageContainer.querySelectorAll("div.botMessage, div.userMessage");
  if (divElements && divElements.length > 0 && index2 >= 0 && index2 < divElements.length) {
    messageContainer == null ? void 0 : messageContainer.removeChild(divElements[index2]);
    if (index2 + 1 < divElements.length) {
      const nextMessage = divElements[index2 + 1];
      if (nextMessage.classList.contains("botMessage")) {
        messageContainer == null ? void 0 : messageContainer.removeChild(nextMessage);
      }
    }
  }
  if (messageHistory[index2 + 1] && messageHistory[index2 + 1].role === "assistant") {
    messageHistory.splice(index2, 2);
  } else {
    messageHistory.splice(index2, 1);
  }
  const jsonString = JSON.stringify(messageHistory, null, 4);
  try {
    await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), jsonString);
  } catch (error) {
    console.error("Error writing messageHistory.json", error);
  }
}

// src/components/chat/Message.ts
var import_obsidian2 = require("obsidian");
async function addMessage(plugin, input, messageType, settings, index2) {
  const messageObj = {
    role: "",
    content: "",
    images: []
  };
  const referenceCurrentNoteContent2 = getCurrentNoteContent() || "";
  const fullInput = referenceCurrentNoteContent2 + input;
  const imagesVaultPath = [];
  if (plugin.settings.OllamaConnection.ollamaModels.includes(plugin.settings.general.model)) {
    const imageMatch = fullInput.match(/!?\[\[(.*?)\]\]/g);
    const imageLink = imageMatch ? imageMatch.map((item) => item.startsWith("!") ? item.slice(3, -2) : item.slice(2, -2)).filter((link) => /\.(jpg|jpeg|png|gif|webp|bmp|tiff|tif|svg)$/i.test(link)) : [];
    if (imageLink.length > 0) {
      imageLink.forEach((link) => {
        const imageFile = this.app.metadataCache.getFirstLinkpathDest(link, "");
        const image = imageFile ? this.app.vault.adapter.getFullPath(imageFile.path) : null;
        if (image) {
          imagesVaultPath.push(image);
        }
      });
    }
  }
  if (messageType === "userMessage") {
    messageObj.role = "user";
    messageObj.content = input;
    messageObj.images = imagesVaultPath;
  } else if (messageType === "botMessage") {
    messageObj.role = "assistant";
    messageObj.content = input;
    const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
    const targetUserMessage = messageContainerElDivs[index2];
    const targetBotMessage = targetUserMessage.nextElementSibling;
    const botMessageToolBarDiv = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".botMessageToolBar");
    const buttonContainerDiv = document.createElement("div");
    buttonContainerDiv.className = "button-container";
    botMessageToolBarDiv == null ? void 0 : botMessageToolBarDiv.appendChild(buttonContainerDiv);
    const submitButton = document.querySelector(".submit-button");
    submitButton.textContent = "send";
    (0, import_obsidian2.setIcon)(submitButton, "arrow-up");
    submitButton.title = "send";
    if (!messageObj.content.includes("commandBotMessage") && !messageObj.content.includes("errorBotMessage")) {
      const editButton = displayBotEditButton(plugin, messageObj.content);
      const copyBotButton = displayBotCopyButton(settings, messageObj.content);
      const appendButton = displayAppendButton(plugin, settings, messageObj.content);
      buttonContainerDiv.appendChild(editButton);
      buttonContainerDiv.appendChild(copyBotButton);
      buttonContainerDiv.appendChild(appendButton);
    }
  }
  try {
    messageHistory.splice(index2 + 1, 0, messageObj);
    const jsonString = JSON.stringify(messageHistory, null, 4);
    await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), jsonString);
    const messageContainerEl = document.getElementById("messageContainer");
    if (messageContainerEl) {
      const lastBotMessage = messageContainerEl.querySelector(".botMessage:last-child");
      if (lastBotMessage) {
        const getBlockLanguage = lastBotMessage.querySelectorAll('div[class^="block-language-"]');
        const replacedLangaugeBlocks = /* @__PURE__ */ new Set();
        getBlockLanguage.forEach(async (block) => {
          if (!block.querySelector(".rendered-markdown-output") && messageType === "botMessage") {
            const blockToMarkdown = (0, import_obsidian2.htmlToMarkdown)(block || "");
            const markdownNode = document.createElement("div");
            markdownNode.classList.add("rendered-markdown-output");
            markdownNode.textContent = `

<block-rendered>
${blockToMarkdown}
</block-rendered>

`;
            let renderedMarkdownOutput = markdownNode.textContent;
            renderedMarkdownOutput = renderedMarkdownOutput.replace(/\[([^\]]+)\]\(([^)]+)\)/g, (match, p1, p2) => {
              const filename = p2.split("/").pop().replace(".md", "");
              return `[[${filename}]]`;
            });
            const extractBlocks = (message) => {
              const regex = /```(\w+)\n([\s\S]*?)```(\s*(<block-rendered>[\s\S]*?<\/block-rendered>\s*)?)/g;
              let updatedMessage = message;
              for (const match of [...message.matchAll(regex)]) {
                const oldBlock = match[0];
                const blockContent = match[2].trim();
                if (replacedLangaugeBlocks.has(oldBlock)) {
                  continue;
                }
                const newBlock = `\`\`\`${match[1]}
${blockContent}
\`\`\`${renderedMarkdownOutput}`;
                updatedMessage = updatedMessage.replace(oldBlock, newBlock);
                replacedLangaugeBlocks.add(newBlock);
                break;
              }
              return updatedMessage;
            };
            const updatedMessageContent = extractBlocks(messageObj.content);
            messageObj.content = updatedMessageContent;
            const updatedJsonString = JSON.stringify(messageHistory, null, 4);
            await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), updatedJsonString);
          }
        });
        const getNoteContent = lastBotMessage.querySelectorAll(".internal-embed.markdown-embed.inline-embed.is-loaded");
        const replacedNoteBlocks = /* @__PURE__ */ new Set();
        getNoteContent.forEach(async (link) => {
          if (!link.querySelector(".rendered-markdown-output")) {
            const blockToMarkdown = (0, import_obsidian2.htmlToMarkdown)(link || "");
            const markdownNode = document.createElement("div");
            markdownNode.classList.add("rendered-markdown-output");
            markdownNode.textContent = `

<note-rendered>
${blockToMarkdown}
</note-rendered>

`;
            const renderedMarkdownOutput = markdownNode.textContent;
            const extractLinks = (message) => {
              const regex = /(!\[\[.*?\]\])(\s*(<note-rendered>[\s\S]*?<\/note-rendered>\s*)?)/g;
              let updatedMessage = message;
              for (const match of [...message.matchAll(regex)]) {
                const oldLink = match[0];
                const noteLink = match[1];
                if (replacedNoteBlocks.has(oldLink)) {
                  continue;
                }
                const newLink = `${noteLink}
${renderedMarkdownOutput}`;
                updatedMessage = updatedMessage.replace(oldLink, newLink);
                replacedNoteBlocks.add(newLink);
                break;
              }
              return updatedMessage;
            };
            const updatedMessageContent = extractLinks(messageObj.content);
            messageObj.content = updatedMessageContent;
            const updatedJsonString = JSON.stringify(messageHistory, null, 4);
            await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), updatedJsonString);
          }
        });
      }
    }
  } catch (error) {
    console.error("Error writing to message history file:", error);
  }
}
function addParagraphBreaks(messageBlock) {
  const paragraphs = messageBlock.querySelectorAll("p");
  for (let i = 0; i < paragraphs.length; i++) {
    const p = paragraphs[i];
    const nextSibling = p.nextElementSibling;
    if (nextSibling && nextSibling.nodeName === "P") {
      const br = document.createElement("br");
      const parent = p.parentNode;
      if (parent) {
        parent.insertBefore(br, nextSibling);
      }
    }
  }
}
function updateUnresolvedInternalLinks(plugin, divBlock) {
  const internalLinks = divBlock.querySelectorAll("a");
  internalLinks.forEach((link) => {
    let linkHref = link.getAttribute("href") || link.getAttribute("data-href");
    if (linkHref) {
      if (linkHref.includes("#")) {
        linkHref = linkHref.split("#")[0];
      }
      const linkExists = plugin.app.metadataCache.getFirstLinkpathDest(linkHref, "");
      if (!linkExists) {
        link.style.color = "grey";
      }
    }
  });
}

// src/components/chat/BotMessage.ts
var import_obsidian3 = require("obsidian");
function displayBotMessage(plugin, settings, messageHistory2, message) {
  const botMessageDiv = document.createElement("div");
  botMessageDiv.className = "botMessage";
  botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
  botMessageDiv.style.color = settings.appearance.botMessageFontColor || DEFAULT_SETTINGS.appearance.botMessageFontColor;
  const botMessageToolBarDiv = document.createElement("div");
  botMessageToolBarDiv.className = "botMessageToolBar";
  const buttonContainerDiv = document.createElement("div");
  buttonContainerDiv.className = "button-container";
  const botNameSpan = document.createElement("span");
  botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
  botNameSpan.className = "chatbotName";
  botMessageToolBarDiv.appendChild(botNameSpan);
  botMessageToolBarDiv.appendChild(buttonContainerDiv);
  const messageBlockDiv = document.createElement("div");
  messageBlockDiv.className = "messageBlock";
  const regexRenderedBlock = /<block-rendered>[\s\S]*?<\/block-rendered>/g;
  message = message.replace(regexRenderedBlock, "").trim();
  const regexRenderedNote = /<note-rendered>[\s\S]*?<\/note-rendered>/g;
  message = message.replace(regexRenderedNote, "").trim();
  import_obsidian3.MarkdownRenderer.render(plugin.app, message, messageBlockDiv, "", plugin);
  if (!message.includes("commandBotMessage") && !message.includes("errorBotMessage")) {
    const editButton = displayBotEditButton(plugin, message);
    const copyBotButton = displayBotCopyButton(settings, message);
    const appendButton = displayAppendButton(plugin, settings, message);
    buttonContainerDiv.appendChild(editButton);
    buttonContainerDiv.appendChild(copyBotButton);
    buttonContainerDiv.appendChild(appendButton);
    addParagraphBreaks(messageBlockDiv);
  }
  const copyCodeBlocks = messageBlockDiv.querySelectorAll(".copy-code-button");
  copyCodeBlocks.forEach((copyCodeBlock) => {
    copyCodeBlock.textContent = "Copy";
    (0, import_obsidian3.setIcon)(copyCodeBlock, "copy");
  });
  botMessageDiv.appendChild(botMessageToolBarDiv);
  botMessageDiv.appendChild(messageBlockDiv);
  return botMessageDiv;
}
function displayLoadingBotMessage(settings) {
  const botMessageDiv = document.createElement("div");
  botMessageDiv.className = "botMessage";
  botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
  botMessageDiv.style.color = settings.appearance.botMessageFontColor || DEFAULT_SETTINGS.appearance.botMessageFontColor;
  const botMessageToolBarDiv = document.createElement("div");
  botMessageToolBarDiv.className = "botMessageToolBar";
  const botNameSpan = document.createElement("span");
  botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
  botNameSpan.className = "chatbotName";
  const messageBlockDiv = document.createElement("div");
  messageBlockDiv.className = "messageBlock";
  const loadingEl = document.createElement("span");
  loadingEl.setAttribute("id", "loading");
  for (let i = 0; i < 3; i++) {
    const dotSpan = document.createElement("span");
    dotSpan.textContent = ".";
    loadingEl.appendChild(dotSpan);
  }
  botMessageToolBarDiv.appendChild(botNameSpan);
  botMessageDiv.appendChild(botMessageToolBarDiv);
  botMessageDiv.appendChild(messageBlockDiv);
  botMessageDiv.appendChild(loadingEl);
  return botMessageDiv;
}
function displayCommandBotMessage(plugin, settings, messageHistory2, message) {
  const botMessageDiv = document.createElement("div");
  botMessageDiv.className = "botMessage";
  botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
  const botMessageToolBarDiv = document.createElement("div");
  botMessageToolBarDiv.className = "botMessageToolBar";
  const botNameSpan = document.createElement("span");
  botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
  botNameSpan.className = "chatbotName";
  const messageBlockDiv = document.createElement("div");
  messageBlockDiv.className = "messageBlock";
  const displayCommandBotMessageDiv = document.createElement("div");
  displayCommandBotMessageDiv.className = "commandBotMessage";
  displayCommandBotMessageDiv.innerHTML = message;
  messageBlockDiv.appendChild(displayCommandBotMessageDiv);
  botMessageToolBarDiv.appendChild(botNameSpan);
  botMessageDiv.appendChild(botMessageToolBarDiv);
  botMessageDiv.appendChild(messageBlockDiv);
  const index2 = messageHistory2.length - 1;
  addMessage(plugin, messageBlockDiv.innerHTML, "botMessage", settings, index2);
  return botMessageDiv;
}
function displayErrorBotMessage(plugin, settings, messageHistory2, message) {
  const botMessageDiv = document.createElement("div");
  botMessageDiv.className = "botMessage";
  botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
  const botMessageToolBarDiv = document.createElement("div");
  botMessageToolBarDiv.className = "botMessageToolBar";
  const botNameSpan = document.createElement("span");
  botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
  botNameSpan.className = "chatbotName";
  const messageBlockDiv = document.createElement("div");
  messageBlockDiv.className = "messageBlock";
  const displayErrorBotMessageDiv = document.createElement("div");
  displayErrorBotMessageDiv.className = "errorBotMessage";
  const BotP = document.createElement("p");
  BotP.textContent = message;
  console.error(message);
  messageBlockDiv.appendChild(displayErrorBotMessageDiv);
  displayErrorBotMessageDiv.appendChild(BotP);
  botMessageToolBarDiv.appendChild(botNameSpan);
  botMessageDiv.appendChild(botMessageToolBarDiv);
  botMessageDiv.appendChild(messageBlockDiv);
  const index2 = messageHistory2.length - 1;
  addMessage(plugin, messageBlockDiv.innerHTML, "botMessage", this.settings, index2);
  return botMessageDiv;
}

// src/components/chat/Prompt.ts
async function getPrompt(plugin, settings) {
  if (settings.prompts.prompt.trim() === "") {
    return "";
  }
  const promptFilePath = settings.prompts.promptFolderPath + "/" + settings.prompts.prompt;
  try {
    const content = await plugin.app.vault.adapter.read(promptFilePath);
    const clearYamlContent = content.replace(/---[\s\S]+?---/, "").trim();
    return "\n\n" + clearYamlContent + "\n\n";
  } catch (error) {
    console.error(`Error reading file ${promptFilePath}:`, error);
    return null;
  }
}

// src/components/FetchModelResponse.ts
var abortController = null;
async function fetchOllamaResponse(plugin, settings, index2) {
  const ollamaRESTAPIURL = settings.OllamaConnection.RESTAPIURL;
  if (!ollamaRESTAPIURL) {
    return;
  }
  const prompt = await getPrompt(plugin, settings);
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(ollamaRESTAPIURL + "/api/chat", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: referenceCurrentNoteContent2 + settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ],
        stream: false,
        options: ollamaParametersOptions(settings)
      }),
      signal: abortController.signal
    });
    const responseData = await response.json();
    let message = responseData.message.content;
    if (messageContainerEl) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
      (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
      submitButton.title = "send";
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
          addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
  } finally {
    abortController = null;
  }
}
async function fetchOllamaResponseStream(plugin, settings, index2) {
  const ollamaRESTAPIURL = settings.OllamaConnection.RESTAPIURL;
  if (!ollamaRESTAPIURL) {
    return;
  }
  const prompt = await getPrompt(plugin, settings);
  const url = ollamaRESTAPIURL + "/api/chat";
  abortController = new AbortController();
  let message = "";
  let isScroll = false;
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ],
        stream: true,
        keep_alive: parseInt(settings.OllamaConnection.ollamaParameters.keep_alive),
        options: ollamaParametersOptions(settings)
      }),
      signal: abortController.signal
    });
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: true }) || "";
      const parts = chunk.split("\n");
      for (const part of parts.filter(Boolean)) {
        let parsedChunk;
        try {
          parsedChunk = JSON.parse(part);
          if (parsedChunk.done !== true) {
            const content = parsedChunk.message.content;
            message += content;
          }
        } catch (err) {
          console.error("Error parsing JSON:", err);
          console.log("Part with error:", part);
          parsedChunk = { response: "{_e_}" };
        }
      }
      const messageContainerEl2 = document.querySelector("#messageContainer");
      if (messageContainerEl2) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl2.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
    if (message.trim() === "") {
      addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
    } else {
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
    new import_obsidian4.Notice("Stream stopped.");
    console.error("Error fetching chat response from Ollama:", error);
  } finally {
    abortController = null;
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
async function fetchRESTAPIURLResponse(plugin, settings, index2) {
  const prompt = await getPrompt(plugin, settings);
  const noImageMessageHistory = messageHistory.map(({ role, content }) => ({ role, content }));
  const filteredMessageHistory = filterMessageHistory(noImageMessageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  try {
    const response = await (0, import_obsidian4.requestUrl)({
      url: settings.RESTAPIURLConnection.RESTAPIURL + "/chat/completions",
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.RESTAPIURLConnection.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 || "You are a helpful assistant." },
          ...messageHistoryAtIndex
        ],
        max_tokens: parseInt(settings.general.max_tokens) || -1,
        temperature: parseInt(settings.general.temperature)
      })
    });
    let message = response.json.choices[0].message.content;
    const messageContainerEl2 = document.querySelector("#messageContainer");
    if (messageContainerEl2) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    return;
  } catch (error) {
    const targetUserMessage = messageContainerElDivs[index2];
    const targetBotMessage = targetUserMessage.nextElementSibling;
    targetBotMessage == null ? void 0 : targetBotMessage.remove();
    const messageContainer = document.querySelector("#messageContainer");
    const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
    messageContainer.appendChild(botMessageDiv2);
  }
}
async function fetchRESTAPIURLResponseStream(plugin, settings, index2) {
  const RESTAPIURL = settings.RESTAPIURLConnection.RESTAPIURL;
  if (!RESTAPIURL) {
    return;
  }
  const prompt = await getPrompt(plugin, settings);
  const url = RESTAPIURL + "/chat/completions";
  abortController = new AbortController();
  let message = "";
  let isScroll = false;
  const noImageMessageHistory = messageHistory.map(({ role, content }) => ({ role, content }));
  const filteredMessageHistory = filterMessageHistory(noImageMessageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.RESTAPIURLConnection.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 || "You are a helpful assistant." },
          ...messageHistoryAtIndex
        ],
        stream: true,
        temperature: parseInt(settings.general.temperature),
        max_tokens: parseInt(settings.general.max_tokens) || 4096
      }),
      signal: abortController.signal
    });
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: false }) || "";
      const parts = chunk.split("\n");
      for (const part of parts.filter(Boolean)) {
        if (part.includes("data: [DONE]")) {
          break;
        }
        let parsedChunk;
        try {
          parsedChunk = JSON.parse(part.replace(/^data: /, ""));
          if (parsedChunk.choices[0].finish_reason !== "stop") {
            const content = parsedChunk.choices[0].delta.content;
            message += content;
          }
        } catch (err) {
          console.error("Error parsing JSON:", err);
          console.log("Part with error:", part);
          parsedChunk = { response: "{_e_}" };
        }
      }
      const messageContainerEl2 = document.querySelector("#messageContainer");
      if (messageContainerEl2) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl2.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
    if (message.trim() === "") {
      addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
    } else {
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
    new import_obsidian4.Notice("Stream stopped.");
    console.error("Error fetching chat response from Ollama:", error);
  } finally {
    abortController = null;
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
async function fetchAnthropicResponse(plugin, settings, index2) {
  const prompt = await getPrompt(plugin, settings);
  const noImageMessageHistory = messageHistory.map(({ role, content }) => ({ role, content }));
  const filteredMessageHistory = filterMessageHistory(noImageMessageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await (0, import_obsidian4.requestUrl)({
      url: "https://api.anthropic.com/v1/messages",
      method: "POST",
      headers: {
        "anthropic-version": "2023-06-01",
        "content-type": "application/json",
        "x-api-key": settings.APIConnections.anthropic.APIKey
      },
      body: JSON.stringify({
        model: settings.general.model,
        system: settings.general.system_role + prompt + referenceCurrentNoteContent2,
        messages: [
          ...messageHistoryAtIndex
        ],
        max_tokens: parseInt(settings.general.max_tokens) || 4096,
        temperature: parseInt(settings.general.temperature)
      })
    });
    let message = response.json.content[0].text;
    const messageContainerEl2 = document.querySelector("#messageContainer");
    if (messageContainerEl2) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    return;
  } catch (error) {
    const targetUserMessage = messageContainerElDivs[index2];
    const targetBotMessage = targetUserMessage.nextElementSibling;
    targetBotMessage == null ? void 0 : targetBotMessage.remove();
    const messageContainer = document.querySelector("#messageContainer");
    const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
    messageContainer.appendChild(botMessageDiv2);
  }
}
async function fetchGoogleGeminiResponse(plugin, settings, index2) {
  const prompt = await getPrompt(plugin, settings);
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const convertMessageHistory = (messageHistory2) => {
    const modifiedMessageHistory = [...messageHistory2];
    const convertedMessageHistory2 = modifiedMessageHistory.map(({ role, content }) => ({
      role: role === "assistant" ? "model" : role,
      parts: [{ text: content }]
    }));
    const contents = [
      ...convertedMessageHistory2
    ];
    return { contents };
  };
  const convertedMessageHistory = convertMessageHistory(messageHistoryAtIndex);
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const API_KEY = settings.APIConnections.googleGemini.APIKey;
    const MODEL = settings.general.model;
    const url = "https://generativelanguage.googleapis.com/v1beta/" + MODEL + ":generateContent?key=" + API_KEY;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: [
          {
            role: "user",
            parts: [{ text: `System prompt: 

 ${plugin.settings.general.system_role} ${prompt} ${referenceCurrentNoteContent2} Respond understood if you got it.` }]
          },
          {
            role: "model",
            parts: [{ text: "Understood." }]
          },
          ...convertedMessageHistory.contents
        ],
        generationConfig: {
          stopSequences: "",
          temperature: parseInt(settings.general.temperature),
          maxOutputTokens: settings.general.max_tokens || 4096,
          topP: 0.8,
          topK: 10
        }
      }),
      signal: abortController == null ? void 0 : abortController.signal
    });
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const responseData = await response.json();
    let message = responseData.candidates[0].content.parts[0].text;
    const messageContainerEl2 = document.querySelector("#messageContainer");
    if (messageContainerEl2) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    return;
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
      (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
      submitButton.title = "send";
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
          addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
  } finally {
    abortController = null;
  }
}
async function fetchGoogleGeminiResponseStream(plugin, settings, index2) {
  const prompt = await getPrompt(plugin, settings);
  abortController = new AbortController();
  let message = "";
  let isScroll = false;
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const convertMessageHistory = (messageHistory2) => {
    const modifiedMessageHistory = [...messageHistory2];
    const convertedMessageHistory2 = modifiedMessageHistory.map(({ role, content }) => ({
      role: role === "assistant" ? "model" : role,
      parts: [{ text: content }]
    }));
    const contents = [
      ...convertedMessageHistory2
    ];
    return { contents };
  };
  const convertedMessageHistory = convertMessageHistory(messageHistoryAtIndex);
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const API_KEY = settings.APIConnections.googleGemini.APIKey;
    const MODEL = settings.general.model;
    const url = "https://generativelanguage.googleapis.com/v1beta/" + MODEL + ":streamGenerateContent?alt=sse&key=" + API_KEY;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: [
          {
            role: "user",
            parts: [{ text: `System prompt: 

 ${plugin.settings.general.system_role} ${prompt} ${referenceCurrentNoteContent2} Respond understood if you got it.` }]
          },
          {
            role: "model",
            parts: [{ text: "Understood." }]
          },
          ...convertedMessageHistory.contents
        ],
        generationConfig: {
          stopSequences: "",
          temperature: parseInt(settings.general.temperature),
          maxOutputTokens: settings.general.max_tokens || 4096,
          topP: 0.8,
          topK: 10
        }
      }),
      signal: abortController == null ? void 0 : abortController.signal
    });
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: true }) || "";
      const parts = chunk.split("\n");
      for (const part of parts.filter(Boolean)) {
        if (part.startsWith("data: ")) {
          const jsonData = part.slice(6);
          let parsedChunk;
          try {
            parsedChunk = JSON.parse(jsonData);
            if (parsedChunk.done !== true) {
              const content = parsedChunk.candidates[0].content.parts[0].text;
              message += content;
            }
          } catch (err) {
            console.error("Error parsing JSON:", err);
            console.log("Part with error:", jsonData);
            parsedChunk = { response: "{_e_}" };
          }
        }
      }
      const messageContainerEl2 = document.querySelector("#messageContainer");
      if (messageContainerEl2) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl2.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
    if (message.trim() === "") {
      addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
    } else {
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
    new import_obsidian4.Notice("Stream stopped.");
    console.error("Error fetching chat response from Google Gemini:", error);
  } finally {
    abortController = null;
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
async function fetchMistralResponse(plugin, settings, index2) {
  const prompt = await getPrompt(plugin, settings);
  const noImageMessageHistory = messageHistory.map(({ role, content }) => ({ role, content }));
  const filteredMessageHistory = filterMessageHistory(noImageMessageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch("https://api.mistral.ai/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.mistral.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ],
        max_tokens: parseInt(settings.general.max_tokens) || 4096,
        temperature: parseInt(settings.general.temperature)
      }),
      signal: abortController == null ? void 0 : abortController.signal
    });
    const data = await response.json();
    let message = data.choices[0].message.content;
    const messageContainerEl2 = document.querySelector("#messageContainer");
    if (messageContainerEl2) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    return;
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
      (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
      submitButton.title = "send";
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
          addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
  } finally {
    abortController = null;
  }
}
async function fetchMistralResponseStream(plugin, settings, index2) {
  abortController = new AbortController();
  const prompt = await getPrompt(plugin, settings);
  let message = "";
  let isScroll = false;
  const noImageMessageHistory = messageHistory.map(({ role, content }) => ({ role, content }));
  const filteredMessageHistory = filterMessageHistory(noImageMessageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  abortController = new AbortController();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch("https://api.mistral.ai/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.mistral.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ],
        stream: true,
        temperature: parseInt(settings.general.temperature),
        max_tokens: parseInt(settings.general.max_tokens) || 4096
      }),
      signal: abortController.signal
    });
    (0, import_obsidian4.setIcon)(submitButton, "square");
    submitButton.title = "stop";
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: false }) || "";
      const parts = chunk.split("\n");
      for (const part of parts.filter(Boolean)) {
        if (part.includes("data: [DONE]")) {
          break;
        }
        let parsedChunk;
        try {
          parsedChunk = JSON.parse(part.replace(/^data: /, ""));
          if (parsedChunk.choices[0].finish_reason !== "stop") {
            const content = parsedChunk.choices[0].delta.content;
            message += content;
          }
        } catch (err) {
          console.error("Error parsing JSON:", err);
          console.log("Part with error:", part);
          parsedChunk = { response: "{_e_}" };
        }
      }
      const messageContainerEl2 = document.querySelector("#messageContainer");
      if (messageContainerEl2) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl2.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
    if (message.trim() === "") {
      addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
    } else {
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
    new import_obsidian4.Notice("Stream stopped.");
    console.error("Error fetching chat response from Mistral:", error);
  } finally {
    abortController = null;
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
async function fetchOpenAIAPIResponse(plugin, settings, index2) {
  abortController = new AbortController();
  const prompt = await getPrompt(plugin, settings);
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(`${plugin.settings.APIConnections.openAI.openAIBaseUrl}/chat/completions`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${plugin.settings.APIConnections.openAI.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        max_tokens: parseInt(settings.general.max_tokens),
        stream: false,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ]
      }),
      signal: abortController.signal
    });
    const data = await response.json();
    let message = data.choices[0].message.content || "";
    if (messageContainerEl) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    if (message != null) {
      const regexPatterns = [
        /<block-rendered>[\s\S]*?<\/block-rendered>/g,
        /<note-rendered>[\s\S]*?<\/note-rendered>/g,
        /<note-rendered>[\s\S]*?<\/note-rendered>/g
      ];
      regexPatterns.forEach((pattern) => {
        message = message.replace(pattern, "").trim();
      });
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
      (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
      submitButton.title = "send";
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
          addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
  } finally {
    abortController = null;
  }
}
async function fetchOpenAIAPIResponseStream(plugin, settings, index2) {
  abortController = new AbortController();
  const prompt = await getPrompt(plugin, settings);
  let message = "";
  let isScroll = false;
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  const targetUserMessage = messageContainerElDivs[index2];
  const targetBotMessage = targetUserMessage.nextElementSibling;
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(`${plugin.settings.APIConnections.openAI.openAIBaseUrl}/chat/completions`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${plugin.settings.APIConnections.openAI.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        max_tokens: parseInt(settings.general.max_tokens),
        stream: true,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 },
          ...messageHistoryAtIndex
        ]
      }),
      signal: abortController.signal
    });
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: true }) || "";
      const parts = chunk.split("\n");
      for (const part of parts) {
        if (part.includes("data: [DONE]")) {
          reading = false;
          break;
        }
        try {
          const trimmedPart = part.replace(/^data: /, "").trim();
          if (trimmedPart) {
            const data = JSON.parse(trimmedPart);
            if (data.choices && data.choices[0].delta && data.choices[0].delta.content) {
              const content = data.choices[0].delta.content;
              message += content;
            }
          }
        } catch (err) {
          console.error("Error parsing JSON:", err);
          console.log("Part with error:", part);
        }
      }
      if (messageContainerEl) {
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
      if (abortController.signal.aborted) {
        new import_obsidian4.Notice("Stream stopped.");
        break;
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    if (error.name === "AbortError") {
      if (messageContainerEl) {
        const targetUserMessage2 = messageContainerElDivs[index2];
        const targetBotMessage2 = targetUserMessage2.nextElementSibling;
        const messageBlock = targetBotMessage2 == null ? void 0 : targetBotMessage2.querySelector(".messageBlock");
        const loadingEl = targetBotMessage2 == null ? void 0 : targetBotMessage2.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage2 == null ? void 0 : targetBotMessage2.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
        }
      }
    } else {
      const targetUserMessage2 = messageContainerElDivs[index2];
      const targetBotMessage2 = targetUserMessage2.nextElementSibling;
      targetBotMessage2 == null ? void 0 : targetBotMessage2.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
    if (message.trim() === "") {
      addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
    } else {
      addMessage(plugin, message.trim(), "botMessage", settings, index2);
    }
    new import_obsidian4.Notice("Stream stopped.");
    console.error("Error fetching chat response from OpenAI-Based Models:", error);
  } finally {
    abortController = null;
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
async function fetchOpenRouterResponse(plugin, settings, index2) {
  abortController = new AbortController();
  const prompt = await getPrompt(plugin, settings);
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", async () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.openRouter.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 || "You are a helpful assistant." },
          ...messageHistoryAtIndex
        ],
        max_tokens: parseInt(settings.general.max_tokens) || 4096,
        temperature: parseInt(settings.general.temperature)
      }),
      signal: abortController.signal
    });
    const data = await response.json();
    let message = data.choices[0].message.content;
    const messageContainerEl2 = document.querySelector("#messageContainer");
    if (messageContainerEl2) {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
      const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
      if (messageBlock) {
        if (loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
        }
        await import_obsidian4.MarkdownRenderer.render(plugin.app, message || "", messageBlock, "/", plugin);
        addParagraphBreaks(messageBlock);
        updateUnresolvedInternalLinks(plugin, messageBlock);
        const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
        copyCodeBlocks.forEach((copyCodeBlock) => {
          copyCodeBlock.textContent = "Copy";
          (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
        });
        targetBotMessage == null ? void 0 : targetBotMessage.appendChild(messageBlock);
      }
      targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    return;
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
      (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
      submitButton.title = "send";
      if (messageContainerEl) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock && loadingEl) {
          targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          messageBlock.textContent = "SYSTEM: Response aborted.";
          addMessage(plugin, "SYSTEM: Response aborted.", "botMessage", settings, index2);
        }
      }
    } else {
      const targetUserMessage = messageContainerElDivs[index2];
      const targetBotMessage = targetUserMessage.nextElementSibling;
      targetBotMessage == null ? void 0 : targetBotMessage.remove();
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv2 = displayErrorBotMessage(plugin, settings, messageHistory, error);
      messageContainer.appendChild(botMessageDiv2);
    }
  } finally {
    abortController = null;
  }
}
async function fetchOpenRouterResponseStream(plugin, settings, index2) {
  const url = "https://openrouter.ai/api/v1/chat/completions";
  abortController = new AbortController();
  const prompt = await getPrompt(plugin, settings);
  let message = "";
  let isScroll = false;
  const filteredMessageHistory = filterMessageHistory(messageHistory);
  const messageHistoryAtIndex = removeConsecutiveUserRoles(filteredMessageHistory);
  const messageContainerEl = document.querySelector("#messageContainer");
  const messageContainerElDivs = document.querySelectorAll("#messageContainer div.userMessage, #messageContainer div.botMessage");
  const botMessageDiv = displayLoadingBotMessage(settings);
  messageContainerEl == null ? void 0 : messageContainerEl.insertBefore(botMessageDiv, messageContainerElDivs[index2 + 1]);
  botMessageDiv.scrollIntoView({ behavior: "smooth", block: "start" });
  await getActiveFileContent(plugin, settings);
  const referenceCurrentNoteContent2 = getCurrentNoteContent();
  const submitButton = document.querySelector(".submit-button");
  (0, import_obsidian4.setIcon)(submitButton, "square");
  submitButton.title = "stop";
  submitButton.addEventListener("click", () => {
    if (submitButton.title === "stop") {
      const controller = getAbortController();
      if (controller) {
        controller.abort();
      }
    }
  });
  try {
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.openRouter.APIKey}`
      },
      body: JSON.stringify({
        model: settings.general.model,
        messages: [
          { role: "system", content: settings.general.system_role + prompt + referenceCurrentNoteContent2 || "You are a helpful assistant." },
          ...messageHistoryAtIndex
        ],
        stream: true,
        temperature: parseInt(settings.general.temperature),
        max_tokens: parseInt(settings.general.max_tokens) || 4096
      }),
      signal: abortController.signal
    });
    if (!response.ok) {
      new import_obsidian4.Notice(`HTTP error! Status: ${response.status}`);
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    if (!response.body) {
      new import_obsidian4.Notice("Response body is null or undefined.");
      throw new Error("Response body is null or undefined.");
    }
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let reading = true;
    while (reading) {
      const { done, value } = await reader.read();
      if (done) {
        reading = false;
        break;
      }
      const chunk = decoder.decode(value, { stream: false }) || "";
      const parts = chunk.split("\n");
      for (const part of parts.filter(Boolean)) {
        if (part.includes("data: [DONE]")) {
          break;
        }
        let parsedChunk;
        try {
          parsedChunk = JSON.parse(part.replace(/^data: /, ""));
          if (parsedChunk.choices[0].finish_reason !== "stop") {
            const content = parsedChunk.choices[0].delta.content;
            message += content;
          }
        } catch (err) {
          console.error("Error parsing JSON:", err);
          console.log("Part with error:", part);
          parsedChunk = { response: "{_e_}" };
        }
      }
      const messageContainerEl2 = document.querySelector("#messageContainer");
      if (messageContainerEl2) {
        const targetUserMessage = messageContainerElDivs[index2];
        const targetBotMessage = targetUserMessage.nextElementSibling;
        const messageBlock = targetBotMessage == null ? void 0 : targetBotMessage.querySelector(".messageBlock");
        const loadingEl = targetBotMessage == null ? void 0 : targetBotMessage.querySelector("#loading");
        if (messageBlock) {
          if (loadingEl) {
            targetBotMessage == null ? void 0 : targetBotMessage.removeChild(loadingEl);
          }
          messageBlock.innerHTML = "";
          const fragment = document.createDocumentFragment();
          const tempContainer = document.createElement("div");
          fragment.appendChild(tempContainer);
          await import_obsidian4.MarkdownRenderer.render(plugin.app, message, tempContainer, "/", plugin);
          while (tempContainer.firstChild) {
            messageBlock.appendChild(tempContainer.firstChild);
          }
          addParagraphBreaks(messageBlock);
          updateUnresolvedInternalLinks(plugin, messageBlock);
          const copyCodeBlocks = messageBlock.querySelectorAll(".copy-code-button");
          copyCodeBlocks.forEach((copyCodeBlock) => {
            copyCodeBlock.textContent = "Copy";
            (0, import_obsidian4.setIcon)(copyCodeBlock, "copy");
          });
        }
        messageContainerEl2.addEventListener("wheel", (event) => {
          if (event.deltaY < 0 || event.deltaY > 0) {
            isScroll = true;
          }
        });
        if (!isScroll) {
          targetBotMessage == null ? void 0 : targetBotMessage.scrollIntoView({ behavior: "auto", block: "start" });
        }
      }
    }
    const regexPatterns = [
      /<block-rendered>[\s\S]*?<\/block-rendered>/g,
      /<note-rendered>[\s\S]*?<\/note-rendered>/g
    ];
    regexPatterns.forEach((pattern) => {
      message = message.replace(pattern, "").trim();
    });
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
  } catch (error) {
    addMessage(plugin, message.trim(), "botMessage", settings, index2);
    new import_obsidian4.Notice("Stream stopped.");
    console.error(error);
  }
  submitButton.textContent = "send";
  (0, import_obsidian4.setIcon)(submitButton, "arrow-up");
  submitButton.title = "send";
}
function getAbortController() {
  return abortController;
}
function ollamaParametersOptions(settings) {
  return {
    mirostat: parseInt(settings.OllamaConnection.ollamaParameters.mirostat),
    mirostat_eta: parseFloat(settings.OllamaConnection.ollamaParameters.mirostat_eta),
    mirostat_tau: parseFloat(settings.OllamaConnection.ollamaParameters.mirostat_tau),
    num_ctx: parseInt(settings.OllamaConnection.ollamaParameters.num_ctx),
    num_gqa: parseInt(settings.OllamaConnection.ollamaParameters.num_gqa),
    num_thread: parseInt(settings.OllamaConnection.ollamaParameters.num_thread),
    repeat_last_n: parseInt(settings.OllamaConnection.ollamaParameters.repeat_last_n),
    repeat_penalty: parseFloat(settings.OllamaConnection.ollamaParameters.repeat_penalty),
    temperature: parseInt(settings.general.temperature),
    seed: parseInt(settings.OllamaConnection.ollamaParameters.seed),
    stop: settings.OllamaConnection.ollamaParameters.stop,
    tfs_z: parseFloat(settings.OllamaConnection.ollamaParameters.tfs_z),
    num_predict: parseInt(settings.general.max_tokens) || -1,
    top_k: parseInt(settings.OllamaConnection.ollamaParameters.top_k),
    top_p: parseFloat(settings.OllamaConnection.ollamaParameters.top_p),
    min_p: parseFloat(settings.OllamaConnection.ollamaParameters.min_p)
  };
}
function filterMessageHistory(messageHistory2) {
  const skipIndexes = /* @__PURE__ */ new Set();
  messageHistory2.forEach((message, index2, array) => {
    if (message.role === "user" && message.content.startsWith("/")) {
      skipIndexes.add(index2);
      if (index2 + 1 < array.length && array[index2 + 1].role === "assistant") {
        skipIndexes.add(index2 + 1);
      }
    } else if (message.role === "assistant" && message.content.includes("errorBotMessage")) {
      skipIndexes.add(index2);
      if (index2 > 0) {
        skipIndexes.add(index2 - 1);
      }
    }
  });
  const filteredMessageHistory = messageHistory2.filter((_, index2) => !skipIndexes.has(index2));
  return filteredMessageHistory;
}
function removeConsecutiveUserRoles(messageHistory2) {
  const result = [];
  let foundUserMessage = false;
  for (let i = 0; i < messageHistory2.length; i++) {
    if (messageHistory2[i].role === "user") {
      if (!foundUserMessage) {
        result.push(messageHistory2[i]);
        foundUserMessage = true;
      } else {
        break;
      }
    } else {
      result.push(messageHistory2[i]);
      foundUserMessage = false;
    }
  }
  return result;
}

// src/components/editor/FetchRenameNoteTitle.ts
var import_obsidian5 = require("obsidian");

// node_modules/whatwg-fetch/fetch.js
var g = typeof globalThis !== "undefined" && globalThis || typeof self !== "undefined" && self || // eslint-disable-next-line no-undef
typeof global !== "undefined" && global || {};
var support = {
  searchParams: "URLSearchParams" in g,
  iterable: "Symbol" in g && "iterator" in Symbol,
  blob: "FileReader" in g && "Blob" in g && function() {
    try {
      new Blob();
      return true;
    } catch (e) {
      return false;
    }
  }(),
  formData: "FormData" in g,
  arrayBuffer: "ArrayBuffer" in g
};
function isDataView(obj) {
  return obj && DataView.prototype.isPrototypeOf(obj);
}
if (support.arrayBuffer) {
  viewClasses = [
    "[object Int8Array]",
    "[object Uint8Array]",
    "[object Uint8ClampedArray]",
    "[object Int16Array]",
    "[object Uint16Array]",
    "[object Int32Array]",
    "[object Uint32Array]",
    "[object Float32Array]",
    "[object Float64Array]"
  ];
  isArrayBufferView = ArrayBuffer.isView || function(obj) {
    return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;
  };
}
var viewClasses;
var isArrayBufferView;
function normalizeName(name) {
  if (typeof name !== "string") {
    name = String(name);
  }
  if (/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(name) || name === "") {
    throw new TypeError('Invalid character in header field name: "' + name + '"');
  }
  return name.toLowerCase();
}
function normalizeValue(value) {
  if (typeof value !== "string") {
    value = String(value);
  }
  return value;
}
function iteratorFor(items) {
  var iterator = {
    next: function() {
      var value = items.shift();
      return { done: value === void 0, value };
    }
  };
  if (support.iterable) {
    iterator[Symbol.iterator] = function() {
      return iterator;
    };
  }
  return iterator;
}
function Headers2(headers) {
  this.map = {};
  if (headers instanceof Headers2) {
    headers.forEach(function(value, name) {
      this.append(name, value);
    }, this);
  } else if (Array.isArray(headers)) {
    headers.forEach(function(header) {
      if (header.length != 2) {
        throw new TypeError("Headers constructor: expected name/value pair to be length 2, found" + header.length);
      }
      this.append(header[0], header[1]);
    }, this);
  } else if (headers) {
    Object.getOwnPropertyNames(headers).forEach(function(name) {
      this.append(name, headers[name]);
    }, this);
  }
}
Headers2.prototype.append = function(name, value) {
  name = normalizeName(name);
  value = normalizeValue(value);
  var oldValue = this.map[name];
  this.map[name] = oldValue ? oldValue + ", " + value : value;
};
Headers2.prototype["delete"] = function(name) {
  delete this.map[normalizeName(name)];
};
Headers2.prototype.get = function(name) {
  name = normalizeName(name);
  return this.has(name) ? this.map[name] : null;
};
Headers2.prototype.has = function(name) {
  return this.map.hasOwnProperty(normalizeName(name));
};
Headers2.prototype.set = function(name, value) {
  this.map[normalizeName(name)] = normalizeValue(value);
};
Headers2.prototype.forEach = function(callback, thisArg) {
  for (var name in this.map) {
    if (this.map.hasOwnProperty(name)) {
      callback.call(thisArg, this.map[name], name, this);
    }
  }
};
Headers2.prototype.keys = function() {
  var items = [];
  this.forEach(function(value, name) {
    items.push(name);
  });
  return iteratorFor(items);
};
Headers2.prototype.values = function() {
  var items = [];
  this.forEach(function(value) {
    items.push(value);
  });
  return iteratorFor(items);
};
Headers2.prototype.entries = function() {
  var items = [];
  this.forEach(function(value, name) {
    items.push([name, value]);
  });
  return iteratorFor(items);
};
if (support.iterable) {
  Headers2.prototype[Symbol.iterator] = Headers2.prototype.entries;
}
function consumed(body) {
  if (body._noBody)
    return;
  if (body.bodyUsed) {
    return Promise.reject(new TypeError("Already read"));
  }
  body.bodyUsed = true;
}
function fileReaderReady(reader) {
  return new Promise(function(resolve2, reject) {
    reader.onload = function() {
      resolve2(reader.result);
    };
    reader.onerror = function() {
      reject(reader.error);
    };
  });
}
function readBlobAsArrayBuffer(blob) {
  var reader = new FileReader();
  var promise = fileReaderReady(reader);
  reader.readAsArrayBuffer(blob);
  return promise;
}
function readBlobAsText(blob) {
  var reader = new FileReader();
  var promise = fileReaderReady(reader);
  var match = /charset=([A-Za-z0-9_-]+)/.exec(blob.type);
  var encoding = match ? match[1] : "utf-8";
  reader.readAsText(blob, encoding);
  return promise;
}
function readArrayBufferAsText(buf) {
  var view = new Uint8Array(buf);
  var chars = new Array(view.length);
  for (var i = 0; i < view.length; i++) {
    chars[i] = String.fromCharCode(view[i]);
  }
  return chars.join("");
}
function bufferClone(buf) {
  if (buf.slice) {
    return buf.slice(0);
  } else {
    var view = new Uint8Array(buf.byteLength);
    view.set(new Uint8Array(buf));
    return view.buffer;
  }
}
function Body() {
  this.bodyUsed = false;
  this._initBody = function(body) {
    this.bodyUsed = this.bodyUsed;
    this._bodyInit = body;
    if (!body) {
      this._noBody = true;
      this._bodyText = "";
    } else if (typeof body === "string") {
      this._bodyText = body;
    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
      this._bodyBlob = body;
    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
      this._bodyFormData = body;
    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
      this._bodyText = body.toString();
    } else if (support.arrayBuffer && support.blob && isDataView(body)) {
      this._bodyArrayBuffer = bufferClone(body.buffer);
      this._bodyInit = new Blob([this._bodyArrayBuffer]);
    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
      this._bodyArrayBuffer = bufferClone(body);
    } else {
      this._bodyText = body = Object.prototype.toString.call(body);
    }
    if (!this.headers.get("content-type")) {
      if (typeof body === "string") {
        this.headers.set("content-type", "text/plain;charset=UTF-8");
      } else if (this._bodyBlob && this._bodyBlob.type) {
        this.headers.set("content-type", this._bodyBlob.type);
      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
        this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
      }
    }
  };
  if (support.blob) {
    this.blob = function() {
      var rejected = consumed(this);
      if (rejected) {
        return rejected;
      }
      if (this._bodyBlob) {
        return Promise.resolve(this._bodyBlob);
      } else if (this._bodyArrayBuffer) {
        return Promise.resolve(new Blob([this._bodyArrayBuffer]));
      } else if (this._bodyFormData) {
        throw new Error("could not read FormData body as blob");
      } else {
        return Promise.resolve(new Blob([this._bodyText]));
      }
    };
  }
  this.arrayBuffer = function() {
    if (this._bodyArrayBuffer) {
      var isConsumed = consumed(this);
      if (isConsumed) {
        return isConsumed;
      } else if (ArrayBuffer.isView(this._bodyArrayBuffer)) {
        return Promise.resolve(
          this._bodyArrayBuffer.buffer.slice(
            this._bodyArrayBuffer.byteOffset,
            this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength
          )
        );
      } else {
        return Promise.resolve(this._bodyArrayBuffer);
      }
    } else if (support.blob) {
      return this.blob().then(readBlobAsArrayBuffer);
    } else {
      throw new Error("could not read as ArrayBuffer");
    }
  };
  this.text = function() {
    var rejected = consumed(this);
    if (rejected) {
      return rejected;
    }
    if (this._bodyBlob) {
      return readBlobAsText(this._bodyBlob);
    } else if (this._bodyArrayBuffer) {
      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));
    } else if (this._bodyFormData) {
      throw new Error("could not read FormData body as text");
    } else {
      return Promise.resolve(this._bodyText);
    }
  };
  if (support.formData) {
    this.formData = function() {
      return this.text().then(decode);
    };
  }
  this.json = function() {
    return this.text().then(JSON.parse);
  };
  return this;
}
var methods = ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"];
function normalizeMethod(method) {
  var upcased = method.toUpperCase();
  return methods.indexOf(upcased) > -1 ? upcased : method;
}
function Request2(input, options) {
  if (!(this instanceof Request2)) {
    throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  }
  options = options || {};
  var body = options.body;
  if (input instanceof Request2) {
    if (input.bodyUsed) {
      throw new TypeError("Already read");
    }
    this.url = input.url;
    this.credentials = input.credentials;
    if (!options.headers) {
      this.headers = new Headers2(input.headers);
    }
    this.method = input.method;
    this.mode = input.mode;
    this.signal = input.signal;
    if (!body && input._bodyInit != null) {
      body = input._bodyInit;
      input.bodyUsed = true;
    }
  } else {
    this.url = String(input);
  }
  this.credentials = options.credentials || this.credentials || "same-origin";
  if (options.headers || !this.headers) {
    this.headers = new Headers2(options.headers);
  }
  this.method = normalizeMethod(options.method || this.method || "GET");
  this.mode = options.mode || this.mode || null;
  this.signal = options.signal || this.signal || function() {
    if ("AbortController" in g) {
      var ctrl = new AbortController();
      return ctrl.signal;
    }
  }();
  this.referrer = null;
  if ((this.method === "GET" || this.method === "HEAD") && body) {
    throw new TypeError("Body not allowed for GET or HEAD requests");
  }
  this._initBody(body);
  if (this.method === "GET" || this.method === "HEAD") {
    if (options.cache === "no-store" || options.cache === "no-cache") {
      var reParamSearch = /([?&])_=[^&]*/;
      if (reParamSearch.test(this.url)) {
        this.url = this.url.replace(reParamSearch, "$1_=" + new Date().getTime());
      } else {
        var reQueryString = /\?/;
        this.url += (reQueryString.test(this.url) ? "&" : "?") + "_=" + new Date().getTime();
      }
    }
  }
}
Request2.prototype.clone = function() {
  return new Request2(this, { body: this._bodyInit });
};
function decode(body) {
  var form = new FormData();
  body.trim().split("&").forEach(function(bytes) {
    if (bytes) {
      var split = bytes.split("=");
      var name = split.shift().replace(/\+/g, " ");
      var value = split.join("=").replace(/\+/g, " ");
      form.append(decodeURIComponent(name), decodeURIComponent(value));
    }
  });
  return form;
}
function parseHeaders(rawHeaders) {
  var headers = new Headers2();
  var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, " ");
  preProcessedHeaders.split("\r").map(function(header) {
    return header.indexOf("\n") === 0 ? header.substr(1, header.length) : header;
  }).forEach(function(line) {
    var parts = line.split(":");
    var key = parts.shift().trim();
    if (key) {
      var value = parts.join(":").trim();
      try {
        headers.append(key, value);
      } catch (error) {
        console.warn("Response " + error.message);
      }
    }
  });
  return headers;
}
Body.call(Request2.prototype);
function Response2(bodyInit, options) {
  if (!(this instanceof Response2)) {
    throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
  }
  if (!options) {
    options = {};
  }
  this.type = "default";
  this.status = options.status === void 0 ? 200 : options.status;
  if (this.status < 200 || this.status > 599) {
    throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");
  }
  this.ok = this.status >= 200 && this.status < 300;
  this.statusText = options.statusText === void 0 ? "" : "" + options.statusText;
  this.headers = new Headers2(options.headers);
  this.url = options.url || "";
  this._initBody(bodyInit);
}
Body.call(Response2.prototype);
Response2.prototype.clone = function() {
  return new Response2(this._bodyInit, {
    status: this.status,
    statusText: this.statusText,
    headers: new Headers2(this.headers),
    url: this.url
  });
};
Response2.error = function() {
  var response = new Response2(null, { status: 200, statusText: "" });
  response.ok = false;
  response.status = 0;
  response.type = "error";
  return response;
};
var redirectStatuses = [301, 302, 303, 307, 308];
Response2.redirect = function(url, status) {
  if (redirectStatuses.indexOf(status) === -1) {
    throw new RangeError("Invalid status code");
  }
  return new Response2(null, { status, headers: { location: url } });
};
var DOMException = g.DOMException;
try {
  new DOMException();
} catch (err) {
  DOMException = function(message, name) {
    this.message = message;
    this.name = name;
    var error = Error(message);
    this.stack = error.stack;
  };
  DOMException.prototype = Object.create(Error.prototype);
  DOMException.prototype.constructor = DOMException;
}
function fetch2(input, init) {
  return new Promise(function(resolve2, reject) {
    var request = new Request2(input, init);
    if (request.signal && request.signal.aborted) {
      return reject(new DOMException("Aborted", "AbortError"));
    }
    var xhr = new XMLHttpRequest();
    function abortXhr() {
      xhr.abort();
    }
    xhr.onload = function() {
      var options = {
        statusText: xhr.statusText,
        headers: parseHeaders(xhr.getAllResponseHeaders() || "")
      };
      if (request.url.indexOf("file://") === 0 && (xhr.status < 200 || xhr.status > 599)) {
        options.status = 200;
      } else {
        options.status = xhr.status;
      }
      options.url = "responseURL" in xhr ? xhr.responseURL : options.headers.get("X-Request-URL");
      var body = "response" in xhr ? xhr.response : xhr.responseText;
      setTimeout(function() {
        resolve2(new Response2(body, options));
      }, 0);
    };
    xhr.onerror = function() {
      setTimeout(function() {
        reject(new TypeError("Network request failed"));
      }, 0);
    };
    xhr.ontimeout = function() {
      setTimeout(function() {
        reject(new TypeError("Network request timed out"));
      }, 0);
    };
    xhr.onabort = function() {
      setTimeout(function() {
        reject(new DOMException("Aborted", "AbortError"));
      }, 0);
    };
    function fixUrl(url) {
      try {
        return url === "" && g.location.href ? g.location.href : url;
      } catch (e) {
        return url;
      }
    }
    xhr.open(request.method, fixUrl(request.url), true);
    if (request.credentials === "include") {
      xhr.withCredentials = true;
    } else if (request.credentials === "omit") {
      xhr.withCredentials = false;
    }
    if ("responseType" in xhr) {
      if (support.blob) {
        xhr.responseType = "blob";
      } else if (support.arrayBuffer) {
        xhr.responseType = "arraybuffer";
      }
    }
    if (init && typeof init.headers === "object" && !(init.headers instanceof Headers2 || g.Headers && init.headers instanceof g.Headers)) {
      var names = [];
      Object.getOwnPropertyNames(init.headers).forEach(function(name) {
        names.push(normalizeName(name));
        xhr.setRequestHeader(name, normalizeValue(init.headers[name]));
      });
      request.headers.forEach(function(value, name) {
        if (names.indexOf(name) === -1) {
          xhr.setRequestHeader(name, value);
        }
      });
    } else {
      request.headers.forEach(function(value, name) {
        xhr.setRequestHeader(name, value);
      });
    }
    if (request.signal) {
      request.signal.addEventListener("abort", abortXhr);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          request.signal.removeEventListener("abort", abortXhr);
        }
      };
    }
    xhr.send(typeof request._bodyInit === "undefined" ? null : request._bodyInit);
  });
}
fetch2.polyfill = true;
if (!g.fetch) {
  g.fetch = fetch2;
  g.Headers = Headers2;
  g.Request = Request2;
  g.Response = Response2;
}

// node_modules/ollama/dist/shared/ollama.14e58652.mjs
var version = "0.5.1";
var ResponseError = class extends Error {
  constructor(error, status_code) {
    super(error);
    this.error = error;
    this.status_code = status_code;
    this.name = "ResponseError";
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, ResponseError);
    }
  }
};
var checkOk = async (response) => {
  var _a2;
  if (!response.ok) {
    let message = `Error ${response.status}: ${response.statusText}`;
    let errorData = null;
    if ((_a2 = response.headers.get("content-type")) == null ? void 0 : _a2.includes("application/json")) {
      try {
        errorData = await response.json();
        message = errorData.error || message;
      } catch (error) {
        console.log("Failed to parse error response as JSON");
      }
    } else {
      try {
        console.log("Getting text from response");
        const textResponse = await response.text();
        message = textResponse || message;
      } catch (error) {
        console.log("Failed to get text from error response");
      }
    }
    throw new ResponseError(message, response.status);
  }
};
function getPlatform() {
  if (typeof window !== "undefined" && window.navigator) {
    return `${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`;
  } else if (typeof process !== "undefined") {
    return `${process.arch} ${process.platform} Node.js/${process.version}`;
  }
  return "";
}
var fetchWithHeaders = async (fetch3, url, options = {}) => {
  const defaultHeaders = {
    "Content-Type": "application/json",
    Accept: "application/json",
    "User-Agent": `ollama-js/${version} (${getPlatform()})`
  };
  if (!options.headers) {
    options.headers = {};
  }
  options.headers = {
    ...defaultHeaders,
    ...options.headers
  };
  return fetch3(url, options);
};
var get = async (fetch3, host) => {
  const response = await fetchWithHeaders(fetch3, host);
  await checkOk(response);
  return response;
};
var head = async (fetch3, host) => {
  const response = await fetchWithHeaders(fetch3, host, {
    method: "HEAD"
  });
  await checkOk(response);
  return response;
};
var post = async (fetch3, host, data, options) => {
  const isRecord = (input) => {
    return input !== null && typeof input === "object" && !Array.isArray(input);
  };
  const formattedData = isRecord(data) ? JSON.stringify(data) : data;
  const response = await fetchWithHeaders(fetch3, host, {
    method: "POST",
    body: formattedData,
    signal: options == null ? void 0 : options.signal
  });
  await checkOk(response);
  return response;
};
var del = async (fetch3, host, data) => {
  const response = await fetchWithHeaders(fetch3, host, {
    method: "DELETE",
    body: JSON.stringify(data)
  });
  await checkOk(response);
  return response;
};
var parseJSON = async function* (itr) {
  var _a2;
  const decoder = new TextDecoder("utf-8");
  let buffer = "";
  const reader = itr.getReader();
  while (true) {
    const { done, value: chunk } = await reader.read();
    if (done) {
      break;
    }
    buffer += decoder.decode(chunk);
    const parts = buffer.split("\n");
    buffer = (_a2 = parts.pop()) != null ? _a2 : "";
    for (const part of parts) {
      try {
        yield JSON.parse(part);
      } catch (error) {
        console.warn("invalid json: ", part);
      }
    }
  }
  for (const part of buffer.split("\n").filter((p) => p !== "")) {
    try {
      yield JSON.parse(part);
    } catch (error) {
      console.warn("invalid json: ", part);
    }
  }
};
var formatHost = (host) => {
  if (!host) {
    return "http://127.0.0.1:11434";
  }
  let isExplicitProtocol = host.includes("://");
  if (host.startsWith(":")) {
    host = `http://127.0.0.1${host}`;
    isExplicitProtocol = false;
  }
  if (!isExplicitProtocol) {
    host = `http://${host}`;
  }
  const url = new URL(host);
  let port = url.port;
  if (!port) {
    if (!isExplicitProtocol) {
      port = "11434";
    } else {
      port = url.protocol === "https:" ? "443" : "80";
    }
  }
  let formattedHost = `${url.protocol}//${url.hostname}:${port}${url.pathname}`;
  if (formattedHost.endsWith("/")) {
    formattedHost = formattedHost.slice(0, -1);
  }
  return formattedHost;
};
var __defProp2 = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
var Ollama$1 = class Ollama {
  constructor(config) {
    var _a2;
    __publicField(this, "config");
    __publicField(this, "fetch");
    __publicField(this, "abortController");
    this.config = {
      host: ""
    };
    if (!(config == null ? void 0 : config.proxy)) {
      this.config.host = formatHost((_a2 = config == null ? void 0 : config.host) != null ? _a2 : "http://127.0.0.1:11434");
    }
    this.fetch = fetch;
    if ((config == null ? void 0 : config.fetch) != null) {
      this.fetch = config.fetch;
    }
    this.abortController = new AbortController();
  }
  // Abort any ongoing requests to Ollama
  abort() {
    this.abortController.abort();
    this.abortController = new AbortController();
  }
  async processStreamableRequest(endpoint, request) {
    var _a2;
    request.stream = (_a2 = request.stream) != null ? _a2 : false;
    const response = await post(
      this.fetch,
      `${this.config.host}/api/${endpoint}`,
      {
        ...request
      },
      { signal: this.abortController.signal }
    );
    if (!response.body) {
      throw new Error("Missing body");
    }
    const itr = parseJSON(response.body);
    if (request.stream) {
      return async function* () {
        for await (const message of itr) {
          if ("error" in message) {
            throw new Error(message.error);
          }
          yield message;
          if (message.done || message.status === "success") {
            return;
          }
        }
        throw new Error("Did not receive done or success response in stream.");
      }();
    } else {
      const message = await itr.next();
      if (!message.value.done && message.value.status !== "success") {
        throw new Error("Expected a completed response.");
      }
      return message.value;
    }
  }
  async encodeImage(image) {
    if (typeof image !== "string") {
      const uint8Array = new Uint8Array(image);
      const numberArray = Array.from(uint8Array);
      const base64String = btoa(String.fromCharCode.apply(null, numberArray));
      return base64String;
    }
    return image;
  }
  async generate(request) {
    if (request.images) {
      request.images = await Promise.all(request.images.map(this.encodeImage.bind(this)));
    }
    return this.processStreamableRequest("generate", request);
  }
  async chat(request) {
    if (request.messages) {
      for (const message of request.messages) {
        if (message.images) {
          message.images = await Promise.all(
            message.images.map(this.encodeImage.bind(this))
          );
        }
      }
    }
    return this.processStreamableRequest("chat", request);
  }
  async create(request) {
    return this.processStreamableRequest("create", {
      name: request.model,
      stream: request.stream,
      modelfile: request.modelfile,
      quantize: request.quantize
    });
  }
  async pull(request) {
    return this.processStreamableRequest("pull", {
      name: request.model,
      stream: request.stream,
      insecure: request.insecure
    });
  }
  async push(request) {
    return this.processStreamableRequest("push", {
      name: request.model,
      stream: request.stream,
      insecure: request.insecure
    });
  }
  async delete(request) {
    await del(this.fetch, `${this.config.host}/api/delete`, {
      name: request.model
    });
    return { status: "success" };
  }
  async copy(request) {
    await post(this.fetch, `${this.config.host}/api/copy`, { ...request });
    return { status: "success" };
  }
  async list() {
    const response = await get(this.fetch, `${this.config.host}/api/tags`);
    const listResponse = await response.json();
    return listResponse;
  }
  async show(request) {
    const response = await post(this.fetch, `${this.config.host}/api/show`, {
      ...request
    });
    const showResponse = await response.json();
    return showResponse;
  }
  async embeddings(request) {
    const response = await post(this.fetch, `${this.config.host}/api/embeddings`, {
      ...request
    });
    const embeddingsResponse = await response.json();
    return embeddingsResponse;
  }
};
var browser = new Ollama$1();

// node_modules/ollama/dist/index.mjs
var import_fs = __toESM(require("fs"), 1);
var import_path = require("path");
var import_crypto = require("crypto");
var import_os = require("os");
var Ollama2 = class extends Ollama$1 {
  async encodeImage(image) {
    if (typeof image !== "string") {
      const result = Buffer.from(image).toString("base64");
      return result;
    }
    try {
      if (import_fs.default.existsSync(image)) {
        const fileBuffer = await import_fs.promises.readFile((0, import_path.resolve)(image));
        return Buffer.from(fileBuffer).toString("base64");
      }
    } catch (e) {
    }
    return image;
  }
  async parseModelfile(modelfile, mfDir = process.cwd()) {
    const out = [];
    const lines = modelfile.split("\n");
    for (const line of lines) {
      const [command, args] = line.split(" ", 2);
      if (["FROM", "ADAPTER"].includes(command.toUpperCase())) {
        const path = this.resolvePath(args.trim(), mfDir);
        if (await this.fileExists(path)) {
          out.push(`${command} @${await this.createBlob(path)}`);
        } else {
          out.push(`${command} ${args}`);
        }
      } else {
        out.push(line);
      }
    }
    return out.join("\n");
  }
  resolvePath(inputPath, mfDir) {
    if (inputPath.startsWith("~")) {
      return (0, import_path.join)((0, import_os.homedir)(), inputPath.slice(1));
    }
    return (0, import_path.resolve)(mfDir, inputPath);
  }
  async fileExists(path) {
    try {
      await import_fs.promises.access(path);
      return true;
    } catch (e) {
      return false;
    }
  }
  async createBlob(path) {
    if (typeof ReadableStream === "undefined") {
      throw new Error("Streaming uploads are not supported in this environment.");
    }
    const fileStream = (0, import_fs.createReadStream)(path);
    const sha256sum = await new Promise((resolve2, reject) => {
      const hash = (0, import_crypto.createHash)("sha256");
      fileStream.on("data", (data) => hash.update(data));
      fileStream.on("end", () => resolve2(hash.digest("hex")));
      fileStream.on("error", reject);
    });
    const digest = `sha256:${sha256sum}`;
    try {
      await head(this.fetch, `${this.config.host}/api/blobs/${digest}`);
    } catch (e) {
      if (e instanceof Error && e.message.includes("404")) {
        const readableStream = new ReadableStream({
          start(controller) {
            fileStream.on("data", (chunk) => {
              controller.enqueue(chunk);
            });
            fileStream.on("end", () => {
              controller.close();
            });
            fileStream.on("error", (err) => {
              controller.error(err);
            });
          }
        });
        await post(
          this.fetch,
          `${this.config.host}/api/blobs/${digest}`,
          readableStream
        );
      } else {
        throw e;
      }
    }
    return digest;
  }
  async create(request) {
    let modelfileContent = "";
    if (request.path) {
      modelfileContent = await import_fs.promises.readFile(request.path, { encoding: "utf8" });
      modelfileContent = await this.parseModelfile(
        modelfileContent,
        (0, import_path.dirname)(request.path)
      );
    } else if (request.modelfile) {
      modelfileContent = await this.parseModelfile(request.modelfile);
    } else {
      throw new Error("Must provide either path or modelfile to create a model");
    }
    request.modelfile = modelfileContent;
    if (request.stream) {
      return super.create(request);
    } else {
      return super.create(request);
    }
  }
};
var index = new Ollama2();

// node_modules/openai/version.mjs
var VERSION = "4.6.0";

// node_modules/openai/streaming.mjs
var Stream = class {
  constructor(response, controller) {
    this.response = response;
    this.controller = controller;
    this.decoder = new SSEDecoder();
  }
  async *iterMessages() {
    if (!this.response.body) {
      this.controller.abort();
      throw new Error(`Attempted to iterate over a response with no body`);
    }
    const lineDecoder = new LineDecoder();
    const iter = readableStreamAsyncIterable(this.response.body);
    for await (const chunk of iter) {
      for (const line of lineDecoder.decode(chunk)) {
        const sse = this.decoder.decode(line);
        if (sse)
          yield sse;
      }
    }
    for (const line of lineDecoder.flush()) {
      const sse = this.decoder.decode(line);
      if (sse)
        yield sse;
    }
  }
  async *[Symbol.asyncIterator]() {
    let done = false;
    try {
      for await (const sse of this.iterMessages()) {
        if (done)
          continue;
        if (sse.data.startsWith("[DONE]")) {
          done = true;
          continue;
        }
        if (sse.event === null) {
          try {
            yield JSON.parse(sse.data);
          } catch (e) {
            console.error(`Could not parse message into JSON:`, sse.data);
            console.error(`From chunk:`, sse.raw);
            throw e;
          }
        }
      }
      done = true;
    } catch (e) {
      if (e instanceof Error && e.name === "AbortError")
        return;
      throw e;
    } finally {
      if (!done)
        this.controller.abort();
    }
  }
};
var SSEDecoder = class {
  constructor() {
    this.event = null;
    this.data = [];
    this.chunks = [];
  }
  decode(line) {
    if (line.endsWith("\r")) {
      line = line.substring(0, line.length - 1);
    }
    if (!line) {
      if (!this.event && !this.data.length)
        return null;
      const sse = {
        event: this.event,
        data: this.data.join("\n"),
        raw: this.chunks
      };
      this.event = null;
      this.data = [];
      this.chunks = [];
      return sse;
    }
    this.chunks.push(line);
    if (line.startsWith(":")) {
      return null;
    }
    let [fieldname, _, value] = partition(line, ":");
    if (value.startsWith(" ")) {
      value = value.substring(1);
    }
    if (fieldname === "event") {
      this.event = value;
    } else if (fieldname === "data") {
      this.data.push(value);
    }
    return null;
  }
};
var LineDecoder = class {
  constructor() {
    this.buffer = [];
    this.trailingCR = false;
  }
  decode(chunk) {
    let text = this.decodeText(chunk);
    if (this.trailingCR) {
      text = "\r" + text;
      this.trailingCR = false;
    }
    if (text.endsWith("\r")) {
      this.trailingCR = true;
      text = text.slice(0, -1);
    }
    if (!text) {
      return [];
    }
    const trailingNewline = LineDecoder.NEWLINE_CHARS.has(text[text.length - 1] || "");
    let lines = text.split(LineDecoder.NEWLINE_REGEXP);
    if (lines.length === 1 && !trailingNewline) {
      this.buffer.push(lines[0]);
      return [];
    }
    if (this.buffer.length > 0) {
      lines = [this.buffer.join("") + lines[0], ...lines.slice(1)];
      this.buffer = [];
    }
    if (!trailingNewline) {
      this.buffer = [lines.pop() || ""];
    }
    return lines;
  }
  decodeText(bytes) {
    var _a2;
    if (bytes == null)
      return "";
    if (typeof bytes === "string")
      return bytes;
    if (typeof Buffer !== "undefined") {
      if (bytes instanceof Buffer) {
        return bytes.toString();
      }
      if (bytes instanceof Uint8Array) {
        return Buffer.from(bytes).toString();
      }
      throw new Error(
        `Unexpected: received non-Uint8Array (${bytes.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`
      );
    }
    if (typeof TextDecoder !== "undefined") {
      if (bytes instanceof Uint8Array || bytes instanceof ArrayBuffer) {
        (_a2 = this.textDecoder) !== null && _a2 !== void 0 ? _a2 : this.textDecoder = new TextDecoder("utf8");
        return this.textDecoder.decode(bytes);
      }
      throw new Error(
        `Unexpected: received non-Uint8Array/ArrayBuffer (${bytes.constructor.name}) in a web platform. Please report this error.`
      );
    }
    throw new Error(
      `Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.`
    );
  }
  flush() {
    if (!this.buffer.length && !this.trailingCR) {
      return [];
    }
    const lines = [this.buffer.join("")];
    this.buffer = [];
    this.trailingCR = false;
    return lines;
  }
};
LineDecoder.NEWLINE_CHARS = /* @__PURE__ */ new Set(["\n", "\r", "\v", "\f", "", "", "", "\x85", "\u2028", "\u2029"]);
LineDecoder.NEWLINE_REGEXP = /\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;
function partition(str, delimiter) {
  const index2 = str.indexOf(delimiter);
  if (index2 !== -1) {
    return [str.substring(0, index2), delimiter, str.substring(index2 + delimiter.length)];
  }
  return [str, "", ""];
}
function readableStreamAsyncIterable(stream) {
  if (stream[Symbol.asyncIterator])
    return stream;
  const reader = stream.getReader();
  return {
    async next() {
      try {
        const result = await reader.read();
        if (result === null || result === void 0 ? void 0 : result.done)
          reader.releaseLock();
        return result;
      } catch (e) {
        reader.releaseLock();
        throw e;
      }
    },
    async return() {
      const cancelPromise = reader.cancel();
      reader.releaseLock();
      await cancelPromise;
      return { done: true, value: void 0 };
    },
    [Symbol.asyncIterator]() {
      return this;
    }
  };
}

// node_modules/openai/error.mjs
var error_exports = {};
__export(error_exports, {
  APIConnectionError: () => APIConnectionError,
  APIConnectionTimeoutError: () => APIConnectionTimeoutError,
  APIError: () => APIError,
  APIUserAbortError: () => APIUserAbortError,
  AuthenticationError: () => AuthenticationError,
  BadRequestError: () => BadRequestError,
  ConflictError: () => ConflictError,
  InternalServerError: () => InternalServerError,
  NotFoundError: () => NotFoundError,
  PermissionDeniedError: () => PermissionDeniedError,
  RateLimitError: () => RateLimitError,
  UnprocessableEntityError: () => UnprocessableEntityError
});
var APIError = class extends Error {
  constructor(status, error, message, headers) {
    super(APIError.makeMessage(error, message));
    this.status = status;
    this.headers = headers;
    const data = error;
    this.error = data;
    this.code = data === null || data === void 0 ? void 0 : data["code"];
    this.param = data === null || data === void 0 ? void 0 : data["param"];
    this.type = data === null || data === void 0 ? void 0 : data["type"];
  }
  static makeMessage(error, message) {
    return (error === null || error === void 0 ? void 0 : error.message) ? typeof error.message === "string" ? error.message : JSON.stringify(error.message) : error ? JSON.stringify(error) : message || "Unknown error occurred";
  }
  static generate(status, errorResponse, message, headers) {
    if (!status) {
      return new APIConnectionError({ cause: castToError(errorResponse) });
    }
    const error = errorResponse === null || errorResponse === void 0 ? void 0 : errorResponse["error"];
    if (status === 400) {
      return new BadRequestError(status, error, message, headers);
    }
    if (status === 401) {
      return new AuthenticationError(status, error, message, headers);
    }
    if (status === 403) {
      return new PermissionDeniedError(status, error, message, headers);
    }
    if (status === 404) {
      return new NotFoundError(status, error, message, headers);
    }
    if (status === 409) {
      return new ConflictError(status, error, message, headers);
    }
    if (status === 422) {
      return new UnprocessableEntityError(status, error, message, headers);
    }
    if (status === 429) {
      return new RateLimitError(status, error, message, headers);
    }
    if (status >= 500) {
      return new InternalServerError(status, error, message, headers);
    }
    return new APIError(status, error, message, headers);
  }
};
var APIUserAbortError = class extends APIError {
  constructor({ message } = {}) {
    super(void 0, void 0, message || "Request was aborted.", void 0);
    this.status = void 0;
  }
};
var APIConnectionError = class extends APIError {
  constructor({ message, cause }) {
    super(void 0, void 0, message || "Connection error.", void 0);
    this.status = void 0;
    if (cause)
      this.cause = cause;
  }
};
var APIConnectionTimeoutError = class extends APIConnectionError {
  constructor({ message } = {}) {
    super({ message: message !== null && message !== void 0 ? message : "Request timed out." });
  }
};
var BadRequestError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 400;
  }
};
var AuthenticationError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 401;
  }
};
var PermissionDeniedError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 403;
  }
};
var NotFoundError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 404;
  }
};
var ConflictError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 409;
  }
};
var UnprocessableEntityError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 422;
  }
};
var RateLimitError = class extends APIError {
  constructor() {
    super(...arguments);
    this.status = 429;
  }
};
var InternalServerError = class extends APIError {
};

// node_modules/openai/_shims/agent.mjs
var getDefaultAgent = (url) => {
  return void 0;
};

// node_modules/openai/_shims/fetch.mjs
var _fetch = fetch.bind(void 0);
var isPolyfilled = false;

// node_modules/openai/_shims/form-data.mjs
var _FormData = FormData;
var _File = typeof File !== "undefined" ? File : (
  // Bun doesn't implement File yet, so just make a shim that throws a helpful error message
  class File2 extends Blob {
    constructor() {
      throw new Error(`file uploads aren't supported in this environment yet as 'File' is not defined`);
    }
  }
);

// node_modules/openai/_shims/getMultipartRequestOptions.mjs
async function getMultipartRequestOptions(form, opts) {
  return { ...opts, body: new MultipartBody(form) };
}

// node_modules/openai/_shims/fileFromPath.mjs
async function fileFromPath() {
  throw new Error(
    "The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads"
  );
}

// node_modules/openai/_shims/node-readable.mjs
function isFsReadStream(value) {
  return false;
}

// node_modules/openai/uploads.mjs
var isResponseLike = (value) => value != null && typeof value === "object" && typeof value.url === "string" && typeof value.blob === "function";
var isFileLike = (value) => value != null && typeof value === "object" && typeof value.name === "string" && typeof value.lastModified === "number" && isBlobLike(value);
var isBlobLike = (value) => value != null && typeof value === "object" && typeof value.size === "number" && typeof value.type === "string" && typeof value.text === "function" && typeof value.slice === "function" && typeof value.arrayBuffer === "function";
var isUploadable = (value) => {
  return isFileLike(value) || isResponseLike(value) || isFsReadStream(value);
};
async function toFile(value, name, options = {}) {
  var _a2, _b, _c;
  value = await value;
  if (isResponseLike(value)) {
    const blob = await value.blob();
    name || (name = (_a2 = new URL(value.url).pathname.split(/[\\/]/).pop()) !== null && _a2 !== void 0 ? _a2 : "unknown_file");
    return new _File([blob], name, options);
  }
  const bits = await getBytes(value);
  name || (name = (_b = getName(value)) !== null && _b !== void 0 ? _b : "unknown_file");
  if (!options.type) {
    const type = (_c = bits[0]) === null || _c === void 0 ? void 0 : _c.type;
    if (typeof type === "string") {
      options = { ...options, type };
    }
  }
  return new _File(bits, name, options);
}
async function getBytes(value) {
  var _a2;
  let parts = [];
  if (typeof value === "string" || ArrayBuffer.isView(value) || // includes Uint8Array, Buffer, etc.
  value instanceof ArrayBuffer) {
    parts.push(value);
  } else if (isBlobLike(value)) {
    parts.push(await value.arrayBuffer());
  } else if (isAsyncIterableIterator(value)) {
    for await (const chunk of value) {
      parts.push(chunk);
    }
  } else {
    throw new Error(
      `Unexpected data type: ${typeof value}; constructor: ${(_a2 = value === null || value === void 0 ? void 0 : value.constructor) === null || _a2 === void 0 ? void 0 : _a2.name}; props: ${propsForError(value)}`
    );
  }
  return parts;
}
function propsForError(value) {
  const props = Object.getOwnPropertyNames(value);
  return `[${props.map((p) => `"${p}"`).join(", ")}]`;
}
function getName(value) {
  var _a2;
  return getStringFromMaybeBuffer(value.name) || getStringFromMaybeBuffer(value.filename) || // For fs.ReadStream
  ((_a2 = getStringFromMaybeBuffer(value.path)) === null || _a2 === void 0 ? void 0 : _a2.split(/[\\/]/).pop());
}
var getStringFromMaybeBuffer = (x) => {
  if (typeof x === "string")
    return x;
  if (typeof Buffer !== "undefined" && x instanceof Buffer)
    return String(x);
  return void 0;
};
var isAsyncIterableIterator = (value) => value != null && typeof value === "object" && typeof value[Symbol.asyncIterator] === "function";
var MultipartBody = class {
  constructor(body) {
    this.body = body;
  }
  get [Symbol.toStringTag]() {
    return "MultipartBody";
  }
};
var isMultipartBody = (body) => body && typeof body === "object" && body.body && body[Symbol.toStringTag] === "MultipartBody";
var multipartFormRequestOptions = async (opts) => {
  const form = await createForm(opts.body);
  return getMultipartRequestOptions(form, opts);
};
var createForm = async (body) => {
  const form = new _FormData();
  await Promise.all(Object.entries(body || {}).map(([key, value]) => addFormValue(form, key, value)));
  return form;
};
var addFormValue = async (form, key, value) => {
  if (value === void 0)
    return;
  if (value == null) {
    throw new TypeError(
      `Received null for "${key}"; to pass null in FormData, you must use the string 'null'`
    );
  }
  if (typeof value === "string" || typeof value === "number" || typeof value === "boolean") {
    form.append(key, String(value));
  } else if (isUploadable(value)) {
    const file = await toFile(value);
    form.append(key, file);
  } else if (Array.isArray(value)) {
    await Promise.all(value.map((entry) => addFormValue(form, key + "[]", entry)));
  } else if (typeof value === "object") {
    await Promise.all(
      Object.entries(value).map(([name, prop]) => addFormValue(form, `${key}[${name}]`, prop))
    );
  } else {
    throw new TypeError(
      `Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${value} instead`
    );
  }
};

// node_modules/openai/core.mjs
var __classPrivateFieldSet = function(receiver, state, value, kind, f) {
  if (kind === "m")
    throw new TypeError("Private method is not writable");
  if (kind === "a" && !f)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;
};
var __classPrivateFieldGet = function(receiver, state, kind, f) {
  if (kind === "a" && !f)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var _AbstractPage_client;
var MAX_RETRIES = 2;
async function defaultParseResponse(props) {
  const { response } = props;
  if (props.options.stream) {
    return new Stream(response, props.controller);
  }
  const contentType = response.headers.get("content-type");
  if (contentType === null || contentType === void 0 ? void 0 : contentType.includes("application/json")) {
    const json = await response.json();
    debug("response", response.status, response.url, response.headers, json);
    return json;
  }
  const text = await response.text();
  debug("response", response.status, response.url, response.headers, text);
  return text;
}
var APIPromise = class extends Promise {
  constructor(responsePromise, parseResponse = defaultParseResponse) {
    super((resolve2) => {
      resolve2(null);
    });
    this.responsePromise = responsePromise;
    this.parseResponse = parseResponse;
  }
  _thenUnwrap(transform) {
    return new APIPromise(this.responsePromise, async (props) => transform(await this.parseResponse(props)));
  }
  /**
   * Gets the raw `Response` instance instead of parsing the response
   * data.
   *
   * If you want to parse the response body but still get the `Response`
   * instance, you can use {@link withResponse()}.
   */
  asResponse() {
    return this.responsePromise.then((p) => p.response);
  }
  /**
   * Gets the parsed response data and the raw `Response` instance.
   *
   * If you just want to get the raw `Response` instance without parsing it,
   * you can use {@link asResponse()}.
   */
  async withResponse() {
    const [data, response] = await Promise.all([this.parse(), this.asResponse()]);
    return { data, response };
  }
  parse() {
    if (!this.parsedPromise) {
      this.parsedPromise = this.responsePromise.then(this.parseResponse);
    }
    return this.parsedPromise;
  }
  then(onfulfilled, onrejected) {
    return this.parse().then(onfulfilled, onrejected);
  }
  catch(onrejected) {
    return this.parse().catch(onrejected);
  }
  finally(onfinally) {
    return this.parse().finally(onfinally);
  }
};
var APIClient = class {
  constructor({
    baseURL,
    maxRetries,
    timeout = 6e5,
    // 10 minutes
    httpAgent,
    fetch: overridenFetch
  }) {
    this.baseURL = baseURL;
    this.maxRetries = validatePositiveInteger(
      "maxRetries",
      maxRetries !== null && maxRetries !== void 0 ? maxRetries : MAX_RETRIES
    );
    this.timeout = validatePositiveInteger("timeout", timeout);
    this.httpAgent = httpAgent;
    this.fetch = overridenFetch !== null && overridenFetch !== void 0 ? overridenFetch : _fetch;
  }
  authHeaders(opts) {
    return {};
  }
  /**
   * Override this to add your own default headers, for example:
   *
   *  {
   *    ...super.defaultHeaders(),
   *    Authorization: 'Bearer 123',
   *  }
   */
  defaultHeaders(opts) {
    return {
      Accept: "application/json",
      "Content-Type": "application/json",
      "User-Agent": this.getUserAgent(),
      ...getPlatformHeaders(),
      ...this.authHeaders(opts)
    };
  }
  /**
   * Override this to add your own headers validation:
   */
  validateHeaders(headers, customHeaders) {
  }
  defaultIdempotencyKey() {
    return `stainless-node-retry-${uuid4()}`;
  }
  get(path, opts) {
    return this.methodRequest("get", path, opts);
  }
  post(path, opts) {
    return this.methodRequest("post", path, opts);
  }
  patch(path, opts) {
    return this.methodRequest("patch", path, opts);
  }
  put(path, opts) {
    return this.methodRequest("put", path, opts);
  }
  delete(path, opts) {
    return this.methodRequest("delete", path, opts);
  }
  methodRequest(method, path, opts) {
    return this.request(Promise.resolve(opts).then((opts2) => ({ method, path, ...opts2 })));
  }
  getAPIList(path, Page2, opts) {
    return this.requestAPIList(Page2, { method: "get", path, ...opts });
  }
  calculateContentLength(body) {
    if (typeof body === "string") {
      if (typeof Buffer !== "undefined") {
        return Buffer.byteLength(body, "utf8").toString();
      }
      if (typeof TextEncoder !== "undefined") {
        const encoder = new TextEncoder();
        const encoded = encoder.encode(body);
        return encoded.length.toString();
      }
    }
    return null;
  }
  buildRequest(options) {
    var _a2, _b, _c, _d, _e, _f;
    const { method, path, query, headers = {} } = options;
    const body = isMultipartBody(options.body) ? options.body.body : options.body ? JSON.stringify(options.body, null, 2) : null;
    const contentLength = this.calculateContentLength(body);
    const url = this.buildURL(path, query);
    if ("timeout" in options)
      validatePositiveInteger("timeout", options.timeout);
    const timeout = (_a2 = options.timeout) !== null && _a2 !== void 0 ? _a2 : this.timeout;
    const httpAgent = (_c = (_b = options.httpAgent) !== null && _b !== void 0 ? _b : this.httpAgent) !== null && _c !== void 0 ? _c : getDefaultAgent(url);
    const minAgentTimeout = timeout + 1e3;
    if (typeof ((_d = httpAgent === null || httpAgent === void 0 ? void 0 : httpAgent.options) === null || _d === void 0 ? void 0 : _d.timeout) === "number" && minAgentTimeout > ((_e = httpAgent.options.timeout) !== null && _e !== void 0 ? _e : 0)) {
      httpAgent.options.timeout = minAgentTimeout;
    }
    if (this.idempotencyHeader && method !== "get") {
      if (!options.idempotencyKey)
        options.idempotencyKey = this.defaultIdempotencyKey();
      headers[this.idempotencyHeader] = options.idempotencyKey;
    }
    const reqHeaders = {
      ...contentLength && { "Content-Length": contentLength },
      ...this.defaultHeaders(options),
      ...headers
    };
    if (isMultipartBody(options.body) && !isPolyfilled) {
      delete reqHeaders["Content-Type"];
    }
    Object.keys(reqHeaders).forEach((key) => reqHeaders[key] === null && delete reqHeaders[key]);
    const req = {
      method,
      ...body && { body },
      headers: reqHeaders,
      ...httpAgent && { agent: httpAgent },
      // @ts-ignore node-fetch uses a custom AbortSignal type that is
      // not compatible with standard web types
      signal: (_f = options.signal) !== null && _f !== void 0 ? _f : null
    };
    this.validateHeaders(reqHeaders, headers);
    return { req, url, timeout };
  }
  /**
   * Used as a callback for mutating the given `RequestInit` object.
   *
   * This is useful for cases where you want to add certain headers based off of
   * the request properties, e.g. `method` or `url`.
   */
  async prepareRequest(request, { url, options }) {
  }
  parseHeaders(headers) {
    return !headers ? {} : Symbol.iterator in headers ? Object.fromEntries(Array.from(headers).map((header) => [...header])) : { ...headers };
  }
  makeStatusError(status, error, message, headers) {
    return APIError.generate(status, error, message, headers);
  }
  request(options, remainingRetries = null) {
    return new APIPromise(this.makeRequest(options, remainingRetries));
  }
  async makeRequest(optionsInput, retriesRemaining) {
    var _a2, _b, _c;
    const options = await optionsInput;
    if (retriesRemaining == null) {
      retriesRemaining = (_a2 = options.maxRetries) !== null && _a2 !== void 0 ? _a2 : this.maxRetries;
    }
    const { req, url, timeout } = this.buildRequest(options);
    await this.prepareRequest(req, { url, options });
    debug("request", url, options, req.headers);
    if ((_b = options.signal) === null || _b === void 0 ? void 0 : _b.aborted) {
      throw new APIUserAbortError();
    }
    const controller = new AbortController();
    const response = await this.fetchWithTimeout(url, req, timeout, controller).catch(castToError);
    if (response instanceof Error) {
      if ((_c = options.signal) === null || _c === void 0 ? void 0 : _c.aborted) {
        throw new APIUserAbortError();
      }
      if (retriesRemaining) {
        return this.retryRequest(options, retriesRemaining);
      }
      if (response.name === "AbortError") {
        throw new APIConnectionTimeoutError();
      }
      throw new APIConnectionError({ cause: response });
    }
    const responseHeaders = createResponseHeaders(response.headers);
    if (!response.ok) {
      if (retriesRemaining && this.shouldRetry(response)) {
        return this.retryRequest(options, retriesRemaining, responseHeaders);
      }
      const errText = await response.text().catch(() => "Unknown");
      const errJSON = safeJSON(errText);
      const errMessage = errJSON ? void 0 : errText;
      debug("response", response.status, url, responseHeaders, errMessage);
      const err = this.makeStatusError(response.status, errJSON, errMessage, responseHeaders);
      throw err;
    }
    return { response, options, controller };
  }
  requestAPIList(Page2, options) {
    const request = this.makeRequest(options, null);
    return new PagePromise(this, request, Page2);
  }
  buildURL(path, query) {
    const url = isAbsoluteURL(path) ? new URL(path) : new URL(this.baseURL + (this.baseURL.endsWith("/") && path.startsWith("/") ? path.slice(1) : path));
    const defaultQuery = this.defaultQuery();
    if (!isEmptyObj(defaultQuery)) {
      query = { ...defaultQuery, ...query };
    }
    if (query) {
      url.search = this.stringifyQuery(query);
    }
    return url.toString();
  }
  stringifyQuery(query) {
    return Object.entries(query).filter(([_, value]) => typeof value !== "undefined").map(([key, value]) => {
      if (typeof value === "string" || typeof value === "number" || typeof value === "boolean") {
        return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
      }
      if (value === null) {
        return `${encodeURIComponent(key)}=`;
      }
      throw new Error(
        `Cannot stringify type ${typeof value}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`
      );
    }).join("&");
  }
  async fetchWithTimeout(url, init, ms, controller) {
    const { signal, ...options } = init || {};
    if (signal)
      signal.addEventListener("abort", () => controller.abort());
    const timeout = setTimeout(() => controller.abort(), ms);
    return this.getRequestClient().fetch(url, { signal: controller.signal, ...options }).finally(() => {
      clearTimeout(timeout);
    });
  }
  getRequestClient() {
    return { fetch: this.fetch };
  }
  shouldRetry(response) {
    const shouldRetryHeader = response.headers.get("x-should-retry");
    if (shouldRetryHeader === "true")
      return true;
    if (shouldRetryHeader === "false")
      return false;
    if (response.status === 409)
      return true;
    if (response.status === 429)
      return true;
    if (response.status >= 500)
      return true;
    return false;
  }
  async retryRequest(options, retriesRemaining, responseHeaders) {
    var _a2;
    retriesRemaining -= 1;
    const retryAfter = parseInt(
      (responseHeaders === null || responseHeaders === void 0 ? void 0 : responseHeaders["retry-after"]) || ""
    );
    const maxRetries = (_a2 = options.maxRetries) !== null && _a2 !== void 0 ? _a2 : this.maxRetries;
    const timeout = this.calculateRetryTimeoutSeconds(retriesRemaining, retryAfter, maxRetries) * 1e3;
    await sleep(timeout);
    return this.makeRequest(options, retriesRemaining);
  }
  calculateRetryTimeoutSeconds(retriesRemaining, retryAfter, maxRetries) {
    const initialRetryDelay = 0.5;
    const maxRetryDelay = 2;
    if (Number.isInteger(retryAfter) && retryAfter <= 60) {
      return retryAfter;
    }
    const numRetries = maxRetries - retriesRemaining;
    const sleepSeconds = Math.min(initialRetryDelay * Math.pow(numRetries - 1, 2), maxRetryDelay);
    const jitter = Math.random() - 0.5;
    return sleepSeconds + jitter;
  }
  getUserAgent() {
    return `${this.constructor.name}/JS ${VERSION}`;
  }
};
var AbstractPage = class {
  constructor(client, response, body, options) {
    _AbstractPage_client.set(this, void 0);
    __classPrivateFieldSet(this, _AbstractPage_client, client, "f");
    this.options = options;
    this.response = response;
    this.body = body;
  }
  hasNextPage() {
    const items = this.getPaginatedItems();
    if (!items.length)
      return false;
    return this.nextPageInfo() != null;
  }
  async getNextPage() {
    const nextInfo = this.nextPageInfo();
    if (!nextInfo) {
      throw new Error(
        "No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`."
      );
    }
    const nextOptions = { ...this.options };
    if ("params" in nextInfo) {
      nextOptions.query = { ...nextOptions.query, ...nextInfo.params };
    } else if ("url" in nextInfo) {
      const params = [...Object.entries(nextOptions.query || {}), ...nextInfo.url.searchParams.entries()];
      for (const [key, value] of params) {
        nextInfo.url.searchParams.set(key, value);
      }
      nextOptions.query = void 0;
      nextOptions.path = nextInfo.url.toString();
    }
    return await __classPrivateFieldGet(this, _AbstractPage_client, "f").requestAPIList(
      this.constructor,
      nextOptions
    );
  }
  async *iterPages() {
    let page = this;
    yield page;
    while (page.hasNextPage()) {
      page = await page.getNextPage();
      yield page;
    }
  }
  async *[(_AbstractPage_client = /* @__PURE__ */ new WeakMap(), Symbol.asyncIterator)]() {
    for await (const page of this.iterPages()) {
      for (const item of page.getPaginatedItems()) {
        yield item;
      }
    }
  }
};
var PagePromise = class extends APIPromise {
  constructor(client, request, Page2) {
    super(
      request,
      async (props) => new Page2(client, props.response, await defaultParseResponse(props), props.options)
    );
  }
  /**
   * Allow auto-paginating iteration on an unawaited list call, eg:
   *
   *    for await (const item of client.items.list()) {
   *      console.log(item)
   *    }
   */
  async *[Symbol.asyncIterator]() {
    const page = await this;
    for await (const item of page) {
      yield item;
    }
  }
};
var createResponseHeaders = (headers) => {
  return new Proxy(
    Object.fromEntries(
      // @ts-ignore
      headers.entries()
    ),
    {
      get(target, name) {
        const key = name.toString();
        return target[key.toLowerCase()] || target[key];
      }
    }
  );
};
var requestOptionsKeys = {
  method: true,
  path: true,
  query: true,
  body: true,
  headers: true,
  maxRetries: true,
  stream: true,
  timeout: true,
  httpAgent: true,
  signal: true,
  idempotencyKey: true
};
var isRequestOptions = (obj) => {
  return typeof obj === "object" && obj !== null && !isEmptyObj(obj) && Object.keys(obj).every((k) => hasOwn(requestOptionsKeys, k));
};
var getPlatformProperties = () => {
  if (typeof Deno !== "undefined" && Deno.build != null) {
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": VERSION,
      "X-Stainless-OS": normalizePlatform(Deno.build.os),
      "X-Stainless-Arch": normalizeArch(Deno.build.arch),
      "X-Stainless-Runtime": "deno",
      "X-Stainless-Runtime-Version": Deno.version
    };
  }
  if (typeof EdgeRuntime !== "undefined") {
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": VERSION,
      "X-Stainless-OS": "Unknown",
      "X-Stainless-Arch": `other:${EdgeRuntime}`,
      "X-Stainless-Runtime": "edge",
      "X-Stainless-Runtime-Version": process.version
    };
  }
  if (Object.prototype.toString.call(typeof process !== "undefined" ? process : 0) === "[object process]") {
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": VERSION,
      "X-Stainless-OS": normalizePlatform(process.platform),
      "X-Stainless-Arch": normalizeArch(process.arch),
      "X-Stainless-Runtime": "node",
      "X-Stainless-Runtime-Version": process.version
    };
  }
  const browserInfo = getBrowserInfo();
  if (browserInfo) {
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": VERSION,
      "X-Stainless-OS": "Unknown",
      "X-Stainless-Arch": "unknown",
      "X-Stainless-Runtime": `browser:${browserInfo.browser}`,
      "X-Stainless-Runtime-Version": browserInfo.version
    };
  }
  return {
    "X-Stainless-Lang": "js",
    "X-Stainless-Package-Version": VERSION,
    "X-Stainless-OS": "Unknown",
    "X-Stainless-Arch": "unknown",
    "X-Stainless-Runtime": "unknown",
    "X-Stainless-Runtime-Version": "unknown"
  };
};
function getBrowserInfo() {
  if (typeof navigator === "undefined" || !navigator) {
    return null;
  }
  const browserPatterns = [
    { key: "edge", pattern: /Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "ie", pattern: /MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "ie", pattern: /Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "chrome", pattern: /Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "firefox", pattern: /Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "safari", pattern: /(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/ }
  ];
  for (const { key, pattern } of browserPatterns) {
    const match = pattern.exec(navigator.userAgent);
    if (match) {
      const major = match[1] || 0;
      const minor = match[2] || 0;
      const patch = match[3] || 0;
      return { browser: key, version: `${major}.${minor}.${patch}` };
    }
  }
  return null;
}
var normalizeArch = (arch) => {
  if (arch === "x32")
    return "x32";
  if (arch === "x86_64" || arch === "x64")
    return "x64";
  if (arch === "arm")
    return "arm";
  if (arch === "aarch64" || arch === "arm64")
    return "arm64";
  if (arch)
    return `other:${arch}`;
  return "unknown";
};
var normalizePlatform = (platform) => {
  platform = platform.toLowerCase();
  if (platform.includes("ios"))
    return "iOS";
  if (platform === "android")
    return "Android";
  if (platform === "darwin")
    return "MacOS";
  if (platform === "win32")
    return "Windows";
  if (platform === "freebsd")
    return "FreeBSD";
  if (platform === "openbsd")
    return "OpenBSD";
  if (platform === "linux")
    return "Linux";
  if (platform)
    return `Other:${platform}`;
  return "Unknown";
};
var _platformHeaders;
var getPlatformHeaders = () => {
  return _platformHeaders !== null && _platformHeaders !== void 0 ? _platformHeaders : _platformHeaders = getPlatformProperties();
};
var safeJSON = (text) => {
  try {
    return JSON.parse(text);
  } catch (err) {
    return void 0;
  }
};
var startsWithSchemeRegexp = new RegExp("^(?:[a-z]+:)?//", "i");
var isAbsoluteURL = (url) => {
  return startsWithSchemeRegexp.test(url);
};
var sleep = (ms) => new Promise((resolve2) => setTimeout(resolve2, ms));
var validatePositiveInteger = (name, n) => {
  if (typeof n !== "number" || !Number.isInteger(n)) {
    throw new Error(`${name} must be an integer`);
  }
  if (n < 0) {
    throw new Error(`${name} must be a positive integer`);
  }
  return n;
};
var castToError = (err) => {
  if (err instanceof Error)
    return err;
  return new Error(err);
};
var readEnv = (env) => {
  var _a2, _b, _c, _d;
  if (typeof process !== "undefined") {
    return (_b = (_a2 = process.env) === null || _a2 === void 0 ? void 0 : _a2[env]) !== null && _b !== void 0 ? _b : void 0;
  }
  if (typeof Deno !== "undefined") {
    return (_d = (_c = Deno.env) === null || _c === void 0 ? void 0 : _c.get) === null || _d === void 0 ? void 0 : _d.call(_c, env);
  }
  return void 0;
};
function isEmptyObj(obj) {
  if (!obj)
    return true;
  for (const _k in obj)
    return false;
  return true;
}
function hasOwn(obj, key) {
  return Object.prototype.hasOwnProperty.call(obj, key);
}
function debug(action, ...args) {
  if (typeof process !== "undefined" && process.env["DEBUG"] === "true") {
    console.log(`OpenAI:DEBUG:${action}`, ...args);
  }
}
var uuid4 = () => {
  return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (c) => {
    const r = Math.random() * 16 | 0;
    const v = c === "x" ? r : r & 3 | 8;
    return v.toString(16);
  });
};
var isRunningInBrowser = () => {
  return (
    // @ts-ignore
    typeof window !== "undefined" && // @ts-ignore
    typeof window.document !== "undefined" && // @ts-ignore
    typeof navigator !== "undefined"
  );
};

// node_modules/openai/pagination.mjs
var Page = class extends AbstractPage {
  constructor(client, response, body, options) {
    super(client, response, body, options);
    this.object = body.object;
    this.data = body.data;
  }
  getPaginatedItems() {
    return this.data;
  }
  // @deprecated Please use `nextPageInfo()` instead
  /**
   * This page represents a response that isn't actually paginated at the API level
   * so there will never be any next page params.
   */
  nextPageParams() {
    return null;
  }
  nextPageInfo() {
    return null;
  }
};
var CursorPage = class extends AbstractPage {
  constructor(client, response, body, options) {
    super(client, response, body, options);
    this.data = body.data;
  }
  getPaginatedItems() {
    return this.data;
  }
  // @deprecated Please use `nextPageInfo()` instead
  nextPageParams() {
    const info = this.nextPageInfo();
    if (!info)
      return null;
    if ("params" in info)
      return info.params;
    const params = Object.fromEntries(info.url.searchParams);
    if (!Object.keys(params).length)
      return null;
    return params;
  }
  nextPageInfo() {
    var _a2, _b;
    if (!((_a2 = this.data) === null || _a2 === void 0 ? void 0 : _a2.length)) {
      return null;
    }
    const next = (_b = this.data[this.data.length - 1]) === null || _b === void 0 ? void 0 : _b.id;
    if (!next)
      return null;
    return { params: { after: next } };
  }
};

// node_modules/openai/resource.mjs
var APIResource = class {
  constructor(client) {
    this.client = client;
    this.get = client.get.bind(client);
    this.post = client.post.bind(client);
    this.patch = client.patch.bind(client);
    this.put = client.put.bind(client);
    this.delete = client.delete.bind(client);
    this.getAPIList = client.getAPIList.bind(client);
  }
};

// node_modules/openai/resources/audio/transcriptions.mjs
var Transcriptions = class extends APIResource {
  /**
   * Transcribes audio into the input language.
   */
  create(body, options) {
    return this.post("/audio/transcriptions", multipartFormRequestOptions({ body, ...options }));
  }
};
(function(Transcriptions2) {
})(Transcriptions || (Transcriptions = {}));

// node_modules/openai/resources/audio/translations.mjs
var Translations = class extends APIResource {
  /**
   * Translates audio into English.
   */
  create(body, options) {
    return this.post("/audio/translations", multipartFormRequestOptions({ body, ...options }));
  }
};
(function(Translations2) {
})(Translations || (Translations = {}));

// node_modules/openai/resources/audio/audio.mjs
var Audio = class extends APIResource {
  constructor() {
    super(...arguments);
    this.transcriptions = new Transcriptions(this.client);
    this.translations = new Translations(this.client);
  }
};
(function(Audio2) {
  Audio2.Transcriptions = Transcriptions;
  Audio2.Translations = Translations;
})(Audio || (Audio = {}));

// node_modules/openai/resources/chat/completions.mjs
var Completions = class extends APIResource {
  create(body, options) {
    var _a2;
    return this.post("/chat/completions", {
      body,
      ...options,
      stream: (_a2 = body.stream) !== null && _a2 !== void 0 ? _a2 : false
    });
  }
};
(function(Completions3) {
})(Completions || (Completions = {}));

// node_modules/openai/resources/chat/chat.mjs
var Chat = class extends APIResource {
  constructor() {
    super(...arguments);
    this.completions = new Completions(this.client);
  }
};
(function(Chat2) {
  Chat2.Completions = Completions;
})(Chat || (Chat = {}));

// node_modules/openai/resources/completions.mjs
var Completions2 = class extends APIResource {
  create(body, options) {
    var _a2;
    return this.post("/completions", {
      body,
      ...options,
      stream: (_a2 = body.stream) !== null && _a2 !== void 0 ? _a2 : false
    });
  }
};
(function(Completions3) {
})(Completions2 || (Completions2 = {}));

// node_modules/openai/resources/embeddings.mjs
var Embeddings = class extends APIResource {
  /**
   * Creates an embedding vector representing the input text.
   */
  create(body, options) {
    return this.post("/embeddings", { body, ...options });
  }
};
(function(Embeddings2) {
})(Embeddings || (Embeddings = {}));

// node_modules/openai/resources/edits.mjs
var Edits = class extends APIResource {
  /**
   * Creates a new edit for the provided input, instruction, and parameters.
   *
   * @deprecated The Edits API is deprecated; please use Chat Completions instead.
   *
   * https://openai.com/blog/gpt-4-api-general-availability#deprecation-of-the-edits-api
   */
  create(body, options) {
    return this.post("/edits", { body, ...options });
  }
};
(function(Edits2) {
})(Edits || (Edits = {}));

// node_modules/openai/resources/files.mjs
var Files = class extends APIResource {
  /**
   * Upload a file that contains document(s) to be used across various
   * endpoints/features. Currently, the size of all the files uploaded by one
   * organization can be up to 1 GB. Please contact us if you need to increase the
   * storage limit.
   */
  create(body, options) {
    return this.post("/files", multipartFormRequestOptions({ body, ...options }));
  }
  /**
   * Returns information about a specific file.
   */
  retrieve(fileId, options) {
    return this.get(`/files/${fileId}`, options);
  }
  /**
   * Returns a list of files that belong to the user's organization.
   */
  list(options) {
    return this.getAPIList("/files", FileObjectsPage, options);
  }
  /**
   * Delete a file.
   */
  del(fileId, options) {
    return this.delete(`/files/${fileId}`, options);
  }
  /**
   * Returns the contents of the specified file
   */
  retrieveContent(fileId, options) {
    return this.get(`/files/${fileId}/content`, {
      ...options,
      headers: {
        Accept: "application/json",
        ...options === null || options === void 0 ? void 0 : options.headers
      }
    });
  }
  /**
   * Waits for the given file to be processed, default timeout is 30 mins.
   */
  async waitForProcessing(id, { pollInterval = 5e3, maxWait = 30 * 60 * 1e3 } = {}) {
    const TERMINAL_STATES = /* @__PURE__ */ new Set(["processed", "error", "deleted"]);
    const start = Date.now();
    let file = await this.retrieve(id);
    while (!file.status || !TERMINAL_STATES.has(file.status)) {
      await sleep(pollInterval);
      file = await this.retrieve(id);
      if (Date.now() - start > maxWait) {
        throw new APIConnectionTimeoutError({
          message: `Giving up on waiting for file ${id} to finish processing after ${maxWait} milliseconds.`
        });
      }
    }
    return file;
  }
};
var FileObjectsPage = class extends Page {
};
(function(Files2) {
})(Files || (Files = {}));

// node_modules/openai/resources/fine-tunes.mjs
var FineTunes = class extends APIResource {
  /**
   * Creates a job that fine-tunes a specified model from a given dataset.
   *
   * Response includes details of the enqueued job including job status and the name
   * of the fine-tuned models once complete.
   *
   * [Learn more about fine-tuning](/docs/guides/legacy-fine-tuning)
   */
  create(body, options) {
    return this.post("/fine-tunes", { body, ...options });
  }
  /**
   * Gets info about the fine-tune job.
   *
   * [Learn more about fine-tuning](/docs/guides/legacy-fine-tuning)
   */
  retrieve(fineTuneId, options) {
    return this.get(`/fine-tunes/${fineTuneId}`, options);
  }
  /**
   * List your organization's fine-tuning jobs
   */
  list(options) {
    return this.getAPIList("/fine-tunes", FineTunesPage, options);
  }
  /**
   * Immediately cancel a fine-tune job.
   */
  cancel(fineTuneId, options) {
    return this.post(`/fine-tunes/${fineTuneId}/cancel`, options);
  }
  listEvents(fineTuneId, query, options) {
    var _a2;
    return this.get(`/fine-tunes/${fineTuneId}/events`, {
      query,
      timeout: 864e5,
      ...options,
      stream: (_a2 = query === null || query === void 0 ? void 0 : query.stream) !== null && _a2 !== void 0 ? _a2 : false
    });
  }
};
var FineTunesPage = class extends Page {
};
(function(FineTunes2) {
})(FineTunes || (FineTunes = {}));

// node_modules/openai/resources/fine-tuning/jobs.mjs
var Jobs = class extends APIResource {
  /**
   * Creates a job that fine-tunes a specified model from a given dataset.
   *
   * Response includes details of the enqueued job including job status and the name
   * of the fine-tuned models once complete.
   *
   * [Learn more about fine-tuning](/docs/guides/fine-tuning)
   */
  create(body, options) {
    return this.post("/fine_tuning/jobs", { body, ...options });
  }
  /**
   * Get info about a fine-tuning job.
   *
   * [Learn more about fine-tuning](/docs/guides/fine-tuning)
   */
  retrieve(fineTuningJobId, options) {
    return this.get(`/fine_tuning/jobs/${fineTuningJobId}`, options);
  }
  list(query = {}, options) {
    if (isRequestOptions(query)) {
      return this.list({}, query);
    }
    return this.getAPIList("/fine_tuning/jobs", FineTuningJobsPage, { query, ...options });
  }
  /**
   * Immediately cancel a fine-tune job.
   */
  cancel(fineTuningJobId, options) {
    return this.post(`/fine_tuning/jobs/${fineTuningJobId}/cancel`, options);
  }
  listEvents(fineTuningJobId, query = {}, options) {
    if (isRequestOptions(query)) {
      return this.listEvents(fineTuningJobId, {}, query);
    }
    return this.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/events`, FineTuningJobEventsPage, {
      query,
      ...options
    });
  }
};
var FineTuningJobsPage = class extends CursorPage {
};
var FineTuningJobEventsPage = class extends CursorPage {
};
(function(Jobs2) {
})(Jobs || (Jobs = {}));

// node_modules/openai/resources/fine-tuning/fine-tuning.mjs
var FineTuning = class extends APIResource {
  constructor() {
    super(...arguments);
    this.jobs = new Jobs(this.client);
  }
};
(function(FineTuning2) {
  FineTuning2.Jobs = Jobs;
  FineTuning2.FineTuningJobsPage = FineTuningJobsPage;
  FineTuning2.FineTuningJobEventsPage = FineTuningJobEventsPage;
})(FineTuning || (FineTuning = {}));

// node_modules/openai/resources/images.mjs
var Images = class extends APIResource {
  /**
   * Creates a variation of a given image.
   */
  createVariation(body, options) {
    return this.post("/images/variations", multipartFormRequestOptions({ body, ...options }));
  }
  /**
   * Creates an edited or extended image given an original image and a prompt.
   */
  edit(body, options) {
    return this.post("/images/edits", multipartFormRequestOptions({ body, ...options }));
  }
  /**
   * Creates an image given a prompt.
   */
  generate(body, options) {
    return this.post("/images/generations", { body, ...options });
  }
};
(function(Images2) {
})(Images || (Images = {}));

// node_modules/openai/resources/models.mjs
var Models = class extends APIResource {
  /**
   * Retrieves a model instance, providing basic information about the model such as
   * the owner and permissioning.
   */
  retrieve(model, options) {
    return this.get(`/models/${model}`, options);
  }
  /**
   * Lists the currently available models, and provides basic information about each
   * one such as the owner and availability.
   */
  list(options) {
    return this.getAPIList("/models", ModelsPage, options);
  }
  /**
   * Delete a fine-tuned model. You must have the Owner role in your organization to
   * delete a model.
   */
  del(model, options) {
    return this.delete(`/models/${model}`, options);
  }
};
var ModelsPage = class extends Page {
};
(function(Models2) {
})(Models || (Models = {}));

// node_modules/openai/resources/moderations.mjs
var Moderations = class extends APIResource {
  /**
   * Classifies if text violates OpenAI's Content Policy
   */
  create(body, options) {
    return this.post("/moderations", { body, ...options });
  }
};
(function(Moderations2) {
})(Moderations || (Moderations = {}));

// node_modules/openai/index.mjs
var _a;
var OpenAI = class extends APIClient {
  /**
   * API Client for interfacing with the OpenAI API.
   *
   * @param {string} [opts.apiKey=process.env['OPENAI_API_KEY']] - The API Key to send to the API.
   * @param {string} [opts.baseURL] - Override the default base URL for the API.
   * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.
   * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.
   * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.
   * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.
   * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.
   * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.
   * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.
   * @param {string | null} [opts.organization]
   */
  constructor(_b) {
    var _c, _d, _e;
    var {
      apiKey = readEnv("OPENAI_API_KEY"),
      organization = (_c = readEnv("OPENAI_ORG_ID")) !== null && _c !== void 0 ? _c : null,
      ...opts
    } = _b === void 0 ? {} : _b;
    if (apiKey === void 0) {
      throw new Error(
        "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' })."
      );
    }
    const options = {
      apiKey,
      organization,
      ...opts,
      baseURL: (_d = opts.baseURL) !== null && _d !== void 0 ? _d : `https://api.openai.com/v1`
    };
    if (!options.dangerouslyAllowBrowser && isRunningInBrowser()) {
      throw new Error(
        "It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n"
      );
    }
    super({
      baseURL: options.baseURL,
      timeout: (_e = options.timeout) !== null && _e !== void 0 ? _e : 6e5,
      httpAgent: options.httpAgent,
      maxRetries: options.maxRetries,
      fetch: options.fetch
    });
    this.completions = new Completions2(this);
    this.chat = new Chat(this);
    this.edits = new Edits(this);
    this.embeddings = new Embeddings(this);
    this.files = new Files(this);
    this.images = new Images(this);
    this.audio = new Audio(this);
    this.moderations = new Moderations(this);
    this.models = new Models(this);
    this.fineTuning = new FineTuning(this);
    this.fineTunes = new FineTunes(this);
    this._options = options;
    this.apiKey = apiKey;
    this.organization = organization;
  }
  defaultQuery() {
    return this._options.defaultQuery;
  }
  defaultHeaders(opts) {
    return {
      ...super.defaultHeaders(opts),
      "OpenAI-Organization": this.organization,
      ...this._options.defaultHeaders
    };
  }
  authHeaders(opts) {
    return { Authorization: `Bearer ${this.apiKey}` };
  }
};
_a = OpenAI;
OpenAI.OpenAI = _a;
OpenAI.APIError = APIError;
OpenAI.APIConnectionError = APIConnectionError;
OpenAI.APIConnectionTimeoutError = APIConnectionTimeoutError;
OpenAI.APIUserAbortError = APIUserAbortError;
OpenAI.NotFoundError = NotFoundError;
OpenAI.ConflictError = ConflictError;
OpenAI.RateLimitError = RateLimitError;
OpenAI.BadRequestError = BadRequestError;
OpenAI.AuthenticationError = AuthenticationError;
OpenAI.InternalServerError = InternalServerError;
OpenAI.PermissionDeniedError = PermissionDeniedError;
OpenAI.UnprocessableEntityError = UnprocessableEntityError;
var {
  APIError: APIError2,
  APIConnectionError: APIConnectionError2,
  APIConnectionTimeoutError: APIConnectionTimeoutError2,
  APIUserAbortError: APIUserAbortError2,
  NotFoundError: NotFoundError2,
  ConflictError: ConflictError2,
  RateLimitError: RateLimitError2,
  BadRequestError: BadRequestError2,
  AuthenticationError: AuthenticationError2,
  InternalServerError: InternalServerError2,
  PermissionDeniedError: PermissionDeniedError2,
  UnprocessableEntityError: UnprocessableEntityError2
} = error_exports;
(function(OpenAI2) {
  OpenAI2.toFile = toFile;
  OpenAI2.fileFromPath = fileFromPath;
  OpenAI2.Page = Page;
  OpenAI2.CursorPage = CursorPage;
  OpenAI2.Completions = Completions2;
  OpenAI2.Chat = Chat;
  OpenAI2.Edits = Edits;
  OpenAI2.Embeddings = Embeddings;
  OpenAI2.Files = Files;
  OpenAI2.FileObjectsPage = FileObjectsPage;
  OpenAI2.Images = Images;
  OpenAI2.Audio = Audio;
  OpenAI2.Moderations = Moderations;
  OpenAI2.Models = Models;
  OpenAI2.ModelsPage = ModelsPage;
  OpenAI2.FineTuning = FineTuning;
  OpenAI2.FineTunes = FineTunes;
  OpenAI2.FineTunesPage = FineTunesPage;
})(OpenAI || (OpenAI = {}));
var openai_default = OpenAI;

// src/components/editor/FetchRenameNoteTitle.ts
async function fetchModelRenameTitle(settings, referenceCurrentNoteContent2) {
  var _a2, _b;
  const clearYamlContent = referenceCurrentNoteContent2.replace(/---[\s\S]+?---/, "").trim();
  const prompt = `You are a title generator. You will give succinct titles that does not contain backslashes,
                    forward slashes, or colons. Only generate a title as your response for:

`;
  try {
    if (settings.OllamaConnection.RESTAPIURL && settings.OllamaConnection.ollamaModels.includes(settings.general.model)) {
      try {
        const ollama = new Ollama2({ host: settings.OllamaConnection.RESTAPIURL });
        const response = await ollama.generate({
          model: settings.general.model,
          system: prompt,
          prompt: clearYamlContent + "\n\n",
          stream: false,
          options: {
            temperature: parseInt(settings.general.temperature),
            num_predict: 40
          }
        });
        let title = response.response;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        new import_obsidian5.Notice("Error generating title:", error);
        console.error("Error generating title:", error);
        throw error;
      }
    } else if (settings.RESTAPIURLConnection.RESTAPIURLModels.includes(settings.general.model)) {
      try {
        const response = await (0, import_obsidian5.requestUrl)({
          url: settings.RESTAPIURLConnection.RESTAPIURL + "/chat/completions",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${settings.RESTAPIURLConnection.APIKey}`
          },
          body: JSON.stringify({
            model: settings.general.model,
            messages: [
              { role: "system", content: prompt + clearYamlContent },
              { role: "user", content: "\n" }
            ],
            max_tokens: 40
          })
        });
        let title = response.json.choices[0].message.content;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        console.error("Error making API request:", error);
        throw error;
      }
    } else if (ANTHROPIC_MODELS.includes(settings.general.model)) {
      try {
        const response = await (0, import_obsidian5.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "anthropic-version": "2023-06-01",
            "content-type": "application/json",
            "x-api-key": settings.APIConnections.anthropic.APIKey
          },
          body: JSON.stringify({
            model: settings.general.model,
            system: prompt,
            messages: [
              { role: "user", content: `${clearYamlContent}` }
            ],
            max_tokens: 40,
            temperature: parseInt(settings.general.temperature)
          })
        });
        let title = response.json.content[0].text;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        new import_obsidian5.Notice(error);
        console.error(error);
        throw error;
      }
    } else if (settings.APIConnections.googleGemini.geminiModels.includes(settings.general.model)) {
      try {
        const API_KEY = settings.APIConnections.googleGemini.APIKey;
        const requestBody = {
          contents: [{
            parts: [
              { text: prompt + clearYamlContent }
            ]
          }]
        };
        const response = await (0, import_obsidian5.requestUrl)({
          url: `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`,
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(requestBody)
        });
        let title = response.json.candidates[0].content.parts[0].text;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        console.error(error);
      }
    } else if (settings.APIConnections.mistral.mistralModels.includes(settings.general.model)) {
      try {
        const response = await (0, import_obsidian5.requestUrl)({
          url: "https://api.mistral.ai/v1/chat/completions",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${settings.APIConnections.mistral.APIKey}`
          },
          body: JSON.stringify({
            model: settings.general.model,
            messages: [
              { role: "system", content: prompt + clearYamlContent },
              { role: "user", content: "\n" }
            ],
            max_tokens: 40
          })
        });
        let title = response.json.choices[0].message.content;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        console.error(error);
      }
    } else if (OPENAI_MODELS.includes(settings.general.model) || settings.APIConnections.openAI.openAIBaseModels.includes(settings.general.model)) {
      const openai = new openai_default({
        apiKey: settings.APIConnections.openAI.APIKey,
        baseURL: settings.APIConnections.openAI.openAIBaseUrl,
        dangerouslyAllowBrowser: true
        // apiKey is stored within data.json
      });
      const chatCompletion = await openai.chat.completions.create({
        model: settings.general.model,
        max_tokens: 40,
        messages: [
          { role: "system", content: prompt + clearYamlContent },
          { role: "user", content: "" }
        ]
      });
      let title = chatCompletion.choices[0].message.content;
      if (title) {
        title = title.replace(/[\\/:"]/g, "");
      }
      return title;
    } else if (settings.APIConnections.openRouter.openRouterModels.includes(settings.general.model)) {
      try {
        const response = await (0, import_obsidian5.requestUrl)({
          url: "https://openrouter.ai/api/v1/chat/completions",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${settings.APIConnections.openRouter.APIKey}`
          },
          body: JSON.stringify({
            model: settings.general.model,
            messages: [
              { role: "system", content: prompt + clearYamlContent },
              { role: "user", content: "\n" }
            ],
            max_tokens: 40
          })
        });
        let title = response.json.choices[0].message.content;
        if (title) {
          title = title.replace(/[\\/:"]/g, "");
        }
        return title;
      } catch (error) {
        console.error("Error making API request:", error);
        throw error;
      }
    } else {
      throw new Error("Invalid model selected for renaming note title. Please check your settings.");
    }
  } catch (error) {
    console.log("ERROR");
    throw new Error(((_b = (_a2 = error.response) == null ? void 0 : _a2.data) == null ? void 0 : _b.error) || error.message);
  }
}

// src/components/chat/Commands.ts
var lastLoadedChatHistoryFile = null;
var commandMap = {
  "/help": (input, settings, plugin) => commandHelp(plugin, settings),
  "/model": (input, settings, plugin) => commandModel(input, settings, plugin),
  "/profile": (input, settings, plugin) => commandProfile(input, settings, plugin),
  "/prompt": (input, settings, plugin) => commandPrompt(input, settings, plugin),
  "/reference": (input, settings, plugin) => commandReference(input, settings, plugin),
  "/temperature": (input, settings, plugin) => commandTemperature(input, settings, plugin),
  "/maxtokens": (input, settings, plugin) => commandMaxTokens(input, settings, plugin),
  "/append": (input, settings, plugin) => commandAppend(plugin, settings),
  "/save": (input, settings, plugin) => commandSave(plugin, settings),
  "/load": (input, settings, plugin) => commandLoad(input, plugin, settings),
  "/clear": (input, settings, plugin) => removeMessageThread(plugin, 0),
  "/stop": (input, settings, plugin) => commandStop()
};
var aliases = {
  "/help": ["/h", "/man", "/manual", "/commands"],
  "/model": ["/m", "/models"],
  "/profile": ["/p", "/prof", "/profiles"],
  "/prompt": ["/prompts"],
  "/reference": ["/ref"],
  "/temperature": ["/temp", ""],
  "/clear": ["/c"],
  "/stop": ["/s"]
};
Object.entries(aliases).forEach(([command, aliasList]) => {
  aliasList.forEach((alias) => commandMap[alias] = commandMap[command]);
});
function executeCommand(input, settings, plugin) {
  const command = input.split(" ")[0];
  const handler = commandMap[command] || (() => commandFalse());
  return handler(input, settings, plugin);
}
async function commandFalse() {
  new import_obsidian6.Notice("Command not recognized. Type `/help` for commands.");
  const chatbox = document.querySelector(".chatbox textarea");
  chatbox.value = "";
}
function commandHelp(plugin, settings) {
  const messageContainer = document.querySelector("#messageContainer");
  const botMessageDiv = document.createElement("div");
  botMessageDiv.className = "botMessage";
  botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
  const botMessageToolBarDiv = document.createElement("div");
  botMessageToolBarDiv.className = "botMessageToolBar";
  const botNameSpan = document.createElement("span");
  botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
  botNameSpan.className = "chatbotName";
  const messageBlockDiv = document.createElement("div");
  messageBlockDiv.className = "messageBlock";
  const displayCommandBotMessageDiv = document.createElement("div");
  displayCommandBotMessageDiv.className = "commandBotMessage";
  const header = document.createElement("h3");
  header.textContent = "Manual";
  header.style.textAlign = "center";
  displayCommandBotMessageDiv.appendChild(header);
  const generalCommandHeader = document.createElement("h4");
  generalCommandHeader.textContent = "General Commands";
  generalCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(generalCommandHeader);
  const commandClearP = document.createElement("p");
  commandClearP.innerHTML = "<code>/clear</code> or <code>/c</code> - Clear chat history.";
  displayCommandBotMessageDiv.appendChild(commandClearP);
  const commandRefOnP = document.createElement("p");
  commandRefOnP.innerHTML = '<code>/ref on</code> - Turn on "reference current note".';
  displayCommandBotMessageDiv.appendChild(commandRefOnP);
  const commandRefOffP = document.createElement("p");
  commandRefOffP.innerHTML = '<code>/ref off</code> - Turn off "reference current note".';
  displayCommandBotMessageDiv.appendChild(commandRefOffP);
  const commandMaxTokensP = document.createElement("p");
  commandMaxTokensP.innerHTML = "<code>/maxtokens [VALUE]</code> - Set max tokens.";
  displayCommandBotMessageDiv.appendChild(commandMaxTokensP);
  const commandTempP = document.createElement("p");
  commandTempP.innerHTML = "<code>/temp [VALUE]</code> - Change temperature range from 0 to 2.";
  displayCommandBotMessageDiv.appendChild(commandTempP);
  const profileCommandHeader = document.createElement("h4");
  profileCommandHeader.textContent = "Profile Commands";
  profileCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(profileCommandHeader);
  const commandProfileListP = document.createElement("p");
  commandProfileListP.innerHTML = "<code>/profile</code> - List profile.";
  displayCommandBotMessageDiv.appendChild(commandProfileListP);
  const commandProfileChangeP = document.createElement("p");
  commandProfileChangeP.innerHTML = "<code>/profile [PROFILE-NAME] or [VALUE]</code> - Change profile.";
  displayCommandBotMessageDiv.appendChild(commandProfileChangeP);
  const modelCommandHeader = document.createElement("h4");
  modelCommandHeader.textContent = "Model Commands";
  modelCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(modelCommandHeader);
  const commandModelListP = document.createElement("p");
  commandModelListP.innerHTML = "<code>/model</code> - List model.";
  displayCommandBotMessageDiv.appendChild(commandModelListP);
  const commandModelChangeP = document.createElement("p");
  commandModelChangeP.innerHTML = "<code>/model [MODEL-NAME] or [VALUE]</code> - Change model.";
  displayCommandBotMessageDiv.appendChild(commandModelChangeP);
  const promptCommandHeader = document.createElement("h4");
  promptCommandHeader.textContent = "Prompt Commands";
  promptCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(promptCommandHeader);
  const commandPromptListP = document.createElement("p");
  commandPromptListP.innerHTML = "<code>/prompt</code> - List prompts.";
  displayCommandBotMessageDiv.appendChild(commandPromptListP);
  const commandPromptChangeP = document.createElement("p");
  commandPromptChangeP.innerHTML = "<code>/prompt [PROMPT-NAME] or [VALUE]</code> - Change prompts.";
  displayCommandBotMessageDiv.appendChild(commandPromptChangeP);
  const commandPromptClearP = document.createElement("p");
  commandPromptClearP.innerHTML = "<code>/prompt clear</code> - Clear prompt.";
  displayCommandBotMessageDiv.appendChild(commandPromptClearP);
  const editorCommandHeader = document.createElement("h4");
  editorCommandHeader.textContent = "Editor Commands";
  editorCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(editorCommandHeader);
  const commandAppendP = document.createElement("p");
  commandAppendP.innerHTML = "<code>/append</code> - Append current chat history to current active note.";
  displayCommandBotMessageDiv.appendChild(commandAppendP);
  const commandSaveP = document.createElement("p");
  commandSaveP.innerHTML = "<code>/save</code> - Save current chat history to a note.";
  displayCommandBotMessageDiv.appendChild(commandSaveP);
  const commandLoadP = document.createElement("p");
  commandLoadP.innerHTML = "<code>/load</code> - List or load a chat history into view.";
  displayCommandBotMessageDiv.appendChild(commandLoadP);
  const streamCommandHeader = document.createElement("h4");
  streamCommandHeader.textContent = "Response Commands";
  streamCommandHeader.style.textAlign = "left";
  displayCommandBotMessageDiv.appendChild(streamCommandHeader);
  const commandStopP = document.createElement("p");
  commandStopP.innerHTML = "<code>/stop</code> or <code>/s</code> - Stop fetching response. Warning: Anthropric models cannot be aborted. Please use with caution.";
  displayCommandBotMessageDiv.appendChild(commandStopP);
  messageBlockDiv.appendChild(displayCommandBotMessageDiv);
  botMessageToolBarDiv.appendChild(botNameSpan);
  botMessageDiv.appendChild(botMessageToolBarDiv);
  botMessageDiv.appendChild(messageBlockDiv);
  const index2 = messageHistory.length - 1;
  addMessage(plugin, messageBlockDiv.innerHTML, "botMessage", settings, index2);
  messageContainer.appendChild(botMessageDiv);
}
async function commandModel(input, settings, plugin) {
  const messageContainer = document.querySelector("#messageContainer");
  const ollamaModels = settings.OllamaConnection.ollamaModels.map((model) => model);
  const RESTAPIModels = settings.RESTAPIURLConnection.RESTAPIURLModels.map((model) => model);
  const anthropicModels = settings.APIConnections.anthropic.anthropicModels.map((model) => model);
  const googleGeminiModels = settings.APIConnections.googleGemini.geminiModels.map((model) => model);
  const mistralModels = settings.APIConnections.mistral.mistralModels.map((model) => model);
  const openAIBaseModels = settings.APIConnections.openAI.openAIBaseModels.map((model) => model);
  const openRouterModels = settings.APIConnections.openRouter.openRouterModels.map((model) => model);
  const allModels = [
    ...settings.OllamaConnection.ollamaModels,
    ...settings.RESTAPIURLConnection.RESTAPIURLModels,
    ...settings.APIConnections.anthropic.anthropicModels,
    ...settings.APIConnections.googleGemini.geminiModels,
    ...settings.APIConnections.mistral.mistralModels,
    ...settings.APIConnections.openAI.openAIBaseModels,
    ...settings.APIConnections.openRouter.openRouterModels
  ];
  if (!input.split(" ")[1]) {
    let currentModel = settings.general.model;
    if (!currentModel) {
      currentModel = "Empty";
    }
    const botMessageDiv = document.createElement("div");
    botMessageDiv.className = "botMessage";
    botMessageDiv.style.backgroundColor = colorToHex(settings.appearance.botMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim());
    const botMessageToolBarDiv = document.createElement("div");
    botMessageToolBarDiv.className = "botMessageToolBar";
    const botNameSpan = document.createElement("span");
    botNameSpan.textContent = settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName;
    botNameSpan.className = "chatbotName";
    const messageBlockDiv = document.createElement("div");
    messageBlockDiv.className = "messageBlock";
    const displayCommandBotMessageDiv = document.createElement("div");
    displayCommandBotMessageDiv.className = "commandBotMessage";
    const header = document.createElement("h3");
    header.textContent = "Model List";
    header.style.textAlign = "center";
    displayCommandBotMessageDiv.appendChild(header);
    const currentModelP = document.createElement("p");
    currentModelP.innerHTML = `<b>Current Model:</b> ${currentModel}`;
    currentModelP.style.textAlign = "center";
    displayCommandBotMessageDiv.appendChild(currentModelP);
    const apiLists = [
      { header: "Ollama Models", items: ollamaModels },
      { header: "REST API Models", items: RESTAPIModels },
      { header: "Anthropic Models", items: anthropicModels },
      { header: "Google Gemini Models", items: googleGeminiModels },
      { header: "Mistral Models", items: mistralModels },
      { header: "OpenAI-Based Models", items: openAIBaseModels },
      { header: "OpenRouter Models", items: openRouterModels }
    ];
    let currentStartIndex = 1;
    apiLists.forEach((api) => {
      if (Array.isArray(api.items) && api.items.length) {
        const header2 = document.createElement("h4");
        header2.textContent = api.header;
        displayCommandBotMessageDiv.appendChild(header2);
        const list = document.createElement("ol");
        list.setAttribute("start", String(currentStartIndex));
        api.items.forEach((item) => {
          const listItem = document.createElement("li");
          listItem.textContent = item;
          list.appendChild(listItem);
        });
        displayCommandBotMessageDiv.appendChild(list);
        currentStartIndex += api.items.length;
      }
    });
    messageBlockDiv.appendChild(displayCommandBotMessageDiv);
    botMessageToolBarDiv.appendChild(botNameSpan);
    botMessageDiv.appendChild(botMessageToolBarDiv);
    botMessageDiv.appendChild(messageBlockDiv);
    const index2 = messageHistory.length - 1;
    addMessage(plugin, messageBlockDiv.innerHTML, "botMessage", settings, index2);
    messageContainer.appendChild(botMessageDiv);
  }
  if (input.split(" ")[1] !== void 0) {
    const inputModel = input.split(" ")[1].replace(/^"(.*)"$/, "$1");
    const modelAliases = {};
    for (let i = 1; i <= allModels.length; i++) {
      const model = allModels[i - 1];
      modelAliases[i] = model;
    }
    if (Object.entries(modelAliases).find(([key, val]) => key === inputModel)) {
      settings.general.model = modelAliases[inputModel];
      new import_obsidian6.Notice(`Updated model to ${settings.general.model}`);
    } else if (Object.entries(modelAliases).find(([key, val]) => val === inputModel)) {
      settings.general.model = modelAliases[Object.keys(modelAliases).find((key) => modelAliases[key] === inputModel) || ""];
      new import_obsidian6.Notice(`Updated model to ${settings.general.model}`);
    } else {
      new import_obsidian6.Notice("Invalid model.");
    }
    await plugin.saveSettings();
  }
}
async function commandProfile(input, settings, plugin) {
  const messageContainer = document.querySelector("#messageContainer");
  if (!settings.profiles.profileFolderPath) {
    new import_obsidian6.Notice("Profile folder path not set.");
    const commandBotMessage = "<p>Profile folder path not set.</p>";
    const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, commandBotMessage);
    messageContainer.appendChild(botMessageDiv);
    return;
  }
  const files = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.profiles.profileFolderPath));
  files.sort((a, b) => a.name.localeCompare(b.name));
  let currentProfile = settings.profiles.profile.replace(/\.[^/.]+$/, "");
  if (!input.split(" ")[1]) {
    const fileListItems = files.map((file) => {
      const fileNameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
      return `<li>${fileNameWithoutExtension}</li>`;
    }).join("");
    if (!currentProfile) {
      currentProfile = "Empty";
    }
    const commandBotMessage = `<h2 style="text-align: center;">Profiles</h2>
      <p style="text-align: center;"><b>Current profile:</b> ${currentProfile}</p>
      <ol>${fileListItems}</ol>`;
    const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, commandBotMessage);
    messageContainer.appendChild(botMessageDiv);
    return;
  }
  if (input.startsWith("/p") || input.startsWith("/prof") || input.startsWith("/profile") || input.startsWith("/profiles")) {
    let inputValue = input.split(" ").slice(1).join(" ").trim();
    if (inputValue.startsWith('"') && inputValue.endsWith('"') || inputValue.startsWith("'") && inputValue.endsWith("'")) {
      inputValue = inputValue.substring(1, inputValue.length - 1);
    }
    const profileAliases = {};
    for (let i = 1; i <= files.length; i++) {
      const fileNameWithoutExtension = files[i - 1].name.replace(/\.[^/.]+$/, "");
      profileAliases[i.toString().toLowerCase()] = fileNameWithoutExtension;
    }
    if (profileAliases[inputValue]) {
      plugin.settings.profiles.profile = profileAliases[inputValue] + ".md";
      const profileFilePath = plugin.settings.profiles.profileFolderPath + "/" + profileAliases[inputValue] + ".md";
      const currentProfile2 = plugin.app.vault.getAbstractFileByPath(profileFilePath);
      const currentProfileName = settings.profiles.profile.replace(/\.[^/.]+$/, "");
      const profileIndex = files.findIndex((file) => file.basename === currentProfileName);
      settings.profiles.lastLoadedChatHistoryPath = settings.profiles.lastLoadedChatHistory[profileIndex];
      plugin.activateView();
      await updateSettingsFromFrontMatter(plugin, currentProfile2);
      await plugin.saveSettings();
    } else if (Object.values(profileAliases).map((v) => v.toLowerCase()).includes(inputValue.toLowerCase())) {
      const matchedProfile = Object.entries(profileAliases).find(([key, value]) => value.toLowerCase() === inputValue.toLowerCase());
      if (matchedProfile) {
        plugin.settings.profiles.profile = matchedProfile[1] + ".md";
        const profileFilePath = plugin.settings.profiles.profileFolderPath + "/" + matchedProfile[1] + ".md";
        const currentProfile2 = plugin.app.vault.getAbstractFileByPath(profileFilePath);
        const currentProfileName = settings.profiles.profile.replace(/\.[^/.]+$/, "");
        const profileIndex = files.findIndex((file) => file.basename === currentProfileName);
        settings.profiles.lastLoadedChatHistoryPath = settings.profiles.lastLoadedChatHistory[profileIndex];
        plugin.activateView();
        await updateSettingsFromFrontMatter(plugin, currentProfile2);
        await plugin.saveSettings();
      }
    } else {
      new import_obsidian6.Notice("Invalid profile.");
    }
    await plugin.saveSettings();
  }
}
async function commandPrompt(input, settings, plugin) {
  const messageContainer = document.querySelector("#messageContainer");
  if (!settings.prompts.promptFolderPath) {
    new import_obsidian6.Notice("Prompt folder path not set.");
    const commandBotMessage = "<p>Prompt folder path not set.</p>";
    const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, commandBotMessage);
    messageContainer.appendChild(botMessageDiv);
    return;
  }
  const files = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.prompts.promptFolderPath));
  files.sort((a, b) => a.name.localeCompare(b.name));
  if (!input.split(" ")[1]) {
    const fileListItems = files.map((file) => {
      const fileNameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
      return `<li>${fileNameWithoutExtension}</li>`;
    }).join("");
    let currentPrompt = settings.prompts.prompt;
    if (!currentPrompt) {
      currentPrompt = "Empty";
    }
    const commandBotMessage = `<h2 style="text-align: center;">Prompts</h2>
      <p style="text-align: center;"><b>Current prompt:</b> ${currentPrompt.replace(".md", "")}</p>
      <ol>${fileListItems}</ol>`;
    const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, commandBotMessage);
    messageContainer.appendChild(botMessageDiv);
    return;
  }
  if (input.startsWith("/prompt")) {
    let inputValue = input.split(" ").slice(1).join(" ").trim();
    if (inputValue.startsWith('"') && inputValue.endsWith('"') || inputValue.startsWith("'") && inputValue.endsWith("'")) {
      inputValue = inputValue.substring(1, inputValue.length - 1);
    }
    if (inputValue === "clear" || inputValue === "c") {
      settings.prompts.prompt = "";
      new import_obsidian6.Notice("Prompt cleared.");
      await plugin.saveSettings();
    }
    const promptAliases = {};
    for (let i = 1; i <= files.length; i++) {
      const fileNameWithoutExtension = files[i - 1].name.replace(/\.[^/.]+$/, "");
      promptAliases[i.toString()] = fileNameWithoutExtension;
    }
    let currentModel;
    if (promptAliases[inputValue]) {
      settings.prompts.prompt = promptAliases[inputValue] + ".md";
      currentModel = settings.prompts.prompt.replace(/\.[^/.]+$/, "");
      new import_obsidian6.Notice(`Prompt updated to '${currentModel}'`);
    } else if (Object.values(promptAliases).map((v) => v.toLowerCase()).includes(inputValue.toLowerCase())) {
      const matchedProfile = Object.entries(promptAliases).find(([key, value]) => value.toLowerCase() === inputValue.toLowerCase());
      if (matchedProfile) {
        settings.prompts.prompt = matchedProfile[1] + ".md";
        currentModel = settings.prompts.prompt.replace(/\.[^/.]+$/, "");
        new import_obsidian6.Notice(`Prompt updated to '${currentModel}'`);
      }
    } else {
      if (inputValue !== "clear" && inputValue !== "c") {
        new import_obsidian6.Notice("Invalid prompt.");
      }
    }
    await plugin.saveSettings();
  }
}
async function commandReference(input, settings, plugin) {
  var _a2;
  const referenceCurrentNoteElement = document.getElementById("referenceCurrentNote");
  const inputValue = (_a2 = input.split(" ")[1]) == null ? void 0 : _a2.toLowerCase();
  if (inputValue === "true" || inputValue === "on") {
    settings.general.enableReferenceCurrentNote = true;
    if (referenceCurrentNoteElement) {
      referenceCurrentNoteElement.style.display = "block";
    }
    new import_obsidian6.Notice("Reference current note: on.");
  } else if (inputValue === "false" || inputValue === "off") {
    settings.general.enableReferenceCurrentNote = false;
    if (referenceCurrentNoteElement) {
      referenceCurrentNoteElement.style.display = "none";
    }
    new import_obsidian6.Notice("Reference current note: off.");
  } else {
    new import_obsidian6.Notice("Type `/ref on` or `/ref off` to turn on/off reference current note.");
  }
  await plugin.saveSettings();
}
async function commandTemperature(input, settings, plugin) {
  const inputValue = input.split(" ")[1];
  const floatValue = parseFloat(inputValue);
  if (settings && !isNaN(floatValue)) {
    if (floatValue < 0) {
      settings.general.temperature = "0.00";
    } else if (floatValue > 2) {
      settings.general.temperature = "2.00";
    } else {
      settings.general.temperature = floatValue.toFixed(2);
    }
    new import_obsidian6.Notice(`Temperature updated: ${settings.general.temperature}`);
  } else {
    new import_obsidian6.Notice(`Current temperature: ${settings.general.temperature}`);
  }
  await plugin.saveSettings();
}
async function commandMaxTokens(input, settings, plugin) {
  const commandParts = input.split(" ");
  const commandAction = commandParts[1] ? commandParts[1].toLowerCase() : "";
  if (commandAction === "c" || commandAction === "clear") {
    settings.general.max_tokens = "";
    new import_obsidian6.Notice("Max tokens cleared.");
  } else if (commandAction !== "") {
    const inputValue = parseInt(commandAction);
    if (!isNaN(inputValue) && inputValue >= 0) {
      settings.general.max_tokens = inputValue.toString();
      new import_obsidian6.Notice(`Max tokens updated: ${inputValue}`);
    } else {
      new import_obsidian6.Notice("Max tokens update: invalid");
    }
  } else {
    if (settings.general.max_tokens === "") {
      new import_obsidian6.Notice("Current max tokens: Empty");
    } else {
      new import_obsidian6.Notice(`Current max tokens: ${settings.general.max_tokens}`);
    }
  }
  await plugin.saveSettings();
}
async function commandAppend(plugin, settings) {
  let markdownContent = "";
  const activeFile = plugin.app.workspace.getActiveFile();
  if ((activeFile == null ? void 0 : activeFile.extension) === "md") {
    const existingContent = await plugin.app.vault.read(activeFile);
    const userNames = document.querySelectorAll(".userName");
    let userNameText = "USER";
    if (userNames.length > 0) {
      const userNameNode = userNames[0];
      Array.from(userNameNode.childNodes).forEach((node) => {
        if (node.nodeType === Node.TEXT_NODE && node.textContent) {
          userNameText = node.textContent.trim().toUpperCase();
        }
      });
    }
    const chatbotNames = document.querySelectorAll(".chatbotName");
    const chatbotNameText = chatbotNames.length > 0 && chatbotNames[0].textContent ? chatbotNames[0].textContent.toUpperCase() : "ASSISTANT";
    if (await this.app.vault.adapter.exists(fileNameMessageHistoryJson(plugin))) {
      try {
        const jsonContent = await this.app.vault.adapter.read(fileNameMessageHistoryJson(plugin));
        const messages = JSON.parse(jsonContent);
        let skipNext = false;
        markdownContent += messages.filter((messageHistory2, index2, array) => {
          if (skipNext && messageHistory2.role === "assistant") {
            skipNext = false;
            return false;
          }
          if (messageHistory2.content.startsWith("/") || messageHistory2.content.includes("errorBotMessage")) {
            skipNext = index2 + 1 < array.length && array[index2 + 1].role === "assistant" || messageHistory2.role === "assistant";
            return false;
          }
          return true;
        }).map((message) => {
          let roleText = message.role.toUpperCase();
          roleText = roleText === "USER" ? userNameText : roleText;
          roleText = roleText === "ASSISTANT" ? chatbotNameText : roleText;
          return `###### ${roleText}
${message.content}
`;
        }).join("\n");
      } catch (error) {
        const messageContainer = document.querySelector("#messageContainer");
        const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, error);
        messageContainer.appendChild(botMessageDiv);
        console.error("Error processing message history:", error);
      }
    }
    const updatedContent = existingContent + "\n" + markdownContent;
    await plugin.app.vault.modify(activeFile, updatedContent);
    new import_obsidian6.Notice("Appended conversation.");
  } else {
    new import_obsidian6.Notice("No active Markdown file detected.");
  }
}
async function commandSave(plugin, settings) {
  new import_obsidian6.Notice("Saving conversation...");
  let folderName = settings.chatHistory.chatHistoryPath;
  if (!await plugin.app.vault.adapter.exists(folderName)) {
    await plugin.app.vault.createFolder(folderName);
  }
  const baseFileName = "Chat History";
  const fileExtension = ".md";
  if (folderName && !folderName.endsWith("/")) {
    folderName += "/";
  }
  const now = new Date();
  const dateTimeStamp = now.getFullYear() + "-" + (now.getMonth() + 1).toString().padStart(2, "0") + "-" + now.getDate().toString().padStart(2, "0") + " " + now.getHours().toString().padStart(2, "0") + "-" + now.getMinutes().toString().padStart(2, "0") + "-" + now.getSeconds().toString().padStart(2, "0");
  try {
    let markdownContent = "";
    const allFiles = plugin.app.vault.getFiles();
    const templateFile = allFiles.find((file) => file.path.toLowerCase() === settings.chatHistory.templateFilePath.toLowerCase());
    if (templateFile) {
      let fileContent = await plugin.app.vault.read(templateFile);
      if (/^---\s*[\s\S]*?---/.test(fileContent)) {
        if (!/^model:\s/m.test(fileContent)) {
          fileContent = fileContent.replace(/^---/, `---
model: ${settings.general.model}`);
        }
      } else {
        fileContent = `---
  model: ${settings.general.model}
---
` + fileContent;
      }
      markdownContent += fileContent;
    } else {
      markdownContent += `---
  model: ${settings.general.model}
---
`;
    }
    const userNames = document.querySelectorAll(".userName");
    let userNameText = "USER";
    if (userNames.length > 0) {
      const userNameNode = userNames[0];
      Array.from(userNameNode.childNodes).forEach((node) => {
        if (node.nodeType === Node.TEXT_NODE && node.textContent) {
          userNameText = node.textContent.trim().toUpperCase();
        }
      });
    }
    const chatbotNames = document.querySelectorAll(".chatbotName");
    const chatbotNameText = chatbotNames.length > 0 && chatbotNames[0].textContent ? chatbotNames[0].textContent.toUpperCase() : "ASSISTANT";
    if (await plugin.app.vault.adapter.exists(fileNameMessageHistoryJson(plugin))) {
      try {
        const jsonContent = await plugin.app.vault.adapter.read(fileNameMessageHistoryJson(plugin));
        const messages = JSON.parse(jsonContent);
        let skipNext = false;
        markdownContent += messages.filter((messageHistory2, index2, array) => {
          if (skipNext && messageHistory2.role === "assistant") {
            skipNext = false;
            return false;
          }
          if (messageHistory2.content.startsWith("/") || messageHistory2.content.includes("errorBotMessage")) {
            skipNext = index2 + 1 < array.length && array[index2 + 1].role === "assistant" || messageHistory2.role === "assistant";
            return false;
          }
          return true;
        }).map((message) => {
          let roleText = message.role.toUpperCase();
          roleText = roleText === "USER" ? userNameText : roleText;
          roleText = roleText === "ASSISTANT" ? chatbotNameText : roleText;
          const regexRenderedBlock = /<block-rendered>[\s\S]*?<\/block-rendered>/g;
          message.content = message.content.replace(regexRenderedBlock, "").trim();
          const regexRenderedNote = /<note-rendered>[\s\S]*?<\/note-rendered>/g;
          message.content = message.content.replace(regexRenderedNote, "").trim();
          return `###### ${roleText}
${message.content}
`;
        }).join("\n");
      } catch (error) {
        console.error("Error processing message history:", error);
      }
    }
    let fileName = "";
    if (settings.chatHistory.allowRenameNoteTitle) {
      let uniqueNameFound = false;
      let modelRenameTitle;
      const fileNameExists = (name) => {
        return allFiles.some((file) => file.path === folderName + name + fileExtension);
      };
      while (!uniqueNameFound) {
        modelRenameTitle = await fetchModelRenameTitle(settings, markdownContent);
        if (!fileNameExists(modelRenameTitle)) {
          uniqueNameFound = true;
        }
      }
      fileName = folderName + modelRenameTitle + fileExtension;
    } else {
      fileName = folderName + baseFileName + " " + dateTimeStamp + fileExtension;
    }
    if (settings.profiles.lastLoadedChatHistoryPath !== null) {
      lastLoadedChatHistoryFile = plugin.app.vault.getAbstractFileByPath(settings.profiles.lastLoadedChatHistoryPath);
    }
    if (lastLoadedChatHistoryFile === null) {
      const file = await plugin.app.vault.create(fileName, markdownContent);
      const profileFiles = plugin.app.vault.getFiles().filter((file2) => file2.path.startsWith(settings.profiles.profileFolderPath));
      profileFiles.sort((a, b) => a.name.localeCompare(b.name));
      const currentProfile = settings.profiles.profile.replace(/\.[^/.]+$/, "");
      const profileIndex = profileFiles.findIndex((file2) => file2.basename === currentProfile);
      if (file) {
        settings.profiles.lastLoadedChatHistoryPath = file.path;
        settings.profiles.lastLoadedChatHistory[profileIndex] = file.path;
        plugin.app.workspace.openLinkText(fileName, "", true, { active: true });
      }
    } else {
      await plugin.app.vault.modify(lastLoadedChatHistoryFile, markdownContent);
      const activeFile = plugin.app.workspace.getActiveFile();
      if ((activeFile == null ? void 0 : activeFile.path) !== lastLoadedChatHistoryFile.path) {
        plugin.app.workspace.openLinkText(lastLoadedChatHistoryFile.path, lastLoadedChatHistoryFile.path, true, { active: true });
      }
    }
    new import_obsidian6.Notice(`Saved to '${lastLoadedChatHistoryFile == null ? void 0 : lastLoadedChatHistoryFile.name}'`);
    await plugin.saveSettings();
  } catch (error) {
    console.error("Failed to create note:", error);
  }
}
async function commandLoad(input, plugin, settings) {
  const messageContainer = document.querySelector("#messageContainer");
  const folderPath = plugin.settings.chatHistory.chatHistoryPath.trim() || DEFAULT_SETTINGS.chatHistory.chatHistoryPath;
  const files = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(folderPath));
  files.sort((a, b) => a.name.localeCompare(b.name));
  const profileFiles = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.profiles.profileFolderPath));
  profileFiles.sort((a, b) => a.name.localeCompare(b.name));
  const currentProfile = settings.profiles.profile.replace(/\.[^/.]+$/, "");
  const profileIndex = profileFiles.findIndex((file) => file.basename === currentProfile);
  if (!input.split(" ")[1]) {
    const fileGroups = files.reduce((acc, file) => {
      const fileNameWithoutExtension = file.name.replace(/\.[^/.]+$/, "");
      if (acc[fileNameWithoutExtension]) {
        acc[fileNameWithoutExtension].count++;
      } else {
        acc[fileNameWithoutExtension] = { count: 1 };
      }
      return acc;
    }, {});
    const fileListItems = Object.entries(fileGroups).map(([fileName, { count }]) => {
      return count > 1 ? `<li>${fileName} [${count} files found]</li>` : `<li>${fileName}</li>`;
    }).join("");
    const commandBotMessage = `<h2 style="text-align: center;">Chat History</h2>
   <p style="text-align: center;"><b>Current Chat History:</b> ${settings.profiles.lastLoadedChatHistory[profileIndex] ? settings.profiles.lastLoadedChatHistory[profileIndex] : "Empty"}</p>
    <ol>${fileListItems}</ol>`;
    const botMessageDiv = displayCommandBotMessage(plugin, settings, messageHistory, commandBotMessage);
    messageContainer.appendChild(botMessageDiv);
    return;
  }
  if (input.startsWith("/load")) {
    let inputValue = input.split(" ").slice(1).join(" ").trim();
    if (inputValue.startsWith('"') && inputValue.endsWith('"') || inputValue.startsWith("'") && inputValue.endsWith("'")) {
      inputValue = inputValue.substring(1, inputValue.length - 1);
    }
    const loadAliases = {};
    let currentIndex = 1;
    for (let i = 0; i < files.length; i++) {
      const fileNameWithoutExtension = files[i].name.replace(/\.[^/.]+$/, "");
      const existingKey = Object.values(loadAliases).find(
        (value) => value === fileNameWithoutExtension
      );
      if (!existingKey) {
        loadAliases[currentIndex.toString().toLowerCase()] = fileNameWithoutExtension;
        currentIndex++;
      }
    }
    const messageHistory2 = [];
    const loadChatHistory = async (filePath) => {
      const currentLoad = plugin.app.vault.getAbstractFileByPath(filePath);
      const fileContent = await plugin.app.vault.cachedRead(currentLoad);
      const contentWithoutFrontmatter = fileContent.replace(/^---\n[\s\S]*?\n---\n/, "");
      const lines = contentWithoutFrontmatter.split("\n");
      let currentRole = "";
      let currentContent = "";
      let headerCount = 0;
      for (const line of lines) {
        if (line.startsWith("###### ")) {
          headerCount++;
          if (currentContent) {
            messageHistory2.push({
              role: currentRole,
              content: currentContent.trim()
            });
          }
          currentRole = currentRole === "user" ? "assistant" : "user";
          currentContent = "";
        } else {
          currentContent += line + "\n";
        }
      }
      if (currentContent) {
        messageHistory2.push({
          role: currentRole,
          content: currentContent.trim()
        });
      }
      if (headerCount % 2 !== 0) {
        new import_obsidian6.Notice("Incorrect formatting.");
        return false;
      }
      const updatedJsonString = JSON.stringify(messageHistory2, null, 4);
      await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), updatedJsonString);
      plugin.activateView();
      return true;
    };
    if (loadAliases[inputValue]) {
      const matchingFiles = files.filter((file) => file.name.includes(loadAliases[inputValue]));
      const modal = new import_obsidian6.Modal(plugin.app);
      const modalContent = document.createElement("div");
      modalContent.classList.add("modal-content");
      const heading = document.createElement("h2");
      heading.textContent = "Load Chat History";
      modalContent.appendChild(heading);
      if (matchingFiles.length === 1) {
        const message = document.createElement("p");
        message.textContent = `Are you sure you want to override your current chat history with "${matchingFiles[0].name}"?`;
        modalContent.appendChild(message);
        const confirmLoadButton = document.createElement("button");
        confirmLoadButton.id = "confirmLoad";
        confirmLoadButton.textContent = "Confirm";
        modalContent.appendChild(confirmLoadButton);
        confirmLoadButton == null ? void 0 : confirmLoadButton.addEventListener("click", async function() {
          const selectedFile = matchingFiles[0];
          const chatHistoryFilePath = selectedFile.path;
          const success = await loadChatHistory(chatHistoryFilePath);
          if (success) {
            new import_obsidian6.Notice(`Switched to '${selectedFile.path}' chat history.`);
            lastLoadedChatHistoryFile = selectedFile;
            settings.profiles.lastLoadedChatHistoryPath = selectedFile.path;
            settings.profiles.lastLoadedChatHistory[profileIndex] = settings.profiles.lastLoadedChatHistoryPath;
            await plugin.saveSettings();
          }
          modal.close();
        });
      } else {
        const message = document.createElement("p");
        message.textContent = "Select a chat history to override:";
        modalContent.appendChild(message);
        const optionsContainer = document.createElement("div");
        optionsContainer.classList.add("file-options");
        optionsContainer.style.marginBottom = "16px";
        matchingFiles.forEach((file, index2) => {
          const radioElement = document.createElement("input");
          radioElement.type = "radio";
          radioElement.name = "fileOption";
          radioElement.value = file.path;
          radioElement.id = `file-${index2}`;
          const labelElement = document.createElement("label");
          labelElement.htmlFor = `file-${index2}`;
          labelElement.textContent = file.path;
          optionsContainer.appendChild(radioElement);
          optionsContainer.appendChild(labelElement);
          optionsContainer.appendChild(document.createElement("br"));
        });
        modalContent.appendChild(optionsContainer);
        const confirmLoadButton = document.createElement("button");
        confirmLoadButton.id = "confirmLoad";
        confirmLoadButton.textContent = "Load";
        modalContent.appendChild(confirmLoadButton);
        confirmLoadButton == null ? void 0 : confirmLoadButton.addEventListener("click", async function() {
          const selectedRadio = optionsContainer.querySelector('input[type="radio"]:checked');
          if (selectedRadio) {
            const selectedFilePath = selectedRadio.value;
            const selectedFile = matchingFiles.find((file) => file.path === selectedFilePath);
            if (selectedFile) {
              const chatHistoryFilePath = selectedFile.path;
              const success = await loadChatHistory(chatHistoryFilePath);
              if (success) {
                new import_obsidian6.Notice(`Switched to '${selectedFile.path}' chat history.`);
                lastLoadedChatHistoryFile = selectedFile;
                settings.profiles.lastLoadedChatHistoryPath = selectedFile.path;
                settings.profiles.lastLoadedChatHistory[profileIndex] = settings.profiles.lastLoadedChatHistoryPath;
                await plugin.saveSettings();
              }
              modal.close();
            }
          }
        });
      }
      modal.contentEl.appendChild(modalContent);
      modal.open();
    } else if (Object.values(loadAliases).map((v) => v.toLowerCase()).includes(inputValue.toLowerCase())) {
      const matchedFile = Object.entries(loadAliases).find(([key, value]) => value.toLowerCase() === inputValue.toLowerCase());
      if (matchedFile) {
        const matchingFiles = files.filter((file) => file.name.includes(matchedFile[1]));
        const modal = new import_obsidian6.Modal(plugin.app);
        const modalContent = document.createElement("div");
        modalContent.classList.add("modal-content");
        const heading = document.createElement("h2");
        heading.textContent = "Load Chat History";
        modalContent.appendChild(heading);
        if (matchingFiles.length === 1) {
          const message = document.createElement("p");
          message.textContent = `Are you sure you want to override your current chat history with "${matchingFiles[0].name}"?`;
          modalContent.appendChild(message);
          const confirmLoadButton = document.createElement("button");
          confirmLoadButton.id = "confirmLoad";
          confirmLoadButton.textContent = "Confirm";
          modalContent.appendChild(confirmLoadButton);
          confirmLoadButton == null ? void 0 : confirmLoadButton.addEventListener("click", async function() {
            const selectedFile = matchingFiles[0];
            const chatHistoryFilePath = selectedFile.path;
            const success = await loadChatHistory(chatHistoryFilePath);
            if (success) {
              new import_obsidian6.Notice(`Switched to '${selectedFile.path}' chat history.`);
              lastLoadedChatHistoryFile = selectedFile;
              settings.profiles.lastLoadedChatHistoryPath = selectedFile.path;
              settings.profiles.lastLoadedChatHistory[profileIndex] = settings.profiles.lastLoadedChatHistoryPath;
              await plugin.saveSettings();
            }
            modal.close();
          });
        } else {
          const message = document.createElement("p");
          message.textContent = "Select a chat history to override:";
          modalContent.appendChild(message);
          const optionsContainer = document.createElement("div");
          optionsContainer.classList.add("file-options");
          optionsContainer.style.marginBottom = "16px";
          matchingFiles.forEach((file, index2) => {
            const radioElement = document.createElement("input");
            radioElement.type = "radio";
            radioElement.name = "fileOption";
            radioElement.value = file.path;
            radioElement.id = `file-${index2}`;
            const labelElement = document.createElement("label");
            labelElement.htmlFor = `file-${index2}`;
            labelElement.textContent = file.path;
            optionsContainer.appendChild(radioElement);
            optionsContainer.appendChild(labelElement);
            optionsContainer.appendChild(document.createElement("br"));
          });
          modalContent.appendChild(optionsContainer);
          const confirmLoadButton = document.createElement("button");
          confirmLoadButton.id = "confirmLoad";
          confirmLoadButton.textContent = "Load";
          modalContent.appendChild(confirmLoadButton);
          confirmLoadButton == null ? void 0 : confirmLoadButton.addEventListener("click", async function() {
            const selectedRadio = optionsContainer.querySelector('input[type="radio"]:checked');
            if (selectedRadio) {
              const selectedFilePath = selectedRadio.value;
              const selectedFile = matchingFiles.find((file) => file.path === selectedFilePath);
              if (selectedFile) {
                const chatHistoryFilePath = selectedFile.path;
                const success = await loadChatHistory(chatHistoryFilePath);
                if (success) {
                  new import_obsidian6.Notice(`Switched to '${selectedFile.path}' chat history.`);
                  lastLoadedChatHistoryFile = selectedFile;
                  settings.profiles.lastLoadedChatHistoryPath = selectedFile.path;
                  settings.profiles.lastLoadedChatHistory[profileIndex] = settings.profiles.lastLoadedChatHistoryPath;
                  await plugin.saveSettings();
                }
                modal.close();
              }
            }
          });
        }
        modal.contentEl.appendChild(modalContent);
        modal.open();
      }
    } else {
      new import_obsidian6.Notice("File does not exist.");
    }
  }
}
function commandStop() {
  const controller = getAbortController();
  if (controller) {
    controller.abort();
  }
}
async function removeMessageThread(plugin, index2) {
  const messageContainer = document.querySelector("#messageContainer");
  const divElements = messageContainer == null ? void 0 : messageContainer.querySelectorAll("div.botMessage, div.userMessage");
  if (divElements && divElements.length > 0 && index2 >= 0 && index2 < divElements.length) {
    for (let i = index2; i < divElements.length; i++) {
      messageContainer == null ? void 0 : messageContainer.removeChild(divElements[i]);
    }
  }
  messageHistory.splice(index2);
  const jsonString = JSON.stringify(messageHistory, null, 4);
  try {
    await plugin.app.vault.adapter.write(fileNameMessageHistoryJson(plugin), jsonString);
    const profileFiles = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.profiles.profileFolderPath));
    profileFiles.sort((a, b) => a.name.localeCompare(b.name));
    const currentProfile = plugin.settings.profiles.profile.replace(/\.[^/.]+$/, "");
    const profileIndex = profileFiles.findIndex((file) => file.basename === currentProfile);
    lastLoadedChatHistoryFile = null;
    plugin.settings.profiles.lastLoadedChatHistoryPath = null;
    plugin.settings.profiles.lastLoadedChatHistory[profileIndex] = plugin.settings.profiles.lastLoadedChatHistoryPath;
    await plugin.saveSettings();
    new import_obsidian6.Notice("Chat history cleared.");
  } catch (error) {
    console.error("Error writing messageHistory.json", error);
  }
}

// src/components/chat/UserMessage.ts
function displayUserMessage(plugin, settings, message) {
  let trimmedMessage = message.trim();
  const userMessageDiv = document.createElement("div");
  userMessageDiv.className = "userMessage";
  userMessageDiv.style.backgroundColor = colorToHex(settings.appearance.userMessageBackgroundColor || getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.userMessageBackgroundColor).trim());
  userMessageDiv.style.color = settings.appearance.userMessageFontColor || DEFAULT_SETTINGS.appearance.userMessageFontColor;
  const userMessageToolBarDiv = document.createElement("div");
  userMessageToolBarDiv.className = "userMessageToolBar";
  const buttonContainerDiv = document.createElement("div");
  buttonContainerDiv.className = "button-container";
  const userNameSpan = document.createElement("span");
  userNameSpan.className = "userName";
  userNameSpan.textContent = settings.appearance.userName || DEFAULT_SETTINGS.appearance.userName;
  userMessageToolBarDiv.appendChild(userNameSpan);
  userMessageToolBarDiv.appendChild(buttonContainerDiv);
  const userPre = document.createElement("pre");
  const preUserMessage = document.createElement("span");
  preUserMessage.className = "preUserMessage";
  userPre.appendChild(preUserMessage);
  const regexRenderedNote = /<note-rendered>[\s\S]*?<\/note-rendered>/g;
  trimmedMessage = trimmedMessage.replace(regexRenderedNote, "").trim();
  preUserMessage.innerHTML = trimmedMessage;
  const regenerateButton = regenerateUserButton(plugin, settings);
  const editButton = displayUserEditButton(plugin, settings, userPre);
  const copyUserButton = displayUserCopyButton(userPre);
  const trashButton = displayTrashButton(plugin);
  if (!message.startsWith("/")) {
    buttonContainerDiv.appendChild(regenerateButton);
    buttonContainerDiv.appendChild(editButton);
  }
  buttonContainerDiv.appendChild(copyUserButton);
  buttonContainerDiv.appendChild(trashButton);
  userMessageDiv.appendChild(userMessageToolBarDiv);
  userMessageDiv.appendChild(userPre);
  return userMessageDiv;
}

// src/view.ts
var VIEW_TYPE_CHATBOT = "chatbot-view";
var ANTHROPIC_MODELS = ["claude-instant-1.2", "claude-2.0", "claude-2.1", "claude-3-haiku-20240307", "claude-3-sonnet-20240229", "claude-3-5-sonnet-20240620", "claude-3-opus-20240229"];
var OPENAI_MODELS = ["gpt-3.5-turbo", "gpt-4", "gpt-4-turbo", "gpt-4o", "gpt-4o-mini"];
function fileNameMessageHistoryJson(plugin) {
  const filenameMessageHistoryPath = "./.obsidian/plugins/bmo-chatbot/data/";
  const currentProfileMessageHistory = "messageHistory_" + plugin.settings.profiles.profile.replace(".md", ".json");
  return filenameMessageHistoryPath + currentProfileMessageHistory;
}
var messageHistory = [];
var lastCursorPosition = {
  line: 0,
  ch: 0
};
var lastCursorPositionFile = null;
var activeEditor = null;
var BMOView = class extends import_obsidian7.ItemView {
  constructor(leaf, settings, plugin) {
    super(leaf);
    this.preventEnter = false;
    this.settings = settings;
    this.plugin = plugin;
    this.icon = "bot";
    this.addCursorLogging();
  }
  getViewType() {
    return VIEW_TYPE_CHATBOT;
  }
  getDisplayText() {
    return "BMO Chatbot";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    const chatbotContainer = container.createEl("div", {
      attr: {
        class: "chatbotContainer"
      }
    });
    const header = chatbotContainer.createEl("div", {
      attr: {
        id: "header"
      }
    });
    const chatbotNameHeading = chatbotContainer.createEl("h1", {
      text: this.settings.appearance.chatbotName || DEFAULT_SETTINGS.appearance.chatbotName,
      attr: {
        id: "chatbotNameHeading"
      }
    });
    const modelOptions = populateModelDropdown(this.plugin, this.settings);
    const dotIndicator = chatbotContainer.createEl("span", {
      attr: {
        class: "dotIndicator",
        id: "markDownBoolean"
      }
    });
    const referenceCurrentNoteElement = chatbotContainer.createEl("p", {
      text: "Reference Current Note",
      attr: {
        id: "referenceCurrentNote"
      }
    });
    header.appendChild(chatbotNameHeading);
    header.appendChild(modelOptions);
    referenceCurrentNoteElement.appendChild(dotIndicator);
    referenceCurrentNoteElement.style.display = "none";
    if (referenceCurrentNoteElement) {
      if (this.settings.general.enableReferenceCurrentNote) {
        referenceCurrentNoteElement.style.display = "block";
      } else {
        referenceCurrentNoteElement.style.display = "none";
      }
    }
    const messageContainer = chatbotContainer.createEl("div", {
      attr: {
        id: "messageContainer"
      }
    });
    if (this.settings.appearance.enableHeader) {
      header.style.display = "block";
    } else {
      header.style.display = "none";
      messageContainer.style.maxHeight = "calc(100% - 60px)";
      referenceCurrentNoteElement.style.margin = "0.5rem 0 0.5rem 0";
    }
    await loadData(this.plugin);
    messageContainer.id = "messageContainer";
    messageHistory.forEach(async (messageData) => {
      if (messageData.role == "user") {
        const userMessageDiv = displayUserMessage(this.plugin, this.settings, messageData.content);
        messageContainer.appendChild(userMessageDiv);
      }
      if (messageData.role == "assistant") {
        const botMessageDiv = displayBotMessage(this.plugin, this.settings, messageHistory, messageData.content);
        updateUnresolvedInternalLinks(this.plugin, botMessageDiv);
        messageContainer.appendChild(botMessageDiv);
      }
    });
    messageContainer.addEventListener("click", (event) => {
      const target = event.target;
      if (target.tagName === "A" && target.classList.contains("internal-link")) {
        const link = target;
        const linkName = link.getAttribute("data-href") || "";
        this.plugin.app.workspace.openLinkText(linkName, "", false);
        link.style.color = "var(--link-color)";
      }
    });
    const parentElement = document.getElementById("parentElementId");
    parentElement == null ? void 0 : parentElement.appendChild(messageContainer);
    const chatbox = chatbotContainer.createEl("div", {
      attr: {
        class: "chatbox"
      }
    });
    const textarea = document.createElement("textarea");
    textarea.setAttribute("contenteditable", true.toString());
    textarea.setAttribute("placeholder", "Start typing...");
    if (textarea) {
      textarea.style.color = this.settings.appearance.chatBoxFontColor;
      const style = document.createElement("style");
      style.textContent = `
                .chatbox textarea::placeholder {
                    color: ${this.settings.appearance.chatBoxFontColor} !important;
                }
            `;
      textarea.appendChild(style);
    }
    const submitButton = document.createElement("button");
    submitButton.textContent = "send";
    (0, import_obsidian7.setIcon)(submitButton, "arrow-up");
    submitButton.classList.add("submit-button");
    submitButton.title = "send";
    submitButton.addEventListener("click", () => {
      this.handleKeyup(new KeyboardEvent("keyup", { key: "Enter" }), true);
    });
    chatbotContainer.style.backgroundColor = this.settings.appearance.chatbotContainerBackgroundColor || DEFAULT_SETTINGS.appearance.chatbotContainerBackgroundColor;
    messageContainer.style.backgroundColor = this.settings.appearance.messageContainerBackgroundColor || DEFAULT_SETTINGS.appearance.messageContainerBackgroundColor;
    textarea.style.backgroundColor = this.settings.appearance.chatBoxBackgroundColor || DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor;
    textarea.style.borderColor = this.settings.appearance.chatBoxBackgroundColor || DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor;
    textarea.style.color = this.settings.appearance.chatBoxFontColor || DEFAULT_SETTINGS.appearance.chatBoxFontColor;
    chatbox.style.backgroundColor = this.settings.appearance.chatBoxBackgroundColor || DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor;
    submitButton.style.backgroundColor = this.settings.appearance.chatBoxBackgroundColor || DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor;
    const userMessages = messageContainer.querySelectorAll(".userMessage");
    userMessages.forEach((userMessage) => {
      userMessage.style.color = this.settings.appearance.userMessageFontColor || DEFAULT_SETTINGS.appearance.userMessageFontColor;
    });
    const botMessages = messageContainer.querySelectorAll(".botMessage");
    botMessages.forEach((botMessage) => {
      botMessage.style.color = this.settings.appearance.botMessageFontColor || DEFAULT_SETTINGS.appearance.botMessageFontColor;
    });
    chatbox.appendChild(textarea);
    chatbox.appendChild(submitButton);
    this.textareaElement = textarea;
    this.addEventListeners();
    messageContainer.scrollTop = messageContainer.scrollHeight;
  }
  addEventListeners() {
    this.textareaElement.addEventListener("keyup", this.handleKeyup.bind(this));
    this.textareaElement.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textareaElement.addEventListener("input", this.handleInput.bind(this));
    this.textareaElement.addEventListener("blur", this.handleBlur.bind(this));
  }
  async handleKeyup(event, fromSubmitButton = false) {
    if ((document.body.classList.contains("is-mobile") || document.body.classList.contains("is-tablet")) && event.key === "Enter" && !fromSubmitButton) {
      event.preventDefault();
      this.textareaElement.value += "\n";
      this.handleInput(event);
      return;
    }
    const input = this.textareaElement.value;
    const index2 = messageHistory.length - 1;
    if (this.settings.OllamaConnection.enableStream || this.settings.RESTAPIURLConnection.enableStream || this.settings.APIConnections.mistral.enableStream || this.settings.APIConnections.openAI.enableStream) {
      if ((input === "/s" || input === "/stop") && event.key === "Enter") {
        this.preventEnter = false;
        await executeCommand(input, this.settings, this.plugin);
      }
    }
    const regex = /(!?)\[\[(.*?)\]\]/g;
    let matches;
    let inputModified = input;
    const replacements = /* @__PURE__ */ new Map();
    while ((matches = regex.exec(input)) !== null) {
      const exclamation = matches[1];
      const linktext = matches[2];
      const [path, subpath] = linktext.split("#");
      const file = this.plugin.app.metadataCache.getFirstLinkpathDest(path, "");
      if (file && file instanceof import_obsidian7.TFile) {
        try {
          const filePath = file.path;
          const fileExtension = filePath.split(".").pop();
          if (fileExtension !== "md") {
            const isImageFile = /\.(jpg|jpeg|png|gif|webp|bmp|tiff|tif|svg)$/i.test(filePath);
            if (!this.plugin.settings.OllamaConnection.ollamaModels.includes(this.plugin.settings.general.model)) {
              replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
            } else if (this.plugin.settings.OllamaConnection.ollamaModels.includes(this.plugin.settings.general.model)) {
              if (!isImageFile) {
                replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>ERROR: File cannot be read.</note-rendered>`);
              }
            }
            continue;
          }
          const content = await this.app.vault.read(file);
          let contentToInsert = content;
          if (subpath) {
            const lines = content.split("\n");
            let inSubpath = false;
            const subpathContent = [];
            let subpathLevel = 0;
            for (const line of lines) {
              if (line.startsWith("#")) {
                const match = line.match(/^#+/);
                const headingLevel = match ? match[0].length : 0;
                if (inSubpath) {
                  if (headingLevel <= subpathLevel) {
                    break;
                  }
                }
                if (!inSubpath && line.toLowerCase().includes(subpath.toLowerCase())) {
                  inSubpath = true;
                  subpathLevel = headingLevel;
                }
              }
              if (inSubpath) {
                subpathContent.push(line);
              }
            }
            contentToInsert = subpathContent.join("\n");
          }
          replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>${contentToInsert}</note-rendered>`);
        } catch (err) {
          console.error(`Failed to read the content of "${path}": ${err}`);
        }
      } else {
        replacements.set(matches[0], `${exclamation}[[${matches[2]}]]<note-rendered>File cannot be read.</note-rendered>`);
      }
    }
    for (const [original, replacement] of replacements) {
      inputModified = inputModified.split(original).join(replacement);
    }
    inputModified = inputModified.replace(/(<note-rendered>File cannot be read.<\/note-rendered>)+/g, "<note-rendered>File cannot be read.</note-rendered>");
    if (this.preventEnter === false && !event.shiftKey && event.key === "Enter") {
      loadData(this.plugin);
      event.preventDefault();
      if (input.length === 0) {
        return;
      }
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const excludedCommands = [
          "/c",
          "/clear",
          "/s",
          "/stop",
          "/save",
          "/load ",
          "/m ",
          "/model ",
          "/models ",
          "/p ",
          "/profile ",
          "/prof ",
          "/profiles ",
          "/prompt ",
          "/prompts ",
          "/append",
          "/reference ",
          "/ref ",
          "/maxtokens",
          "/maxtokens ",
          "/temperature",
          "/temperature ",
          "/temp",
          "/temp "
        ];
        if (!excludedCommands.some((cmd) => input.startsWith(cmd))) {
          const parts = input.split(" ");
          const baseCommand = parts[0];
          if (baseCommand.startsWith("/") && commandMap.hasOwnProperty(baseCommand)) {
            addMessage(this.plugin, input, "userMessage", this.settings, index2);
            const userMessageDiv = displayUserMessage(this.plugin, this.settings, input);
            messageContainer.appendChild(userMessageDiv);
          } else if (!baseCommand.startsWith("/")) {
            addMessage(this.plugin, inputModified, "userMessage", this.settings, index2);
            const userMessageDiv = displayUserMessage(this.plugin, this.settings, input);
            messageContainer.appendChild(userMessageDiv);
          } else {
          }
        }
        if (input.startsWith("/")) {
          executeCommand(input, this.settings, this.plugin);
          if (!excludedCommands.some((cmd) => input.startsWith(cmd))) {
            const botMessages = messageContainer.querySelectorAll(".botMessage");
            const lastBotMessage = botMessages[botMessages.length - 1];
            lastBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
          }
        } else {
          this.preventEnter = true;
          this.BMOchatbot().then(() => {
            this.preventEnter = false;
          }).catch(() => {
            const messageContainer2 = document.querySelector("#messageContainer");
            const botMessageDiv = displayErrorBotMessage(this.plugin, this.settings, messageHistory, "Oops, something went wrong. Please try again.");
            messageContainer2.appendChild(botMessageDiv);
          });
        }
      }
      this.textareaElement.value = "";
      this.textareaElement.style.height = "29px";
      this.textareaElement.value = this.textareaElement.value.trim();
      this.textareaElement.setSelectionRange(0, 0);
    }
  }
  handleKeydown(event) {
    if (event.key === "Enter" && !event.shiftKey) {
      event.preventDefault();
    }
  }
  handleInput(event) {
    this.textareaElement.style.height = "29px";
    this.textareaElement.style.height = this.textareaElement.scrollHeight + "px";
  }
  handleBlur(event) {
    if (!this.textareaElement.value) {
      this.textareaElement.style.height = "29px";
    }
  }
  exportSettings() {
    return this.settings;
  }
  addCursorLogging() {
    const updateCursorPosition = async () => {
      await getActiveFileContent(this.plugin, this.settings);
      const view = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
      if (view) {
        const cursor = view.editor.getCursor();
        lastCursorPositionFile = this.plugin.app.workspace.getActiveFile();
        if (cursor != null && this.plugin.app.workspace.activeEditor != null) {
          lastCursorPosition = cursor;
          activeEditor = view.editor;
        }
      }
    };
    activeWindow.addEventListener("click", updateCursorPosition);
    activeWindow.addEventListener("keyup", updateCursorPosition);
    activeWindow.addEventListener("keydown", updateCursorPosition);
    activeWindow.addEventListener("input", updateCursorPosition);
  }
  cleanup() {
    this.textareaElement.removeEventListener("keyup", this.handleKeyup.bind(this));
    this.textareaElement.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textareaElement.removeEventListener("input", this.handleInput.bind(this));
    this.textareaElement.removeEventListener("blur", this.handleBlur.bind(this));
  }
  async BMOchatbot() {
    await getActiveFileContent(this.plugin, this.settings);
    const index2 = messageHistory.length - 1;
    if (this.settings.general.model === "") {
      const errorMessage = "Model not found.";
      const messageContainer = document.querySelector("#messageContainer");
      const botMessageDiv = displayErrorBotMessage(this.plugin, this.settings, messageHistory, errorMessage);
      messageContainer.appendChild(botMessageDiv);
      const botMessages = messageContainer.querySelectorAll(".botMessage");
      const lastBotMessage = botMessages[botMessages.length - 1];
      lastBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
    } else {
      if (this.settings.OllamaConnection.ollamaModels.includes(this.settings.general.model)) {
        if (this.settings.OllamaConnection.enableStream) {
          await fetchOllamaResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchOllamaResponse(this.plugin, this.settings, index2);
        }
      } else if (this.settings.RESTAPIURLConnection.RESTAPIURLModels.includes(this.settings.general.model)) {
        if (this.settings.RESTAPIURLConnection.enableStream) {
          await fetchRESTAPIURLResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchRESTAPIURLResponse(this.plugin, this.settings, index2);
        }
      } else if (ANTHROPIC_MODELS.includes(this.settings.general.model)) {
        await fetchAnthropicResponse(this.plugin, this.settings, index2);
      } else if (this.settings.APIConnections.mistral.mistralModels.includes(this.settings.general.model)) {
        if (this.settings.APIConnections.mistral.enableStream) {
          await fetchMistralResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchMistralResponse(this.plugin, this.settings, index2);
        }
      } else if (this.settings.APIConnections.googleGemini.geminiModels.includes(this.settings.general.model)) {
        if (this.settings.APIConnections.googleGemini.enableStream) {
          await fetchGoogleGeminiResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchGoogleGeminiResponse(this.plugin, this.settings, index2);
        }
      } else if (this.settings.APIConnections.openAI.openAIBaseModels.includes(this.settings.general.model)) {
        if (this.settings.APIConnections.openAI.enableStream) {
          await fetchOpenAIAPIResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchOpenAIAPIResponse(this.plugin, this.settings, index2);
        }
      } else if (this.settings.APIConnections.openRouter.openRouterModels.includes(this.settings.general.model)) {
        if (this.settings.APIConnections.openRouter.enableStream) {
          await fetchOpenRouterResponseStream(this.plugin, this.settings, index2);
        } else {
          await fetchOpenRouterResponse(this.plugin, this.settings, index2);
        }
      } else {
        const errorMessage = "Connection not found.";
        const messageContainer = document.querySelector("#messageContainer");
        const botMessageDiv = displayErrorBotMessage(this.plugin, this.settings, messageHistory, errorMessage);
        messageContainer.appendChild(botMessageDiv);
        const botMessages = messageContainer.querySelectorAll(".botMessage");
        const lastBotMessage = botMessages[botMessages.length - 1];
        lastBotMessage.scrollIntoView({ behavior: "smooth", block: "start" });
      }
    }
  }
  async onClose() {
  }
};
async function loadData(plugin) {
  if (!await plugin.app.vault.adapter.exists("./.obsidian/plugins/bmo-chatbot/data/")) {
    plugin.app.vault.adapter.mkdir("./.obsidian/plugins/bmo-chatbot/data/");
  }
  if (await plugin.app.vault.adapter.exists(fileNameMessageHistoryJson(plugin))) {
    try {
      const fileContent = await plugin.app.vault.adapter.read(fileNameMessageHistoryJson(plugin));
      if (fileContent.trim() === "") {
        messageHistory = [];
      } else {
        messageHistory = JSON.parse(fileContent);
      }
    } catch (error) {
      console.error("Error processing message history:", error);
    }
  } else {
    messageHistory = [];
  }
}
function populateModelDropdown(plugin, settings) {
  const modelOptions = document.createElement("select");
  modelOptions.id = "modelOptions";
  if (modelOptions) {
    modelOptions.innerHTML = "";
  }
  const defaultModel = settings.general.model || DEFAULT_SETTINGS.general.model;
  const modelGroups = [
    { name: "Ollama Models", models: settings.OllamaConnection.ollamaModels },
    { name: "REST API Models", models: settings.RESTAPIURLConnection.RESTAPIURLModels },
    { name: "Anthropic Models", models: settings.APIConnections.anthropic.anthropicModels },
    { name: "Google Gemini Models", models: settings.APIConnections.googleGemini.geminiModels },
    { name: "Mistral Models", models: settings.APIConnections.mistral.mistralModels },
    { name: "OpenAI-Based Models", models: settings.APIConnections.openAI.openAIBaseModels },
    { name: "OpenRouter Models", models: settings.APIConnections.openRouter.openRouterModels }
  ];
  if (defaultModel === "") {
    const optionEl = document.createElement("option");
    optionEl.textContent = "No Model";
    optionEl.value = "";
    optionEl.selected = true;
    modelOptions.appendChild(optionEl);
  }
  modelGroups.forEach((group) => {
    if (group.models.length > 0) {
      const optgroup = document.createElement("optgroup");
      optgroup.label = group.name;
      group.models.forEach((model) => {
        const optionEl = document.createElement("option");
        optionEl.textContent = model;
        optionEl.value = model;
        if (model === defaultModel) {
          optionEl.selected = true;
        }
        optgroup.appendChild(optionEl);
      });
      modelOptions.appendChild(optgroup);
    }
  });
  modelOptions.addEventListener("change", async function() {
    plugin.settings.general.model = this.value;
    await plugin.saveSettings();
  });
  return modelOptions;
}

// src/settings.ts
var import_obsidian23 = require("obsidian");

// src/components/settings/GeneralSettings.ts
var import_obsidian9 = require("obsidian");

// src/components/FetchModelList.ts
var import_obsidian8 = require("obsidian");
async function fetchOllamaModels(plugin) {
  const ollamaRESTAPIURL = plugin.settings.OllamaConnection.RESTAPIURL;
  try {
    const ollama = new Ollama2({ host: ollamaRESTAPIURL });
    const modelsList = await ollama.list();
    const models = modelsList.models.map((model) => model.name);
    plugin.settings.OllamaConnection.ollamaModels = models;
    return models;
  } catch (error) {
    console.error("Error fetching models from Ollama:", error);
    return;
  }
}
async function fetchRESTAPIURLModels(plugin) {
  const RESTAPIURL = plugin.settings.RESTAPIURLConnection.RESTAPIURL;
  try {
    new URL(RESTAPIURL);
  } catch (error) {
    console.error("Invalid REST API URL:", RESTAPIURL);
    return;
  }
  try {
    const response = await (0, import_obsidian8.requestUrl)({
      url: RESTAPIURL + "/models",
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${plugin.settings.RESTAPIURLConnection.APIKey}`
      }
    });
    if (response.json && (response.json.data || Array.isArray(response.json))) {
      let models;
      if (Array.isArray(response.json)) {
        models = response.json.map((model) => model.id);
      } else {
        models = response.json.data.map((model) => model.id);
      }
      plugin.settings.RESTAPIURLConnection.RESTAPIURLModels = models;
      return models;
    }
  } catch (error) {
    console.error("Error making API request:", error);
    throw error;
  }
}
async function fetchGoogleGeminiModels(plugin) {
  try {
    const API_KEY = plugin.settings.APIConnections.googleGemini.APIKey;
    const response = await (0, import_obsidian8.requestUrl)({
      url: `https://generativelanguage.googleapis.com/v1beta/models?key=${API_KEY}`,
      method: "GET",
      headers: {
        "Content-Type": "application/json"
      }
    });
    if (response.json && response.json.models) {
      const models = response.json.models.map((model) => model.name).filter((model) => model.startsWith("models/gemini"));
      plugin.settings.APIConnections.googleGemini.geminiModels = models;
      return models;
    }
  } catch (error) {
    console.error(error);
  }
}
async function fetchMistralModels(plugin) {
  try {
    const response = await (0, import_obsidian8.requestUrl)({
      url: "https://api.mistral.ai/v1/models",
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${plugin.settings.APIConnections.mistral.APIKey}`
      }
    });
    if (response.json && response.json.data) {
      const models = response.json.data.map((model) => model.id);
      plugin.settings.APIConnections.mistral.mistralModels = models;
      console.log(models);
      return models;
    }
  } catch (error) {
    console.error(error);
  }
}
async function fetchOpenAIBaseModels(plugin) {
  const openai = new openai_default({
    apiKey: plugin.settings.APIConnections.openAI.APIKey,
    baseURL: plugin.settings.APIConnections.openAI.openAIBaseUrl,
    dangerouslyAllowBrowser: true
    // apiKey is stored within data.json
  });
  const list = await openai.models.list();
  if (openai.baseURL == "https://api.openai.com/v1") {
    plugin.settings.APIConnections.openAI.openAIBaseModels = OPENAI_MODELS;
    return OPENAI_MODELS;
  } else {
    const models = list.data.map((model) => model.id);
    plugin.settings.APIConnections.openAI.openAIBaseModels = models;
    return models;
  }
}
async function fetchOpenRouterModels(plugin) {
  try {
    const response = await (0, import_obsidian8.requestUrl)({
      url: "https://openrouter.ai/api/v1/models",
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${plugin.settings.APIConnections.openRouter.APIKey}`
      }
    });
    if (response.json && (response.json.data || Array.isArray(response.json))) {
      let models;
      if (Array.isArray(response.json)) {
        models = response.json.map((model) => model.id);
      } else {
        models = response.json.data.map((model) => model.id);
      }
      plugin.settings.APIConnections.openRouter.openRouterModels = models;
      return models;
    }
  } catch (error) {
    console.error("Error making API request:", error);
    throw error;
  }
}

// src/components/settings/GeneralSettings.ts
async function addGeneralSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "General" });
  const initialState = plugin.settings.toggleGeneralSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian9.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian9.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleGeneralSettings = false;
    } else {
      (0, import_obsidian9.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleGeneralSettings = true;
    }
    await plugin.saveSettings();
  });
  const createModelDropdown = (dropdown) => {
    const modelGroups = [
      { name: "Ollama Models", models: plugin.settings.OllamaConnection.ollamaModels },
      { name: "REST API Models", models: plugin.settings.RESTAPIURLConnection.RESTAPIURLModels },
      { name: "Anthropic Models", models: plugin.settings.APIConnections.anthropic.anthropicModels },
      { name: "Google Gemini Models", models: plugin.settings.APIConnections.googleGemini.geminiModels },
      { name: "Mistral Models", models: plugin.settings.APIConnections.mistral.mistralModels },
      { name: "OpenAI-Based Models", models: plugin.settings.APIConnections.openAI.openAIBaseModels },
      { name: "OpenRouter Models", models: plugin.settings.APIConnections.openRouter.openRouterModels }
    ];
    const selectEl = dropdown.selectEl;
    selectEl.innerHTML = "";
    const defaultOption = selectEl.createEl("option", {
      value: "",
      text: "No Model"
    });
    if (plugin.settings.general.model === "No Model") {
      defaultOption.selected = true;
    }
    modelGroups.forEach((group) => {
      if (group.models.length > 0) {
        const optgroup = selectEl.createEl("optgroup");
        optgroup.label = group.name;
        group.models.forEach((model) => {
          const option = optgroup.createEl("option", {
            value: model,
            text: model
          });
          if (model === plugin.settings.general.model) {
            option.selected = true;
          }
        });
      }
    });
    dropdown.onChange(async (value) => {
      plugin.settings.general.model = value;
      await plugin.saveSettings();
    });
  };
  let modelDropdown;
  new import_obsidian9.Setting(settingsContainer).setName("Model").setDesc("Choose a model.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      new import_obsidian9.Notice("Reloading...");
      if (plugin.settings.OllamaConnection.RESTAPIURL !== "") {
        const models = await fetchOllamaModels(plugin);
        plugin.settings.OllamaConnection.ollamaModels = models || [];
      }
      if (plugin.settings.RESTAPIURLConnection.RESTAPIURL !== "") {
        const models = await fetchRESTAPIURLModels(plugin);
        plugin.settings.RESTAPIURLConnection.RESTAPIURLModels = models || [];
      }
      if (plugin.settings.APIConnections.anthropic.APIKey !== "") {
        const models = ANTHROPIC_MODELS;
        plugin.settings.APIConnections.anthropic.anthropicModels = models || [];
      }
      if (plugin.settings.APIConnections.googleGemini.APIKey !== "") {
        const models = await fetchGoogleGeminiModels(plugin);
        plugin.settings.APIConnections.googleGemini.geminiModels = models || [];
      }
      if (plugin.settings.APIConnections.mistral.APIKey !== "") {
        const models = await fetchMistralModels(plugin);
        plugin.settings.APIConnections.mistral.mistralModels = models || [];
      }
      if (plugin.settings.APIConnections.openAI.APIKey !== "" || plugin.settings.APIConnections.openAI.openAIBaseUrl != DEFAULT_SETTINGS.APIConnections.openAI.openAIBaseUrl) {
        const models = await fetchOpenAIBaseModels(plugin);
        plugin.settings.APIConnections.openAI.openAIBaseModels = models || [];
      }
      if (plugin.settings.APIConnections.openRouter.APIKey !== "") {
        const models = await fetchOpenRouterModels(plugin);
        plugin.settings.APIConnections.openRouter.openRouterModels = models || [];
      }
      if (modelDropdown) {
        createModelDropdown(modelDropdown);
      }
      new import_obsidian9.Notice("Models reloaded.");
    })
  ).addDropdown((dropdown) => {
    modelDropdown = dropdown;
    createModelDropdown(dropdown);
  });
  new import_obsidian9.Setting(settingsContainer).setName("Max Tokens").setDesc("The maximum number of tokens, or words, that the model is allowed to generate in its output. Some models require a minimum number of tokens to be set. The default value is empty.").addText(
    (text) => text.setPlaceholder("4096").setValue(plugin.settings.general.max_tokens).onChange(async (value) => {
      plugin.settings.general.max_tokens = value;
      await plugin.saveSettings();
    })
  );
  new import_obsidian9.Setting(settingsContainer).setName("Temperature").setDesc("Temperature controls how random the generated output is. Lower values make the text more predictable, while higher values make it more creative and unpredictable.").addText(
    (text) => text.setPlaceholder("1.00").setValue(plugin.settings.general.temperature).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (!isNaN(floatValue)) {
        if (!isNaN(floatValue)) {
          if (floatValue < 0) {
            plugin.settings.general.temperature = "0.00";
          } else if (floatValue > 2) {
            plugin.settings.general.temperature = "2.00";
          } else {
            plugin.settings.general.temperature = floatValue.toFixed(2);
          }
        } else {
          plugin.settings.general.temperature = DEFAULT_SETTINGS.general.temperature;
        }
      } else {
        plugin.settings.general.temperature = DEFAULT_SETTINGS.general.temperature;
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian9.Setting(settingsContainer).setName("Enable Reference Current Note").setDesc("Enable chatbot to reference current active note during conversation.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.general.enableReferenceCurrentNote).onChange((value) => {
      plugin.settings.general.enableReferenceCurrentNote = value;
      plugin.saveSettings();
      const referenceCurrentNoteElement = document.getElementById("referenceCurrentNote");
      if (referenceCurrentNoteElement) {
        if (value) {
          referenceCurrentNoteElement.style.display = "block";
        } else {
          referenceCurrentNoteElement.style.display = "none";
        }
      }
    })
  );
}

// src/components/settings/AppearanceSettings.ts
var import_obsidian10 = require("obsidian");
function addAppearanceSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Appearance" });
  const initialState = plugin.settings.toggleAppearanceSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian10.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian10.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleAppearanceSettings = false;
    } else {
      (0, import_obsidian10.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleAppearanceSettings = true;
    }
    await plugin.saveSettings();
  });
  settingsContainer.createEl("h6", { text: "Chat View" });
  new import_obsidian10.Setting(settingsContainer).setName("Enable Header").setDesc("Display chatbot name and model name in header.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.appearance.enableHeader).onChange((value) => {
      plugin.settings.appearance.enableHeader = value;
      const referenceCurrentNoteElement = document.querySelector("#referenceCurrentNote");
      if (value === true) {
        const header = document.querySelector("#header");
        if (header) {
          header.style.display = "block";
          referenceCurrentNoteElement.style.margin = "-0.5rem 0 0.5rem 0";
        }
      } else {
        const header = document.querySelector("#header");
        const messageContainer = document.querySelector("#messageContainer");
        if (header) {
          header.style.display = "none";
          messageContainer.style.maxHeight = "calc(100% - 60px)";
          referenceCurrentNoteElement.style.margin = "0.5rem 0 0.5rem 0";
        }
      }
      plugin.saveSettings();
    })
  );
  new import_obsidian10.Setting(settingsContainer).setName("User Name").setDesc("Create a username.").addText(
    (text) => text.setPlaceholder("Enter user name").setValue(plugin.settings.appearance.userName || DEFAULT_SETTINGS.appearance.userName).onChange(async (value) => {
      plugin.settings.appearance.userName = value ? value : DEFAULT_SETTINGS.appearance.userName;
      text.inputEl.maxLength = 30;
      await plugin.saveSettings();
      const userNames = document.querySelectorAll(".userName");
      userNames.forEach((userName) => {
        userName.textContent = plugin.settings.appearance.userName;
      });
    })
  );
  let colorPicker1;
  const defaultChatbotContainerBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatbotContainerBackgroundColor).trim();
  let colorPicker2;
  const defaultMessageContainerBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.messageContainerBackgroundColor).trim();
  let colorPicker3;
  const defaultUserMessageFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.userMessageFontColor).trim();
  let colorPicker4;
  const defaultUserMessageBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.userMessageBackgroundColor).trim();
  let colorPicker5;
  const defaultBotMessageFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageFontColor).trim();
  let colorPicker6;
  const defaultBotMessageBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim();
  let colorPicker7;
  const defaultChatBoxFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatBoxFontColor).trim();
  let colorPicker8;
  const defaultChatBoxBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor).trim();
  new import_obsidian10.Setting(settingsContainer).setName("Chatbot Container Background Color").setDesc("Modify the background color of the chatbot container.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultChatbotContainerBackgroundColor);
      colorPicker1.setValue(defaultValue);
      const chatbotContainer = document.querySelector(".chatbotContainer");
      const messageContainer = document.querySelector("#messageContainer");
      if (chatbotContainer) {
        chatbotContainer.style.backgroundColor = defaultValue;
        messageContainer.style.backgroundColor = colorPicker2.getValue();
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker1 = color;
    let defaultValue = plugin.settings.appearance.chatbotContainerBackgroundColor;
    if (plugin.settings.appearance.chatbotContainerBackgroundColor == "--background-secondary") {
      defaultValue = colorToHex(defaultChatbotContainerBackgroundColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.chatbotContainerBackgroundColor = hexValue;
      const chatbotContainer = document.querySelector(".chatbotContainer");
      const messageContainer = document.querySelector("#messageContainer");
      if (chatbotContainer) {
        chatbotContainer.style.backgroundColor = hexValue;
        messageContainer.style.backgroundColor = colorPicker2.getValue();
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Message Container Background Color").setDesc("Modify the background color of the message container.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultMessageContainerBackgroundColor);
      colorPicker2.setValue(defaultValue);
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        messageContainer.style.backgroundColor = defaultValue;
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker2 = color;
    let defaultValue = plugin.settings.appearance.messageContainerBackgroundColor;
    if (plugin.settings.appearance.messageContainerBackgroundColor == "--background-secondary") {
      defaultValue = colorToHex(defaultMessageContainerBackgroundColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.messageContainerBackgroundColor = hexValue;
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        messageContainer.style.backgroundColor = hexValue;
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("User Message Font Color").setDesc("Modify the font color of the user message.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultUserMessageFontColor);
      colorPicker3.setValue(defaultValue);
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const userMessages = messageContainer.querySelectorAll(".userMessage");
        userMessages.forEach((userMessage) => {
          const element = userMessage;
          element.style.color = defaultValue;
        });
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker3 = color;
    let defaultValue = plugin.settings.appearance.userMessageFontColor;
    if (plugin.settings.appearance.userMessageFontColor == "--text-normal") {
      defaultValue = colorToHex(defaultUserMessageFontColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.userMessageFontColor = hexValue;
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const userMessages = messageContainer.querySelectorAll(".userMessage");
        userMessages.forEach((userMessage) => {
          const element = userMessage;
          element.style.color = hexValue;
        });
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("User Message Background Color").setDesc("Modify the background color of the user message.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultUserMessageBackgroundColor);
      colorPicker4.setValue(defaultValue);
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const userMessages = messageContainer.querySelectorAll(".userMessage");
        userMessages.forEach((userMessage) => {
          const element = userMessage;
          element.style.backgroundColor = defaultValue;
        });
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker4 = color;
    let defaultValue = plugin.settings.appearance.userMessageBackgroundColor;
    if (plugin.settings.appearance.userMessageBackgroundColor == "--background-primary") {
      defaultValue = colorToHex(defaultUserMessageBackgroundColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.userMessageBackgroundColor = hexValue;
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const userMessages = messageContainer.querySelectorAll(".userMessage");
        userMessages.forEach((userMessage) => {
          const element = userMessage;
          element.style.backgroundColor = hexValue;
        });
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Bot Message Font Color").setDesc("Modify the font color of the bot message.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultBotMessageFontColor);
      colorPicker5.setValue(defaultValue);
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const botMessages = messageContainer.querySelectorAll(".botMessage");
        botMessages.forEach((botMessage) => {
          const element = botMessage;
          element.style.color = defaultValue;
        });
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker5 = color;
    let defaultValue = plugin.settings.appearance.botMessageFontColor;
    if (plugin.settings.appearance.botMessageFontColor == "--text-normal") {
      defaultValue = colorToHex(defaultBotMessageFontColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.botMessageFontColor = hexValue;
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const botMessages = messageContainer.querySelectorAll(".botMessage");
        botMessages.forEach((botMessage) => {
          const element = botMessage;
          element.style.color = hexValue;
        });
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Bot Message Background Color").setDesc("Modify the background color of the bot message.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultBotMessageBackgroundColor);
      colorPicker6.setValue(defaultValue);
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const botMessages = messageContainer.querySelectorAll(".botMessage");
        botMessages.forEach((botMessage) => {
          const element = botMessage;
          element.style.backgroundColor = defaultValue;
        });
        await plugin.saveSettings();
      }
    })
  ).addColorPicker((color) => {
    colorPicker6 = color;
    let defaultValue = plugin.settings.appearance.botMessageBackgroundColor;
    if (plugin.settings.appearance.botMessageBackgroundColor == "--background-secondary") {
      defaultValue = colorToHex(defaultBotMessageBackgroundColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.botMessageBackgroundColor = hexValue;
      const messageContainer = document.querySelector("#messageContainer");
      if (messageContainer) {
        const botMessages = messageContainer.querySelectorAll(".botMessage");
        botMessages.forEach((botMessage) => {
          const element = botMessage;
          element.style.backgroundColor = hexValue;
        });
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Chatbox Font Color").setDesc("Modify the font color of the chatbox.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultChatBoxFontColor);
      colorPicker7.setValue(defaultValue);
      const textarea = document.querySelector(".chatbox textarea");
      if (textarea) {
        textarea.style.color = defaultValue;
        const style = document.createElement("style");
        style.textContent = `
                    .chatbox textarea::placeholder {
                        color: ${defaultValue} !important;
                    }
                `;
        textarea.appendChild(style);
        await plugin.saveSettings();
      }
    })
  ).addColorPicker(async (color) => {
    colorPicker7 = color;
    let defaultValue = plugin.settings.appearance.chatBoxFontColor;
    if (defaultValue == "--text-normal") {
      defaultValue = colorToHex(defaultChatBoxFontColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.chatBoxFontColor = hexValue;
      const textarea = document.querySelector(".chatbox textarea");
      if (textarea) {
        textarea.style.color = hexValue;
        const style = document.createElement("style");
        style.textContent = `
                        .chatbox textarea::placeholder {
                            color: ${hexValue} !important;
                        }
                    `;
        textarea.appendChild(style);
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Chatbox Background Color").setDesc("Modify the background color of the chatbox.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultChatBoxBackgroundColor);
      colorPicker8.setValue(defaultValue);
      const chatbox = document.querySelector(".chatbox");
      if (chatbox) {
        const element = chatbox;
        element.style.backgroundColor = defaultValue;
        element.style.borderColor = defaultValue;
        await plugin.saveSettings();
      }
    })
  ).addColorPicker(async (color) => {
    colorPicker8 = color;
    let defaultValue = plugin.settings.appearance.chatBoxBackgroundColor;
    if (defaultValue == "--interactive-accent") {
      defaultValue = colorToHex(defaultChatBoxBackgroundColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.chatBoxBackgroundColor = hexValue;
      const chatbox = document.querySelector(".chatbox");
      if (chatbox) {
        const element = chatbox;
        element.style.backgroundColor = hexValue;
        element.style.borderColor = hexValue;
      }
      const textarea = document.querySelector(".chatbox textarea");
      if (textarea) {
        const element = textarea;
        element.style.backgroundColor = hexValue;
        element.style.borderColor = hexValue;
      }
      const submitButton = document.querySelector(".chatbox .submit-button");
      if (submitButton) {
        const element = submitButton;
        element.style.backgroundColor = hexValue;
        element.style.borderColor = hexValue;
      }
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("Enable Scrollbar").setDesc("Display scrollbar in chatbox.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.appearance.enableScrollBar).onChange((value) => {
      plugin.settings.appearance.enableScrollBar = value;
      if (value === true) {
        const chatbox = document.querySelector(".chatbox textarea");
        if (chatbox) {
          chatbox.style.overflowY = "auto";
        }
      } else {
        const chatbox = document.querySelector(".chatbox textarea");
        if (chatbox) {
          chatbox.style.overflowY = "hidden";
        }
      }
      plugin.saveSettings();
    })
  );
  settingsContainer.createEl("h6", { text: "Generate View" });
  let colorPicker9;
  let colorPicker10;
  const defaultBMOGenerateFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.bmoGenerateFontColor).trim();
  new import_obsidian10.Setting(settingsContainer).setName("BMO Generate Background Color").setDesc("Modify the background color of BMO Generate.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      colorPicker9.setValue(DEFAULT_SETTINGS.appearance.bmoGenerateBackgroundColor);
      const containers = document.querySelectorAll(".bmoCodeBlockContainer");
      containers.forEach((container) => {
        const element = container;
        element.style.backgroundColor = DEFAULT_SETTINGS.appearance.bmoGenerateBackgroundColor;
      });
      await plugin.saveSettings();
    })
  ).addColorPicker(async (color) => {
    colorPicker9 = color;
    const defaultValue = plugin.settings.appearance.bmoGenerateBackgroundColor;
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.bmoGenerateBackgroundColor = hexValue;
      const containers = document.querySelectorAll(".bmoCodeBlockContainer");
      containers.forEach((container) => {
        const element = container;
        element.style.backgroundColor = hexValue;
      });
      await plugin.saveSettings();
    });
  });
  new import_obsidian10.Setting(settingsContainer).setName("BMO Generate Font Color").setDesc("Modify the font color of BMO Generate.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      const defaultValue = colorToHex(defaultBMOGenerateFontColor);
      colorPicker10.setValue(defaultValue);
      const bmoCodeBlockContents = document.querySelectorAll(".bmoCodeBlockContent");
      bmoCodeBlockContents.forEach((content) => {
        const element = content;
        element.style.color = defaultValue;
      });
      await plugin.saveSettings();
    })
  ).addColorPicker(async (color) => {
    colorPicker10 = color;
    let defaultValue = plugin.settings.appearance.bmoGenerateFontColor;
    if (defaultValue == "--text-normal") {
      defaultValue = colorToHex(defaultBMOGenerateFontColor);
    }
    color.setValue(defaultValue).onChange(async (value) => {
      const hexValue = colorToHex(value);
      plugin.settings.appearance.bmoGenerateFontColor = hexValue;
      const bmoCodeBlockContents2 = document.querySelectorAll(".bmoCodeBlockContent");
      bmoCodeBlockContents2.forEach((content) => {
        const element = content;
        element.style.color = hexValue;
      });
      await plugin.saveSettings();
    });
    const bmoCodeBlockContents = document.querySelectorAll(".bmoCodeBlockContent");
    bmoCodeBlockContents.forEach((content) => {
      const element = content;
      element.style.color = defaultValue;
    });
  });
}

// src/components/settings/ChatHistorySettings.ts
var import_obsidian11 = require("obsidian");
function addChatHistorySettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Chat History" });
  const initialState = plugin.settings.toggleChatHistorySettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian11.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian11.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleChatHistorySettings = false;
    } else {
      (0, import_obsidian11.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleChatHistorySettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian11.Setting(settingsContainer).setName("Chat History Folder Path").setDesc("Save your chat history in a specified folder.").addText(
    (text) => text.setPlaceholder("BMO/History").setValue(plugin.settings.chatHistory.chatHistoryPath || DEFAULT_SETTINGS.chatHistory.chatHistoryPath).onChange(async (value) => {
      plugin.settings.chatHistory.chatHistoryPath = value ? value : DEFAULT_SETTINGS.chatHistory.chatHistoryPath;
      if (value) {
        let folderPath = plugin.settings.chatHistory.chatHistoryPath.trim() || DEFAULT_SETTINGS.chatHistory.chatHistoryPath;
        while (folderPath.endsWith("/")) {
          folderPath = folderPath.substring(0, folderPath.length - 1);
          plugin.settings.chatHistory.chatHistoryPath = folderPath;
        }
        const folder = plugin.app.vault.getAbstractFileByPath(folderPath);
        if (folder && folder instanceof import_obsidian11.TFolder) {
          text.inputEl.style.borderColor = "";
        } else {
          text.inputEl.style.borderColor = "red";
        }
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian11.Setting(settingsContainer).setName("Template File Path").setDesc("Insert your template file path.").addText(
    (text) => text.setPlaceholder("templates/bmo.md").setValue(plugin.settings.chatHistory.templateFilePath || DEFAULT_SETTINGS.chatHistory.templateFilePath).onChange(async (value) => {
      plugin.settings.chatHistory.templateFilePath = value ? value : DEFAULT_SETTINGS.chatHistory.templateFilePath;
      if (value) {
        if (!plugin.settings.chatHistory.templateFilePath.endsWith(".md")) {
          plugin.settings.chatHistory.templateFilePath += ".md";
        }
        await plugin.saveSettings();
        const allFiles = plugin.app.vault.getFiles();
        const fileExists = allFiles.some((file) => file.path.toLowerCase() === plugin.settings.chatHistory.templateFilePath.toLowerCase());
        if (fileExists) {
          text.inputEl.style.borderColor = "";
        } else {
          text.inputEl.style.borderColor = "red";
        }
      } else {
        text.inputEl.style.borderColor = "";
        plugin.settings.chatHistory.templateFilePath = DEFAULT_SETTINGS.chatHistory.templateFilePath;
      }
    })
  );
  new import_obsidian11.Setting(settingsContainer).setName("Enable Rename Note Title").setDesc("Enable model to rename the note title when saving chat history.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.chatHistory.allowRenameNoteTitle).onChange((value) => {
      plugin.settings.chatHistory.allowRenameNoteTitle = value;
      plugin.saveSettings();
    })
  );
}

// src/components/settings/OllamaSettings.ts
var import_obsidian12 = require("obsidian");

// src/utils/DescriptionLink.ts
function addDescriptionLink(text, link, extraWords, innerText) {
  const frag = new DocumentFragment();
  const desc = document.createElement("span");
  desc.innerText = text + " ";
  frag.appendChild(desc);
  const anchor = document.createElement("a");
  anchor.href = link;
  anchor.target = "_blank";
  anchor.rel = "noopener noreferrer";
  anchor.innerText = innerText;
  frag.appendChild(anchor);
  const extra = document.createElement("span");
  extra.innerText = " " + extraWords;
  frag.appendChild(extra);
  return frag;
}

// src/components/settings/OllamaSettings.ts
function addOllamaSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Ollama Connection" });
  const initialState = plugin.settings.toggleOllamaSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian12.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian12.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleOllamaSettings = false;
    } else {
      (0, import_obsidian12.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleOllamaSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian12.Setting(settingsContainer).setName("OLLAMA REST API URL").setDesc(addDescriptionLink("Enter your REST API URL. Update ", "https://ollama.com/", "to version >=0.1.42 to avoid CORS restriction.", "Ollama")).addText(
    (text) => text.setPlaceholder("http://localhost:11434").setValue(plugin.settings.OllamaConnection.RESTAPIURL || DEFAULT_SETTINGS.OllamaConnection.RESTAPIURL).onChange(async (value) => {
      plugin.settings.OllamaConnection.ollamaModels = [];
      plugin.settings.OllamaConnection.RESTAPIURL = value ? value : DEFAULT_SETTINGS.OllamaConnection.RESTAPIURL;
      if (plugin.settings.OllamaConnection.RESTAPIURL === "") {
        plugin.settings.OllamaConnection.ollamaModels = [];
      } else {
        const models = await fetchOllamaModels(plugin);
        models == null ? void 0 : models.forEach((model) => {
          if (!plugin.settings.OllamaConnection.ollamaModels.includes(model)) {
            plugin.settings.OllamaConnection.ollamaModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(settingsContainer).setName("Enable Stream").setDesc("Enable Ollama models to stream response.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.OllamaConnection.enableStream).onChange((value) => {
      plugin.settings.OllamaConnection.enableStream = value;
      plugin.saveSettings();
    })
  );
  const advancedToggleSettingContainer = settingsContainer.createDiv({ cls: "toggleSettingContainer" });
  advancedToggleSettingContainer.createEl("h2", { text: "Advanced Settings" });
  const advancedInitialState = plugin.settings.toggleAdvancedSettings;
  const advancedChevronIcon = advancedToggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian12.setIcon)(advancedChevronIcon, advancedInitialState ? "chevron-down" : "chevron-right");
  const advancedSettingsContainer = settingsContainer.createDiv({ cls: "settingsContainer" });
  advancedSettingsContainer.style.display = advancedInitialState ? "block" : "none";
  advancedToggleSettingContainer.addEventListener("click", async () => {
    const isOpen = advancedSettingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian12.setIcon)(advancedChevronIcon, "chevron-right");
      advancedSettingsContainer.style.display = "none";
      plugin.settings.toggleAdvancedSettings = false;
    } else {
      (0, import_obsidian12.setIcon)(advancedChevronIcon, "chevron-down");
      advancedSettingsContainer.style.display = "block";
      plugin.settings.toggleAdvancedSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian12.Setting(advancedSettingsContainer).setName("mirostat").setDesc("Enable Mirostat sampling for controlling perplexity. (default: 0, 0 = disabled, 1 = Mirostat, 2 = Mirostat 2.0)").addText(
    (text) => text.setPlaceholder("0").setValue(plugin.settings.OllamaConnection.ollamaParameters.mirostat || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("mirostat_eta").setDesc("Influences how quickly the algorithm responds to feedback from the generated text. A lower learning rate will result in slower adjustments, while a higher learning rate will make the algorithm more responsive. (Default: 0.1)").addText(
    (text) => text.setPlaceholder("0.1").setValue(plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_eta).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (!isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta = floatValue.toFixed(2).toString();
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_eta;
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("mirostat_tau").setDesc("Controls the balance between coherence and diversity of the output. A lower value will result in more focused and coherent text. (Default: 5.0)").addText(
    (text) => text.setPlaceholder("5.00").setValue(plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_tau).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (!isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau = floatValue.toFixed(2).toString();
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_tau;
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("num_ctx").setDesc("Sets the size of the context window used to generate the next token. (Default: 2048)").addText(
    (text) => text.setPlaceholder("2048").setValue(plugin.settings.OllamaConnection.ollamaParameters.num_ctx || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_ctx).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.num_ctx = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_ctx;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_ctx = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("num_gqa").setDesc("The number of GQA groups in the transformer layer. Required for some models, for example it is 8 for llama2:70b.").addText(
    (text) => text.setPlaceholder("0").setValue(plugin.settings.OllamaConnection.ollamaParameters.num_gqa || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_gqa).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.num_gqa = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_gqa;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_gqa = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("num_thread").setDesc("Sets the number of threads to use during computation. By default, Ollama will detect this for optimal performance. It is recommended to set this value to the number of physical CPU cores your system has (as opposed to the logical number of cores).").addText(
    (text) => text.setPlaceholder("0").setValue(plugin.settings.OllamaConnection.ollamaParameters.num_thread || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_thread).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.num_thread = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_thread;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_thread = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("repeat_last_n").setDesc("Sets how far back for the model to look back to prevent repetition. (Default: 64, 0 = disabled, -1 = num_ctx)").addText(
    (text) => text.setPlaceholder("64").setValue(plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_last_n).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_last_n;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("repeat_penalty").setDesc("Sets how strongly to penalize repetitions. A higher value (e.g., 1.5) will penalize repetitions more strongly, while a lower value (e.g., 0.9) will be more lenient. (Default: 1.1)").addText(
    (text) => text.setPlaceholder("1.1").setValue(plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_penalty).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_penalty;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty = floatValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("seed").setDesc("Sets the random number seed to use for generation. Setting this to a specific number will make the model generate the same text for the same prompt.").addText(
    (text) => text.setPlaceholder("0").setValue(plugin.settings.OllamaConnection.ollamaParameters.seed || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.seed).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.seed = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.seed;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.seed = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("stop").setDesc("Sets the stop sequences to use. When this pattern is encountered, the LLM will stop generating text and return. Multiple stop patterns may be set by specifying them as a comma-separated list in the input field.").addText(
    (text) => text.setPlaceholder("stop, \\n, user:").setValue(plugin.settings.OllamaConnection.ollamaParameters.stop && Array.isArray(plugin.settings.OllamaConnection.ollamaParameters.stop) ? plugin.settings.OllamaConnection.ollamaParameters.stop.join(", ") : DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.stop.join(", ")).onChange(async (value) => {
      const stopsArray = value ? value.split(",").map((s) => s.trim()) : [...DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.stop];
      plugin.settings.OllamaConnection.ollamaParameters.stop = stopsArray;
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("tfs_z").setDesc("Tail free sampling is used to reduce the impact of less probable tokens from the output. A higher value (e.g., 2.0) will reduce the impact more, while a value of 1.0 disables this setting. (default: 1)").addText(
    (text) => text.setPlaceholder("1.0").setValue(plugin.settings.OllamaConnection.ollamaParameters.tfs_z || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.tfs_z).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.tfs_z = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.tfs_z;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.tfs_z = floatValue.toFixed(2).toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("top_k").setDesc("Reduces the probability of generating nonsense. A higher value (e.g. 100) will give more diverse answers, while a lower value (e.g. 10) will be more conservative. (Default: 40)").addText(
    (text) => text.setPlaceholder("40").setValue(plugin.settings.OllamaConnection.ollamaParameters.top_k || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_k).onChange(async (value) => {
      const intValue = parseInt(value, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.top_k = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_k;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.top_k = intValue.toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("top_p").setDesc("Works together with top-k. A higher value (e.g., 0.95) will lead to more diverse text, while a lower value (e.g., 0.5) will generate more focused and conservative text. (Default: 0.9)").addText(
    (text) => text.setPlaceholder("1.0").setValue(plugin.settings.OllamaConnection.ollamaParameters.top_p || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_p).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.top_p = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_p;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.top_p = floatValue.toFixed(2).toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("min_p").setDesc("Alternative to the top_p, and aims to ensure a balance of quality and variety. The parameter p represents the minimum probability for a token to be considered, relative to the probability of the most likely token. (Default: 0.0)").addText(
    (text) => text.setPlaceholder("0.0").setValue(plugin.settings.OllamaConnection.ollamaParameters.min_p || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.min_p).onChange(async (value) => {
      const floatValue = parseFloat(value);
      if (isNaN(floatValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.min_p = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.min_p;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.min_p = floatValue.toFixed(2).toString();
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian12.Setting(advancedSettingsContainer).setName("keep_alive").setDesc("If set to a positive duration (e.g. 20m, 1hr or 30), the model will stay loaded for the provided duration in seconds. If set to a negative duration (e.g. -1), the model will stay loaded indefinitely. If set to 0, the model will be unloaded immediately once finished. If not set, the model will stay loaded for 5 minutes by default.").addText(
    (text) => text.setPlaceholder("30s").setValue(plugin.settings.OllamaConnection.ollamaParameters.keep_alive || DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.keep_alive).onChange(async (value) => {
      const match = value.match(/^(-?\d+)(m|hr|h)?$/);
      if (match) {
        const num = parseInt(match[1]);
        const unit = match[2];
        let seconds;
        if (unit === "m") {
          seconds = num * 60;
        } else if (unit === "hr" || unit === "h") {
          seconds = num * 3600;
        } else {
          seconds = num;
        }
        plugin.settings.OllamaConnection.ollamaParameters.keep_alive = seconds.toString();
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.keep_alive = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.keep_alive;
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
}

// src/components/settings/ConnectionSettings.ts
var import_obsidian18 = require("obsidian");

// src/components/settings/APIConnections/OpenAIConnections.ts
var import_obsidian13 = require("obsidian");
function addOpenAIConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "OpenAI" });
  const initialState = plugin.settings.toggleOpenAISettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian13.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian13.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleOpenAISettings = false;
    } else {
      (0, import_obsidian13.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleOpenAISettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian13.Setting(settingsContainer).setName("OpenAI API Key").setDesc("Insert OpenAI API Key.").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.APIConnections.openAI.APIKey ? `${plugin.settings.APIConnections.openAI.APIKey.slice(0, 7)}-...${plugin.settings.APIConnections.openAI.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.APIConnections.openAI.openAIBaseModels = [];
      plugin.settings.APIConnections.openAI.APIKey = value;
      if (plugin.settings.APIConnections.openAI.APIKey === "") {
        plugin.settings.APIConnections.openAI.openAIBaseModels = [];
      } else {
        const models = await fetchOpenAIBaseModels(plugin);
        models.forEach((model) => {
          if (!plugin.settings.APIConnections.openAI.openAIBaseModels.includes(model)) {
            plugin.settings.APIConnections.openAI.openAIBaseModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian13.Setting(settingsContainer).setName("OpenAI-Based URL").setDesc("Enter your custom OpenAI-Based URL.").addButton(
    (button) => button.setButtonText("Restore Default").setIcon("rotate-cw").setClass("clickable-icon").onClick(async () => {
      plugin.settings.APIConnections.openAI.openAIBaseModels = [];
      plugin.settings.APIConnections.openAI.openAIBaseUrl = DEFAULT_SETTINGS.APIConnections.openAI.openAIBaseUrl;
      await plugin.saveSettings();
      SettingTab15.display();
    })
  ).addText(
    (text) => text.setPlaceholder("https://api.openai.com/v1").setValue(plugin.settings.APIConnections.openAI.openAIBaseUrl || DEFAULT_SETTINGS.APIConnections.openAI.openAIBaseUrl).onChange(async (value) => {
      plugin.settings.APIConnections.openAI.openAIBaseUrl = value ? value : DEFAULT_SETTINGS.APIConnections.openAI.openAIBaseUrl;
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian13.Setting(settingsContainer).setName("Enable Stream").setDesc("Enable stream for OpenAI-Based models.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.APIConnections.openAI.enableStream).onChange(async (value) => {
      plugin.settings.APIConnections.openAI.enableStream = value;
      await plugin.saveSettings();
    })
  );
}

// src/components/settings/APIConnections/MistralConnections.ts
var import_obsidian14 = require("obsidian");
function addMistralConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Mistral AI" });
  const initialState = plugin.settings.toggleMistralSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian14.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian14.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleMistralSettings = false;
    } else {
      (0, import_obsidian14.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleMistralSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian14.Setting(settingsContainer).setName("Mistral API Key").setDesc("Insert Mistral API Key.").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.APIConnections.mistral.APIKey ? `${plugin.settings.APIConnections.mistral.APIKey.slice(0, 6)}-...${plugin.settings.APIConnections.mistral.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.APIConnections.mistral.mistralModels = [];
      plugin.settings.APIConnections.mistral.APIKey = value;
      if (plugin.settings.APIConnections.mistral.APIKey === "") {
        plugin.settings.APIConnections.mistral.mistralModels = [];
      } else {
        const models = await fetchMistralModels(plugin);
        models.forEach((model) => {
          if (!plugin.settings.APIConnections.mistral.mistralModels.includes(model)) {
            plugin.settings.APIConnections.mistral.mistralModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian14.Setting(settingsContainer).setName("Enable Stream").setDesc("Enable stream for Mistral models.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.APIConnections.mistral.enableStream).onChange((value) => {
      plugin.settings.APIConnections.mistral.enableStream = value;
      plugin.saveSettings();
    })
  );
}

// src/components/settings/APIConnections/GoogleGeminiConnections.ts
var import_obsidian15 = require("obsidian");
function addGoogleGeminiConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Google Gemini" });
  const initialState = plugin.settings.toggleGoogleGeminiSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian15.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian15.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleGoogleGeminiSettings = false;
    } else {
      (0, import_obsidian15.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleGoogleGeminiSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian15.Setting(settingsContainer).setName("Google Gemini API Key").setDesc("Insert Google Gemini API Key.").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.APIConnections.googleGemini.APIKey ? `${plugin.settings.APIConnections.googleGemini.APIKey.slice(0, 6)}-...${plugin.settings.APIConnections.googleGemini.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.APIConnections.googleGemini.geminiModels = [];
      plugin.settings.APIConnections.googleGemini.APIKey = value;
      if (plugin.settings.APIConnections.googleGemini.APIKey === "") {
        plugin.settings.APIConnections.googleGemini.geminiModels = [];
      } else {
        const models = await fetchGoogleGeminiModels(plugin);
        models.forEach((model) => {
          if (!plugin.settings.APIConnections.googleGemini.geminiModels.includes(model)) {
            plugin.settings.APIConnections.googleGemini.geminiModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian15.Setting(settingsContainer).setName("Enable Stream").setDesc("Enable Google Gemini models to stream response.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.APIConnections.googleGemini.enableStream).onChange((value) => {
      plugin.settings.APIConnections.googleGemini.enableStream = value;
      plugin.saveSettings();
    })
  );
}

// src/components/settings/APIConnections/AnthropicConnections.ts
var import_obsidian16 = require("obsidian");
function addAnthropicConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Anthropic" });
  const initialState = plugin.settings.toggleAnthropicSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian16.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian16.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleAnthropicSettings = false;
    } else {
      (0, import_obsidian16.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleAnthropicSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian16.Setting(settingsContainer).setName("Anthropic API Key").setDesc("Insert Anthropic API Key. Warning: Anthropic models cannot be aborted. Please use with caution.").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.APIConnections.anthropic.APIKey ? `${plugin.settings.APIConnections.anthropic.APIKey.slice(0, 6)}-...${plugin.settings.APIConnections.anthropic.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.APIConnections.anthropic.anthropicModels = [];
      plugin.settings.APIConnections.anthropic.APIKey = value;
      if (plugin.settings.APIConnections.anthropic.APIKey === "") {
        plugin.settings.APIConnections.anthropic.anthropicModels = [];
      } else {
        const models = ANTHROPIC_MODELS;
        models.forEach((model) => {
          if (!plugin.settings.APIConnections.anthropic.anthropicModels.includes(model)) {
            plugin.settings.APIConnections.anthropic.anthropicModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
}

// src/components/settings/APIConnections/OpenRouterConnections.ts
var import_obsidian17 = require("obsidian");
function addOpenRouterConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "OpenRouter" });
  const initialState = plugin.settings.toggleOpenRouterSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian17.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian17.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleOpenRouterSettings = false;
    } else {
      (0, import_obsidian17.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleOpenRouterSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian17.Setting(settingsContainer).setName("OpenRouter API Key").setDesc("Insert OpenRouter API Key.").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.APIConnections.openRouter.APIKey ? `${plugin.settings.APIConnections.openRouter.APIKey.slice(0, 6)}-...${plugin.settings.APIConnections.openRouter.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.APIConnections.openAI.openAIBaseModels = [];
      plugin.settings.APIConnections.openRouter.APIKey = value;
      if (plugin.settings.APIConnections.openRouter.APIKey === "") {
        plugin.settings.APIConnections.openRouter.openRouterModels = [];
      } else {
        const models = await fetchOpenRouterModels(plugin);
        models.forEach((model) => {
          if (!plugin.settings.APIConnections.openRouter.openRouterModels.includes(model)) {
            plugin.settings.APIConnections.openRouter.openRouterModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian17.Setting(settingsContainer).setName("Enable Stream").setDesc("Enable stream for OpenRouter models.").addToggle(
    (toggle) => toggle.setValue(plugin.settings.APIConnections.openRouter.enableStream).onChange((value) => {
      plugin.settings.APIConnections.openRouter.enableStream = value;
      plugin.saveSettings();
    })
  );
}

// src/components/settings/ConnectionSettings.ts
function addAPIConnectionSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "API Connections" });
  const initialState = plugin.settings.toggleAPIConnectionSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian18.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian18.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleAPIConnectionSettings = false;
    } else {
      (0, import_obsidian18.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleAPIConnectionSettings = true;
    }
    await plugin.saveSettings();
  });
  addAnthropicConnectionSettings(settingsContainer, plugin, SettingTab15);
  addGoogleGeminiConnectionSettings(settingsContainer, plugin, SettingTab15);
  addMistralConnectionSettings(settingsContainer, plugin, SettingTab15);
  addOpenAIConnectionSettings(settingsContainer, plugin, SettingTab15);
  addOpenRouterConnectionSettings(settingsContainer, plugin, SettingTab15);
}

// src/components/settings/ProfileSettings.ts
var import_obsidian19 = require("obsidian");
function addProfileSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Profiles" });
  const initialState = plugin.settings.toggleProfileSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian19.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian19.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleProfileSettings = false;
    } else {
      (0, import_obsidian19.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleProfileSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian19.Setting(settingsContainer).setName("Profile").setDesc("Select a profile.").addDropdown((dropdown) => {
    if (plugin.settings.profiles.profileFolderPath !== "") {
      const files = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.profiles.profileFolderPath));
      files.sort((a, b) => a.name.localeCompare(b.name));
      const dataFolderPath = "./.obsidian/plugins/bmo-chatbot/data/";
      if (!plugin.app.vault.getAbstractFileByPath(dataFolderPath)) {
        plugin.app.vault.adapter.mkdir(dataFolderPath);
      }
      files.forEach((file) => {
        if (file instanceof import_obsidian19.TFile) {
          const fileName = file.basename;
          const newFileName = `messageHistory_${fileName}.json`;
          const newFilePath = `${dataFolderPath}${newFileName}`;
          plugin.app.vault.create(newFilePath, "").catch((err) => {
            if (err.message === "File already exists.") {
            } else {
              throw err;
            }
          });
          dropdown.addOption(file.name, fileName);
        }
      });
    }
    dropdown.setValue(plugin.settings.profiles.profile || DEFAULT_SETTINGS.profiles.profile).onChange(async (value) => {
      plugin.settings.profiles.profile = value ? value : DEFAULT_SETTINGS.profiles.profile;
      const profileFilePath = plugin.settings.profiles.profileFolderPath + "/" + plugin.settings.profiles.profile;
      const currentProfile = plugin.app.vault.getAbstractFileByPath(profileFilePath);
      plugin.activateView();
      await updateSettingsFromFrontMatter(plugin, currentProfile);
      await plugin.saveSettings();
      SettingTab15.display();
    });
  });
  new import_obsidian19.Setting(settingsContainer).setName("Profile Folder Path").setDesc("Select a profile from a specified folder.").addText(
    (text) => text.setPlaceholder("BMO/Profiles").setValue(plugin.settings.profiles.profileFolderPath || DEFAULT_SETTINGS.profiles.profileFolderPath).onChange(async (value) => {
      plugin.settings.profiles.profileFolderPath = value ? value : DEFAULT_SETTINGS.profiles.profileFolderPath;
      if (value) {
        let folderPath = plugin.settings.profiles.profileFolderPath.trim() || DEFAULT_SETTINGS.profiles.profileFolderPath;
        while (folderPath.endsWith("/")) {
          folderPath = folderPath.substring(0, folderPath.length - 1);
          plugin.settings.profiles.profileFolderPath = folderPath;
        }
        const folder = plugin.app.vault.getAbstractFileByPath(folderPath);
        if (folder && folder instanceof import_obsidian19.TFolder) {
          text.inputEl.style.borderColor = "";
        } else {
          text.inputEl.style.borderColor = "red";
        }
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
}

// src/components/settings/RESTAPIURLSettings.ts
var import_obsidian20 = require("obsidian");
function addRESTAPIURLSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "REST API Connection" });
  const initialState = plugin.settings.toggleRESTAPIURLSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian20.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian20.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleRESTAPIURLSettings = false;
    } else {
      (0, import_obsidian20.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleRESTAPIURLSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian20.Setting(settingsContainer).setName("API Key").setDesc("Insert API Key (Optional).").addText(
    (text) => text.setPlaceholder("insert-api-key").setValue(plugin.settings.RESTAPIURLConnection.APIKey ? `${plugin.settings.RESTAPIURLConnection.APIKey.slice(0, 6)}-...${plugin.settings.RESTAPIURLConnection.APIKey.slice(-4)}` : "").onChange(async (value) => {
      plugin.settings.RESTAPIURLConnection.RESTAPIURLModels = [];
      plugin.settings.RESTAPIURLConnection.APIKey = value;
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
  new import_obsidian20.Setting(settingsContainer).setName("REST API URL").setDesc(addDescriptionLink("ENTER YOUR REST API URL.", "https://github.com/longy2k/obsidian-bmo-chatbot/wiki/How-to-setup-with-LM-Studio", "", "[Instructions]")).addText(
    (text) => text.setPlaceholder("http://localhost:1234/v1").setValue(plugin.settings.RESTAPIURLConnection.RESTAPIURL || DEFAULT_SETTINGS.RESTAPIURLConnection.RESTAPIURL).onChange(async (value) => {
      plugin.settings.RESTAPIURLConnection.RESTAPIURLModels = [];
      plugin.settings.RESTAPIURLConnection.RESTAPIURL = value ? value : DEFAULT_SETTINGS.RESTAPIURLConnection.RESTAPIURL;
      if (plugin.settings.RESTAPIURLConnection.RESTAPIURL === "") {
        plugin.settings.RESTAPIURLConnection.RESTAPIURLModels = [];
      } else {
        const models = await fetchRESTAPIURLModels(plugin);
        models.forEach((model) => {
          if (!plugin.settings.RESTAPIURLConnection.RESTAPIURLModels.includes(model)) {
            plugin.settings.RESTAPIURLConnection.RESTAPIURLModels.push(model);
          }
        });
      }
    }).inputEl.addEventListener("focusout", async () => {
      await plugin.saveSettings();
      SettingTab15.display();
    })
  );
  new import_obsidian20.Setting(settingsContainer).setName("Enable Stream").setDesc(addDescriptionLink("Enable REST API models to stream response.", "", "", "")).addToggle(
    (toggle) => toggle.setValue(plugin.settings.RESTAPIURLConnection.enableStream).onChange((value) => {
      plugin.settings.RESTAPIURLConnection.enableStream = value;
      plugin.saveSettings();
    })
  );
}

// src/components/settings/EditorSettings.ts
var import_obsidian21 = require("obsidian");
async function addEditorSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Editor" });
  const initialState = plugin.settings.toggleEditorSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian21.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian21.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.toggleEditorSettings = false;
    } else {
      (0, import_obsidian21.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.toggleEditorSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian21.Setting(settingsContainer).setName("Editor System Role").setDesc("System role for BMO Generate and 'Prompt Select Generate' command.").addTextArea(
    (text) => text.setPlaceholder("You are a helpful assistant.").setValue(plugin.settings.editor.systen_role !== void 0 ? plugin.settings.editor.systen_role : DEFAULT_SETTINGS.editor.systen_role).onChange(async (value) => {
      plugin.settings.editor.systen_role = value !== void 0 ? value : DEFAULT_SETTINGS.editor.systen_role;
      await plugin.saveSettings();
    })
  );
}

// src/components/settings/PromptSettings.ts
var import_obsidian22 = require("obsidian");
function addPromptSettings(containerEl, plugin, SettingTab15) {
  const toggleSettingContainer = containerEl.createDiv({ cls: "toggleSettingContainer" });
  toggleSettingContainer.createEl("h2", { text: "Prompts" });
  const initialState = plugin.settings.togglePromptSettings;
  const chevronIcon = toggleSettingContainer.createEl("span", { cls: "chevron-icon" });
  (0, import_obsidian22.setIcon)(chevronIcon, initialState ? "chevron-down" : "chevron-right");
  const settingsContainer = containerEl.createDiv({ cls: "settingsContainer" });
  settingsContainer.style.display = initialState ? "block" : "none";
  toggleSettingContainer.addEventListener("click", async () => {
    const isOpen = settingsContainer.style.display !== "none";
    if (isOpen) {
      (0, import_obsidian22.setIcon)(chevronIcon, "chevron-right");
      settingsContainer.style.display = "none";
      plugin.settings.togglePromptSettings = false;
    } else {
      (0, import_obsidian22.setIcon)(chevronIcon, "chevron-down");
      settingsContainer.style.display = "block";
      plugin.settings.togglePromptSettings = true;
    }
    await plugin.saveSettings();
  });
  new import_obsidian22.Setting(settingsContainer).setName("Prompt").setDesc("Select a prompt to provide additional context to the system role.").addDropdown((dropdown) => {
    dropdown.addOption("", "--EMPTY--");
    if (plugin.settings.prompts.promptFolderPath !== "") {
      const files = plugin.app.vault.getFiles().filter((file) => file.path.startsWith(plugin.settings.prompts.promptFolderPath));
      files.sort((a, b) => a.name.localeCompare(b.name));
      files.forEach((file) => {
        if (file instanceof import_obsidian22.TFile) {
          const fileName = file.basename;
          dropdown.addOption(file.name, fileName);
        }
      });
    }
    dropdown.setValue("");
    dropdown.setValue(plugin.settings.prompts.prompt || DEFAULT_SETTINGS.prompts.prompt).onChange(async (value) => {
      plugin.settings.prompts.prompt = value ? value : DEFAULT_SETTINGS.prompts.prompt;
      await plugin.saveSettings();
    });
  });
  new import_obsidian22.Setting(settingsContainer).setName("Prompt Folder Path").setDesc("Select a prompt from a specified folder.").addText(
    (text) => text.setPlaceholder("BMO/Prompts").setValue(plugin.settings.prompts.promptFolderPath || DEFAULT_SETTINGS.prompts.promptFolderPath).onChange(async (value) => {
      plugin.settings.prompts.promptFolderPath = value ? value : DEFAULT_SETTINGS.prompts.promptFolderPath;
      if (value) {
        let folderPath = plugin.settings.prompts.promptFolderPath.trim() || DEFAULT_SETTINGS.prompts.promptFolderPath;
        while (folderPath.endsWith("/")) {
          folderPath = folderPath.substring(0, folderPath.length - 1);
          plugin.settings.prompts.promptFolderPath = folderPath;
        }
        const folder = plugin.app.vault.getAbstractFileByPath(folderPath);
        if (folder && folder instanceof import_obsidian22.TFolder) {
          text.inputEl.style.borderColor = "";
        } else {
          text.inputEl.style.borderColor = "red";
        }
      }
      await plugin.saveSettings();
    }).inputEl.addEventListener("focusout", async () => {
      SettingTab15.display();
    })
  );
}

// src/settings.ts
var BMOSettingTab = class extends import_obsidian23.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  async display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h1", { text: "BMO Chatbot Settings" });
    const linkContainer = containerEl.createEl("div");
    const links = [
      { text: "Changelog", href: "https://github.com/longy2k/obsidian-bmo-chatbot/releases" },
      { text: "Wiki", href: "https://github.com/longy2k/obsidian-bmo-chatbot/wiki" },
      { text: "Report a Bug", href: "https://github.com/longy2k/obsidian-bmo-chatbot/issues" },
      { text: "Support Me", href: "https://ko-fi.com/longy2k" }
    ];
    links.forEach((link, index2) => {
      if (index2 > 0) {
        linkContainer.createEl("span", {
          text: " | ",
          attr: { style: "font-size: 0.8rem; margin-right: 5px;" }
        });
      }
      const linkEl = linkContainer.createEl("a", {
        text: link.text,
        href: link.href,
        attr: { style: "font-size: 0.8rem;" }
      });
      if (index2 < links.length - 1) {
        linkEl.style.marginRight = "5px";
      }
    });
    containerEl.createEl("p", { text: "Type `/help` in chat for commands." });
    addHorizontalRule(this.containerEl);
    addProfileSettings(this.containerEl, this.plugin, this);
    addGeneralSettings(this.containerEl, this.plugin, this);
    addPromptSettings(this.containerEl, this.plugin, this);
    addAppearanceSettings(this.containerEl, this.plugin, this);
    addChatHistorySettings(this.containerEl, this.plugin, this);
    addEditorSettings(this.containerEl, this.plugin, this);
    addHorizontalRule(this.containerEl);
    addOllamaSettings(this.containerEl, this.plugin, this);
    addRESTAPIURLSettings(this.containerEl, this.plugin, this);
    addAPIConnectionSettings(this.containerEl, this.plugin, this);
    addHorizontalRule(this.containerEl);
    const resetButton = containerEl.createEl("a", {
      text: "Reset Settings",
      href: "#",
      attr: {
        style: "display: block; text-align: center; margin: 1rem 0; font-size: 0.7rem; color: #ff6666;"
      }
    });
    resetButton.addEventListener("click", async (event) => {
      event.preventDefault();
      const confirmReset = confirm("Are you sure you want to reset all settings to default?");
      if (confirmReset) {
        const profilePathFile = this.plugin.settings.profiles.profileFolderPath + "/" + this.plugin.settings.profiles.profile;
        const profilePath = this.plugin.app.vault.getAbstractFileByPath(profilePathFile);
        const defaultProfilePathFile = DEFAULT_SETTINGS.profiles.profileFolderPath + "/" + DEFAULT_SETTINGS.profiles.profile;
        const defaultProfilePath = this.plugin.app.vault.getAbstractFileByPath(defaultProfilePathFile);
        if (profilePath) {
          if (profilePath.path === defaultProfilePath.path) {
            this.plugin.settings = DEFAULT_SETTINGS;
            await this.plugin.saveSettings();
            await this.plugin.app.plugins.disablePlugin(this.plugin.manifest.id);
            await this.plugin.app.plugins.enablePlugin(this.plugin.manifest.id);
          } else {
            const filenameMessageHistory = "./.obsidian/plugins/bmo-chatbot/data/messageHistory_" + defaultProfilePath.name.replace(".md", ".json");
            this.app.vault.adapter.remove(filenameMessageHistory);
            this.plugin.app.vault.delete(profilePath);
            this.plugin.settings.profiles.profile = DEFAULT_SETTINGS.profiles.profile;
            await updateSettingsFromFrontMatter(this.plugin, defaultProfilePath);
            await this.plugin.saveSettings();
          }
        }
        requestAnimationFrame(() => {
          const refreshTab = this.plugin.app.setting.openTabById("bmo-chatbot");
          if (refreshTab) {
            refreshTab.display();
          } else {
            new BMOSettingTab(this.app, this.plugin).display();
          }
        });
      }
    });
  }
};
function addHorizontalRule(containerEl) {
  const separator = document.createElement("hr");
  separator.style.margin = "1rem 0";
  containerEl.appendChild(separator);
}

// src/components/editor/EditorCommands.ts
var import_obsidian25 = require("obsidian");

// src/components/FetchModelEditor.ts
var import_obsidian24 = require("obsidian");
async function fetchOllamaResponseEditor(settings, prompt, model, temperature, maxTokens, signal) {
  const ollamaRESTAPIURL = settings.OllamaConnection.RESTAPIURL;
  if (!ollamaRESTAPIURL) {
    return;
  }
  const imageMatch = prompt.match(/!?\[\[(.*?)\]\]/g);
  const imageLink = imageMatch ? imageMatch.map((item) => item.startsWith("!") ? item.slice(3, -2) : item.slice(2, -2)).filter((link) => /\.(jpg|jpeg|png|gif|webp|bmp|tiff|tif|svg)$/i.test(link)) : [];
  const imagesVaultPath = [];
  if (imageLink.length > 0) {
    imageLink.forEach((link) => {
      const imageFile = this.app.metadataCache.getFirstLinkpathDest(link, "");
      const image = imageFile ? this.app.vault.adapter.getFullPath(imageFile.path) : null;
      if (image) {
        imagesVaultPath.push(image);
      }
    });
  }
  try {
    const response = await fetch(ollamaRESTAPIURL + "/api/generate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: model || settings.general.model,
        system: settings.editor.systen_role,
        prompt,
        images: imagesVaultPath,
        stream: false,
        keep_alive: parseInt(settings.OllamaConnection.ollamaParameters.keep_alive),
        options: {
          temperature: temperature ? parseFloat(temperature) : parseFloat(settings.general.temperature),
          num_predict: maxTokens ? parseInt(maxTokens) : parseInt(settings.general.max_tokens)
        }
      }),
      signal
    });
    const data = await response.json();
    const message = data.response.trim();
    return message;
  } catch (error) {
    if (error.name === "AbortError") {
      console.log("Request aborted");
    } else {
      console.error("Ollama request:", error);
      throw error;
    }
  }
}
async function fetchRESTAPIURLDataEditor(settings, prompt, model, temperature, maxTokens, signal) {
  try {
    const response = await fetch(settings.RESTAPIURLConnection.RESTAPIURL + "/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.RESTAPIURLConnection.APIKey}`
      },
      body: JSON.stringify({
        model: model || settings.general.model,
        messages: [
          { role: "system", content: settings.editor.systen_role || "You are a helpful assistant." },
          { role: "user", content: prompt }
        ],
        max_tokens: parseInt(maxTokens || settings.general.max_tokens || "-1"),
        temperature: parseFloat(temperature || settings.general.temperature)
      }),
      signal
    });
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const data = await response.json();
    const message = data.choices[0].message.content.trim();
    return message;
  } catch (error) {
    console.error("Error making API request:", error);
    throw error;
  }
}
async function fetchAnthropicResponseEditor(settings, prompt, model, temperature, maxTokens, signal) {
  try {
    const response = await (0, import_obsidian24.requestUrl)({
      url: "https://api.anthropic.com/v1/messages",
      method: "POST",
      headers: {
        "anthropic-version": "2023-06-01",
        "content-type": "application/json",
        "x-api-key": settings.APIConnections.anthropic.APIKey
      },
      body: JSON.stringify({
        model: model || settings.general.model,
        system: settings.editor.systen_role,
        messages: [
          { role: "user", content: prompt }
        ],
        max_tokens: parseInt(maxTokens || settings.general.max_tokens) || 4096,
        temperature: parseFloat(temperature || settings.general.temperature)
      })
    });
    const message = response.json.content[0].text.trim();
    return message;
  } catch (error) {
    console.error(error);
  }
}
async function fetchGoogleGeminiDataEditor(settings, prompt, model, temperature, maxTokens, signal) {
  try {
    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${settings.APIConnections.googleGemini.APIKey}`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: [
          {
            parts: [
              { text: settings.editor.systen_role + prompt }
            ]
          }
        ],
        model: model || settings.general.model,
        generationConfig: {
          temperature: parseFloat(temperature || settings.general.temperature),
          maxOutputTokens: parseInt(maxTokens || settings.general.max_tokens) || 4096
        }
      }),
      signal
    });
    const data = await response.json();
    const message = data.candidates[0].content.parts[0].text.trim();
    return message;
  } catch (error) {
    console.error(error);
  }
}
async function fetchMistralDataEditor(settings, prompt, model, temperature, maxTokens, signal) {
  try {
    const response = await fetch("https://api.mistral.ai/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.mistral.APIKey}`
      },
      body: JSON.stringify({
        model: model || settings.general.model,
        messages: [
          { role: "system", content: settings.editor.systen_role },
          { role: "user", content: prompt }
        ],
        max_tokens: parseInt(maxTokens || settings.general.max_tokens),
        temperature: parseFloat(temperature || settings.general.temperature)
      }),
      signal
    });
    const data = await response.json();
    const message = data.choices[0].message.content.trim();
    return message;
  } catch (error) {
    console.error(error);
  }
}
async function fetchOpenAIBaseAPIResponseEditor(settings, prompt, model, temperature, maxTokens, signal) {
  const response = await fetch(`${settings.APIConnections.openAI.openAIBaseUrl}/chat/completions`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${settings.APIConnections.openAI.APIKey}`
    },
    body: JSON.stringify({
      model: model || settings.general.model,
      max_tokens: parseInt(maxTokens || settings.general.max_tokens),
      temperature: parseFloat(temperature || settings.general.temperature),
      stream: false,
      messages: [
        { role: "system", content: settings.editor.systen_role },
        { role: "user", content: prompt }
      ]
    }),
    signal
  });
  const data = await response.json();
  const message = data.choices[0].message.content || "";
  return message;
}
async function fetchOpenRouterEditor(settings, prompt, model, temperature, maxTokens, signal) {
  try {
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${settings.APIConnections.openRouter.APIKey}`
      },
      body: JSON.stringify({
        model: model || settings.general.model,
        messages: [
          { role: "system", content: settings.editor.systen_role },
          { role: "user", content: prompt }
        ],
        max_tokens: parseInt(maxTokens || settings.general.max_tokens),
        temperature: parseFloat(temperature || settings.general.temperature)
      }),
      signal
    });
    const data = await response.json();
    const message = data.choices[0].message.content.trim();
    return message;
  } catch (error) {
    console.error("Error making API request:", error);
    throw error;
  }
}

// src/components/editor/EditorCommands.ts
async function renameTitleCommand(plugin, settings) {
  var _a2, _b, _c;
  let uniqueNameFound = false;
  let modelRenameTitle;
  let folderName = ((_c = (_b = plugin.app.vault.getAbstractFileByPath(((_a2 = plugin.app.workspace.getActiveFile()) == null ? void 0 : _a2.path) || "")) == null ? void 0 : _b.parent) == null ? void 0 : _c.path) || "";
  const fileExtension = ".md";
  const allFiles = plugin.app.vault.getFiles();
  const activeFile = plugin.app.workspace.getActiveFile();
  let fileContent = "";
  try {
    new import_obsidian25.Notice("Generating title...");
    if (activeFile) {
      fileContent = await plugin.app.vault.read(activeFile);
    }
    if (folderName && !folderName.endsWith("/")) {
      folderName += "/";
    }
    const fileNameExists = (name) => {
      return allFiles.some((file) => file.path === folderName + name + fileExtension);
    };
    while (!uniqueNameFound) {
      modelRenameTitle = await fetchModelRenameTitle(settings, fileContent);
      if (!fileNameExists(modelRenameTitle)) {
        uniqueNameFound = true;
      }
    }
    const fileName = folderName + modelRenameTitle + fileExtension;
    if (activeFile) {
      plugin.app.vault.rename(activeFile, fileName);
    }
    new import_obsidian25.Notice("Renamed note title.");
  } catch (error) {
    console.error(error);
  }
}
async function promptSelectGenerateCommand(plugin, settings) {
  var _a2, _b;
  const view = plugin.app.workspace.getActiveViewOfType(import_obsidian25.MarkdownView);
  const select = view == null ? void 0 : view.editor.getSelection();
  if (view && select && select.trim() !== "") {
    const generatingNotice = new import_obsidian25.Notice("Generating...", 0);
    if (settings.OllamaConnection.RESTAPIURL && settings.OllamaConnection.ollamaModels.includes(settings.general.model)) {
      try {
        const response = await fetchOllamaResponseEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response != null ? response : "ERROR");
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + (response != null ? response : "ERROR").length
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (settings.RESTAPIURLConnection.RESTAPIURL && settings.RESTAPIURLConnection.RESTAPIURLModels.includes(settings.general.model)) {
      try {
        const response = await fetchRESTAPIURLDataEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response);
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + (response == null ? void 0 : response.length)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (ANTHROPIC_MODELS.includes(settings.general.model)) {
      try {
        const response = await fetchAnthropicResponseEditor(settings, select);
        view.editor.replaceSelection(response);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (settings.APIConnections.googleGemini.geminiModels.includes(settings.general.model)) {
      try {
        const response = await fetchGoogleGeminiDataEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response);
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + (response == null ? void 0 : response.length)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (settings.APIConnections.mistral.mistralModels.includes(settings.general.model)) {
      try {
        const response = await fetchMistralDataEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response);
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + (response == null ? void 0 : response.length)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (OPENAI_MODELS.includes(settings.general.model)) {
      try {
        const response = await fetchOpenAIBaseAPIResponseEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response || "");
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + ((_a2 = response == null ? void 0 : response.length) != null ? _a2 : 0)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (settings.APIConnections.openAI.openAIBaseUrl != DEFAULT_SETTINGS.APIConnections.openAI.openAIBaseUrl && settings.APIConnections.openAI.openAIBaseModels.includes(settings.general.model)) {
      try {
        const response = await fetchOpenAIBaseAPIResponseEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response || "");
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + ((_b = response == null ? void 0 : response.length) != null ? _b : 0)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    } else if (settings.APIConnections.openRouter.openRouterModels.includes(settings.general.model)) {
      try {
        const response = await fetchOpenRouterEditor(settings, select);
        const cursorStart = view.editor.getCursor("from");
        view.editor.replaceSelection(response);
        const cursorEnd = {
          line: cursorStart.line,
          ch: cursorStart.ch + (response == null ? void 0 : response.length)
        };
        view.editor.setSelection(cursorStart, cursorEnd);
      } catch (error) {
        new import_obsidian25.Notice("Error occurred while fetching completion: " + error.message);
        console.log(error.message);
      }
    }
    generatingNotice.hide();
    new import_obsidian25.Notice("Generation complete.");
  } else {
    new import_obsidian25.Notice("No text selected.");
  }
}

// src/components/editor/BMOCodeBlockProcessor.ts
var import_obsidian26 = require("obsidian");
function bmoCodeBlockProcessor(plugin, settings) {
  let previousPrompt = "";
  let abortController2 = null;
  return plugin.registerMarkdownCodeBlockProcessor("bmo", async (source, el, ctx) => {
    if (abortController2) {
      abortController2.abort();
    }
    abortController2 = new AbortController();
    const file = plugin.app.workspace.getActiveFile();
    if (file && settings.general.model !== "") {
      const fileContent = await plugin.app.vault.read(file);
      const codeBlockRegex = /```bmo\n([\s\S]*?)```/g;
      let match;
      let updatedFileContent = fileContent;
      while ((match = codeBlockRegex.exec(fileContent)) !== null) {
        const originalCodeBlock = match[0];
        const codeBlockContent = match[1];
        if (!codeBlockContent.includes("MODEL ")) {
          const updatedSource = "MODEL " + settings.general.model + "\n" + codeBlockContent;
          updatedFileContent = updatedFileContent.replace(originalCodeBlock, "```bmo\n" + updatedSource + "```");
        }
      }
      if (updatedFileContent !== fileContent) {
        await plugin.app.vault.modify(file, updatedFileContent);
      }
    }
    let modelName = "No Model";
    let temperature = "1.0";
    let maxTokens = "";
    let contentToRender = "";
    const modelMatch = source.match(/MODEL\s+(.+)/);
    if (modelMatch) {
      modelName = modelMatch[1].trim();
    }
    const temperatureMatch = source.match(/TEMPERATURE\s+(.+)/);
    if (temperatureMatch) {
      temperature = temperatureMatch[1].trim();
    }
    const maxTokensMatch = source.match(/MAX_TOKENS\s+(.+)/);
    if (maxTokensMatch) {
      maxTokens = maxTokensMatch[1].trim();
    }
    const promptMatch = source.match(/^(?:MODEL.*\n|TEMPERATURE.*\n|MAX_TOKENS.*\n)*([\s\S]*?)(?=\s*<response>|$)/);
    let prompt = "";
    if (promptMatch) {
      prompt = promptMatch[1].trim();
    }
    if (prompt !== previousPrompt) {
      previousPrompt = prompt;
    }
    const responseMatch = source.match(/<response>([\s\S]*?)<\/response>/);
    if (responseMatch) {
      contentToRender = responseMatch[1].trim();
    }
    const container = el.createEl("div");
    container.style.position = "relative";
    const bmoCodeBlockContainer = container.createEl("div", { cls: "bmoCodeBlockContainer" });
    bmoCodeBlockContainer.dataset.callout = "chat";
    bmoCodeBlockContainer.style.backgroundColor = settings.appearance.bmoGenerateBackgroundColor;
    bmoCodeBlockContainer.style.border = "1px solid #0a0f0a";
    bmoCodeBlockContainer.style.borderRadius = "5px";
    bmoCodeBlockContainer.style.padding = "10px";
    bmoCodeBlockContainer.style.marginBottom = "10px";
    const bmoCodeBlockContent = bmoCodeBlockContainer.createEl("div", { cls: "bmoCodeBlockContent" });
    bmoCodeBlockContent.style.color = settings.appearance.bmoGenerateFontColor;
    bmoCodeBlockContent.style.whiteSpace = "normal";
    const bottomContainer = container.createEl("div");
    bottomContainer.style.display = "flex";
    bottomContainer.style.justifyContent = "space-between";
    bottomContainer.style.alignItems = "center";
    bottomContainer.style.marginTop = "10px";
    const modelText = bottomContainer.createEl("span");
    modelText.textContent = modelName;
    modelText.style.fontSize = "0.9em";
    modelText.style.color = "#666";
    modelText.style.fontWeight = "bold";
    const loaderCircle = bottomContainer.createEl("div");
    loaderCircle.classList.add("loader-circle");
    loaderCircle.style.width = "20px";
    loaderCircle.style.height = "20px";
    loaderCircle.style.border = "2px solid #666";
    loaderCircle.style.borderTopColor = "transparent";
    loaderCircle.style.borderRadius = "50%";
    loaderCircle.style.animation = "spin 1s linear infinite";
    loaderCircle.style.display = "none";
    const bmoGenerationNotice = bottomContainer.createEl("span");
    bmoGenerationNotice.textContent = "Done!";
    bmoGenerationNotice.style.fontSize = "0.9em";
    bmoGenerationNotice.style.color = "#4caf50";
    bmoGenerationNotice.style.display = "none";
    const button = bottomContainer.createEl("button");
    button.textContent = "Generate";
    button.onclick = async () => {
      if (button.textContent === "Cancel") {
        if (abortController2) {
          abortController2.abort();
          abortController2 = null;
        }
        button.textContent = "Generate";
        loaderCircle.style.display = "none";
        bmoGenerationNotice.textContent = "Aborted.";
        bmoGenerationNotice.style.color = "#ff6666";
        bmoGenerationNotice.style.display = "inline";
        setTimeout(() => {
          bmoGenerationNotice.style.display = "none";
        }, 2e3);
        return;
      }
      button.textContent = "Cancel";
      if (!abortController2) {
        abortController2 = new AbortController();
      }
      const signal = abortController2.signal;
      loaderCircle.style.display = "block";
      let modelResponse = "";
      try {
        if (settings.OllamaConnection.ollamaModels.includes(modelName)) {
          modelResponse = await fetchOllamaResponseEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.RESTAPIURLConnection.RESTAPIURLModels.includes(modelName)) {
          modelResponse = await fetchRESTAPIURLDataEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.APIConnections.anthropic.anthropicModels.includes(modelName)) {
          button.disabled = true;
          modelResponse = await fetchAnthropicResponseEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.APIConnections.googleGemini.geminiModels.includes(modelName)) {
          modelResponse = await fetchGoogleGeminiDataEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.APIConnections.mistral.mistralModels.includes(modelName)) {
          modelResponse = await fetchMistralDataEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.APIConnections.openAI.openAIBaseModels.includes(modelName)) {
          modelResponse = await fetchOpenAIBaseAPIResponseEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else if (settings.APIConnections.openRouter.openRouterModels.includes(modelName)) {
          modelResponse = await fetchOpenRouterEditor(settings, prompt, modelName, temperature, maxTokens, signal) || contentToRender;
        } else {
          bmoGenerationNotice.textContent = "Model not found.";
          bmoGenerationNotice.style.color = "#ff6666";
          bmoGenerationNotice.style.display = "inline";
          setTimeout(() => {
            bmoGenerationNotice.style.display = "none";
            button.textContent = "Generate";
          }, 2e3);
        }
        if (modelResponse !== "") {
          if (!modelResponse.includes("\\`")) {
            modelResponse = modelResponse.replace(/`/g, "\\`");
          }
          const responseTagsExist = source.includes("<response>") && source.includes("</response>");
          let updatedSource = source;
          if (responseTagsExist) {
            updatedSource = source.replace(
              /<response>[\s\S]*?<\/response>/,
              `<response>
${modelResponse}
</response>`
            );
          } else {
            updatedSource = `${source}

<response>
${modelResponse}
</response>`;
          }
          const newResponseMatch = updatedSource.match(/<response>([\s\S]*?)<\/response>/);
          if (newResponseMatch) {
            contentToRender = newResponseMatch[1].trim();
          }
          const file2 = plugin.app.workspace.getActiveFile();
          if (file2) {
            const fileContent = await plugin.app.vault.read(file2);
            const updatedFileContent = fileContent.replace(source, updatedSource);
            await plugin.app.vault.modify(file2, updatedFileContent);
          }
        }
        loaderCircle.style.display = "none";
      } catch (error) {
        if (error.name === "AbortError") {
          console.log("BMO Generate Aborted.");
          button.textContent = "Generate";
          loaderCircle.style.display = "none";
          bmoGenerationNotice.textContent = "Aborted.";
          bmoGenerationNotice.style.color = "#ff6666";
          bmoGenerationNotice.style.display = "inline";
          setTimeout(() => {
            bmoGenerationNotice.style.display = "none";
          }, 2e3);
          return;
        } else {
          console.error("Generation error:", error);
          bmoGenerationNotice.textContent = "Error occurred.";
          bmoGenerationNotice.style.color = "#ff6666";
          bmoGenerationNotice.style.display = "inline";
          setTimeout(() => {
            bmoGenerationNotice.style.display = "none";
          }, 2e3);
        }
      }
    };
    if (source.includes("<response>") && source.includes("</response>")) {
      await import_obsidian26.MarkdownRenderer.render(plugin.app, contentToRender, bmoCodeBlockContent, "/", plugin);
    } else {
      await import_obsidian26.MarkdownRenderer.render(plugin.app, prompt, bmoCodeBlockContent, "/", plugin);
    }
  });
}

// src/main.ts
var DEFAULT_SETTINGS = {
  profiles: {
    profile: "BMO.md",
    profileFolderPath: "BMO/Profiles",
    lastLoadedChatHistoryPath: null,
    lastLoadedChatHistory: []
  },
  general: {
    model: "",
    system_role: "You are a helpful assistant.",
    max_tokens: "",
    temperature: "1.00",
    enableReferenceCurrentNote: false
  },
  appearance: {
    userName: "YOU",
    chatbotName: "BMO",
    chatbotContainerBackgroundColor: "--background-secondary",
    messageContainerBackgroundColor: "--background-secondary",
    userMessageFontColor: "--text-normal",
    userMessageBackgroundColor: "--background-primary",
    botMessageFontColor: "--text-normal",
    botMessageBackgroundColor: "--background-secondary",
    chatBoxFontColor: "--text-normal",
    chatBoxBackgroundColor: "--interactive-accent",
    enableHeader: true,
    enableScrollBar: false,
    bmoGenerateBackgroundColor: "#0c0a12",
    bmoGenerateFontColor: "--text-normal"
  },
  prompts: {
    prompt: "",
    promptFolderPath: "BMO/Prompts"
  },
  editor: {
    systen_role: "You are a helpful assistant."
  },
  chatHistory: {
    chatHistoryPath: "BMO/History",
    templateFilePath: "",
    allowRenameNoteTitle: false
  },
  OllamaConnection: {
    RESTAPIURL: "http://localhost:11434",
    enableStream: true,
    ollamaParameters: {
      mirostat: "0",
      mirostat_eta: "0.10",
      mirostat_tau: "5.00",
      num_ctx: "2048",
      num_gqa: "",
      num_thread: "",
      repeat_last_n: "64",
      repeat_penalty: "1.10",
      seed: "",
      stop: [],
      tfs_z: "1.00",
      top_k: "40",
      top_p: "0.90",
      min_p: "0.0",
      keep_alive: ""
    },
    ollamaModels: []
  },
  RESTAPIURLConnection: {
    APIKey: "",
    RESTAPIURL: "",
    enableStream: false,
    RESTAPIURLModels: []
  },
  APIConnections: {
    anthropic: {
      APIKey: "",
      anthropicModels: []
    },
    googleGemini: {
      APIKey: "",
      enableStream: false,
      geminiModels: []
    },
    mistral: {
      APIKey: "",
      enableStream: false,
      mistralModels: []
    },
    openAI: {
      APIKey: "",
      openAIBaseUrl: "https://api.openai.com/v1",
      enableStream: true,
      openAIBaseModels: []
    },
    openRouter: {
      APIKey: "",
      enableStream: false,
      openRouterModels: []
    }
  },
  toggleGeneralSettings: true,
  toggleAppearanceSettings: false,
  togglePromptSettings: false,
  toggleEditorSettings: false,
  toggleChatHistorySettings: false,
  toggleProfileSettings: false,
  toggleAPIConnectionSettings: true,
  toggleOpenAISettings: false,
  toggleMistralSettings: false,
  toggleGoogleGeminiSettings: false,
  toggleAnthropicSettings: false,
  toggleRESTAPIURLSettings: true,
  toggleOpenRouterSettings: false,
  toggleOllamaSettings: true,
  toggleAdvancedSettings: false
};
var checkActiveFile = null;
var BMOGPT15 = class extends import_obsidian27.Plugin {
  async onload() {
    await this.loadSettings();
    const folderPath = this.settings.profiles.profileFolderPath || DEFAULT_SETTINGS.profiles.profileFolderPath;
    const defaultFilePath = `${folderPath}/${DEFAULT_SETTINGS.profiles.profile}`;
    const defaultProfile = this.app.vault.getAbstractFileByPath(defaultFilePath);
    if (!await this.app.vault.adapter.exists(folderPath)) {
      await this.app.vault.createFolder(folderPath);
    }
    if (!await this.app.vault.adapter.exists(defaultFilePath)) {
      this.app.vault.create(defaultFilePath, "");
      console.log("Default profile created.");
    }
    this.registerEvent(
      this.app.vault.on("create", async (file) => {
        if (file instanceof import_obsidian27.TFile && file.path.startsWith(folderPath)) {
          const fileContent = await this.app.vault.read(file);
          if (fileContent.trim() === "") {
            defaultFrontMatter(this, file);
          }
          const profileFiles = this.app.vault.getFiles().filter((file2) => file2.path.startsWith(this.settings.profiles.profileFolderPath));
          profileFiles.sort((a, b) => a.name.localeCompare(b.name));
          if (this.settings.profiles.lastLoadedChatHistory.length === 0) {
            profileFiles.forEach((profile, index2) => {
              if (!this.settings.profiles.lastLoadedChatHistory[index2]) {
                this.settings.profiles.lastLoadedChatHistory[index2] = null;
              }
            });
          } else {
            if (this.settings.profiles.lastLoadedChatHistory.length !== profileFiles.length) {
              const profileIndex = profileFiles.findIndex((profileFiles2) => profileFiles2.basename === file.basename);
              this.settings.profiles.lastLoadedChatHistory.splice(profileIndex, 0, null);
            }
          }
          await this.saveSettings();
        }
      })
    );
    this.registerEvent(
      this.app.vault.on(
        "delete",
        async (file) => {
          const profileFiles = this.app.vault.getFiles().filter((file2) => file2.path.startsWith(this.settings.profiles.profileFolderPath));
          profileFiles.sort((a, b) => a.name.localeCompare(b.name));
          if (file instanceof import_obsidian27.TFile && file.path.startsWith(this.settings.chatHistory.chatHistoryPath)) {
            const currentProfile = this.settings.profiles.profile.replace(/\.[^/.]+$/, "");
            const profileIndex = profileFiles.findIndex((file2) => file2.basename === currentProfile);
            const currentIndex = this.settings.profiles.lastLoadedChatHistory.indexOf(file.path);
            if (this.settings.profiles.lastLoadedChatHistory[currentIndex] === file.path) {
              this.settings.profiles.lastLoadedChatHistory[currentIndex] = null;
            }
            if (profileIndex === currentIndex) {
              this.settings.profiles.lastLoadedChatHistoryPath = null;
            }
          }
          if (file instanceof import_obsidian27.TFile && file.path.startsWith(folderPath)) {
            const filenameMessageHistory = "./.obsidian/plugins/bmo-chatbot/data/messageHistory_" + file.name.replace(".md", ".json");
            this.app.vault.adapter.remove(filenameMessageHistory);
            const profileIndex = profileFiles.findIndex((profileFile) => profileFile.name > file.name);
            this.settings.profiles.lastLoadedChatHistory.splice(profileIndex, 1);
            if (file.path === defaultFilePath) {
              this.settings = DEFAULT_SETTINGS;
              this.app.vault.create(defaultFilePath, "");
              await updateSettingsFromFrontMatter(this, defaultProfile);
            } else {
              if (this.settings.profiles.profile === file.name) {
                this.settings.profiles.profile = DEFAULT_SETTINGS.profiles.profile;
                const profileFiles2 = this.app.vault.getFiles().filter((file2) => file2.path.startsWith(this.settings.profiles.profileFolderPath));
                profileFiles2.sort((a, b) => a.name.localeCompare(b.name));
                const currentProfile = this.settings.profiles.profile.replace(/\.[^/.]+$/, "");
                const profileIndex2 = profileFiles2.findIndex((file2) => file2.basename === currentProfile);
                if (this.settings.profiles.lastLoadedChatHistoryPath !== null) {
                  this.settings.profiles.lastLoadedChatHistoryPath = this.settings.profiles.lastLoadedChatHistory[profileIndex2];
                }
                const fileContent = (await this.app.vault.read(defaultProfile)).replace(/^---\s*[\s\S]*?---/, "").trim();
                this.settings.general.system_role = fileContent;
                await updateSettingsFromFrontMatter(this, defaultProfile);
              }
            }
          }
          await this.saveSettings();
        }
      )
    );
    this.registerEvent(
      this.app.vault.on(
        "modify",
        async (file) => {
          const currentProfilePath = `${folderPath}/${this.settings.profiles.profile}`;
          if (file.path === currentProfilePath) {
            await updateSettingsFromFrontMatter(this, file);
            const fileContent = (await this.app.vault.read(file)).replace(/^---\s*[\s\S]*?---/, "").trim();
            this.settings.general.system_role = fileContent;
            await this.saveSettings();
          }
        }
      )
    );
    this.registerEvent(
      this.app.vault.on("rename", async (file, oldPath) => {
        try {
          const currentProfilePath = `${folderPath}/${this.settings.profiles.profile}`;
          if (oldPath === currentProfilePath) {
            this.settings.profiles.profile = file.name;
            this.settings.appearance.chatbotName = file.basename;
            await this.saveSettings();
          }
          if (file instanceof import_obsidian27.TFile && file.path.startsWith(folderPath)) {
            const filenameMessageHistoryPath = "./.obsidian/plugins/bmo-chatbot/data/";
            const oldProfileMessageHistory = "messageHistory_" + oldPath.replace(folderPath + "/", "").replace(".md", ".json");
            await this.app.vault.adapter.rename(filenameMessageHistoryPath + oldProfileMessageHistory, filenameMessageHistoryPath + "messageHistory_" + file.name.replace(".md", ".json")).catch((error) => {
              console.error("Error handling rename event:", error);
            });
            await this.app.vault.adapter.remove(filenameMessageHistoryPath + oldProfileMessageHistory);
          }
        } catch (error) {
          if (error.message.includes("ENOENT: no such file or directory, unlink")) {
          } else {
            console.error("Error handling rename event:", error);
          }
        }
        const profileFiles = this.app.vault.getFiles().filter((file2) => file2.path.startsWith(this.settings.profiles.profileFolderPath));
        profileFiles.sort((a, b) => a.name.localeCompare(b.name));
        const currentIndex = profileFiles.findIndex((profileFile) => profileFile.path === file.path);
        const prevFileName = oldPath.replace(folderPath + "/", "");
        const updatedProfileFiles = [...profileFiles, { name: prevFileName }];
        updatedProfileFiles.sort((a, b) => a.name.localeCompare(b.name));
        const fileIndex = updatedProfileFiles.findIndex((profileFile) => profileFile.name === file.name);
        if (fileIndex !== -1) {
          updatedProfileFiles.splice(fileIndex, 1);
        }
        const prevIndex = updatedProfileFiles.findIndex((profileFile) => profileFile.name === prevFileName);
        if (currentIndex !== -1) {
          const [removed] = this.settings.profiles.lastLoadedChatHistory.splice(prevIndex, 1);
          this.settings.profiles.lastLoadedChatHistory.splice(currentIndex, 0, removed);
        }
        const currentProfile = this.settings.profiles.profile.replace(/\.[^/.]+$/, "");
        const profileIndex = profileFiles.findIndex((file2) => file2.basename === currentProfile);
        const index2 = this.settings.profiles.lastLoadedChatHistory.indexOf(oldPath);
        if (this.settings.profiles.lastLoadedChatHistory[profileIndex] === oldPath) {
          this.settings.profiles.lastLoadedChatHistory[index2] = file.path;
          this.settings.profiles.lastLoadedChatHistoryPath = file.path;
        } else if (this.settings.profiles.lastLoadedChatHistory[index2] === oldPath) {
          this.settings.profiles.lastLoadedChatHistory[index2] = file.path;
        }
        await this.saveSettings();
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.handleFileSwitch();
      })
    );
    this.registerView(
      VIEW_TYPE_CHATBOT,
      (leaf) => new BMOView(leaf, this.settings, this)
    );
    this.addRibbonIcon("bot", "BMO Chatbot", () => {
      this.activateView();
    });
    this.addCommand({
      id: "open-bmo-chatbot",
      name: "Open BMO Chatbot",
      callback: () => {
        this.activateView();
      },
      hotkeys: [
        {
          modifiers: ["Mod"],
          key: "0"
        }
      ]
    });
    this.addCommand({
      id: "rename-note-title",
      name: "Rename Note Title",
      callback: () => {
        renameTitleCommand(this, this.settings);
      },
      hotkeys: [
        {
          modifiers: ["Mod"],
          key: "'"
        }
      ]
    });
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        if (!(file instanceof import_obsidian27.TFile)) {
          return;
        }
        menu.addItem((item) => {
          item.setTitle("BMO Chatbot: Generate new title").onClick(() => renameTitleCommand(this, this.settings));
        });
      })
    );
    this.addCommand({
      id: "prompt-select-generate",
      name: "Prompt Select Generate",
      callback: () => {
        promptSelectGenerateCommand(this, this.settings);
      },
      hotkeys: [
        {
          modifiers: ["Mod", "Shift"],
          key: "="
        }
      ]
    });
    bmoCodeBlockProcessor(this, this.settings);
    this.addSettingTab(new BMOSettingTab(this.app, this));
  }
  handleFileSwitch() {
    checkActiveFile = this.app.workspace.getActiveFile();
  }
  async onunload() {
    this.app.workspace.getLeavesOfType(VIEW_TYPE_CHATBOT).forEach((leaf) => {
      const bmoView = leaf.view;
      if (bmoView) {
        this.saveSettings();
      }
    });
  }
  async activateView() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_CHATBOT);
    const rightLeaf = this.app.workspace.getRightLeaf(false);
    await (rightLeaf == null ? void 0 : rightLeaf.setViewState({
      type: VIEW_TYPE_CHATBOT,
      active: true
    }));
    this.app.workspace.revealLeaf(
      this.app.workspace.getLeavesOfType(VIEW_TYPE_CHATBOT)[0]
    );
    const textarea = document.querySelector(".chatbox textarea");
    if (textarea) {
      textarea.style.opacity = "0";
      textarea.style.transition = "opacity 1s ease-in-out";
      setTimeout(() => {
        textarea.focus();
        textarea.style.opacity = "1";
      }, 50);
    }
    this.app.workspace.revealLeaf(
      this.app.workspace.getLeavesOfType(VIEW_TYPE_CHATBOT)[0]
    );
    const messageContainer = document.querySelector("#messageContainer");
    if (messageContainer) {
      messageContainer.scroll({
        top: messageContainer.scrollHeight,
        behavior: "smooth"
      });
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    const currentProfileFile = `${this.settings.profiles.profileFolderPath}/${this.settings.profiles.profile}`;
    const currentProfile = this.app.vault.getAbstractFileByPath(currentProfileFile);
    updateFrontMatter(this, currentProfile);
    const header = document.querySelector("#header");
    const modelOptions = header == null ? void 0 : header.querySelector("#modelOptions");
    if (modelOptions) {
      modelOptions.remove();
    }
    const populateModelOptions = populateModelDropdown(this, this.settings);
    header == null ? void 0 : header.appendChild(populateModelOptions);
    await this.saveData(this.settings);
  }
};
async function defaultFrontMatter(plugin, file) {
  const setDefaultFrontMatter = async (frontmatter) => {
    frontmatter.model = DEFAULT_SETTINGS.general.model;
    frontmatter.max_tokens = parseInt(DEFAULT_SETTINGS.general.max_tokens);
    frontmatter.temperature = parseFloat(DEFAULT_SETTINGS.general.temperature);
    frontmatter.enable_reference_current_note = DEFAULT_SETTINGS.general.enableReferenceCurrentNote;
    frontmatter.prompt = DEFAULT_SETTINGS.prompts.prompt;
    frontmatter.user_name = DEFAULT_SETTINGS.appearance.userName;
    frontmatter.enable_header = DEFAULT_SETTINGS.appearance.enableHeader;
    frontmatter.chatbot_container_background_color = DEFAULT_SETTINGS.appearance.chatbotContainerBackgroundColor.replace(/^#/, "");
    frontmatter.message_container_background_color = DEFAULT_SETTINGS.appearance.messageContainerBackgroundColor.replace(/^#/, "");
    frontmatter.user_message_font_color = DEFAULT_SETTINGS.appearance.userMessageFontColor.replace(/^#/, "");
    frontmatter.user_message_background_color = DEFAULT_SETTINGS.appearance.userMessageBackgroundColor.replace(/^#/, "");
    frontmatter.bot_message_font_color = DEFAULT_SETTINGS.appearance.botMessageFontColor.replace(/^#/, "");
    frontmatter.chatbot_message_background_color = DEFAULT_SETTINGS.appearance.botMessageBackgroundColor.replace(/^#/, "");
    frontmatter.chatbox_font_color = DEFAULT_SETTINGS.appearance.chatBoxFontColor.replace(/^#/, "");
    frontmatter.chatbox_background_color = DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor.replace(/^#/, "");
    frontmatter.bmo_generate_background_color = DEFAULT_SETTINGS.appearance.bmoGenerateBackgroundColor.replace(/^#/, "");
    frontmatter.bmo_generate_font_color = DEFAULT_SETTINGS.appearance.bmoGenerateFontColor.replace(/^#/, "");
    frontmatter.systen_role = DEFAULT_SETTINGS.editor.systen_role;
    frontmatter.ollama_mirostat = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat);
    frontmatter.ollama_mirostat_eta = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_eta);
    frontmatter.ollama_mirostat_tau = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_tau);
    frontmatter.ollama_num_ctx = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_ctx);
    frontmatter.ollama_num_gqa = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_gqa);
    frontmatter.ollama_num_thread = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_thread);
    frontmatter.ollama_repeat_last_n = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_last_n);
    frontmatter.ollama_repeat_penalty = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_penalty);
    frontmatter.ollama_seed = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.seed);
    frontmatter.ollama_stop = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.stop;
    frontmatter.ollama_tfs_z = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.tfs_z);
    frontmatter.ollama_top_k = parseInt(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_k);
    frontmatter.ollama_top_p = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_p);
    frontmatter.ollama_min_p = parseFloat(DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.min_p);
    frontmatter.ollama_keep_alive = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.keep_alive;
  };
  const writeOptions = {
    // Specify options if needed
  };
  try {
    await plugin.app.fileManager.processFrontMatter(file, setDefaultFrontMatter, writeOptions);
  } catch (error) {
    console.error("Error processing frontmatter:", error);
  }
  plugin.app.vault.append(file, DEFAULT_SETTINGS.general.system_role);
}
async function updateSettingsFromFrontMatter(plugin, file) {
  const updateSettings = async (frontmatter) => {
    plugin.settings.general.model = frontmatter.model;
    plugin.settings.general.max_tokens = frontmatter.max_tokens;
    plugin.settings.general.temperature = frontmatter.temperature;
    plugin.settings.general.enableReferenceCurrentNote = frontmatter.enable_reference_current_note;
    plugin.settings.prompts.prompt = frontmatter.prompt;
    plugin.settings.appearance.userName = frontmatter.user_name;
    plugin.settings.appearance.chatbotName = file.basename;
    plugin.settings.appearance.enableHeader = frontmatter.enable_header;
    plugin.settings.appearance.chatbotContainerBackgroundColor = "#" + frontmatter.chatbot_container_background_color;
    plugin.settings.appearance.messageContainerBackgroundColor = "#" + frontmatter.message_container_background_color;
    plugin.settings.appearance.userMessageFontColor = "#" + frontmatter.user_message_font_color;
    plugin.settings.appearance.userMessageBackgroundColor = "#" + frontmatter.user_message_background_color;
    plugin.settings.appearance.botMessageFontColor = "#" + frontmatter.bot_message_font_color;
    plugin.settings.appearance.botMessageBackgroundColor = "#" + frontmatter.chatbot_message_background_color;
    plugin.settings.appearance.chatBoxFontColor = "#" + frontmatter.chatbox_font_color;
    plugin.settings.appearance.chatBoxBackgroundColor = "#" + frontmatter.chatbox_background_color;
    plugin.settings.appearance.bmoGenerateBackgroundColor = "#" + frontmatter.bmo_generate_background_color;
    plugin.settings.appearance.bmoGenerateFontColor = "#" + frontmatter.bmo_generate_font_color;
    plugin.settings.editor.systen_role = frontmatter.systen_role;
    plugin.settings.OllamaConnection.ollamaParameters.mirostat = frontmatter.ollama_mirostat;
    plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta = frontmatter.ollama_mirostat_eta;
    plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau = frontmatter.ollama_mirostat_tau;
    plugin.settings.OllamaConnection.ollamaParameters.num_ctx = frontmatter.ollama_num_ctx;
    plugin.settings.OllamaConnection.ollamaParameters.num_gqa = frontmatter.ollama_num_gqa;
    plugin.settings.OllamaConnection.ollamaParameters.num_thread = frontmatter.ollama_num_thread;
    plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n = frontmatter.ollama_repeat_last_n;
    plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty = frontmatter.ollama_repeat_penalty;
    plugin.settings.OllamaConnection.ollamaParameters.seed = frontmatter.ollama_seed;
    plugin.settings.OllamaConnection.ollamaParameters.stop = frontmatter.ollama_stop;
    plugin.settings.OllamaConnection.ollamaParameters.tfs_z = frontmatter.ollama_tfs_z;
    plugin.settings.OllamaConnection.ollamaParameters.top_k = frontmatter.ollama_top_k;
    plugin.settings.OllamaConnection.ollamaParameters.top_p = frontmatter.ollama_top_p;
    plugin.settings.OllamaConnection.ollamaParameters.min_p = frontmatter.ollama_min_p;
    plugin.settings.OllamaConnection.ollamaParameters.keep_alive = frontmatter.ollama_keep_alive;
  };
  const writeOptions = {
    // Specify options if needed
  };
  try {
    await plugin.app.fileManager.processFrontMatter(file, updateSettings, writeOptions);
    const fileContent = (await plugin.app.vault.read(file)).replace(/^---\s*[\s\S]*?---/, "").trim();
    plugin.settings.general.system_role = fileContent;
    updateProfile(plugin, file);
  } catch (error) {
    console.error("Error processing frontmatter:", error);
  }
}
async function updateFrontMatter(plugin, file) {
  const modifyFrontMatter = async (frontmatter) => {
    frontmatter.model = plugin.settings.general.model;
    frontmatter.max_tokens = parseInt(plugin.settings.general.max_tokens);
    frontmatter.temperature = parseFloat(plugin.settings.general.temperature);
    frontmatter.enable_reference_current_note = plugin.settings.general.enableReferenceCurrentNote;
    frontmatter.prompt = plugin.settings.prompts.prompt.replace(".md", "");
    frontmatter.user_name = plugin.settings.appearance.userName;
    frontmatter.enable_header = plugin.settings.appearance.enableHeader;
    frontmatter.chatbot_container_background_color = plugin.settings.appearance.chatbotContainerBackgroundColor.replace(/^#/, "");
    frontmatter.message_container_background_color = plugin.settings.appearance.messageContainerBackgroundColor.replace(/^#/, "");
    frontmatter.user_message_font_color = plugin.settings.appearance.userMessageFontColor.replace(/^#/, "");
    frontmatter.user_message_background_color = plugin.settings.appearance.userMessageBackgroundColor.replace(/^#/, "");
    frontmatter.bot_message_font_color = plugin.settings.appearance.botMessageFontColor.replace(/^#/, "");
    frontmatter.chatbot_message_background_color = plugin.settings.appearance.botMessageBackgroundColor.replace(/^#/, "");
    frontmatter.chatbox_font_color = plugin.settings.appearance.chatBoxFontColor.replace(/^#/, "");
    frontmatter.chatbox_background_color = plugin.settings.appearance.chatBoxBackgroundColor.replace(/^#/, "");
    frontmatter.bmo_generate_background_color = plugin.settings.appearance.bmoGenerateBackgroundColor.replace(/^#/, "");
    frontmatter.bmo_generate_font_color = plugin.settings.appearance.bmoGenerateFontColor.replace(/^#/, "");
    frontmatter.systen_role = plugin.settings.editor.systen_role;
    frontmatter.ollama_mirostat = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.mirostat);
    frontmatter.ollama_mirostat_eta = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta);
    frontmatter.ollama_mirostat_tau = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau);
    frontmatter.ollama_num_ctx = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_ctx);
    frontmatter.ollama_num_gqa = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_gqa);
    frontmatter.ollama_num_thread = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_thread);
    frontmatter.ollama_repeat_last_n = parseInt(plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n);
    frontmatter.ollama_repeat_penalty = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty);
    frontmatter.ollama_seed = parseInt(plugin.settings.OllamaConnection.ollamaParameters.seed);
    frontmatter.ollama_stop = plugin.settings.OllamaConnection.ollamaParameters.stop;
    frontmatter.ollama_tfs_z = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.tfs_z);
    frontmatter.ollama_top_k = parseInt(plugin.settings.OllamaConnection.ollamaParameters.top_k);
    frontmatter.ollama_top_p = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.top_p);
    frontmatter.ollama_min_p = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.min_p);
    frontmatter.ollama_keep_alive = plugin.settings.OllamaConnection.ollamaParameters.keep_alive;
  };
  const writeOptions = {
    // Specify options if needed
  };
  try {
    await plugin.app.fileManager.processFrontMatter(file, modifyFrontMatter, writeOptions);
    updateProfile(plugin, file);
  } catch (error) {
    console.error("Error processing frontmatter:", error);
  }
}
async function updateProfile(plugin, file) {
  try {
    await plugin.app.fileManager.processFrontMatter(file, (frontmatter) => {
      plugin.settings.general.model = frontmatter.model || DEFAULT_SETTINGS.general.model;
      if (frontmatter.max_tokens) {
        plugin.settings.general.max_tokens = frontmatter.max_tokens.toString();
        frontmatter.max_tokens = parseInt(plugin.settings.general.max_tokens);
      } else {
        plugin.settings.general.max_tokens = DEFAULT_SETTINGS.general.max_tokens;
      }
      if (frontmatter.temperature) {
        if (frontmatter.temperature < 0) {
          frontmatter.temperature = "0.00";
        } else if (frontmatter.temperature > 2) {
          frontmatter.temperature = "2.00";
        } else {
          plugin.settings.general.temperature = parseFloat(frontmatter.temperature).toFixed(2).toString();
          frontmatter.temperature = parseFloat(plugin.settings.general.temperature);
        }
      } else {
        plugin.settings.general.temperature = DEFAULT_SETTINGS.general.temperature;
        frontmatter.temperature = DEFAULT_SETTINGS.general.temperature;
      }
      plugin.settings.general.enableReferenceCurrentNote = frontmatter.enable_reference_current_note;
      const referenceCurrentNoteElement = document.getElementById("referenceCurrentNote");
      if (referenceCurrentNoteElement) {
        if (frontmatter.enable_reference_current_note === true) {
          referenceCurrentNoteElement.style.display = "block";
        } else {
          referenceCurrentNoteElement.style.display = "none";
        }
      }
      if (frontmatter.prompt && frontmatter.prompt !== "") {
        plugin.settings.prompts.prompt = frontmatter.prompt + ".md";
      } else {
        plugin.settings.prompts.prompt = DEFAULT_SETTINGS.prompts.prompt;
      }
      if (frontmatter.user_name) {
        plugin.settings.appearance.userName = frontmatter.user_name.substring(0, 30);
      } else {
        plugin.settings.appearance.userName = DEFAULT_SETTINGS.appearance.userName;
      }
      frontmatter.user_name = plugin.settings.appearance.userName;
      const userNames = document.querySelectorAll(".userName");
      userNames.forEach((userName) => {
        userName.textContent = plugin.settings.appearance.userName;
      });
      const chatbotNameHeading = document.querySelector("#chatbotNameHeading");
      const chatbotNames = document.querySelectorAll(".chatbotName");
      if (chatbotNameHeading) {
        chatbotNameHeading.textContent = plugin.settings.appearance.chatbotName;
      }
      chatbotNames.forEach((chatbotName) => {
        chatbotName.textContent = plugin.settings.appearance.chatbotName;
      });
      const chatbotContainer = document.querySelector(".chatbotContainer");
      const messageContainer = document.querySelector("#messageContainer");
      if (isValidHexColor(frontmatter.chatbot_container_background_color)) {
        plugin.settings.appearance.chatbotContainerBackgroundColor = "#" + frontmatter.chatbot_container_background_color.substring(0, 6);
        if (chatbotContainer) {
          chatbotContainer.style.backgroundColor = plugin.settings.appearance.chatbotContainerBackgroundColor;
        }
      } else {
        plugin.settings.appearance.chatbotContainerBackgroundColor = colorToHex(DEFAULT_SETTINGS.appearance.chatbotContainerBackgroundColor);
        frontmatter.chatbot_container_background_color = plugin.settings.appearance.chatbotContainerBackgroundColor.replace(/^#/, "");
        if (chatbotContainer) {
          const defaultChatbotContainerBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatbotContainerBackgroundColor).trim();
          chatbotContainer.style.backgroundColor = defaultChatbotContainerBackgroundColor;
        }
      }
      if (isValidHexColor(frontmatter.message_container_background_color)) {
        plugin.settings.appearance.messageContainerBackgroundColor = "#" + frontmatter.message_container_background_color.substring(0, 6);
        if (messageContainer) {
          messageContainer.style.backgroundColor = plugin.settings.appearance.messageContainerBackgroundColor;
        }
      } else {
        plugin.settings.appearance.messageContainerBackgroundColor = colorToHex(DEFAULT_SETTINGS.appearance.messageContainerBackgroundColor);
        frontmatter.message_container_background_color = plugin.settings.appearance.messageContainerBackgroundColor.replace(/^#/, "");
        if (messageContainer) {
          const defaultMessageContainerBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.messageContainerBackgroundColor).trim();
          messageContainer.style.backgroundColor = defaultMessageContainerBackgroundColor;
        }
      }
      if (isValidHexColor(frontmatter.user_message_font_color)) {
        plugin.settings.appearance.userMessageFontColor = "#" + frontmatter.user_message_font_color.substring(0, 6);
        if (messageContainer) {
          const userMessages = messageContainer.querySelectorAll(".userMessage");
          userMessages.forEach((userMessage) => {
            const element = userMessage;
            element.style.color = plugin.settings.appearance.userMessageFontColor;
          });
        }
      } else {
        plugin.settings.appearance.userMessageFontColor = colorToHex(DEFAULT_SETTINGS.appearance.userMessageFontColor);
        frontmatter.user_message_font_color = plugin.settings.appearance.userMessageFontColor.replace(/^#/, "");
        if (messageContainer) {
          const userMessages = messageContainer.querySelectorAll(".userMessage");
          userMessages.forEach((userMessage) => {
            const element = userMessage;
            const defaultUserMessageFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.userMessageFontColor).trim();
            element.style.color = defaultUserMessageFontColor;
          });
        }
      }
      if (isValidHexColor(frontmatter.user_message_background_color)) {
        plugin.settings.appearance.userMessageBackgroundColor = "#" + frontmatter.user_message_background_color.substring(0, 6);
        if (messageContainer) {
          const userMessages = messageContainer.querySelectorAll(".userMessage");
          userMessages.forEach((userMessage) => {
            const element = userMessage;
            element.style.backgroundColor = plugin.settings.appearance.userMessageBackgroundColor;
          });
        }
      } else {
        plugin.settings.appearance.userMessageBackgroundColor = colorToHex(DEFAULT_SETTINGS.appearance.userMessageBackgroundColor);
        frontmatter.user_message_background_color = plugin.settings.appearance.userMessageBackgroundColor.replace(/^#/, "");
        if (messageContainer) {
          const userMessages = messageContainer.querySelectorAll(".userMessage");
          userMessages.forEach((userMessage) => {
            const element = userMessage;
            const defaultUserMessageBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.userMessageBackgroundColor).trim();
            element.style.backgroundColor = defaultUserMessageBackgroundColor;
          });
        }
      }
      if (isValidHexColor(frontmatter.bot_message_font_color)) {
        plugin.settings.appearance.botMessageFontColor = "#" + frontmatter.bot_message_font_color.substring(0, 6);
        if (messageContainer) {
          const botMessages = messageContainer.querySelectorAll(".botMessage");
          botMessages.forEach((botMessage) => {
            const element = botMessage;
            element.style.color = plugin.settings.appearance.botMessageFontColor;
          });
        }
      } else {
        plugin.settings.appearance.botMessageFontColor = colorToHex(DEFAULT_SETTINGS.appearance.botMessageFontColor);
        frontmatter.bot_message_font_color = plugin.settings.appearance.botMessageFontColor.replace(/^#/, "");
        if (messageContainer) {
          const botMessages = messageContainer.querySelectorAll(".botMessage");
          botMessages.forEach((botMessage) => {
            const element = botMessage;
            const defaultBotMessageFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageFontColor).trim();
            element.style.color = defaultBotMessageFontColor;
          });
        }
      }
      if (isValidHexColor(frontmatter.chatbot_message_background_color)) {
        plugin.settings.appearance.botMessageBackgroundColor = "#" + frontmatter.chatbot_message_background_color.substring(0, 6);
        if (messageContainer) {
          const botMessages = messageContainer.querySelectorAll(".botMessage");
          botMessages.forEach((botMessage) => {
            const element = botMessage;
            element.style.backgroundColor = plugin.settings.appearance.botMessageBackgroundColor;
          });
        }
      } else {
        plugin.settings.appearance.botMessageBackgroundColor = colorToHex(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor);
        frontmatter.chatbot_message_background_color = plugin.settings.appearance.botMessageBackgroundColor.replace(/^#/, "");
        if (messageContainer) {
          const botMessages = messageContainer.querySelectorAll(".botMessage");
          botMessages.forEach((botMessage) => {
            const element = botMessage;
            const defaultBotMessageBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.botMessageBackgroundColor).trim();
            element.style.backgroundColor = defaultBotMessageBackgroundColor;
          });
        }
      }
      if (isValidHexColor(frontmatter.chatbox_font_color)) {
        plugin.settings.appearance.chatBoxFontColor = "#" + frontmatter.chatbox_font_color.substring(0, 6);
        const textarea = document.querySelector(".chatbox textarea");
        if (textarea) {
          textarea.style.color = plugin.settings.appearance.chatBoxFontColor;
          const style = document.createElement("style");
          style.textContent = `
						.chatbox textarea::placeholder {
							color: ${plugin.settings.appearance.chatBoxFontColor} !important;
						}
					`;
          textarea.appendChild(style);
        }
      } else {
        plugin.settings.appearance.chatBoxFontColor = colorToHex(DEFAULT_SETTINGS.appearance.chatBoxFontColor);
        frontmatter.chatbox_font_color = plugin.settings.appearance.chatBoxFontColor.replace(/^#/, "");
        const textarea = document.querySelector(".chatbox textarea");
        const defaultChatBoxFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatBoxFontColor).trim();
        if (textarea) {
          textarea.style.color = DEFAULT_SETTINGS.appearance.chatBoxFontColor;
          const style = document.createElement("style");
          style.textContent = `
                        .chatbox textarea::placeholder {
                            color: ${defaultChatBoxFontColor} !important;
                        }
                    `;
          textarea.appendChild(style);
        }
      }
      if (isValidHexColor(frontmatter.chatbox_background_color)) {
        plugin.settings.appearance.chatBoxBackgroundColor = "#" + frontmatter.chatbox_background_color.substring(0, 6);
        if (messageContainer) {
          const chatbox = document.querySelector(".chatbox");
          if (chatbox) {
            const element = chatbox;
            element.style.backgroundColor = plugin.settings.appearance.chatBoxBackgroundColor;
            element.style.borderColor = plugin.settings.appearance.chatBoxBackgroundColor;
          }
          const textarea = document.querySelector(".chatbox textarea");
          if (textarea) {
            const element = textarea;
            element.style.backgroundColor = plugin.settings.appearance.chatBoxBackgroundColor;
            element.style.borderColor = plugin.settings.appearance.chatBoxBackgroundColor;
          }
          const submitButton = document.querySelector(".chatbox .submit-button");
          if (submitButton) {
            const element = submitButton;
            element.style.backgroundColor = plugin.settings.appearance.chatBoxBackgroundColor;
            element.style.borderColor = plugin.settings.appearance.chatBoxBackgroundColor;
          }
        }
      } else {
        plugin.settings.appearance.chatBoxBackgroundColor = DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor;
        frontmatter.chatbox_background_color = DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor.replace(/^#/, "");
        const defaultChatBoxBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.chatBoxBackgroundColor).trim();
        if (messageContainer) {
          const chatbox = document.querySelector(".chatbox");
          if (chatbox) {
            const element = chatbox;
            element.style.backgroundColor = defaultChatBoxBackgroundColor;
            element.style.borderColor = defaultChatBoxBackgroundColor;
          }
          const textarea = document.querySelector(".chatbox textarea");
          if (textarea) {
            const element = textarea;
            element.style.backgroundColor = defaultChatBoxBackgroundColor;
            element.style.borderColor = defaultChatBoxBackgroundColor;
          }
          const submitButton = document.querySelector(".chatbox .submit-button");
          if (submitButton) {
            const element = submitButton;
            element.style.backgroundColor = defaultChatBoxBackgroundColor;
            element.style.borderColor = defaultChatBoxBackgroundColor;
          }
        }
      }
      if (isValidHexColor(frontmatter.bmo_generate_background_color)) {
        plugin.settings.appearance.bmoGenerateBackgroundColor = "#" + frontmatter.bmo_generate_background_color.substring(0, 6);
        const containers = document.querySelectorAll(".bmoCodeBlockContainer");
        containers.forEach((container) => {
          const element = container;
          element.style.backgroundColor = plugin.settings.appearance.bmoGenerateBackgroundColor;
        });
      } else {
        plugin.settings.appearance.bmoGenerateBackgroundColor = colorToHex(DEFAULT_SETTINGS.appearance.bmoGenerateBackgroundColor);
        frontmatter.bmo_generate_background_color = plugin.settings.appearance.bmoGenerateBackgroundColor.replace(/^#/, "");
        const containers = document.querySelectorAll(".bmoCodeBlockContainer");
        containers.forEach((container) => {
          const element = container;
          const defaultBMOGenerateBackgroundColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.bmoGenerateBackgroundColor).trim();
          element.style.backgroundColor = defaultBMOGenerateBackgroundColor;
        });
      }
      if (isValidHexColor(frontmatter.bmo_generate_font_color)) {
        plugin.settings.appearance.bmoGenerateFontColor = "#" + frontmatter.bmo_generate_font_color.substring(0, 6);
        const containers = document.querySelectorAll(".bmoCodeBlockContent");
        containers.forEach((container) => {
          const element = container;
          element.style.color = plugin.settings.appearance.bmoGenerateFontColor;
        });
      } else {
        plugin.settings.appearance.bmoGenerateFontColor = colorToHex(DEFAULT_SETTINGS.appearance.bmoGenerateFontColor);
        frontmatter.bmo_generate_font_color = plugin.settings.appearance.bmoGenerateFontColor.replace(/^#/, "");
        const containers = document.querySelectorAll(".bmoCodeBlockContent");
        containers.forEach((container) => {
          const element = container;
          const defaultBMOGenerateFontColor = getComputedStyle(document.body).getPropertyValue(DEFAULT_SETTINGS.appearance.bmoGenerateFontColor).trim();
          element.style.color = defaultBMOGenerateFontColor;
        });
      }
      plugin.settings.editor.systen_role = frontmatter.systen_role;
      plugin.settings.appearance.enableHeader = frontmatter.enable_header;
      if (frontmatter.enable_header === true) {
        const header = document.querySelector("#header");
        if (header) {
          header.style.display = "block";
          referenceCurrentNoteElement.style.margin = "-0.5rem 0 0.5rem 0";
        }
      } else {
        const header = document.querySelector("#header");
        const messageContainer2 = document.querySelector("#messageContainer");
        if (header) {
          header.style.display = "none";
          messageContainer2.style.maxHeight = "calc(100% - 60px)";
          referenceCurrentNoteElement.style.margin = "0.5rem 0 0.5rem 0";
        }
      }
      const intValue = parseInt(frontmatter.ollama_mirostat, 10);
      if (isNaN(intValue)) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat;
        frontmatter.ollama_mirostat = plugin.settings.OllamaConnection.ollamaParameters.mirostat;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat = intValue.toString();
        frontmatter.ollama_mirostat = intValue;
      }
      if (isNaN(parseFloat(frontmatter.ollama_mirostat_eta))) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_eta;
        frontmatter.ollama_mirostat_eta = plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta = parseFloat(frontmatter.ollama_mirostat_eta).toFixed(2).toString();
        frontmatter.ollama_mirostat_eta = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.mirostat_eta);
      }
      if (isNaN(parseFloat(frontmatter.ollama_mirostat_tau))) {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.mirostat_tau;
        frontmatter.ollama_mirostat_tau = plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau = parseFloat(frontmatter.ollama_mirostat_tau).toFixed(2).toString();
        frontmatter.ollama_mirostat_tau = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.mirostat_tau);
      }
      if (isNaN(parseInt(frontmatter.ollama_num_ctx))) {
        plugin.settings.OllamaConnection.ollamaParameters.num_ctx = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_ctx;
        frontmatter.ollama_num_ctx = plugin.settings.OllamaConnection.ollamaParameters.num_ctx;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_ctx = parseInt(frontmatter.ollama_num_ctx).toString();
        frontmatter.ollama_num_ctx = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_ctx);
      }
      if (isNaN(parseInt(frontmatter.ollama_num_gqa))) {
        plugin.settings.OllamaConnection.ollamaParameters.num_gqa = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_gqa;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_gqa = parseInt(frontmatter.ollama_num_gqa).toString();
        frontmatter.ollama_num_gqa = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_gqa);
      }
      if (isNaN(parseInt(frontmatter.ollama_num_thread))) {
        plugin.settings.OllamaConnection.ollamaParameters.num_thread = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.num_thread;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.num_thread = parseInt(frontmatter.ollama_num_thread).toString();
        frontmatter.ollama_num_thread = parseInt(plugin.settings.OllamaConnection.ollamaParameters.num_thread);
      }
      if (isNaN(parseInt(frontmatter.ollama_repeat_last_n))) {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_last_n;
        frontmatter.ollama_repeat_last_n = plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n = parseInt(frontmatter.ollama_repeat_last_n).toString();
        frontmatter.ollama_repeat_last_n = parseInt(plugin.settings.OllamaConnection.ollamaParameters.repeat_last_n);
      }
      if (isNaN(parseFloat(frontmatter.ollama_repeat_penalty))) {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.repeat_penalty;
        frontmatter.ollama_repeat_penalty = plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty = parseFloat(frontmatter.ollama_repeat_penalty).toFixed(2).toString();
        frontmatter.ollama_repeat_penalty = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.repeat_penalty);
      }
      if (isNaN(parseInt(frontmatter.ollama_seed))) {
        plugin.settings.OllamaConnection.ollamaParameters.seed = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.seed;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.seed = parseInt(frontmatter.ollama_seed).toString();
        frontmatter.ollama_seed = parseInt(plugin.settings.OllamaConnection.ollamaParameters.seed);
      }
      plugin.settings.OllamaConnection.ollamaParameters.stop = frontmatter.ollama_stop;
      if (isNaN(parseFloat(frontmatter.ollama_tfs_z))) {
        plugin.settings.OllamaConnection.ollamaParameters.tfs_z = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.tfs_z;
        frontmatter.ollama_tfs_z = plugin.settings.OllamaConnection.ollamaParameters.tfs_z;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.tfs_z = parseFloat(frontmatter.ollama_tfs_z).toFixed(2).toString();
        frontmatter.ollama_tfs_z = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.tfs_z);
      }
      if (isNaN(parseInt(frontmatter.ollama_top_k))) {
        plugin.settings.OllamaConnection.ollamaParameters.top_k = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_k;
        frontmatter.ollama_top_k = plugin.settings.OllamaConnection.ollamaParameters.top_k;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.top_k = parseInt(frontmatter.ollama_top_k).toString();
        frontmatter.ollama_top_k = parseInt(plugin.settings.OllamaConnection.ollamaParameters.top_k);
      }
      if (isNaN(parseInt(frontmatter.ollama_top_p))) {
        plugin.settings.OllamaConnection.ollamaParameters.top_p = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.top_p;
        frontmatter.ollama_top_p = plugin.settings.OllamaConnection.ollamaParameters.top_p;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.top_p = parseFloat(frontmatter.ollama_top_p).toFixed(2).toString();
        frontmatter.ollama_top_p = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.top_p);
      }
      if (isNaN(parseInt(frontmatter.ollama_min_p))) {
        plugin.settings.OllamaConnection.ollamaParameters.min_p = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.min_p;
        frontmatter.ollama_min_p = plugin.settings.OllamaConnection.ollamaParameters.min_p;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.min_p = parseFloat(frontmatter.ollama_min_p).toFixed(2).toString();
        frontmatter.ollama_min_p = parseFloat(plugin.settings.OllamaConnection.ollamaParameters.min_p);
      }
      const match = String(frontmatter.ollama_keep_alive).match(/^(-?\d+)(m|hr|h)?$/);
      if (match) {
        const num = parseInt(match[1]);
        const unit = match[2];
        let seconds;
        if (unit === "m") {
          seconds = num * 60;
        } else if (unit === "hr" || unit === "h") {
          seconds = num * 3600;
        } else {
          seconds = num;
        }
        plugin.settings.OllamaConnection.ollamaParameters.keep_alive = seconds.toString();
        frontmatter.ollama_keep_alive = plugin.settings.OllamaConnection.ollamaParameters.keep_alive;
      } else {
        plugin.settings.OllamaConnection.ollamaParameters.keep_alive = DEFAULT_SETTINGS.OllamaConnection.ollamaParameters.keep_alive;
        frontmatter.ollama_keep_alive = plugin.settings.OllamaConnection.ollamaParameters.keep_alive;
      }
    });
  } catch (error) {
    console.error("Error processing frontmatter:", error);
  }
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3ZpZXcudHMiLCAic3JjL2NvbXBvbmVudHMvY2hhdC9Db21tYW5kcy50cyIsICJzcmMvdXRpbHMvQ29sb3JDb252ZXJ0ZXIudHMiLCAic3JjL2NvbXBvbmVudHMvRmV0Y2hNb2RlbFJlc3BvbnNlLnRzIiwgInNyYy9jb21wb25lbnRzL2NoYXQvQnV0dG9ucy50cyIsICJzcmMvY29tcG9uZW50cy9lZGl0b3IvUmVmZXJlbmNlQ3VycmVudE5vdGUudHMiLCAic3JjL2NvbXBvbmVudHMvY2hhdC9NZXNzYWdlLnRzIiwgInNyYy9jb21wb25lbnRzL2NoYXQvQm90TWVzc2FnZS50cyIsICJzcmMvY29tcG9uZW50cy9jaGF0L1Byb21wdC50cyIsICJzcmMvY29tcG9uZW50cy9lZGl0b3IvRmV0Y2hSZW5hbWVOb3RlVGl0bGUudHMiLCAibm9kZV9tb2R1bGVzL3doYXR3Zy1mZXRjaC9mZXRjaC5qcyIsICJub2RlX21vZHVsZXMvb2xsYW1hL2Rpc3Qvc2hhcmVkL29sbGFtYS4xNGU1ODY1Mi5tanMiLCAibm9kZV9tb2R1bGVzL29sbGFtYS9kaXN0L2luZGV4Lm1qcyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy92ZXJzaW9uLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3N0cmVhbWluZy50cyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy9lcnJvci50cyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy9fc2hpbXMvYWdlbnQudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9fc2hpbXMvZmV0Y2gubWpzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvX3NoaW1zL2Zvcm0tZGF0YS5tanMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvX3NoaW1zL2dldE11bHRpcGFydFJlcXVlc3RPcHRpb25zLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL19zaGltcy9maWxlRnJvbVBhdGgudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvX3NoaW1zL25vZGUtcmVhZGFibGUudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvdXBsb2Fkcy50cyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy9jb3JlLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3BhZ2luYXRpb24udHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2F1ZGlvL3RyYW5zY3JpcHRpb25zLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9hdWRpby90cmFuc2xhdGlvbnMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2F1ZGlvL2F1ZGlvLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9jaGF0L2NvbXBsZXRpb25zLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9jaGF0L2NoYXQudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2NvbXBsZXRpb25zLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9lbWJlZGRpbmdzLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9lZGl0cy50cyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy9yZXNvdXJjZXMvZmlsZXMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2ZpbmUtdHVuZXMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2ZpbmUtdHVuaW5nL2pvYnMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL2ZpbmUtdHVuaW5nL2ZpbmUtdHVuaW5nLnRzIiwgIm5vZGVfbW9kdWxlcy9vcGVuYWkvc3JjL3Jlc291cmNlcy9pbWFnZXMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvcmVzb3VyY2VzL21vZGVscy50cyIsICJub2RlX21vZHVsZXMvb3BlbmFpL3NyYy9yZXNvdXJjZXMvbW9kZXJhdGlvbnMudHMiLCAibm9kZV9tb2R1bGVzL29wZW5haS9zcmMvaW5kZXgudHMiLCAic3JjL2NvbXBvbmVudHMvY2hhdC9Vc2VyTWVzc2FnZS50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2NvbXBvbmVudHMvc2V0dGluZ3MvR2VuZXJhbFNldHRpbmdzLnRzIiwgInNyYy9jb21wb25lbnRzL0ZldGNoTW9kZWxMaXN0LnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL0FwcGVhcmFuY2VTZXR0aW5ncy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9DaGF0SGlzdG9yeVNldHRpbmdzLnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL09sbGFtYVNldHRpbmdzLnRzIiwgInNyYy91dGlscy9EZXNjcmlwdGlvbkxpbmsudHMiLCAic3JjL2NvbXBvbmVudHMvc2V0dGluZ3MvQ29ubmVjdGlvblNldHRpbmdzLnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL0FQSUNvbm5lY3Rpb25zL09wZW5BSUNvbm5lY3Rpb25zLnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL0FQSUNvbm5lY3Rpb25zL01pc3RyYWxDb25uZWN0aW9ucy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9BUElDb25uZWN0aW9ucy9Hb29nbGVHZW1pbmlDb25uZWN0aW9ucy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9BUElDb25uZWN0aW9ucy9BbnRocm9waWNDb25uZWN0aW9ucy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9BUElDb25uZWN0aW9ucy9PcGVuUm91dGVyQ29ubmVjdGlvbnMudHMiLCAic3JjL2NvbXBvbmVudHMvc2V0dGluZ3MvUHJvZmlsZVNldHRpbmdzLnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL1JFU1RBUElVUkxTZXR0aW5ncy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9FZGl0b3JTZXR0aW5ncy50cyIsICJzcmMvY29tcG9uZW50cy9zZXR0aW5ncy9Qcm9tcHRTZXR0aW5ncy50cyIsICJzcmMvY29tcG9uZW50cy9lZGl0b3IvRWRpdG9yQ29tbWFuZHMudHMiLCAic3JjL2NvbXBvbmVudHMvRmV0Y2hNb2RlbEVkaXRvci50cyIsICJzcmMvY29tcG9uZW50cy9lZGl0b3IvQk1PQ29kZUJsb2NrUHJvY2Vzc29yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBEYXRhV3JpdGVPcHRpb25zLCBQbHVnaW4sIFRGaWxlfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCTU9WaWV3LCBWSUVXX1RZUEVfQ0hBVEJPVCwgcG9wdWxhdGVNb2RlbERyb3Bkb3duIH0gZnJvbSAnLi92aWV3JztcbmltcG9ydCB7IEJNT1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IHByb21wdFNlbGVjdEdlbmVyYXRlQ29tbWFuZCwgcmVuYW1lVGl0bGVDb21tYW5kIH0gZnJvbSAnLi9jb21wb25lbnRzL2VkaXRvci9FZGl0b3JDb21tYW5kcyc7XG5pbXBvcnQgeyBjb2xvclRvSGV4LCBpc1ZhbGlkSGV4Q29sb3IgfSBmcm9tICcuL3V0aWxzL0NvbG9yQ29udmVydGVyJztcbmltcG9ydCB7IGJtb0NvZGVCbG9ja1Byb2Nlc3NvciB9IGZyb20gJy4vY29tcG9uZW50cy9lZGl0b3IvQk1PQ29kZUJsb2NrUHJvY2Vzc29yJztcblxuZXhwb3J0IGludGVyZmFjZSBCTU9TZXR0aW5ncyB7XG5cdHByb2ZpbGVzOiB7XG5cdFx0cHJvZmlsZTogc3RyaW5nLFxuXHRcdHByb2ZpbGVGb2xkZXJQYXRoOiBzdHJpbmcsXG5cdFx0bGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aDogc3RyaW5nIHwgbnVsbCxcblx0XHRsYXN0TG9hZGVkQ2hhdEhpc3Rvcnk6IChzdHJpbmcgfCBudWxsKVtdLFxuXHR9LFxuXHRnZW5lcmFsOiB7XG5cdFx0bW9kZWw6IHN0cmluZyxcblx0XHRzeXN0ZW1fcm9sZTogc3RyaW5nLFxuXHRcdG1heF90b2tlbnM6IHN0cmluZyxcblx0XHR0ZW1wZXJhdHVyZTogc3RyaW5nLFxuXHRcdGVuYWJsZVJlZmVyZW5jZUN1cnJlbnROb3RlOiBib29sZWFuLFxuXHR9LFxuXHRhcHBlYXJhbmNlOiB7XG5cdFx0dXNlck5hbWU6IHN0cmluZyxcblx0XHRjaGF0Ym90TmFtZTogc3RyaW5nLFxuXHRcdGNoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3I6IHN0cmluZyxcblx0XHRtZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yOiBzdHJpbmcsXG5cdFx0dXNlck1lc3NhZ2VGb250Q29sb3I6IHN0cmluZyxcblx0XHR1c2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcjogc3RyaW5nLFxuXHRcdGJvdE1lc3NhZ2VGb250Q29sb3I6IHN0cmluZyxcblx0XHRib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yOiBzdHJpbmcsXG5cdFx0Y2hhdEJveEZvbnRDb2xvcjogc3RyaW5nLFxuXHRcdGNoYXRCb3hCYWNrZ3JvdW5kQ29sb3I6IHN0cmluZyxcblx0XHRlbmFibGVIZWFkZXI6IGJvb2xlYW4sXG5cdFx0ZW5hYmxlU2Nyb2xsQmFyOiBib29sZWFuLFxuXHRcdGJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yOiBzdHJpbmcsXG5cdFx0Ym1vR2VuZXJhdGVGb250Q29sb3I6IHN0cmluZyxcblx0fSxcblx0cHJvbXB0czoge1xuXHRcdHByb21wdDogc3RyaW5nLFxuXHRcdHByb21wdEZvbGRlclBhdGg6IHN0cmluZyxcblx0fSxcblx0ZWRpdG9yOiB7XG5cdFx0c3lzdGVuX3JvbGU6IHN0cmluZyxcblx0fSxcblx0Y2hhdEhpc3Rvcnk6IHtcblx0XHRjaGF0SGlzdG9yeVBhdGg6IHN0cmluZyxcblx0XHR0ZW1wbGF0ZUZpbGVQYXRoOiBzdHJpbmcsXG5cdFx0YWxsb3dSZW5hbWVOb3RlVGl0bGU6IGJvb2xlYW4sXG5cdH1cblx0T2xsYW1hQ29ubmVjdGlvbjoge1xuXHRcdFJFU1RBUElVUkw6IHN0cmluZyxcblx0XHRlbmFibGVTdHJlYW06IGJvb2xlYW4sXG5cdFx0b2xsYW1hUGFyYW1ldGVyczoge1xuXHRcdFx0bWlyb3N0YXQ6IHN0cmluZyxcblx0XHRcdG1pcm9zdGF0X2V0YTogc3RyaW5nLFxuXHRcdFx0bWlyb3N0YXRfdGF1OiBzdHJpbmcsXG5cdFx0XHRudW1fY3R4OiBzdHJpbmcsXG5cdFx0XHRudW1fZ3FhOiBzdHJpbmcsXG5cdFx0XHRudW1fdGhyZWFkOiBzdHJpbmcsXG5cdFx0XHRyZXBlYXRfbGFzdF9uOiBzdHJpbmcsXG5cdFx0XHRyZXBlYXRfcGVuYWx0eTogc3RyaW5nLFxuXHRcdFx0c2VlZDogc3RyaW5nLFxuXHRcdFx0c3RvcDogc3RyaW5nW10sXG5cdFx0XHR0ZnNfejogc3RyaW5nLFxuXHRcdFx0dG9wX2s6IHN0cmluZyxcblx0XHRcdHRvcF9wOiBzdHJpbmcsXG5cdFx0XHRtaW5fcDogc3RyaW5nLFxuXHRcdFx0a2VlcF9hbGl2ZTogc3RyaW5nLFxuXHRcdH0sXG5cdFx0b2xsYW1hTW9kZWxzOiBzdHJpbmdbXSxcblx0fSxcblx0UkVTVEFQSVVSTENvbm5lY3Rpb246IHtcblx0XHRBUElLZXk6IHN0cmluZyxcblx0XHRSRVNUQVBJVVJMOiBzdHJpbmcsXG5cdFx0ZW5hYmxlU3RyZWFtOiBib29sZWFuLFxuXHRcdFJFU1RBUElVUkxNb2RlbHM6IHN0cmluZ1tdLFxuXHR9LFxuXHRBUElDb25uZWN0aW9uczoge1xuXHRcdGFudGhyb3BpYzoge1xuXHRcdFx0QVBJS2V5OiBzdHJpbmcsXG5cdFx0XHRhbnRocm9waWNNb2RlbHM6IHN0cmluZ1tdLFxuXHRcdH0sXG5cdFx0Z29vZ2xlR2VtaW5pOiB7XG5cdFx0XHRBUElLZXk6IHN0cmluZyxcblx0XHRcdGVuYWJsZVN0cmVhbTogYm9vbGVhbixcblx0XHRcdGdlbWluaU1vZGVsczogc3RyaW5nW10sXG5cdFx0fSxcblx0XHRtaXN0cmFsOiB7XG5cdFx0XHRBUElLZXk6IHN0cmluZyxcblx0XHRcdGVuYWJsZVN0cmVhbTogYm9vbGVhbixcblx0XHRcdG1pc3RyYWxNb2RlbHM6IHN0cmluZ1tdLFxuXHRcdH0sXG5cdFx0b3BlbkFJOiB7XG5cdFx0XHRBUElLZXk6IHN0cmluZyxcblx0XHRcdG9wZW5BSUJhc2VVcmw6IHN0cmluZyxcblx0XHRcdGVuYWJsZVN0cmVhbTogYm9vbGVhbixcblx0XHRcdG9wZW5BSUJhc2VNb2RlbHM6IHN0cmluZ1tdLFxuXHRcdH0sXG5cdFx0b3BlblJvdXRlcjoge1xuXHRcdFx0QVBJS2V5OiBzdHJpbmcsXG5cdFx0XHRlbmFibGVTdHJlYW06IGJvb2xlYW4sXG5cdFx0XHRvcGVuUm91dGVyTW9kZWxzOiBzdHJpbmdbXSxcblx0XHR9LFxuXHR9LFxuXHR0b2dnbGVHZW5lcmFsU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZUFwcGVhcmFuY2VTZXR0aW5nczogYm9vbGVhbixcblx0dG9nZ2xlUHJvbXB0U2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZUVkaXRvclNldHRpbmdzOiBib29sZWFuLFxuXHR0b2dnbGVDaGF0SGlzdG9yeVNldHRpbmdzOiBib29sZWFuLFxuXHR0b2dnbGVQcm9maWxlU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZUFQSUNvbm5lY3Rpb25TZXR0aW5nczogYm9vbGVhbixcblx0dG9nZ2xlT3BlbkFJU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZU1pc3RyYWxTZXR0aW5nczogYm9vbGVhbixcblx0dG9nZ2xlR29vZ2xlR2VtaW5pU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZUFudGhyb3BpY1NldHRpbmdzOiBib29sZWFuLFxuXHR0b2dnbGVSRVNUQVBJVVJMU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZU9wZW5Sb3V0ZXJTZXR0aW5nczogYm9vbGVhbixcblx0dG9nZ2xlT2xsYW1hU2V0dGluZ3M6IGJvb2xlYW4sXG5cdHRvZ2dsZUFkdmFuY2VkU2V0dGluZ3M6IGJvb2xlYW4sXG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBCTU9TZXR0aW5ncyA9IHtcblx0cHJvZmlsZXM6IHtcblx0XHRwcm9maWxlOiAnQk1PLm1kJyxcblx0XHRwcm9maWxlRm9sZGVyUGF0aDogJ0JNTy9Qcm9maWxlcycsXG5cdFx0bGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aDogbnVsbCxcblx0XHRsYXN0TG9hZGVkQ2hhdEhpc3Rvcnk6IFtdLFxuXHR9LFxuXHRnZW5lcmFsOiB7XG5cdFx0bW9kZWw6ICcnLFxuXHRcdHN5c3RlbV9yb2xlOiAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50LicsXG5cdFx0bWF4X3Rva2VuczogJycsXG5cdFx0dGVtcGVyYXR1cmU6ICcxLjAwJyxcblx0XHRlbmFibGVSZWZlcmVuY2VDdXJyZW50Tm90ZTogZmFsc2UsXG5cdH0sXG5cdGFwcGVhcmFuY2U6IHtcblx0XHR1c2VyTmFtZTogJ1lPVScsXG5cdFx0Y2hhdGJvdE5hbWU6ICdCTU8nLFxuXHRcdGNoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3I6ICctLWJhY2tncm91bmQtc2Vjb25kYXJ5Jyxcblx0XHRtZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yOiAnLS1iYWNrZ3JvdW5kLXNlY29uZGFyeScsXG5cdFx0dXNlck1lc3NhZ2VGb250Q29sb3I6ICctLXRleHQtbm9ybWFsJyxcblx0XHR1c2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcjogJy0tYmFja2dyb3VuZC1wcmltYXJ5Jyxcblx0XHRib3RNZXNzYWdlRm9udENvbG9yOiAnLS10ZXh0LW5vcm1hbCcsXG5cdFx0Ym90TWVzc2FnZUJhY2tncm91bmRDb2xvcjogJy0tYmFja2dyb3VuZC1zZWNvbmRhcnknLFxuXHRcdGNoYXRCb3hGb250Q29sb3I6ICctLXRleHQtbm9ybWFsJyxcblx0XHRjaGF0Qm94QmFja2dyb3VuZENvbG9yOiAnLS1pbnRlcmFjdGl2ZS1hY2NlbnQnLFxuXHRcdGVuYWJsZUhlYWRlcjogdHJ1ZSxcblx0XHRlbmFibGVTY3JvbGxCYXI6IGZhbHNlLFxuXHRcdGJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yOiAnIzBjMGExMicsXG5cdFx0Ym1vR2VuZXJhdGVGb250Q29sb3I6ICctLXRleHQtbm9ybWFsJyxcblx0fSxcblx0cHJvbXB0czoge1xuXHRcdHByb21wdDogJycsXG5cdFx0cHJvbXB0Rm9sZGVyUGF0aDogJ0JNTy9Qcm9tcHRzJyxcblx0fSxcblx0ZWRpdG9yOiB7XG5cdFx0c3lzdGVuX3JvbGU6ICdZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQuJyxcblx0fSxcblx0Y2hhdEhpc3Rvcnk6IHtcblx0XHRjaGF0SGlzdG9yeVBhdGg6ICdCTU8vSGlzdG9yeScsXG5cdFx0dGVtcGxhdGVGaWxlUGF0aDogJycsXG5cdFx0YWxsb3dSZW5hbWVOb3RlVGl0bGU6IGZhbHNlLFxuXHR9LFxuXHRPbGxhbWFDb25uZWN0aW9uOiB7XG5cdFx0UkVTVEFQSVVSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdGVuYWJsZVN0cmVhbTogdHJ1ZSxcblx0XHRvbGxhbWFQYXJhbWV0ZXJzOiB7XG5cdFx0XHRtaXJvc3RhdDogJzAnLFxuXHRcdFx0bWlyb3N0YXRfZXRhOiAnMC4xMCcsXG5cdFx0XHRtaXJvc3RhdF90YXU6ICc1LjAwJyxcblx0XHRcdG51bV9jdHg6ICcyMDQ4Jyxcblx0XHRcdG51bV9ncWE6ICcnLFxuXHRcdFx0bnVtX3RocmVhZDogJycsXG5cdFx0XHRyZXBlYXRfbGFzdF9uOiAnNjQnLFxuXHRcdFx0cmVwZWF0X3BlbmFsdHk6ICcxLjEwJyxcblx0XHRcdHNlZWQ6ICcnLFxuXHRcdFx0c3RvcDogW10sXG5cdFx0XHR0ZnNfejogJzEuMDAnLFxuXHRcdFx0dG9wX2s6ICc0MCcsXG5cdFx0XHR0b3BfcDogJzAuOTAnLFxuXHRcdFx0bWluX3A6ICcwLjAnLFxuXHRcdFx0a2VlcF9hbGl2ZTogJycsXG5cdFx0fSxcblx0XHRvbGxhbWFNb2RlbHM6IFtdLFxuXHR9LFxuXHRSRVNUQVBJVVJMQ29ubmVjdGlvbjoge1xuXHRcdEFQSUtleTogJycsXHRcblx0XHRSRVNUQVBJVVJMOiAnJyxcblx0XHRlbmFibGVTdHJlYW06IGZhbHNlLFxuXHRcdFJFU1RBUElVUkxNb2RlbHM6IFtdLFxuXHR9LFxuXHRBUElDb25uZWN0aW9uczoge1xuXHRcdGFudGhyb3BpYzoge1xuXHRcdFx0QVBJS2V5OiAnJyxcblx0XHRcdGFudGhyb3BpY01vZGVsczogW10sXG5cdFx0fSxcblx0XHRnb29nbGVHZW1pbmk6IHtcblx0XHRcdEFQSUtleTogJycsXG5cdFx0XHRlbmFibGVTdHJlYW06IGZhbHNlLFxuXHRcdFx0Z2VtaW5pTW9kZWxzOiBbXSxcblx0XHR9LFxuXHRcdG1pc3RyYWw6IHtcblx0XHRcdEFQSUtleTogJycsXG5cdFx0XHRlbmFibGVTdHJlYW06IGZhbHNlLFxuXHRcdFx0bWlzdHJhbE1vZGVsczogW10sXG5cdFx0fSxcblx0XHRvcGVuQUk6IHtcblx0XHRcdEFQSUtleTogJycsXG5cdFx0XHRvcGVuQUlCYXNlVXJsOiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScsXG5cdFx0XHRlbmFibGVTdHJlYW06IHRydWUsXG5cdFx0XHRvcGVuQUlCYXNlTW9kZWxzOiBbXSxcblx0XHR9LFxuXHRcdG9wZW5Sb3V0ZXI6IHtcblx0XHRcdEFQSUtleTogJycsXG5cdFx0XHRlbmFibGVTdHJlYW06IGZhbHNlLFxuXHRcdFx0b3BlblJvdXRlck1vZGVsczogW10sXG5cdFx0fSxcblx0fSxcblx0dG9nZ2xlR2VuZXJhbFNldHRpbmdzOiB0cnVlLFxuXHR0b2dnbGVBcHBlYXJhbmNlU2V0dGluZ3M6IGZhbHNlLFxuXHR0b2dnbGVQcm9tcHRTZXR0aW5nczogZmFsc2UsXG5cdHRvZ2dsZUVkaXRvclNldHRpbmdzOiBmYWxzZSxcblx0dG9nZ2xlQ2hhdEhpc3RvcnlTZXR0aW5nczogZmFsc2UsXG5cdHRvZ2dsZVByb2ZpbGVTZXR0aW5nczogZmFsc2UsXG5cdHRvZ2dsZUFQSUNvbm5lY3Rpb25TZXR0aW5nczogdHJ1ZSxcblx0dG9nZ2xlT3BlbkFJU2V0dGluZ3M6IGZhbHNlLFxuXHR0b2dnbGVNaXN0cmFsU2V0dGluZ3M6IGZhbHNlLFxuXHR0b2dnbGVHb29nbGVHZW1pbmlTZXR0aW5nczogZmFsc2UsXG5cdHRvZ2dsZUFudGhyb3BpY1NldHRpbmdzOiBmYWxzZSxcblx0dG9nZ2xlUkVTVEFQSVVSTFNldHRpbmdzOiB0cnVlLFxuXHR0b2dnbGVPcGVuUm91dGVyU2V0dGluZ3M6IGZhbHNlLFxuXHR0b2dnbGVPbGxhbWFTZXR0aW5nczogdHJ1ZSxcblx0dG9nZ2xlQWR2YW5jZWRTZXR0aW5nczogZmFsc2UsXG59XG5cbmV4cG9ydCBsZXQgY2hlY2tBY3RpdmVGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCTU9HUFQgZXh0ZW5kcyBQbHVnaW4ge1xuXHRzZXR0aW5nczogQk1PU2V0dGluZ3M7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHRjb25zdCBmb2xkZXJQYXRoID0gdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCB8fCBERUZBVUxUX1NFVFRJTkdTLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoO1xuXG5cdFx0Y29uc3QgZGVmYXVsdEZpbGVQYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtERUZBVUxUX1NFVFRJTkdTLnByb2ZpbGVzLnByb2ZpbGV9YDtcblx0XHRjb25zdCBkZWZhdWx0UHJvZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkZWZhdWx0RmlsZVBhdGgpIGFzIFRGaWxlO1xuXHRcblx0XHQvLyBDaGVjayBpZiB0aGUgZm9sZGVyIGV4aXN0cywgY3JlYXRlIGl0IGlmIG5vdFxuXHRcdGlmICghYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMoZm9sZGVyUGF0aCkpIHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiB0aGUgJ0RlZmF1bHQubWQnIGZpbGUgZXhpc3RzLCBjcmVhdGUgaXQgaWYgbm90XG5cdFx0aWYgKCFhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhkZWZhdWx0RmlsZVBhdGgpKSB7XG5cdFx0XHR0aGlzLmFwcC52YXVsdC5jcmVhdGUoZGVmYXVsdEZpbGVQYXRoLCAnJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnRGVmYXVsdCBwcm9maWxlIGNyZWF0ZWQuJyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAudmF1bHQub24oJ2NyZWF0ZScsIGFzeW5jIChmaWxlOiBURmlsZSkgPT4ge1xuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLnBhdGguc3RhcnRzV2l0aChmb2xkZXJQYXRoKSkge1xuXHRcdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBmaWxlIGNvbnRlbnQgaXMgZW1wdHlcblx0XHRcdFx0aWYgKGZpbGVDb250ZW50LnRyaW0oKSA9PT0gJycpIHtcblx0XHRcdFx0XHQvLyBGaWxlIGNvbnRlbnQgaXMgZW1wdHksIHByb2NlZWQgd2l0aCBkZWZhdWx0IGZyb250IG1hdHRlciBhbmQgYXBwZW5kaW5nIGNvbnRlbnRcblx0XHRcdFx0XHRkZWZhdWx0RnJvbnRNYXR0ZXIodGhpcywgZmlsZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGZXRjaGluZyBmaWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZm9sZGVyIChwcm9maWxlcylcblx0XHRcdFx0Y29uc3QgcHJvZmlsZUZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGgpKTtcblxuXHRcdFx0XHQvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcblx0XHRcdFx0cHJvZmlsZUZpbGVzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xuXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeS5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHQvLyBFbnN1cmUgZWFjaCBwcm9maWxlIGhhcyBhIGNvcnJlc3BvbmRpbmcgZWxlbWVudCBpbiBsYXN0TG9hZGVkQ2hhdEhpc3Rvcnlcblx0XHRcdFx0XHRwcm9maWxlRmlsZXMuZm9yRWFjaCgocHJvZmlsZSwgaW5kZXgpID0+IHtcblx0XHRcdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbaW5kZXhdKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtpbmRleF0gPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeS5sZW5ndGggIT09IHByb2ZpbGVGaWxlcy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdC8vIEZpbmRpbmcgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50UHJvZmlsZSBpbiB0aGUgcHJvZmlsZUZpbGVzIGFycmF5XG5cdFx0XHRcdFx0XHRjb25zdCBwcm9maWxlSW5kZXggPSBwcm9maWxlRmlsZXMuZmluZEluZGV4KChwcm9maWxlRmlsZXMpID0+IHByb2ZpbGVGaWxlcy5iYXNlbmFtZSA9PT0gZmlsZS5iYXNlbmFtZSk7XG5cblx0XHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5LnNwbGljZShwcm9maWxlSW5kZXgsIDAsIG51bGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cblx0XHRcblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCBhc3luYyAoZmlsZTogVEZpbGUpID0+IHtcblx0XHRcdFx0Ly8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlciAocHJvZmlsZXMpXG5cdFx0XHRcdGNvbnN0IHByb2ZpbGVGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoKSk7XG5cblx0XHRcdFx0Ly8gU29ydGluZyB0aGUgZmlsZXMgYXJyYXkgYWxwaGFiZXRpY2FsbHkgYnkgZmlsZSBuYW1lXG5cdFx0XHRcdHByb2ZpbGVGaWxlcy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcblxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MuY2hhdEhpc3RvcnkuY2hhdEhpc3RvcnlQYXRoKSkge1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRQcm9maWxlID0gdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlLnJlcGxhY2UoL1xcLlteLy5dKyQvLCAnJyk7IC8vIFJlbW92aW5nIHRoZSBmaWxlIGV4dGVuc2lvblxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEZpbmRpbmcgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50UHJvZmlsZSBpbiB0aGUgcHJvZmlsZUZpbGVzIGFycmF5XG5cdFx0XHRcdFx0Y29uc3QgcHJvZmlsZUluZGV4ID0gcHJvZmlsZUZpbGVzLmZpbmRJbmRleCgoZmlsZSkgPT4gZmlsZS5iYXNlbmFtZSA9PT0gY3VycmVudFByb2ZpbGUpO1xuXG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudEluZGV4ID0gdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnkuaW5kZXhPZihmaWxlLnBhdGgpO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5W2N1cnJlbnRJbmRleF0gPT09IGZpbGUucGF0aCkge1xuXHRcdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbY3VycmVudEluZGV4XSA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHByb2ZpbGVJbmRleCA9PT0gY3VycmVudEluZGV4KSB7XG5cdFx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGggPSBudWxsO1xuXHRcdFx0XHRcdH0gXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKGZvbGRlclBhdGgpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZW5hbWVNZXNzYWdlSGlzdG9yeSA9ICcuLy5vYnNpZGlhbi9wbHVnaW5zL2Jtby1jaGF0Ym90L2RhdGEvJyArICdtZXNzYWdlSGlzdG9yeV8nICsgZmlsZS5uYW1lLnJlcGxhY2UoJy5tZCcsICcuanNvbicpO1xuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVtb3ZlKGZpbGVuYW1lTWVzc2FnZUhpc3RvcnkpO1xuXG5cdFx0XHRcdFx0Y29uc3QgcHJvZmlsZUluZGV4ID0gcHJvZmlsZUZpbGVzLmZpbmRJbmRleCgocHJvZmlsZUZpbGUpID0+IHByb2ZpbGVGaWxlLm5hbWUgPiBmaWxlLm5hbWUpO1xuXG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3Rvcnkuc3BsaWNlKHByb2ZpbGVJbmRleCwgMSk7XG5cblx0XHRcdFx0XHRpZiAoZmlsZS5wYXRoID09PSBkZWZhdWx0RmlsZVBhdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MgPSBERUZBVUxUX1NFVFRJTkdTO1xuXHRcdFx0XHRcdFx0dGhpcy5hcHAudmF1bHQuY3JlYXRlKGRlZmF1bHRGaWxlUGF0aCwgJycpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIodGhpcywgZGVmYXVsdFByb2ZpbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUgPT09IGZpbGUubmFtZSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUgPSBERUZBVUxUX1NFVFRJTkdTLnByb2ZpbGVzLnByb2ZpbGU7XG5cblx0XHRcdFx0XHRcdFx0Ly8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlciAocHJvZmlsZXMpXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHByb2ZpbGVGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoKSk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gU29ydGluZyB0aGUgZmlsZXMgYXJyYXkgYWxwaGFiZXRpY2FsbHkgYnkgZmlsZSBuYW1lXG5cdFx0XHRcdFx0XHRcdHByb2ZpbGVGaWxlcy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Y29uc3QgY3VycmVudFByb2ZpbGUgPSB0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIEZpbmRpbmcgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50UHJvZmlsZSBpbiB0aGUgcHJvZmlsZUZpbGVzIGFycmF5XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHByb2ZpbGVJbmRleCA9IHByb2ZpbGVGaWxlcy5maW5kSW5kZXgoKGZpbGUpID0+IGZpbGUuYmFzZW5hbWUgPT09IGN1cnJlbnRQcm9maWxlKTtcblxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoID0gdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbcHJvZmlsZUluZGV4XTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gKGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZGVmYXVsdFByb2ZpbGUpKS5yZXBsYWNlKC9eLS0tXFxzKltcXHNcXFNdKj8tLS0vLCAnJykudHJpbSgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgPSBmaWxlQ29udGVudDtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIodGhpcywgZGVmYXVsdFByb2ZpbGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fVxuXHRcdCkpO1xuXG5cdFx0Ly8gVXBkYXRlIGZyb250bWF0dGVyIHdoZW4gdGhlIHByb2ZpbGUgZmlsZSBpcyBtb2RpZmllZFxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCBhc3luYyAoZmlsZTogVEZpbGUpID0+IHtcblx0XHRcdFx0Y29uc3QgY3VycmVudFByb2ZpbGVQYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHt0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGV9YDtcblx0XHRcdFx0aWYgKGZpbGUucGF0aCA9PT0gY3VycmVudFByb2ZpbGVQYXRoKSB7XG5cdFx0XHRcdFx0YXdhaXQgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIodGhpcywgZmlsZSk7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSAoYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKSkucmVwbGFjZSgvXi0tLVxccypbXFxzXFxTXSo/LS0tLywgJycpLnRyaW0oKTtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgPSBmaWxlQ29udGVudDtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5vbigncmVuYW1lJywgYXN5bmMgKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50UHJvZmlsZVBhdGggPSBgJHtmb2xkZXJQYXRofS8ke3RoaXMuc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZX1gO1xuXHRcdFx0XHRcdGlmIChvbGRQYXRoID09PSBjdXJyZW50UHJvZmlsZVBhdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZSA9IGZpbGUubmFtZTtcblx0XHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoZm9sZGVyUGF0aCkpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVuYW1lTWVzc2FnZUhpc3RvcnlQYXRoID0gJy4vLm9ic2lkaWFuL3BsdWdpbnMvYm1vLWNoYXRib3QvZGF0YS8nO1xuXHRcdFx0XHRcdFx0Y29uc3Qgb2xkUHJvZmlsZU1lc3NhZ2VIaXN0b3J5ID0gJ21lc3NhZ2VIaXN0b3J5XycgKyBvbGRQYXRoLnJlcGxhY2UoZm9sZGVyUGF0aCArICcvJywgJycpLnJlcGxhY2UoJy5tZCcsICcuanNvbicpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZW5hbWUoZmlsZW5hbWVNZXNzYWdlSGlzdG9yeVBhdGggKyBvbGRQcm9maWxlTWVzc2FnZUhpc3RvcnksIGZpbGVuYW1lTWVzc2FnZUhpc3RvcnlQYXRoICsgJ21lc3NhZ2VIaXN0b3J5XycgKyBmaWxlLm5hbWUucmVwbGFjZSgnLm1kJywgJy5qc29uJykpXG5cdFx0XHRcdFx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIHJlbmFtZSBldmVudDonLCBlcnJvcik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVtb3ZlKGZpbGVuYW1lTWVzc2FnZUhpc3RvcnlQYXRoICsgb2xkUHJvZmlsZU1lc3NhZ2VIaXN0b3J5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0aWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOT0VOVDogbm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeSwgdW5saW5rJykpIHtcblx0XHRcdFx0XHRcdC8vIElnbm9yZSB0aGUgc3BlY2lmaWMgZXJyb3IgYW5kIGRvIG5vdGhpbmdcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaGFuZGxpbmcgcmVuYW1lIGV2ZW50OicsIGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGZXRjaGluZyBmaWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZm9sZGVyIChwcm9maWxlcylcblx0XHRcdFx0Y29uc3QgcHJvZmlsZUZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGgpKTtcblxuXHRcdFx0XHQvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcblx0XHRcdFx0cHJvZmlsZUZpbGVzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xuXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRJbmRleCA9IHByb2ZpbGVGaWxlcy5maW5kSW5kZXgoKHByb2ZpbGVGaWxlKSA9PiBwcm9maWxlRmlsZS5wYXRoID09PSBmaWxlLnBhdGgpO1xuXG5cdFx0XHRcdGNvbnN0IHByZXZGaWxlTmFtZSA9IG9sZFBhdGgucmVwbGFjZShmb2xkZXJQYXRoICsgJy8nLCAnJyk7XG5cblx0XHRcdFx0Ly8gQ3JlYXRlIGEgbmV3IGFycmF5IHdpdGggcHJldkZpbGVOYW1lIGFkZGVkXG5cdFx0XHRcdGNvbnN0IHVwZGF0ZWRQcm9maWxlRmlsZXMgPSBbLi4ucHJvZmlsZUZpbGVzLCB7IG5hbWU6IHByZXZGaWxlTmFtZSB9XTtcblxuXHRcdFx0XHQvLyBTb3J0IHRoZSB1cGRhdGVkIGFycmF5XG5cdFx0XHRcdHVwZGF0ZWRQcm9maWxlRmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cblx0XHRcdFx0Y29uc3QgZmlsZUluZGV4ID0gdXBkYXRlZFByb2ZpbGVGaWxlcy5maW5kSW5kZXgoKHByb2ZpbGVGaWxlKSA9PiBwcm9maWxlRmlsZS5uYW1lID09PSBmaWxlLm5hbWUpO1xuXG5cdFx0XHRcdC8vIFJlbW92ZSB0aGUgY3VycmVudEluZGV4IGZyb20gdGhlIHVwZGF0ZWQgYXJyYXlcblx0XHRcdFx0aWYgKGZpbGVJbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0XHR1cGRhdGVkUHJvZmlsZUZpbGVzLnNwbGljZShmaWxlSW5kZXgsIDEpO1xuXHRcdFx0XHR9IFxuXG5cdFx0XHRcdGNvbnN0IHByZXZJbmRleCA9IHVwZGF0ZWRQcm9maWxlRmlsZXMuZmluZEluZGV4KChwcm9maWxlRmlsZSkgPT4gcHJvZmlsZUZpbGUubmFtZSA9PT0gcHJldkZpbGVOYW1lKTtcblxuXHRcdFx0XHRpZiAoY3VycmVudEluZGV4ICE9PSAtMSkge1xuXHRcdFx0XHRcdGNvbnN0IFtyZW1vdmVkXSA9IHRoaXMuc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5LnNwbGljZShwcmV2SW5kZXgsIDEpO1xuXHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5LnNwbGljZShjdXJyZW50SW5kZXgsIDAsIHJlbW92ZWQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgY3VycmVudFByb2ZpbGUgPSB0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG5cdFx0XHRcdFx0XG5cdFx0XHRcdC8vIEZpbmRpbmcgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50UHJvZmlsZSBpbiB0aGUgcHJvZmlsZUZpbGVzIGFycmF5XG5cdFx0XHRcdGNvbnN0IHByb2ZpbGVJbmRleCA9IHByb2ZpbGVGaWxlcy5maW5kSW5kZXgoKGZpbGUpID0+IGZpbGUuYmFzZW5hbWUgPT09IGN1cnJlbnRQcm9maWxlKTtcblxuXG5cdFx0XHRcdC8vIC8vIEZpbmQgYW5kIHJlcGxhY2UgdGhlIG9sZFBhdGggd2l0aCB0aGUgbmV3IHBhdGggaW4gbGFzdExvYWRlZENoYXRIaXN0b3J5XG5cdFx0XHRcdGNvbnN0IGluZGV4ID0gdGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnkuaW5kZXhPZihvbGRQYXRoKTtcblxuXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtwcm9maWxlSW5kZXhdID09PSBvbGRQYXRoKSB7XG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbaW5kZXhdID0gZmlsZS5wYXRoO1xuXHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aCA9IGZpbGUucGF0aDtcblx0XHRcdFx0fSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtpbmRleF0gPT09IG9sZFBhdGgpIHtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtpbmRleF0gPSBmaWxlLnBhdGg7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fSlcblx0XHQpO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRmlsZVN3aXRjaCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0VklFV19UWVBFX0NIQVRCT1QsXG5cdFx0XHQobGVhZikgPT4gbmV3IEJNT1ZpZXcobGVhZiwgdGhpcy5zZXR0aW5ncywgdGhpcylcblx0XHQpO1xuXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKCdib3QnLCAnQk1PIENoYXRib3QnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnb3Blbi1ibW8tY2hhdGJvdCcsXG4gICAgICAgICAgICBuYW1lOiAnT3BlbiBCTU8gQ2hhdGJvdCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaG90a2V5czogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bW9kaWZpZXJzOiBbJ01vZCddLFxuXHRcdFx0XHRcdGtleTogJzAnLFxuXHRcdFx0XHR9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdyZW5hbWUtbm90ZS10aXRsZScsXG4gICAgICAgICAgICBuYW1lOiAnUmVuYW1lIE5vdGUgVGl0bGUnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0cmVuYW1lVGl0bGVDb21tYW5kKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdGtleXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG1vZGlmaWVyczogWydNb2QnXSxcblx0XHRcdFx0XHRrZXk6ICdcXCcnLFxuXHRcdFx0XHR9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBmaWxlKSA9PiB7XG5cdFx0XHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW1cblx0XHRcdFx0XHRcdC5zZXRUaXRsZSgnQk1PIENoYXRib3Q6IEdlbmVyYXRlIG5ldyB0aXRsZScpXG5cdFx0XHRcdFx0XHQub25DbGljaygoKSA9PiByZW5hbWVUaXRsZUNvbW1hbmQodGhpcywgdGhpcy5zZXR0aW5ncykpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3Byb21wdC1zZWxlY3QtZ2VuZXJhdGUnLFxuICAgICAgICAgICAgbmFtZTogJ1Byb21wdCBTZWxlY3QgR2VuZXJhdGUnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0cHJvbXB0U2VsZWN0R2VuZXJhdGVDb21tYW5kKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdGtleXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG1vZGlmaWVyczogWydNb2QnLCAnU2hpZnQnXSxcblx0XHRcdFx0XHRrZXk6ICc9Jyxcblx0XHRcdFx0fSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuXG5cdFx0Ly8gUmVnaXN0ZXIgQk1PIGNvZGUgYmxvY2sgcHJvY2Vzc29yXG5cdFx0Ym1vQ29kZUJsb2NrUHJvY2Vzc29yKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xuXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBCTU9TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdH1cblxuXHRoYW5kbGVGaWxlU3dpdGNoKCkge1xuXHRcdGNoZWNrQWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdH1cblxuXHRhc3luYyBvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DSEFUQk9UKS5mb3JFYWNoKChsZWFmKSA9PiB7XG5cdFx0XHRjb25zdCBibW9WaWV3ID0gbGVhZi52aWV3IGFzIEJNT1ZpZXc7XG5cdFxuXHRcdFx0aWYgKGJtb1ZpZXcpIHtcblx0XHRcdFx0dGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdH0pO1xuXHRcdFxuXHR9XG5cblx0YXN5bmMgYWN0aXZhdGVWaWV3KCkge1xuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NIQVRCT1QpO1xuXHRcblx0XHRjb25zdCByaWdodExlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcblx0XHRhd2FpdCByaWdodExlYWY/LnNldFZpZXdTdGF0ZSh7XG5cdFx0XHR0eXBlOiBWSUVXX1RZUEVfQ0hBVEJPVCxcblx0XHRcdGFjdGl2ZTogdHJ1ZSxcblx0XHR9KTtcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfQ0hBVEJPVClbMF1cblx0XHQpO1xuXHRcblx0XHQvLyBGb2N1cyBvbiB0aGUgdGV4dGFyZWFcblx0XHRjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym94IHRleHRhcmVhJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcblx0XG5cdFx0aWYgKHRleHRhcmVhKSB7XG5cdFx0XHR0ZXh0YXJlYS5zdHlsZS5vcGFjaXR5ID0gJzAnO1xuXHRcdFx0dGV4dGFyZWEuc3R5bGUudHJhbnNpdGlvbiA9ICdvcGFjaXR5IDFzIGVhc2UtaW4tb3V0Jztcblx0XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGV4dGFyZWEuZm9jdXMoKTtcblx0XHRcdFx0dGV4dGFyZWEuc3R5bGUub3BhY2l0eSA9ICcxJztcblx0XHRcdH0sIDUwKTsgXG5cdFx0fVxuXHRcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NIQVRCT1QpWzBdXG5cdFx0KTtcblx0XG5cdFx0Y29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG5cdFx0aWYgKG1lc3NhZ2VDb250YWluZXIpIHtcblx0XHRcdG1lc3NhZ2VDb250YWluZXIuc2Nyb2xsKHtcblx0XHRcdFx0dG9wOiBtZXNzYWdlQ29udGFpbmVyLnNjcm9sbEhlaWdodCwgXG5cdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJyBcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRcblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgY3VycmVudFByb2ZpbGVGaWxlID0gYCR7dGhpcy5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aH0vJHt0aGlzLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGV9YFxuXHRcdGNvbnN0IGN1cnJlbnRQcm9maWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGN1cnJlbnRQcm9maWxlRmlsZSkgYXMgVEZpbGU7XG5cdFx0dXBkYXRlRnJvbnRNYXR0ZXIodGhpcywgY3VycmVudFByb2ZpbGUpO1xuXG5cdFx0Ly8gVXBkYXRlIHRoZSBtb2RlbCBkcm9wZG93biBpbiB0aGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hlYWRlcicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdGNvbnN0IG1vZGVsT3B0aW9ucyA9IGhlYWRlcj8ucXVlcnlTZWxlY3RvcignI21vZGVsT3B0aW9ucycpO1xuXHRcdGlmIChtb2RlbE9wdGlvbnMpIHtcblx0XHRcdG1vZGVsT3B0aW9ucy5yZW1vdmUoKTtcblx0XHR9XG5cdFx0Y29uc3QgcG9wdWxhdGVNb2RlbE9wdGlvbnMgPSBwb3B1bGF0ZU1vZGVsRHJvcGRvd24odGhpcywgdGhpcy5zZXR0aW5ncyk7XG5cdFx0aGVhZGVyPy5hcHBlbmRDaGlsZChwb3B1bGF0ZU1vZGVsT3B0aW9ucyk7XG5cblx0XHQvLyBTYXZlIHRoZSBzZXR0aW5nc1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlZmF1bHRGcm9udE1hdHRlcihwbHVnaW46IEJNT0dQVCwgZmlsZTogVEZpbGUpIHtcbiAgICAvLyBEZWZpbmUgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGZyb250bWF0dGVyXG4gICAgY29uc3Qgc2V0RGVmYXVsdEZyb250TWF0dGVyID0gYXN5bmMgKGZyb250bWF0dGVyOiBhbnkpID0+IHtcbiAgICAgICAgLy8gQWRkIG9yIG1vZGlmeSBwcm9wZXJ0aWVzIGluIHRoZSBmcm9udG1hdHRlclxuICAgICAgICBmcm9udG1hdHRlci5tb2RlbCA9IERFRkFVTFRfU0VUVElOR1MuZ2VuZXJhbC5tb2RlbDtcbiAgICAgICAgZnJvbnRtYXR0ZXIubWF4X3Rva2VucyA9IHBhcnNlSW50KERFRkFVTFRfU0VUVElOR1MuZ2VuZXJhbC5tYXhfdG9rZW5zKTtcbiAgICAgICAgZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPSBwYXJzZUZsb2F0KERFRkFVTFRfU0VUVElOR1MuZ2VuZXJhbC50ZW1wZXJhdHVyZSk7XG4gICAgICAgIGZyb250bWF0dGVyLmVuYWJsZV9yZWZlcmVuY2VfY3VycmVudF9ub3RlID0gREVGQVVMVF9TRVRUSU5HUy5nZW5lcmFsLmVuYWJsZVJlZmVyZW5jZUN1cnJlbnROb3RlO1xuXHRcdGZyb250bWF0dGVyLnByb21wdCA9IERFRkFVTFRfU0VUVElOR1MucHJvbXB0cy5wcm9tcHQ7XG5cdFx0ZnJvbnRtYXR0ZXIudXNlcl9uYW1lID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLnVzZXJOYW1lO1xuXHRcdC8vIGZyb250bWF0dGVyLmNoYXRib3RfbmFtZSA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZTtcblx0XHRmcm9udG1hdHRlci5lbmFibGVfaGVhZGVyID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmVuYWJsZUhlYWRlcjtcblx0XHRmcm9udG1hdHRlci5jaGF0Ym90X2NvbnRhaW5lcl9iYWNrZ3JvdW5kX2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIubWVzc2FnZV9jb250YWluZXJfYmFja2dyb3VuZF9jb2xvciA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9mb250X2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9iYWNrZ3JvdW5kX2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmJvdF9tZXNzYWdlX2ZvbnRfY29sb3IgPSBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvci5yZXBsYWNlKC9eIy8sICcnKTtcblx0XHRmcm9udG1hdHRlci5jaGF0Ym90X21lc3NhZ2VfYmFja2dyb3VuZF9jb2xvciA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmNoYXRib3hfZm9udF9jb2xvciA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Qm94Rm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmNoYXRib3hfYmFja2dyb3VuZF9jb2xvciA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9iYWNrZ3JvdW5kX2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9mb250X2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlRm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLnN5c3Rlbl9yb2xlID0gREVGQVVMVF9TRVRUSU5HUy5lZGl0b3Iuc3lzdGVuX3JvbGU7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0ID0gcGFyc2VGbG9hdChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0X2V0YSA9IHBhcnNlRmxvYXQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfZXRhKTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfdGF1ID0gcGFyc2VGbG9hdChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF90YXUpO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9udW1fY3R4ID0gcGFyc2VJbnQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2N0eCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX251bV9ncWEgPSBwYXJzZUludChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fZ3FhKTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfbnVtX3RocmVhZCA9IHBhcnNlSW50KERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQpO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9yZXBlYXRfbGFzdF9uID0gcGFyc2VJbnQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3Rfbik7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3JlcGVhdF9wZW5hbHR5ID0gcGFyc2VGbG9hdChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfcGVuYWx0eSk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3NlZWQgPSBwYXJzZUludChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkKTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfc3RvcCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnN0b3A7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3Rmc196ID0gcGFyc2VGbG9hdChERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50ZnNfeik7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3RvcF9rID0gcGFyc2VJbnQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX2spO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV90b3BfcCA9IHBhcnNlRmxvYXQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3ApO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9taW5fcCA9IHBhcnNlRmxvYXQoREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3ApO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9rZWVwX2FsaXZlID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMua2VlcF9hbGl2ZTtcbiAgICB9O1xuXG4gICAgLy8gT3B0aW9uYWw6IFNwZWNpZnkgZGF0YSB3cml0ZSBvcHRpb25zXG4gICAgY29uc3Qgd3JpdGVPcHRpb25zOiBEYXRhV3JpdGVPcHRpb25zID0ge1xuICAgICAgICAvLyBTcGVjaWZ5IG9wdGlvbnMgaWYgbmVlZGVkXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHBsdWdpbi5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIHNldERlZmF1bHRGcm9udE1hdHRlciwgd3JpdGVPcHRpb25zKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgZnJvbnRtYXR0ZXI6JywgZXJyb3IpO1xuICAgIH1cblxuXHRwbHVnaW4uYXBwLnZhdWx0LmFwcGVuZChmaWxlLCBERUZBVUxUX1NFVFRJTkdTLmdlbmVyYWwuc3lzdGVtX3JvbGUpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIocGx1Z2luOiBCTU9HUFQsIGZpbGU6IFRGaWxlKXtcbiAgICAvLyBEZWZpbmUgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGZyb250bWF0dGVyXG4gICAgY29uc3QgdXBkYXRlU2V0dGluZ3MgPSBhc3luYyAoZnJvbnRtYXR0ZXI6IGFueSkgPT4ge1xuICAgICAgICAvLyBBZGQgb3IgbW9kaWZ5IHByb3BlcnRpZXMgaW4gdGhlIGZyb250bWF0dGVyXG4gICAgICAgIHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID0gZnJvbnRtYXR0ZXIubW9kZWw7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucyA9IGZyb250bWF0dGVyLm1heF90b2tlbnM7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUgPSBmcm9udG1hdHRlci50ZW1wZXJhdHVyZTtcblx0XHRwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5lbmFibGVSZWZlcmVuY2VDdXJyZW50Tm90ZSA9IGZyb250bWF0dGVyLmVuYWJsZV9yZWZlcmVuY2VfY3VycmVudF9ub3RlO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5wcm9tcHRzLnByb21wdCA9IGZyb250bWF0dGVyLnByb21wdDtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTmFtZSA9IGZyb250bWF0dGVyLnVzZXJfbmFtZTtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuZW5hYmxlSGVhZGVyID0gZnJvbnRtYXR0ZXIuZW5hYmxlX2hlYWRlcjtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIuY2hhdGJvdF9jb250YWluZXJfYmFja2dyb3VuZF9jb2xvcjtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIubWVzc2FnZV9jb250YWluZXJfYmFja2dyb3VuZF9jb2xvcjtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUZvbnRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9mb250X2NvbG9yO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIudXNlcl9tZXNzYWdlX2JhY2tncm91bmRfY29sb3I7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmJvdF9tZXNzYWdlX2ZvbnRfY29sb3I7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmNoYXRib3RfbWVzc2FnZV9iYWNrZ3JvdW5kX2NvbG9yO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hGb250Q29sb3IgPSAnIycgKyBmcm9udG1hdHRlci5jaGF0Ym94X2ZvbnRfY29sb3I7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmNoYXRib3hfYmFja2dyb3VuZF9jb2xvcjtcblx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ibW9HZW5lcmF0ZUJhY2tncm91bmRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9iYWNrZ3JvdW5kX2NvbG9yO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlRm9udENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIuYm1vX2dlbmVyYXRlX2ZvbnRfY29sb3I7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmVkaXRvci5zeXN0ZW5fcm9sZSA9IGZyb250bWF0dGVyLnN5c3Rlbl9yb2xlO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXQgPSBmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXQ7XG5cdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGEgPSBmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfZXRhO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1ID0gZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0X3RhdTtcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9jdHggPSBmcm9udG1hdHRlci5vbGxhbWFfbnVtX2N0eDtcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9ncWEgPSBmcm9udG1hdHRlci5vbGxhbWFfbnVtX2dxYTtcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQgPSBmcm9udG1hdHRlci5vbGxhbWFfbnVtX3RocmVhZDtcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9sYXN0X24gPSBmcm9udG1hdHRlci5vbGxhbWFfcmVwZWF0X2xhc3Rfbjtcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9wZW5hbHR5ID0gZnJvbnRtYXR0ZXIub2xsYW1hX3JlcGVhdF9wZW5hbHR5O1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc2VlZCA9IGZyb250bWF0dGVyLm9sbGFtYV9zZWVkO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc3RvcCA9IGZyb250bWF0dGVyLm9sbGFtYV9zdG9wO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3ogPSBmcm9udG1hdHRlci5vbGxhbWFfdGZzX3o7XG5cdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfayA9IGZyb250bWF0dGVyLm9sbGFtYV90b3Bfaztcblx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9wID0gZnJvbnRtYXR0ZXIub2xsYW1hX3RvcF9wO1xuXHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3AgPSBmcm9udG1hdHRlci5vbGxhbWFfbWluX3A7XG5cdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5rZWVwX2FsaXZlID0gZnJvbnRtYXR0ZXIub2xsYW1hX2tlZXBfYWxpdmU7XG4gICAgfTtcblxuICAgIC8vIE9wdGlvbmFsOiBTcGVjaWZ5IGRhdGEgd3JpdGUgb3B0aW9uc1xuICAgIGNvbnN0IHdyaXRlT3B0aW9uczogRGF0YVdyaXRlT3B0aW9ucyA9IHtcbiAgICAgICAgLy8gU3BlY2lmeSBvcHRpb25zIGlmIG5lZWRlZFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCB1cGRhdGVTZXR0aW5ncywgd3JpdGVPcHRpb25zKTtcblx0XHRjb25zdCBmaWxlQ29udGVudCA9IChhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSkpLnJlcGxhY2UoL14tLS1cXHMqW1xcc1xcU10qPy0tLS8sICcnKS50cmltKCk7XG5cdFx0cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgPSBmaWxlQ29udGVudDtcblx0XHR1cGRhdGVQcm9maWxlKHBsdWdpbiwgZmlsZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIGZyb250bWF0dGVyOicsIGVycm9yKTtcbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVGcm9udE1hdHRlcihwbHVnaW46IEJNT0dQVCwgZmlsZTogVEZpbGUpe1xuICAgIC8vIERlZmluZSBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIG1vZGlmeSB0aGUgZnJvbnRtYXR0ZXJcbiAgICBjb25zdCBtb2RpZnlGcm9udE1hdHRlciA9IGFzeW5jIChmcm9udG1hdHRlcjogYW55KSA9PiB7XG4gICAgICAgIC8vIEFkZCBvciBtb2RpZnkgcHJvcGVydGllcyBpbiB0aGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgZnJvbnRtYXR0ZXIubW9kZWwgPSBwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbDtcbiAgICAgICAgZnJvbnRtYXR0ZXIubWF4X3Rva2VucyA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpO1xuICAgICAgICBmcm9udG1hdHRlci50ZW1wZXJhdHVyZSA9IHBhcnNlRmxvYXQocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpO1xuICAgICAgICBmcm9udG1hdHRlci5lbmFibGVfcmVmZXJlbmNlX2N1cnJlbnRfbm90ZSA9IHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmVuYWJsZVJlZmVyZW5jZUN1cnJlbnROb3RlO1xuXHRcdGZyb250bWF0dGVyLnByb21wdCA9IHBsdWdpbi5zZXR0aW5ncy5wcm9tcHRzLnByb21wdC5yZXBsYWNlKCcubWQnLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIudXNlcl9uYW1lID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck5hbWU7XG5cdFx0Ly8gZnJvbnRtYXR0ZXIuY2hhdGJvdF9uYW1lID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWU7XG5cdFx0ZnJvbnRtYXR0ZXIuZW5hYmxlX2hlYWRlciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmVuYWJsZUhlYWRlcjtcblx0XHRmcm9udG1hdHRlci5jaGF0Ym90X2NvbnRhaW5lcl9iYWNrZ3JvdW5kX2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvci5yZXBsYWNlKC9eIy8sICcnKTtcblx0XHRmcm9udG1hdHRlci5tZXNzYWdlX2NvbnRhaW5lcl9iYWNrZ3JvdW5kX2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvci5yZXBsYWNlKC9eIy8sICcnKTtcblx0XHRmcm9udG1hdHRlci51c2VyX21lc3NhZ2VfZm9udF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9iYWNrZ3JvdW5kX2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIuYm90X21lc3NhZ2VfZm9udF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIuY2hhdGJvdF9tZXNzYWdlX2JhY2tncm91bmRfY29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmNoYXRib3hfZm9udF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hGb250Q29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIuY2hhdGJveF9iYWNrZ3JvdW5kX2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvci5yZXBsYWNlKC9eIy8sICcnKTtcblx0XHRmcm9udG1hdHRlci5ibW9fZ2VuZXJhdGVfYmFja2dyb3VuZF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9mb250X2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0ZnJvbnRtYXR0ZXIuc3lzdGVuX3JvbGUgPSBwbHVnaW4uc2V0dGluZ3MuZWRpdG9yLnN5c3Rlbl9yb2xlO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9taXJvc3RhdCA9IHBhcnNlRmxvYXQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0X2V0YSA9IHBhcnNlRmxvYXQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGEpO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9taXJvc3RhdF90YXUgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1KTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfbnVtX2N0eCA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2N0eCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX251bV9ncWEgPSBwYXJzZUludChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9ncWEpO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9udW1fdGhyZWFkID0gcGFyc2VJbnQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fdGhyZWFkKTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfcmVwZWF0X2xhc3RfbiA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3Rfbik7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3JlcGVhdF9wZW5hbHR5ID0gcGFyc2VGbG9hdChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9wZW5hbHR5KTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfc2VlZCA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc2VlZCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3N0b3AgPSBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnN0b3A7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3Rmc196ID0gcGFyc2VGbG9hdChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRmc196KTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfdG9wX2sgPSBwYXJzZUludChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rKTtcblx0XHRmcm9udG1hdHRlci5vbGxhbWFfdG9wX3AgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3ApO1xuXHRcdGZyb250bWF0dGVyLm9sbGFtYV9taW5fcCA9IHBhcnNlRmxvYXQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taW5fcCk7XG5cdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX2tlZXBfYWxpdmUgPSBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLmtlZXBfYWxpdmU7XG4gICAgfTtcblxuICAgIC8vIE9wdGlvbmFsOiBTcGVjaWZ5IGRhdGEgd3JpdGUgb3B0aW9uc1xuICAgIGNvbnN0IHdyaXRlT3B0aW9uczogRGF0YVdyaXRlT3B0aW9ucyA9IHtcbiAgICAgICAgLy8gU3BlY2lmeSBvcHRpb25zIGlmIG5lZWRlZFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCBtb2RpZnlGcm9udE1hdHRlciwgd3JpdGVPcHRpb25zKTtcblx0XHR1cGRhdGVQcm9maWxlKHBsdWdpbiwgZmlsZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIGZyb250bWF0dGVyOicsIGVycm9yKTtcbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9maWxlKHBsdWdpbjogQk1PR1BULCBmaWxlOiBURmlsZSkge1xuXHR0cnkge1xuXHRcdGF3YWl0IHBsdWdpbi5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIChmcm9udG1hdHRlcjogYW55KSA9PiB7XG5cblx0XHRcdHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID0gZnJvbnRtYXR0ZXIubW9kZWwgfHwgREVGQVVMVF9TRVRUSU5HUy5nZW5lcmFsLm1vZGVsO1xuXG5cdFx0XHRpZiAoZnJvbnRtYXR0ZXIubWF4X3Rva2Vucykge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zID0gZnJvbnRtYXR0ZXIubWF4X3Rva2Vucy50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5tYXhfdG9rZW5zID0gcGFyc2VJbnQocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2Vucyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zID0gREVGQVVMVF9TRVRUSU5HUy5nZW5lcmFsLm1heF90b2tlbnM7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChmcm9udG1hdHRlci50ZW1wZXJhdHVyZSkge1xuXHRcdFx0XHRpZiAoZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPCAwKSB7XG5cdFx0XHRcdFx0ZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPSAnMC4wMCc7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPiAyKSB7XG5cdFx0XHRcdFx0ZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPSAnMi4wMCc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUgPSBwYXJzZUZsb2F0KGZyb250bWF0dGVyLnRlbXBlcmF0dXJlKS50b0ZpeGVkKDIpLnRvU3RyaW5nKCk7XG5cdFx0XHRcdFx0ZnJvbnRtYXR0ZXIudGVtcGVyYXR1cmUgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUgPSBERUZBVUxUX1NFVFRJTkdTLmdlbmVyYWwudGVtcGVyYXR1cmU7XG5cdFx0XHRcdGZyb250bWF0dGVyLnRlbXBlcmF0dXJlID0gREVGQVVMVF9TRVRUSU5HUy5nZW5lcmFsLnRlbXBlcmF0dXJlO1xuXHRcdFx0fVxuXG5cdFx0XHRwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5lbmFibGVSZWZlcmVuY2VDdXJyZW50Tm90ZSA9IGZyb250bWF0dGVyLmVuYWJsZV9yZWZlcmVuY2VfY3VycmVudF9ub3RlO1xuXG5cdFx0XHRjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmZXJlbmNlQ3VycmVudE5vdGUnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChyZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQpIHtcblx0XHRcdFx0aWYgKGZyb250bWF0dGVyLmVuYWJsZV9yZWZlcmVuY2VfY3VycmVudF9ub3RlID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0cmVmZXJlbmNlQ3VycmVudE5vdGVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChmcm9udG1hdHRlci5wcm9tcHQgJiYgKGZyb250bWF0dGVyLnByb21wdCAhPT0gJycpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5wcm9tcHRzLnByb21wdCA9IGZyb250bWF0dGVyLnByb21wdCArICcubWQnXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MucHJvbXB0cy5wcm9tcHQgPSBERUZBVUxUX1NFVFRJTkdTLnByb21wdHMucHJvbXB0O1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZnJvbnRtYXR0ZXIudXNlcl9uYW1lKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJOYW1lID0gZnJvbnRtYXR0ZXIudXNlcl9uYW1lLnN1YnN0cmluZygwLCAzMCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTmFtZSA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS51c2VyTmFtZTtcblx0XHRcdH1cblx0XHRcdGZyb250bWF0dGVyLnVzZXJfbmFtZSA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJOYW1lO1xuXG5cdFx0XHRjb25zdCB1c2VyTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudXNlck5hbWUnKSBhcyBOb2RlTGlzdE9mPEhUTUxIZWFkaW5nRWxlbWVudD47XG5cdFx0XHR1c2VyTmFtZXMuZm9yRWFjaCh1c2VyTmFtZSA9PiB7XG5cdFx0XHRcdHVzZXJOYW1lLnRleHRDb250ZW50ID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck5hbWU7XG5cdFx0XHR9KTtcblxuXG5cdFx0XHQvLyBpZiAoZnJvbnRtYXR0ZXIuY2hhdGJvdF9uYW1lKSB7XG5cdFx0XHRcdC8vIHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lID0gZnJvbnRtYXR0ZXIuY2hhdGJvdF9uYW1lLnRvVXBwZXJDYXNlKCkuc3Vic3RyaW5nKDAsIDMwKTtcblx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHQvLyBcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lO1xuXHRcdFx0Ly8gfVxuXHRcdFx0Ly8gZnJvbnRtYXR0ZXIuY2hhdGJvdF9uYW1lID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWU7XG5cblx0XHRcdGNvbnN0IGNoYXRib3ROYW1lSGVhZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjaGF0Ym90TmFtZUhlYWRpbmcnKSBhcyBIVE1MSGVhZGluZ0VsZW1lbnQ7XG5cdFx0XHRjb25zdCBjaGF0Ym90TmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2hhdGJvdE5hbWUnKSBhcyBOb2RlTGlzdE9mPEhUTUxIZWFkaW5nRWxlbWVudD47XG5cdFx0XHRpZiAoY2hhdGJvdE5hbWVIZWFkaW5nKSB7XG5cdFx0XHRcdGNoYXRib3ROYW1lSGVhZGluZy50ZXh0Q29udGVudCA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lO1xuXHRcdFx0fVxuXHRcdFx0Y2hhdGJvdE5hbWVzLmZvckVhY2goY2hhdGJvdE5hbWUgPT4ge1xuXHRcdFx0XHRjaGF0Ym90TmFtZS50ZXh0Q29udGVudCA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IGNoYXRib3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdENvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0Y29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTEVsZW1lbnQ7XG5cblx0XHRcdGlmIChpc1ZhbGlkSGV4Q29sb3IoZnJvbnRtYXR0ZXIuY2hhdGJvdF9jb250YWluZXJfYmFja2dyb3VuZF9jb2xvcikpIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmNoYXRib3RfY29udGFpbmVyX2JhY2tncm91bmRfY29sb3Iuc3Vic3RyaW5nKDAsIDYpO1xuXHRcdFx0XHRpZiAoY2hhdGJvdENvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNoYXRib3RDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvciA9IGNvbG9yVG9IZXgoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3IpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5jaGF0Ym90X2NvbnRhaW5lcl9iYWNrZ3JvdW5kX2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvci5yZXBsYWNlKC9eIy8sICcnKTtcblx0XHRcdFx0aWYgKGNoYXRib3RDb250YWluZXIpIHtcblx0XHRcdFx0XHRjb25zdCBkZWZhdWx0Q2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvcikudHJpbSgpO1xuXHRcdFx0XHRcdGNoYXRib3RDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdENoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGlzVmFsaWRIZXhDb2xvcihmcm9udG1hdHRlci5tZXNzYWdlX2NvbnRhaW5lcl9iYWNrZ3JvdW5kX2NvbG9yKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIubWVzc2FnZV9jb250YWluZXJfYmFja2dyb3VuZF9jb2xvci5zdWJzdHJpbmcoMCwgNik7XG5cdFx0XHRcdGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0bWVzc2FnZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvcik7XG5cdFx0XHRcdGZyb250bWF0dGVyLm1lc3NhZ2VfY29udGFpbmVyX2JhY2tncm91bmRfY29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRNZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yKS50cmltKCk7XG5cdFx0XHRcdFx0bWVzc2FnZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBkZWZhdWx0TWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNWYWxpZEhleENvbG9yKGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9mb250X2NvbG9yKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUZvbnRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLnVzZXJfbWVzc2FnZV9mb250X2NvbG9yLnN1YnN0cmluZygwLCA2KTtcblx0XHRcdFx0aWYgKG1lc3NhZ2VDb250YWluZXIpIHtcblx0XHRcdFx0XHRjb25zdCB1c2VyTWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy51c2VyTWVzc2FnZScpO1xuXHRcdFx0XHRcdHVzZXJNZXNzYWdlcy5mb3JFYWNoKCh1c2VyTWVzc2FnZSkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSB1c2VyTWVzc2FnZSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmNvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yID0gY29sb3JUb0hleChERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3IpO1xuXHRcdFx0XHRmcm9udG1hdHRlci51c2VyX21lc3NhZ2VfZm9udF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IHVzZXJNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnVzZXJNZXNzYWdlJyk7XG5cdFx0XHRcdFx0dXNlck1lc3NhZ2VzLmZvckVhY2goKHVzZXJNZXNzYWdlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IHVzZXJNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRVc2VyTWVzc2FnZUZvbnRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3IpLnRyaW0oKTtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmNvbG9yID0gZGVmYXVsdFVzZXJNZXNzYWdlRm9udENvbG9yO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChpc1ZhbGlkSGV4Q29sb3IoZnJvbnRtYXR0ZXIudXNlcl9tZXNzYWdlX2JhY2tncm91bmRfY29sb3IpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIudXNlcl9tZXNzYWdlX2JhY2tncm91bmRfY29sb3Iuc3Vic3RyaW5nKDAsIDYpO1xuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IHVzZXJNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnVzZXJNZXNzYWdlJyk7XG5cdFx0XHRcdFx0dXNlck1lc3NhZ2VzLmZvckVhY2goKHVzZXJNZXNzYWdlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IHVzZXJNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpO1xuXHRcdFx0XHRmcm9udG1hdHRlci51c2VyX21lc3NhZ2VfYmFja2dyb3VuZF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IHVzZXJNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnVzZXJNZXNzYWdlJyk7XG5cdFx0XHRcdFx0dXNlck1lc3NhZ2VzLmZvckVhY2goKHVzZXJNZXNzYWdlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IHVzZXJNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRVc2VyTWVzc2FnZUJhY2tncm91bmRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGRlZmF1bHRVc2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNWYWxpZEhleENvbG9yKGZyb250bWF0dGVyLmJvdF9tZXNzYWdlX2ZvbnRfY29sb3IpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3IgPSAnIycgKyBmcm9udG1hdHRlci5ib3RfbWVzc2FnZV9mb250X2NvbG9yLnN1YnN0cmluZygwLCA2KTtcblx0XHRcdFx0aWYgKG1lc3NhZ2VDb250YWluZXIpIHtcblx0XHRcdFx0XHRjb25zdCBib3RNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmJvdE1lc3NhZ2UnKTtcblx0XHRcdFx0XHRib3RNZXNzYWdlcy5mb3JFYWNoKChib3RNZXNzYWdlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IGJvdE1lc3NhZ2UgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3IgPSBjb2xvclRvSGV4KERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yKTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIuYm90X21lc3NhZ2VfZm9udF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0XHRcdGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0Y29uc3QgYm90TWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3RNZXNzYWdlJyk7XG5cdFx0XHRcdFx0Ym90TWVzc2FnZXMuZm9yRWFjaCgoYm90TWVzc2FnZSkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSBib3RNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRCb3RNZXNzYWdlRm9udENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yKS50cmltKCk7XG5cdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5jb2xvciA9IGRlZmF1bHRCb3RNZXNzYWdlRm9udENvbG9yO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChpc1ZhbGlkSGV4Q29sb3IoZnJvbnRtYXR0ZXIuY2hhdGJvdF9tZXNzYWdlX2JhY2tncm91bmRfY29sb3IpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgPSAnIycgKyBmcm9udG1hdHRlci5jaGF0Ym90X21lc3NhZ2VfYmFja2dyb3VuZF9jb2xvci5zdWJzdHJpbmcoMCwgNik7XG5cdFx0XHRcdGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0Y29uc3QgYm90TWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3RNZXNzYWdlJyk7XG5cdFx0XHRcdFx0Ym90TWVzc2FnZXMuZm9yRWFjaCgoYm90TWVzc2FnZSkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IGJvdE1lc3NhZ2UgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRvSGV4KERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yKTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIuY2hhdGJvdF9tZXNzYWdlX2JhY2tncm91bmRfY29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IGJvdE1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuYm90TWVzc2FnZScpO1xuXHRcdFx0XHRcdGJvdE1lc3NhZ2VzLmZvckVhY2goKGJvdE1lc3NhZ2UpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSBib3RNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdFx0Y29uc3QgZGVmYXVsdEJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdEJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGlzVmFsaWRIZXhDb2xvcihmcm9udG1hdHRlci5jaGF0Ym94X2ZvbnRfY29sb3IpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hGb250Q29sb3IgPSAnIycgKyBmcm9udG1hdHRlci5jaGF0Ym94X2ZvbnRfY29sb3Iuc3Vic3RyaW5nKDAsIDYpO1xuXHRcdFx0XHRjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym94IHRleHRhcmVhJykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGlmICh0ZXh0YXJlYSkge1xuXHRcdFx0XHRcdHRleHRhcmVhLnN0eWxlLmNvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcjtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBTZXQgdGhlIHBsYWNlaG9sZGVyIGNvbG9yIHRvIHRoZSBkZWZhdWx0IHZhbHVlXG5cdFx0XHRcdFx0Y29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuXHRcdFx0XHRcdHN0eWxlLnRleHRDb250ZW50ID0gYFxuXHRcdFx0XHRcdFx0LmNoYXRib3ggdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHtcblx0XHRcdFx0XHRcdFx0Y29sb3I6ICR7cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcn0gIWltcG9ydGFudDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRgO1xuXHRcdFx0XHRcdHRleHRhcmVhLmFwcGVuZENoaWxkKHN0eWxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvciA9IGNvbG9yVG9IZXgoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRCb3hGb250Q29sb3IpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5jaGF0Ym94X2ZvbnRfY29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Qm94Rm9udENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggdGV4dGFyZWEnKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xuXHRcdFx0XHRjb25zdCBkZWZhdWx0Q2hhdEJveEZvbnRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcikudHJpbSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0ZXh0YXJlYSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5jb2xvciA9IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Qm94Rm9udENvbG9yO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBwbGFjZWhvbGRlciBjb2xvciB0byB0aGUgc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IGBcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jaGF0Ym94IHRleHRhcmVhOjpwbGFjZWhvbGRlciB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICR7ZGVmYXVsdENoYXRCb3hGb250Q29sb3J9ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgICAgICAgICB9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc1ZhbGlkSGV4Q29sb3IoZnJvbnRtYXR0ZXIuY2hhdGJveF9iYWNrZ3JvdW5kX2NvbG9yKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIuY2hhdGJveF9iYWNrZ3JvdW5kX2NvbG9yLnN1YnN0cmluZygwLCA2KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0Y29uc3QgY2hhdGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym94Jyk7XG5cdFx0XHRcdFx0aWYgKGNoYXRib3gpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSBjaGF0Ym94IGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yO1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5ib3JkZXJDb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggdGV4dGFyZWEnKTtcblx0XHRcdFx0XHRpZiAodGV4dGFyZWEpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSB0ZXh0YXJlYSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYm9yZGVyQ29sb3IgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJveCAuc3VibWl0LWJ1dHRvbicpO1xuXHRcdFx0XHRcdGlmIChzdWJtaXRCdXR0b24pIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSBzdWJtaXRCdXR0b24gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJvcmRlckNvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3IgPSBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIuY2hhdGJveF9iYWNrZ3JvdW5kX2NvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cblx0XHRcdFx0Y29uc3QgZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblxuXHRcdFx0XHRpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuXHRcdFx0XHRcdGNvbnN0IGNoYXRib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJveCcpO1xuXHRcdFx0XHRcdGlmIChjaGF0Ym94KSB7XG5cdFx0XHRcdFx0XHRjb25zdCBlbGVtZW50ID0gY2hhdGJveCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJvcmRlckNvbG9yID0gZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggdGV4dGFyZWEnKTtcblx0XHRcdFx0XHRpZiAodGV4dGFyZWEpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGVsZW1lbnQgPSB0ZXh0YXJlYSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJvcmRlckNvbG9yID0gZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Y29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggLnN1Ym1pdC1idXR0b24nKTtcblx0XHRcdFx0XHRpZiAoc3VibWl0QnV0dG9uKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBlbGVtZW50ID0gc3VibWl0QnV0dG9uIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBkZWZhdWx0Q2hhdEJveEJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0XHRcdGVsZW1lbnQuc3R5bGUuYm9yZGVyQ29sb3IgPSBkZWZhdWx0Q2hhdEJveEJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNWYWxpZEhleENvbG9yKGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9iYWNrZ3JvdW5kX2NvbG9yKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ibW9HZW5lcmF0ZUJhY2tncm91bmRDb2xvciA9ICcjJyArIGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9iYWNrZ3JvdW5kX2NvbG9yLnN1YnN0cmluZygwLCA2KTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnN0IGNvbnRhaW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYm1vQ29kZUJsb2NrQ29udGFpbmVyJyk7XG5cdFx0XHRcdGNvbnRhaW5lcnMuZm9yRWFjaCgoY29udGFpbmVyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVCYWNrZ3JvdW5kQ29sb3IpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5ibW9fZ2VuZXJhdGVfYmFja2dyb3VuZF9jb2xvciA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yLnJlcGxhY2UoL14jLywgJycpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgY29udGFpbmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibW9Db2RlQmxvY2tDb250YWluZXInKTtcblx0XHRcdFx0Y29udGFpbmVycy5mb3JFYWNoKChjb250YWluZXIpID0+IHtcblx0XHRcdFx0XHRjb25zdCBlbGVtZW50ID0gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRCTU9HZW5lcmF0ZUJhY2tncm91bmRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGRlZmF1bHRCTU9HZW5lcmF0ZUJhY2tncm91bmRDb2xvcjtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc1ZhbGlkSGV4Q29sb3IoZnJvbnRtYXR0ZXIuYm1vX2dlbmVyYXRlX2ZvbnRfY29sb3IpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlRm9udENvbG9yID0gJyMnICsgZnJvbnRtYXR0ZXIuYm1vX2dlbmVyYXRlX2ZvbnRfY29sb3Iuc3Vic3RyaW5nKDAsIDYpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgY29udGFpbmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibW9Db2RlQmxvY2tDb250ZW50Jyk7XG5cdFx0XHRcdGNvbnRhaW5lcnMuZm9yRWFjaCgoY29udGFpbmVyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZWxlbWVudCA9IGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmNvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3I7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3IgPSBjb2xvclRvSGV4KERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ibW9HZW5lcmF0ZUZvbnRDb2xvcik7XG5cdFx0XHRcdGZyb250bWF0dGVyLmJtb19nZW5lcmF0ZV9mb250X2NvbG9yID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3IucmVwbGFjZSgvXiMvLCAnJyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zdCBjb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJtb0NvZGVCbG9ja0NvbnRlbnQnKTtcblx0XHRcdFx0Y29udGFpbmVycy5mb3JFYWNoKChjb250YWluZXIpID0+IHtcblx0XHRcdFx0XHRjb25zdCBlbGVtZW50ID0gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGRlZmF1bHRCTU9HZW5lcmF0ZUZvbnRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3IpLnRyaW0oKTtcblx0XHRcdFx0XHRlbGVtZW50LnN0eWxlLmNvbG9yID0gZGVmYXVsdEJNT0dlbmVyYXRlRm9udENvbG9yO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0cGx1Z2luLnNldHRpbmdzLmVkaXRvci5zeXN0ZW5fcm9sZSA9IGZyb250bWF0dGVyLnN5c3Rlbl9yb2xlO1xuXG5cdFx0XHRwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5lbmFibGVIZWFkZXIgPSBmcm9udG1hdHRlci5lbmFibGVfaGVhZGVyO1xuXHRcdFx0aWYgKGZyb250bWF0dGVyLmVuYWJsZV9oZWFkZXIgPT09IHRydWUpIHtcblx0XHRcdFx0Y29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hlYWRlcicpIGFzIEhUTUxFbGVtZW50O1xuXG5cdFx0XHRcdGlmIChoZWFkZXIpIHtcblx0XHRcdFx0XHRoZWFkZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0XHRcdFx0cmVmZXJlbmNlQ3VycmVudE5vdGVFbGVtZW50LnN0eWxlLm1hcmdpbiA9ICctMC41cmVtIDAgMC41cmVtIDAnO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaGVhZGVyJykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRpZiAoaGVhZGVyKSB7XG5cdFx0XHRcdFx0aGVhZGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0bWVzc2FnZUNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSAnY2FsYygxMDAlIC0gNjBweCknO1xuXHRcdFx0XHRcdHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5tYXJnaW4gPSAnMC41cmVtIDAgMC41cmVtIDAnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGludFZhbHVlID0gcGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0LCAxMCk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG5cdFxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHBhcnNlZCB2YWx1ZSBpcyBhIHZhbGlkIGludGVnZXIsIGlmIG5vdCwgZmFsbGJhY2sgdG8gdGhlIGRlZmF1bHQgVVJMXG5cdFx0XHRpZiAoaXNOYU4oaW50VmFsdWUpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXQgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdDtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0ID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXQgPSBpbnRWYWx1ZS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXQgPSBpbnRWYWx1ZTtcblx0XHRcdH1cblxuXG5cdFx0XHRpZiAoaXNOYU4ocGFyc2VGbG9hdChmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfZXRhKSkpIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGEgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGE7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9taXJvc3RhdF9ldGEgPSBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X2V0YTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfZXRhID0gcGFyc2VGbG9hdChmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfZXRhKS50b0ZpeGVkKDIpLnRvU3RyaW5nKCk7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9taXJvc3RhdF9ldGEgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfZXRhKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGlzTmFOKHBhcnNlRmxvYXQoZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0X3RhdSkpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1ID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1O1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfdGF1ID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF90YXU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X3RhdSA9IHBhcnNlRmxvYXQoZnJvbnRtYXR0ZXIub2xsYW1hX21pcm9zdGF0X3RhdSkudG9GaXhlZCgyKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfbWlyb3N0YXRfdGF1ID0gcGFyc2VGbG9hdChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X3RhdSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc05hTihwYXJzZUludChmcm9udG1hdHRlci5vbGxhbWFfbnVtX2N0eCkpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2N0eCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9jdHg7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9udW1fY3R4ID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fY3R4O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fY3R4ID0gcGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX251bV9jdHgpLnRvU3RyaW5nKCk7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9udW1fY3R4ID0gcGFyc2VJbnQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fY3R4KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGlzTmFOKHBhcnNlSW50KGZyb250bWF0dGVyLm9sbGFtYV9udW1fZ3FhKSkpIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fZ3FhID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2dxYTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2dxYSA9IHBhcnNlSW50KGZyb250bWF0dGVyLm9sbGFtYV9udW1fZ3FhKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfbnVtX2dxYSA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2dxYSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc05hTihwYXJzZUludChmcm9udG1hdHRlci5vbGxhbWFfbnVtX3RocmVhZCkpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX3RocmVhZCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQgPSBwYXJzZUludChmcm9udG1hdHRlci5vbGxhbWFfbnVtX3RocmVhZCkudG9TdHJpbmcoKTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX251bV90aHJlYWQgPSBwYXJzZUludChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNOYU4ocGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX3JlcGVhdF9sYXN0X24pKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9sYXN0X24gPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfbGFzdF9uO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfcmVwZWF0X2xhc3RfbiA9IHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3Rfbjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3RfbiA9IHBhcnNlSW50KGZyb250bWF0dGVyLm9sbGFtYV9yZXBlYXRfbGFzdF9uKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfcmVwZWF0X2xhc3RfbiA9IHBhcnNlSW50KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3Rfbik7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc05hTihwYXJzZUZsb2F0KGZyb250bWF0dGVyLm9sbGFtYV9yZXBlYXRfcGVuYWx0eSkpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X3BlbmFsdHkgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfcGVuYWx0eTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3JlcGVhdF9wZW5hbHR5ID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfcGVuYWx0eTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X3BlbmFsdHkgPSBwYXJzZUZsb2F0KGZyb250bWF0dGVyLm9sbGFtYV9yZXBlYXRfcGVuYWx0eSkudG9GaXhlZCgyKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfcmVwZWF0X3BlbmFsdHkgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X3BlbmFsdHkpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNOYU4ocGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX3NlZWQpKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnNlZWQgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkID0gcGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX3NlZWQpLnRvU3RyaW5nKCk7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9zZWVkID0gcGFyc2VJbnQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkKTtcblx0XHRcdH1cblxuXHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zdG9wID0gZnJvbnRtYXR0ZXIub2xsYW1hX3N0b3A7XG5cblx0XHRcdGlmIChpc05hTihwYXJzZUZsb2F0KGZyb250bWF0dGVyLm9sbGFtYV90ZnNfeikpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3ogPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50ZnNfejtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3Rmc196ID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50ZnNfejtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3ogPSBwYXJzZUZsb2F0KGZyb250bWF0dGVyLm9sbGFtYV90ZnNfeikudG9GaXhlZCgyKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfdGZzX3ogPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3opO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNOYU4ocGFyc2VJbnQoZnJvbnRtYXR0ZXIub2xsYW1hX3RvcF9rKSkpIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfayA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfdG9wX2sgPSBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfayA9IHBhcnNlSW50KGZyb250bWF0dGVyLm9sbGFtYV90b3BfaykudG9TdHJpbmcoKTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3RvcF9rID0gcGFyc2VJbnQocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3Bfayk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpc05hTihwYXJzZUludChmcm9udG1hdHRlci5vbGxhbWFfdG9wX3ApKSkge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9wID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3A7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV90b3BfcCA9IHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3A7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9wID0gcGFyc2VGbG9hdChmcm9udG1hdHRlci5vbGxhbWFfdG9wX3ApLnRvRml4ZWQoMikudG9TdHJpbmcoKTtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX3RvcF9wID0gcGFyc2VGbG9hdChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9wKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGlzTmFOKHBhcnNlSW50KGZyb250bWF0dGVyLm9sbGFtYV9taW5fcCkpKSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3AgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taW5fcDtcblx0XHRcdFx0ZnJvbnRtYXR0ZXIub2xsYW1hX21pbl9wID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taW5fcDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3AgPSBwYXJzZUZsb2F0KGZyb250bWF0dGVyLm9sbGFtYV9taW5fcCkudG9GaXhlZCgyKS50b1N0cmluZygpO1xuXHRcdFx0XHRmcm9udG1hdHRlci5vbGxhbWFfbWluX3AgPSBwYXJzZUZsb2F0KHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3ApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZWd1bGFyIGV4cHJlc3Npb24gdG8gdmFsaWRhdGUgdGhlIGlucHV0IHZhbHVlIGFuZCBjYXB0dXJlIHRoZSBudW1iZXIgYW5kIHVuaXRcblx0XHRcdGNvbnN0IG1hdGNoID0gU3RyaW5nKGZyb250bWF0dGVyLm9sbGFtYV9rZWVwX2FsaXZlKS5tYXRjaCgvXigtP1xcZCspKG18aHJ8aCk/JC8pO1xuXG5cdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0Y29uc3QgbnVtID0gcGFyc2VJbnQobWF0Y2hbMV0pO1xuXHRcdFx0XHRjb25zdCB1bml0ID0gbWF0Y2hbMl07XG5cblx0XHRcdFx0Ly8gQ29udmVydCB0byBzZWNvbmRzIGJhc2VkIG9uIHRoZSB1bml0XG5cdFx0XHRcdGxldCBzZWNvbmRzO1xuXHRcdFx0XHRpZiAodW5pdCA9PT0gJ20nKSB7XG5cdFx0XHRcdFx0c2Vjb25kcyA9IG51bSAqIDYwOyAvLyBDb252ZXJ0IG1pbnV0ZXMgdG8gc2Vjb25kc1xuXHRcdFx0XHR9IGVsc2UgaWYgKHVuaXQgPT09ICdocicgfHwgdW5pdCA9PT0gJ2gnKSB7XG5cdFx0XHRcdFx0c2Vjb25kcyA9IG51bSAqIDM2MDA7IC8vIENvbnZlcnQgaG91cnMgdG8gc2Vjb25kc1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlY29uZHMgPSBudW07IC8vIEFzc3VtZSBpdCdzIGFscmVhZHkgaW4gc2Vjb25kcyBpZiBubyB1bml0XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBTdG9yZSB0aGUgdmFsdWUgaW4gc2Vjb25kc1xuXHRcdFx0XHRwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLmtlZXBfYWxpdmUgPSBzZWNvbmRzLnRvU3RyaW5nKCk7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9rZWVwX2FsaXZlID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5rZWVwX2FsaXZlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSWYgdGhlIGlucHV0IGlzIGludmFsaWQsIHJldmVydCB0byB0aGUgZGVmYXVsdCBzZXR0aW5nXG5cdFx0XHRcdHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMua2VlcF9hbGl2ZSA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLmtlZXBfYWxpdmU7XG5cdFx0XHRcdGZyb250bWF0dGVyLm9sbGFtYV9rZWVwX2FsaXZlID0gcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5rZWVwX2FsaXZlO1xuXHRcdFx0fVxuXG5cdFx0fSk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBmcm9udG1hdHRlcjonLCBlcnJvcik7XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIFRGaWxlLCBNYXJrZG93blZpZXcsIEVkaXRvciwgRWRpdG9yUG9zaXRpb24sIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge0RFRkFVTFRfU0VUVElOR1MsIEJNT1NldHRpbmdzfSBmcm9tICcuL21haW4nO1xuaW1wb3J0IEJNT0dQVCBmcm9tICcuL21haW4nO1xuaW1wb3J0IHsgY29tbWFuZE1hcCwgZXhlY3V0ZUNvbW1hbmQgfSBmcm9tICcuL2NvbXBvbmVudHMvY2hhdC9Db21tYW5kcyc7XG5pbXBvcnQgeyBnZXRBY3RpdmVGaWxlQ29udGVudCB9IGZyb20gJy4vY29tcG9uZW50cy9lZGl0b3IvUmVmZXJlbmNlQ3VycmVudE5vdGUnO1xuaW1wb3J0IHsgYWRkTWVzc2FnZSwgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3MgfSBmcm9tICcuL2NvbXBvbmVudHMvY2hhdC9NZXNzYWdlJztcbmltcG9ydCB7IGRpc3BsYXlVc2VyTWVzc2FnZSB9IGZyb20gJy4vY29tcG9uZW50cy9jaGF0L1VzZXJNZXNzYWdlJztcbmltcG9ydCB7IGRpc3BsYXlCb3RNZXNzYWdlLCBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlIH0gZnJvbSAnLi9jb21wb25lbnRzL2NoYXQvQm90TWVzc2FnZSc7XG5pbXBvcnQgeyBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlU3RyZWFtLCBcbiAgICAgICAgZmV0Y2hPcGVuQUlBUElSZXNwb25zZSwgXG4gICAgICAgIGZldGNoT2xsYW1hUmVzcG9uc2UsIFxuICAgICAgICBmZXRjaE9sbGFtYVJlc3BvbnNlU3RyZWFtLCBcbiAgICAgICAgZmV0Y2hSRVNUQVBJVVJMUmVzcG9uc2UsIFxuICAgICAgICBmZXRjaFJFU1RBUElVUkxSZXNwb25zZVN0cmVhbSwgXG4gICAgICAgIGZldGNoTWlzdHJhbFJlc3BvbnNlLCBcbiAgICAgICAgZmV0Y2hNaXN0cmFsUmVzcG9uc2VTdHJlYW0sIFxuICAgICAgICBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlLCBcbiAgICAgICAgZmV0Y2hBbnRocm9waWNSZXNwb25zZSwgXG4gICAgICAgIGZldGNoT3BlblJvdXRlclJlc3BvbnNlU3RyZWFtLFxuICAgICAgICBmZXRjaE9wZW5Sb3V0ZXJSZXNwb25zZSxcbiAgICAgICAgZmV0Y2hHb29nbGVHZW1pbmlSZXNwb25zZVN0cmVhbX0gZnJvbSAnLi9jb21wb25lbnRzL0ZldGNoTW9kZWxSZXNwb25zZSc7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfQ0hBVEJPVCA9ICdjaGF0Ym90LXZpZXcnO1xuZXhwb3J0IGNvbnN0IEFOVEhST1BJQ19NT0RFTFMgPSBbJ2NsYXVkZS1pbnN0YW50LTEuMicsICdjbGF1ZGUtMi4wJywgJ2NsYXVkZS0yLjEnLCAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLCAnY2xhdWRlLTMtc29ubmV0LTIwMjQwMjI5JywgJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQwNjIwJywgJ2NsYXVkZS0zLW9wdXMtMjAyNDAyMjknXTtcbmV4cG9ydCBjb25zdCBPUEVOQUlfTU9ERUxTID0gWydncHQtMy41LXR1cmJvJywgJ2dwdC00JywgJ2dwdC00LXR1cmJvJywgJ2dwdC00bycsICdncHQtNG8tbWluaSddO1xuXG5leHBvcnQgZnVuY3Rpb24gZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luOiBCTU9HUFQpIHtcbiAgICBjb25zdCBmaWxlbmFtZU1lc3NhZ2VIaXN0b3J5UGF0aCA9ICcuLy5vYnNpZGlhbi9wbHVnaW5zL2Jtby1jaGF0Ym90L2RhdGEvJztcbiAgICBjb25zdCBjdXJyZW50UHJvZmlsZU1lc3NhZ2VIaXN0b3J5ID0gJ21lc3NhZ2VIaXN0b3J5XycgKyBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZS5yZXBsYWNlKCcubWQnLCAnLmpzb24nKTtcblxuICAgIHJldHVybiBmaWxlbmFtZU1lc3NhZ2VIaXN0b3J5UGF0aCArIGN1cnJlbnRQcm9maWxlTWVzc2FnZUhpc3Rvcnk7XG59XG5cbmV4cG9ydCBsZXQgbWVzc2FnZUhpc3Rvcnk6IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IGltYWdlczogVWludDhBcnJheVtdIHwgc3RyaW5nW10gfVtdID0gW107XG5cbmV4cG9ydCBsZXQgbGFzdEN1cnNvclBvc2l0aW9uOiBFZGl0b3JQb3NpdGlvbiA9IHtcbiAgICBsaW5lOiAwLFxuICAgIGNoOiAwLFxufVxuXG5leHBvcnQgbGV0IGxhc3RDdXJzb3JQb3NpdGlvbkZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG5leHBvcnQgbGV0IGFjdGl2ZUVkaXRvcjogRWRpdG9yIHwgbnVsbCB8IHVuZGVmaW5lZCA9IG51bGw7XG5cbmV4cG9ydCBjbGFzcyBCTU9WaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IEJNT1NldHRpbmdzO1xuICAgIHByaXZhdGUgdGV4dGFyZWFFbGVtZW50OiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHByaXZhdGUgcHJldmVudEVudGVyID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEJNT0dQVDtcblxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcGx1Z2luOiBCTU9HUFQpIHtcbiAgICAgICAgc3VwZXIobGVhZik7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuaWNvbiA9ICdib3QnO1xuICAgICAgICB0aGlzLmFkZEN1cnNvckxvZ2dpbmcoKTtcbiAgICB9XG5cbiAgICBnZXRWaWV3VHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFZJRVdfVFlQRV9DSEFUQk9UO1xuICAgIH1cblxuICAgIGdldERpc3BsYXlUZXh0KCkge1xuICAgICAgICByZXR1cm4gJ0JNTyBDaGF0Ym90JztcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNoaWxkcmVuWzFdO1xuICAgICAgICBjb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgY29uc3QgY2hhdGJvdENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAnY2hhdGJvdENvbnRhaW5lcicsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoZWFkZXIgPSBjaGF0Ym90Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7XG4gICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgaWQ6ICdoZWFkZXInLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjaGF0Ym90TmFtZUhlYWRpbmcgPSBjaGF0Ym90Q29udGFpbmVyLmNyZWF0ZUVsKCdoMScsIHsgXG4gICAgICAgICAgICB0ZXh0OiB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWUgfHwgREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lLFxuICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgIGlkOiAnY2hhdGJvdE5hbWVIZWFkaW5nJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBNb2RlbHMgZHJvcGRvd25cbiAgICAgICAgY29uc3QgbW9kZWxPcHRpb25zID0gcG9wdWxhdGVNb2RlbERyb3Bkb3duKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzKTtcblxuICAgICAgICBjb25zdCBkb3RJbmRpY2F0b3IgPSBjaGF0Ym90Q29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywge1xuICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgIGNsYXNzOiAnZG90SW5kaWNhdG9yJyxcbiAgICAgICAgICAgICAgICBpZDogJ21hcmtEb3duQm9vbGVhbidcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQgPSBjaGF0Ym90Q29udGFpbmVyLmNyZWF0ZUVsKCdwJywge1xuICAgICAgICAgICAgdGV4dDogJ1JlZmVyZW5jZSBDdXJyZW50IE5vdGUnLFxuICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgIGlkOiAncmVmZXJlbmNlQ3VycmVudE5vdGUnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChjaGF0Ym90TmFtZUhlYWRpbmcpO1xuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQobW9kZWxPcHRpb25zKTtcblxuICAgICAgICByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG90SW5kaWNhdG9yKTtcblxuICAgICAgICByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgXG4gICAgICAgIGlmIChyZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdlbmVyYWwuZW5hYmxlUmVmZXJlbmNlQ3VycmVudE5vdGUpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBjaGF0Ym90Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7XG4gICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgaWQ6ICdtZXNzYWdlQ29udGFpbmVyJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuZW5hYmxlSGVhZGVyKSB7XG4gICAgICAgICAgICBoZWFkZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoZWFkZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gJ2NhbGMoMTAwJSAtIDYwcHgpJztcbiAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5tYXJnaW4gPSAnMC41cmVtIDAgMC41cmVtIDAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCBsb2FkRGF0YSh0aGlzLnBsdWdpbik7XG4gICAgICAgIFxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmlkID0gJ21lc3NhZ2VDb250YWluZXInO1xuICAgICAgICBcbiAgICAgICAgbWVzc2FnZUhpc3RvcnkuZm9yRWFjaChhc3luYyAobWVzc2FnZURhdGEpID0+IHsgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlRGF0YS5yb2xlID09ICd1c2VyJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlRGl2ID0gZGlzcGxheVVzZXJNZXNzYWdlKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBtZXNzYWdlRGF0YS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKHVzZXJNZXNzYWdlRGl2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZURhdGEucm9sZSA9PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5Qm90TWVzc2FnZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIG1lc3NhZ2VEYXRhLmNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3ModGhpcy5wbHVnaW4sIGJvdE1lc3NhZ2VEaXYpO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE9wZW4gbm90ZXMvbGlua3MgZnJvbSBjaGF0Ym90XG4gICAgICAgIG1lc3NhZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PT0gJ0EnICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ludGVybmFsLWxpbmsnKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSB0YXJnZXQgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua05hbWUgPSBsaW5rLmdldEF0dHJpYnV0ZSgnZGF0YS1ocmVmJykgfHwgJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobGlua05hbWUsICcnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgbGluay5zdHlsZS5jb2xvciA9ICd2YXIoLS1saW5rLWNvbG9yKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcGFyZW50RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXJlbnRFbGVtZW50SWQnKTtcbiAgICAgICAgcGFyZW50RWxlbWVudD8uYXBwZW5kQ2hpbGQobWVzc2FnZUNvbnRhaW5lcik7XG5cbiAgICAgICAgY29uc3QgY2hhdGJveCA9IGNoYXRib3RDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcbiAgICAgICAgICAgIGF0dHI6IHtcbiAgICAgICAgICAgICAgICBjbGFzczogJ2NoYXRib3gnLFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG4gICAgICAgIHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgdHJ1ZS50b1N0cmluZygpKTtcbiAgICAgICAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdTdGFydCB0eXBpbmcuLi4nKTtcblxuXG4gICAgICAgIGlmICh0ZXh0YXJlYSkge1xuICAgICAgICAgICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBwbGFjZWhvbGRlciBjb2xvciB0byB0aGUgZGVmYXVsdCB2YWx1ZVxuICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBgXG4gICAgICAgICAgICAgICAgLmNoYXRib3ggdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICR7dGhpcy5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hGb250Q29sb3J9ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIHRleHRhcmVhLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN1Ym1pdCBidXR0b25cbiAgICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdzZW5kJztcbiAgICAgICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCgnc3VibWl0LWJ1dHRvbicpO1xuICAgICAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc2VuZCc7XG5cblxuICAgICAgICBzdWJtaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUtleXVwKG5ldyBLZXlib2FyZEV2ZW50KCdrZXl1cCcsIHsga2V5OiAnRW50ZXInIH0pLCB0cnVlKTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICBjaGF0Ym90Q29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yO1xuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuc2V0dGluZ3MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5tZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yO1xuICAgICAgICB0ZXh0YXJlYS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgdGV4dGFyZWEuc3R5bGUuYm9yZGVyQ29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgdGV4dGFyZWEuc3R5bGUuY29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcjtcbiAgICAgICAgY2hhdGJveC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgc3VibWl0QnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Qm94QmFja2dyb3VuZENvbG9yO1xuXG5cbiAgICAgICAgY29uc3QgdXNlck1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudXNlck1lc3NhZ2UnKTtcbiAgICAgICAgdXNlck1lc3NhZ2VzLmZvckVhY2goKHVzZXJNZXNzYWdlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgdXNlck1lc3NhZ2Uuc3R5bGUuY29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3IgfHwgREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBib3RNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmJvdE1lc3NhZ2UnKTtcbiAgICAgICAgYm90TWVzc2FnZXMuZm9yRWFjaCgoYm90TWVzc2FnZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGJvdE1lc3NhZ2Uuc3R5bGUuY29sb3IgPSB0aGlzLnNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvcjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2hhdGJveC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XG4gICAgICAgIGNoYXRib3guYXBwZW5kQ2hpbGQoc3VibWl0QnV0dG9uKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50ID0gdGV4dGFyZWEgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIC8vIFNjcm9sbCB0byBib3R0b20gb2YgbWVzc2FnZUNvbnRhaW5lclxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnNjcm9sbFRvcCA9IG1lc3NhZ2VDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuICAgIH1cblxuICAgIGFkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5dXAuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5oYW5kbGVJbnB1dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuaGFuZGxlQmx1ci5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgaGFuZGxlS2V5dXAoZXZlbnQ6IEtleWJvYXJkRXZlbnQsIGZyb21TdWJtaXRCdXR0b24gPSBmYWxzZSkge1xuICAgICAgICAvLyBDaGVjayBpZiBpdCdzIG1vYmlsZSBhbmQgcmV0dXJuIGlmIHRydWVcbiAgICAgICAgaWYgKChkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygnaXMtbW9iaWxlJykgfHwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLXRhYmxldCcpKSAmJiBldmVudC5rZXkgPT09ICdFbnRlcicgJiYgIWZyb21TdWJtaXRCdXR0b24pIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7ICAvLyBQcmV2ZW50IGRlZmF1bHQgdG8gYXZvaWQgYW55IG90aGVyIGFjdGlvbnMgbGlrZSBzdWJtaXRcbiAgICAgICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnZhbHVlICs9ICdcXG4nO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVJbnB1dChldmVudCk7ICAvLyBUcmlnZ2VyIHRoZSBpbnB1dCBldmVudCBtYW51YWxseVxuICAgICAgICAgICAgcmV0dXJuOyAgLy8gRXhpdCB0aGUgZnVuY3Rpb24gZWFybHlcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLnRleHRhcmVhRWxlbWVudC52YWx1ZTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBtZXNzYWdlSGlzdG9yeS5sZW5ndGggLSAxO1xuXG4gICAgICAgIC8vIE9ubHkgYWxsb3cgL3N0b3AgY29tbWFuZCB0byBiZSBleGVjdXRlZCBkdXJpbmcgZmV0Y2hcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0gfHwgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLmVuYWJsZVN0cmVhbSB8fCBcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5lbmFibGVTdHJlYW0gfHwgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgIGlmICgoaW5wdXQgPT09ICcvcycgfHwgaW5wdXQgPT09ICcvc3RvcCcpICYmIGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEVudGVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYXdhaXQgZXhlY3V0ZUNvbW1hbmQoaW5wdXQsIHRoaXMuc2V0dGluZ3MsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBpbnB1dCBjb250YWlucyBhbnkgaW50ZXJuYWwgbGlua3MgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRoZSBjb250ZW50IG9mIHRoZSBsaW5rZWQgZmlsZSAoW1tdXSwgIVtbXV0sIFtbI11dKVxuICAgICAgICBjb25zdCByZWdleCA9IC8oIT8pXFxbXFxbKC4qPylcXF1cXF0vZztcbiAgICAgICAgbGV0IG1hdGNoZXM7XG4gICAgICAgIGxldCBpbnB1dE1vZGlmaWVkID0gaW5wdXQ7XG5cbiAgICAgICAgLy8gU3RvcmUgYWxsIHJlcGxhY2VtZW50cyB0byBiZSBtYWRlXG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50cyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG5cbiAgICAgICAgd2hpbGUgKChtYXRjaGVzID0gcmVnZXguZXhlYyhpbnB1dCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBleGNsYW1hdGlvbiA9IG1hdGNoZXNbMV07IC8vIENhcHR1cmUgdGhlIG9wdGlvbmFsIGV4Y2xhbWF0aW9uIG1hcmtcbiAgICAgICAgICAgIGNvbnN0IGxpbmt0ZXh0ID0gbWF0Y2hlc1syXTtcbiAgICAgICAgICAgIC8vIFNwbGl0IHRoZSBsaW5rdGV4dCBpbnRvIHBhdGggYW5kIHN1YnBhdGhcbiAgICAgICAgICAgIGNvbnN0IFtwYXRoLCBzdWJwYXRoXSA9IGxpbmt0ZXh0LnNwbGl0KCcjJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChwYXRoLCAnJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoOyAvLyBBc3N1bWluZyBmaWxlIG9iamVjdCBoYXMgYSBwYXRoIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVFeHRlbnNpb24gPSBmaWxlUGF0aC5zcGxpdCgnLicpLnBvcCgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZmlsZSBleHRlbnNpb24gaXMgLm1kXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlRXh0ZW5zaW9uICE9PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0ltYWdlRmlsZSA9IC9cXC4oanBnfGpwZWd8cG5nfGdpZnx3ZWJwfGJtcHx0aWZmfHRpZnxzdmcpJC9pLnRlc3QoZmlsZVBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzLmluY2x1ZGVzKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnNldChtYXRjaGVzWzBdLCBgJHtleGNsYW1hdGlvbn1bWyR7bWF0Y2hlc1syXX1dXTxub3RlLXJlbmRlcmVkPkVSUk9SOiBGaWxlIGNhbm5vdCBiZSByZWFkLjwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMuaW5jbHVkZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSW1hZ2VGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5zZXQobWF0Y2hlc1swXSwgYCR7ZXhjbGFtYXRpb259W1ske21hdGNoZXNbMl19XV08bm90ZS1yZW5kZXJlZD5FUlJPUjogRmlsZSBjYW5ub3QgYmUgcmVhZC48L25vdGUtcmVuZGVyZWQ+YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIFNraXAgdG8gdGhlIG5leHQgaXRlcmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRUb0luc2VydCA9IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBzdWJwYXRoLCBmaW5kIHRoZSByZWxldmFudCBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJwYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluU3VicGF0aCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VicGF0aENvbnRlbnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdWJwYXRoTGV2ZWwgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eIysvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGluZ0xldmVsID0gbWF0Y2ggPyBtYXRjaFswXS5sZW5ndGggOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpblN1YnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWFkaW5nTGV2ZWwgPD0gc3VicGF0aExldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluU3VicGF0aCAmJiBsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc3VicGF0aC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5TdWJwYXRoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhMZXZlbCA9IGhlYWRpbmdMZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpblN1YnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicGF0aENvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0luc2VydCA9IHN1YnBhdGhDb250ZW50LmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUHJlcGFyZSB0aGUgcmVwbGFjZW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMuc2V0KG1hdGNoZXNbMF0sIGAke2V4Y2xhbWF0aW9ufVtbJHttYXRjaGVzWzJdfV1dPG5vdGUtcmVuZGVyZWQ+JHtjb250ZW50VG9JbnNlcnR9PC9ub3RlLXJlbmRlcmVkPmApO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcmVhZCB0aGUgY29udGVudCBvZiBcIiR7cGF0aH1cIjogJHtlcnJ9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgY2FzZSB3aGVyZSB0aGUgZmlsZSBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYSBURmlsZVxuICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5zZXQobWF0Y2hlc1swXSwgYCR7ZXhjbGFtYXRpb259W1ske21hdGNoZXNbMl19XV08bm90ZS1yZW5kZXJlZD5GaWxlIGNhbm5vdCBiZSByZWFkLjwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFwcGx5IGFsbCByZXBsYWNlbWVudHMgdG8gaW5wdXRNb2RpZmllZFxuICAgICAgICBmb3IgKGNvbnN0IFtvcmlnaW5hbCwgcmVwbGFjZW1lbnRdIG9mIHJlcGxhY2VtZW50cykge1xuICAgICAgICAgICAgaW5wdXRNb2RpZmllZCA9IGlucHV0TW9kaWZpZWQuc3BsaXQob3JpZ2luYWwpLmpvaW4ocmVwbGFjZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgaW4gdGhlIGZpbmFsIG91dHB1dFxuICAgICAgICBpbnB1dE1vZGlmaWVkID0gaW5wdXRNb2RpZmllZC5yZXBsYWNlKC8oPG5vdGUtcmVuZGVyZWQ+RmlsZSBjYW5ub3QgYmUgcmVhZC48XFwvbm90ZS1yZW5kZXJlZD4pKy9nLCAnPG5vdGUtcmVuZGVyZWQ+RmlsZSBjYW5ub3QgYmUgcmVhZC48L25vdGUtcmVuZGVyZWQ+Jyk7XG5cblxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBNb2RpZmllZCBpbnB1dDogJHtpbnB1dE1vZGlmaWVkfWApO1xuXG4gICAgICAgIGlmICh0aGlzLnByZXZlbnRFbnRlciA9PT0gZmFsc2UgJiYgIWV2ZW50LnNoaWZ0S2V5ICYmIGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgbG9hZERhdGEodGhpcy5wbHVnaW4pO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChpbnB1dC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGNsdWRlZENvbW1hbmRzID0gW1xuICAgICAgICAgICAgICAgICAgICAnL2MnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9jbGVhcicsIFxuICAgICAgICAgICAgICAgICAgICAnL3MnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9zdG9wJywgXG4gICAgICAgICAgICAgICAgICAgICcvc2F2ZScsIFxuICAgICAgICAgICAgICAgICAgICAnL2xvYWQgJyxcbiAgICAgICAgICAgICAgICAgICAgJy9tICcsIFxuICAgICAgICAgICAgICAgICAgICAnL21vZGVsICcsIFxuICAgICAgICAgICAgICAgICAgICAnL21vZGVscyAnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9wICcsIFxuICAgICAgICAgICAgICAgICAgICAnL3Byb2ZpbGUgJywgXG4gICAgICAgICAgICAgICAgICAgICcvcHJvZiAnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9wcm9maWxlcyAnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9wcm9tcHQgJywgXG4gICAgICAgICAgICAgICAgICAgICcvcHJvbXB0cyAnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9hcHBlbmQnLCBcbiAgICAgICAgICAgICAgICAgICAgJy9yZWZlcmVuY2UgJyxcbiAgICAgICAgICAgICAgICAgICAgJy9yZWYgJyxcbiAgICAgICAgICAgICAgICAgICAgJy9tYXh0b2tlbnMnLFxuICAgICAgICAgICAgICAgICAgICAnL21heHRva2VucyAnLFxuICAgICAgICAgICAgICAgICAgICAnL3RlbXBlcmF0dXJlJyxcbiAgICAgICAgICAgICAgICAgICAgJy90ZW1wZXJhdHVyZSAnLFxuICAgICAgICAgICAgICAgICAgICAnL3RlbXAnLFxuICAgICAgICAgICAgICAgICAgICAnL3RlbXAgJyxcbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFleGNsdWRlZENvbW1hbmRzLnNvbWUoY21kID0+IGlucHV0LnN0YXJ0c1dpdGgoY21kKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBpbnB1dC5zcGxpdCgnICcpOyAvLyBTcGxpdHMgdGhlIGlucHV0IG9uIHNwYWNlc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBiYXNlQ29tbWFuZCA9IHBhcnRzWzBdOyAvLyBUaGUgYmFzZSBjb21tYW5kIGlzIHRoZSBmaXJzdCBwYXJ0XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChiYXNlQ29tbWFuZC5zdGFydHNXaXRoKCcvJykgJiYgY29tbWFuZE1hcC5oYXNPd25Qcm9wZXJ0eShiYXNlQ29tbWFuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgYmxvY2sgaGFuZGxlcyByZWNvZ25pemVkIGNvbW1hbmRzIHdpdGggb3Igd2l0aG91dCBwYXJhbWV0ZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRNZXNzYWdlKHRoaXMucGx1Z2luLCBpbnB1dCwgJ3VzZXJNZXNzYWdlJywgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlck1lc3NhZ2VEaXYgPSBkaXNwbGF5VXNlck1lc3NhZ2UodGhpcy5wbHVnaW4sIHRoaXMuc2V0dGluZ3MsIGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQodXNlck1lc3NhZ2VEaXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0NvbW1hbmQgcHJvY2Vzc2VkOicsIGNvbW1hbmRNYXBbYmFzZUNvbW1hbmRdLCAnd2l0aCBwYXJhbWV0ZXJzOicsIHBhcnRzLnNsaWNlKDEpLmpvaW4oJyAnKSk7IC8vIExvZ3MgdGhlIHByb2Nlc3NlZCBjb21tYW5kIGFuZCBwYXJhbWV0ZXJzXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWJhc2VDb21tYW5kLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBibG9jayBoYW5kbGVzIG5vbi1jb21tYW5kIGlucHV0c1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ1VzZXIgaW5wdXQgbW9kaWZpZWQ6JywgaW5wdXRNb2RpZmllZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRNZXNzYWdlKHRoaXMucGx1Z2luLCBpbnB1dE1vZGlmaWVkLCAndXNlck1lc3NhZ2UnLCB0aGlzLnNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZURpdiA9IGRpc3BsYXlVc2VyTWVzc2FnZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh1c2VyTWVzc2FnZURpdik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnVW5rbm93biBjb21tYW5kIGlnbm9yZWQ6JywgaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgICAgICBleGVjdXRlQ29tbWFuZChpbnB1dCwgdGhpcy5zZXR0aW5ncywgdGhpcy5wbHVnaW4pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFleGNsdWRlZENvbW1hbmRzLnNvbWUoY21kID0+IGlucHV0LnN0YXJ0c1dpdGgoY21kKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuYm90TWVzc2FnZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdEJvdE1lc3NhZ2UgPSBib3RNZXNzYWdlc1tib3RNZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RCb3RNZXNzYWdlLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50RW50ZXIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENhbGwgdGhlIGNoYXRib3QgZnVuY3Rpb24gd2l0aCB0aGUgdXNlcidzIGlucHV0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuQk1PY2hhdGJvdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50RW50ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgJ09vcHMsIHNvbWV0aGluZyB3ZW50IHdyb25nLiBQbGVhc2UgdHJ5IGFnYWluLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMjlweCc7XG4gICAgICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC52YWx1ZSA9IHRoaXMudGV4dGFyZWFFbGVtZW50LnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKDAsIDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlS2V5ZG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmICFldmVudC5zaGlmdEtleSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhbmRsZUlucHV0KGV2ZW50OiBFdmVudCkge1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMjlweCc7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnN0eWxlLmhlaWdodCA9IHRoaXMudGV4dGFyZWFFbGVtZW50LnNjcm9sbEhlaWdodCArICdweCc7XG4gICAgfVxuXG4gICAgaGFuZGxlQmx1cihldmVudDogRXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRleHRhcmVhRWxlbWVudC52YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzI5cHgnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZXhwb3J0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xuICAgIH1cblxuICAgIGFkZEN1cnNvckxvZ2dpbmcoKSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZUN1cnNvclBvc2l0aW9uID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQodGhpcy5wbHVnaW4sIHRoaXMuc2V0dGluZ3MpOyBcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgbGFzdEN1cnNvclBvc2l0aW9uRmlsZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJzb3IgIT0gbnVsbCAmJiB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RDdXJzb3JQb3NpdGlvbiA9IGN1cnNvcjtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRWRpdG9yID0gdmlldy5lZGl0b3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGFjdGl2ZVdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHVwZGF0ZUN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgYWN0aXZlV2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdXBkYXRlQ3Vyc29yUG9zaXRpb24pO1xuICAgICAgICBhY3RpdmVXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHVwZGF0ZUN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgYWN0aXZlV2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlQ3Vyc29yUG9zaXRpb24pO1xuICAgIH1cblxuICAgIFxuICAgIGNsZWFudXAoKSB7XG4gICAgICAgIHRoaXMudGV4dGFyZWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5oYW5kbGVLZXl1cC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5ZG93bi5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0YXJlYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnRleHRhcmVhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5oYW5kbGVCbHVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGFzeW5jIEJNT2NoYXRib3QoKSB7ICAgICAgXG4gICAgICAgIGF3YWl0IGdldEFjdGl2ZUZpbGVDb250ZW50KHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBtZXNzYWdlSGlzdG9yeS5sZW5ndGggLSAxO1xuXG4gICAgICAgIC8vIElmIG1vZGVsIGRvZXMgbm90IGV4aXN0LlxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID09PSAnJykge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gJ01vZGVsIG5vdCBmb3VuZC4nO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG5cbiAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuYm90TWVzc2FnZScpO1xuICAgICAgICAgICAgY29uc3QgbGFzdEJvdE1lc3NhZ2UgPSBib3RNZXNzYWdlc1tib3RNZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGxhc3RCb3RNZXNzYWdlLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgfSBcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBGZXRjaCBPcGVuQUkgQVBJXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPbGxhbWFSZXNwb25zZVN0cmVhbSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPbGxhbWFSZXNwb25zZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTE1vZGVscy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKXtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hSRVNUQVBJVVJMUmVzcG9uc2VTdHJlYW0odGhpcy5wbHVnaW4sIHRoaXMuc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoUkVTVEFQSVVSTFJlc3BvbnNlKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoQU5USFJPUElDX01PREVMUy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hBbnRocm9waWNSZXNwb25zZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLm1pc3RyYWxNb2RlbHMuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuZW5hYmxlU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoTWlzdHJhbFJlc3BvbnNlU3RyZWFtKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE1pc3RyYWxSZXNwb25zZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmdlbWluaU1vZGVscy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlU3RyZWFtKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hHb29nbGVHZW1pbmlSZXNwb25zZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPcGVuQUlBUElSZXNwb25zZVN0cmVhbSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgaW5kZXgpOyBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoT3BlbkFJQVBJUmVzcG9uc2UodGhpcy5wbHVnaW4sIHRoaXMuc2V0dGluZ3MsIGluZGV4KTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSl7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPcGVuUm91dGVyUmVzcG9uc2VTdHJlYW0odGhpcy5wbHVnaW4sIHRoaXMuc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoT3BlblJvdXRlclJlc3BvbnNlKHRoaXMucGx1Z2luLCB0aGlzLnNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gbm90IGZvdW5kLic7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZSh0aGlzLnBsdWdpbiwgdGhpcy5zZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuYm90TWVzc2FnZScpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RCb3RNZXNzYWdlID0gYm90TWVzc2FnZXNbYm90TWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgbGFzdEJvdE1lc3NhZ2Uuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0JNTyBzZXR0aW5nczonLCB0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBvbkNsb3NlKCkge1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGNsZWFuIHVwLlxuICAgIH1cblxufVxuXG4vLyBDcmVhdGUgZGF0YSBmb2xkZXIgYW5kIGxvYWQgSlNPTiBmaWxlXG5hc3luYyBmdW5jdGlvbiBsb2FkRGF0YShwbHVnaW46IEJNT0dQVCkge1xuICAgIGlmICghYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cygnLi8ub2JzaWRpYW4vcGx1Z2lucy9ibW8tY2hhdGJvdC9kYXRhLycpKSB7XG4gICAgICAgIHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5ta2RpcignLi8ub2JzaWRpYW4vcGx1Z2lucy9ibW8tY2hhdGJvdC9kYXRhLycpO1xuICAgIH1cblxuICAgIGlmIChhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKGZpbGVOYW1lTWVzc2FnZUhpc3RvcnlKc29uKHBsdWdpbikpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5yZWFkKGZpbGVOYW1lTWVzc2FnZUhpc3RvcnlKc29uKHBsdWdpbikpO1xuXG4gICAgICAgICAgICBpZiAoZmlsZUNvbnRlbnQudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VIaXN0b3J5ID0gW107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VIaXN0b3J5ID0gSlNPTi5wYXJzZShmaWxlQ29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIG1lc3NhZ2UgaGlzdG9yeTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBtZXNzYWdlSGlzdG9yeSA9IFtdO1xuICAgIH1cbn1cblxuLy8gRGVsZXRlIGFsbCBtZXNzYWdlcyBmcm9tIHRoZSBtZXNzYWdlQ29udGFpbmVyIGFuZCB0aGUgbWVzc2FnZUhpc3RvcnkgYXJyYXlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVBbGxNZXNzYWdlcyhwbHVnaW46IEJNT0dQVCkge1xuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuXG4gICAgLy8gUmVtb3ZlIGFsbCBjaGlsZCBub2RlcyBmcm9tIHRoZSBtZXNzYWdlQ29udGFpbmVyXG4gICAgaWYgKG1lc3NhZ2VDb250YWluZXIpIHtcbiAgICAgICAgd2hpbGUgKG1lc3NhZ2VDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgdGhlIG1lc3NhZ2VIaXN0b3J5IGFycmF5XG4gICAgbWVzc2FnZUhpc3RvcnkgPSBbXTtcblxuICAgIC8vIFdyaXRlIGFuIGVtcHR5IGFycmF5IHRvIHRoZSBtZXNzYWdlSGlzdG9yeS5qc29uIGZpbGVcbiAgICBjb25zdCBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZUhpc3RvcnksIG51bGwsIDQpO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLndyaXRlKGZpbGVOYW1lTWVzc2FnZUhpc3RvcnlKc29uKHBsdWdpbiksIGpzb25TdHJpbmcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHdyaXRpbmcgbWVzc2FnZUhpc3RvcnkuanNvbicsIGVycm9yKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3B1bGF0ZU1vZGVsRHJvcGRvd24ocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncyk6IEhUTUxTZWxlY3RFbGVtZW50IHtcbiAgICBjb25zdCBtb2RlbE9wdGlvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcbiAgICBtb2RlbE9wdGlvbnMuaWQgPSAnbW9kZWxPcHRpb25zJztcblxuICAgIGlmIChtb2RlbE9wdGlvbnMpIHtcbiAgICAgICAgbW9kZWxPcHRpb25zLmlubmVySFRNTCA9ICcnOyAvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG4gICAgfVxuXG4gICAgY29uc3QgZGVmYXVsdE1vZGVsID0gc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCB8fCBERUZBVUxUX1NFVFRJTkdTLmdlbmVyYWwubW9kZWw7XG5cbiAgICAvLyBHZXQgbW9kZWxzIGFzIGFycmF5c1xuICAgIGNvbnN0IG1vZGVsR3JvdXBzID0gW1xuICAgICAgICB7IG5hbWU6ICdPbGxhbWEgTW9kZWxzJywgbW9kZWxzOiBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscyB9LFxuICAgICAgICB7IG5hbWU6ICdSRVNUIEFQSSBNb2RlbHMnLCBtb2RlbHM6IHNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMgfSxcbiAgICAgICAgeyBuYW1lOiAnQW50aHJvcGljIE1vZGVscycsIG1vZGVsczogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLmFudGhyb3BpY01vZGVscyB9LFxuICAgICAgICB7IG5hbWU6ICdHb29nbGUgR2VtaW5pIE1vZGVscycsIG1vZGVsczogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmdlbWluaU1vZGVscyB9LFxuICAgICAgICB7IG5hbWU6ICdNaXN0cmFsIE1vZGVscycsIG1vZGVsczogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzIH0sXG4gICAgICAgIHsgbmFtZTogJ09wZW5BSS1CYXNlZCBNb2RlbHMnLCBtb2RlbHM6IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzIH0sXG4gICAgICAgIHsgbmFtZTogJ09wZW5Sb3V0ZXIgTW9kZWxzJywgbW9kZWxzOiBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMgfVxuICAgIF07XG5cbiAgICBpZiAoZGVmYXVsdE1vZGVsID09PSAnJykge1xuICAgICAgICBjb25zdCBvcHRpb25FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBvcHRpb25FbC50ZXh0Q29udGVudCA9ICdObyBNb2RlbCc7XG4gICAgICAgIG9wdGlvbkVsLnZhbHVlID0gJyc7XG4gICAgICAgIG9wdGlvbkVsLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgbW9kZWxPcHRpb25zLmFwcGVuZENoaWxkKG9wdGlvbkVsKTtcbiAgICB9XG4gICAgXG4gICAgbW9kZWxHcm91cHMuZm9yRWFjaChncm91cCA9PiB7XG4gICAgICAgIGlmIChncm91cC5tb2RlbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgb3B0Z3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRncm91cCcpO1xuICAgICAgICAgICAgb3B0Z3JvdXAubGFiZWwgPSBncm91cC5uYW1lO1xuICAgICAgICAgICAgZ3JvdXAubW9kZWxzLmZvckVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICAgICAgb3B0aW9uRWwudGV4dENvbnRlbnQgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICBvcHRpb25FbC52YWx1ZSA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbCA9PT0gZGVmYXVsdE1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkVsLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3B0Z3JvdXAuYXBwZW5kQ2hpbGQob3B0aW9uRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtb2RlbE9wdGlvbnMuYXBwZW5kQ2hpbGQob3B0Z3JvdXApO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBtb2RlbE9wdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICAgIHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID0gdGhpcy52YWx1ZTtcbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG1vZGVsT3B0aW9ucztcbn0iLCAiaW1wb3J0IHsgTW9kYWwsIE5vdGljZSwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCTU9TZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUywgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIgfSBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IGNvbG9yVG9IZXggfSBmcm9tICcuLi8uLi91dGlscy9Db2xvckNvbnZlcnRlcic7XG5pbXBvcnQgeyBmaWxlTmFtZU1lc3NhZ2VIaXN0b3J5SnNvbiwgbWVzc2FnZUhpc3RvcnkgfSBmcm9tICcuLi8uLi92aWV3JztcbmltcG9ydCBCTU9HUFQgZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBnZXRBYm9ydENvbnRyb2xsZXIgfSBmcm9tICcuLi9GZXRjaE1vZGVsUmVzcG9uc2UnO1xuaW1wb3J0IHsgZmV0Y2hNb2RlbFJlbmFtZVRpdGxlIH0gZnJvbSAnLi4vZWRpdG9yL0ZldGNoUmVuYW1lTm90ZVRpdGxlJztcbmltcG9ydCB7IGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZSB9IGZyb20gJy4vQm90TWVzc2FnZSc7XG5pbXBvcnQgeyBhZGRNZXNzYWdlIH0gZnJvbSAnLi9NZXNzYWdlJztcbi8vIERlZmluZSBoYW5kbGVyIGZ1bmN0aW9uIHNpZ25hdHVyZXNcbnR5cGUgQ29tbWFuZEhhbmRsZXIgPSAoaW5wdXQ6IHN0cmluZywgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBwbHVnaW46IEJNT0dQVCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD47XG5cbmV4cG9ydCBsZXQgbGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblxuLy8gRGVmaW5lIHRoZSBjb21tYW5kIG1hcCB3aXRoIGV4cGxpY2l0IHR5cGluZ1xuZXhwb3J0IGNvbnN0IGNvbW1hbmRNYXA6IFJlY29yZDxzdHJpbmcsIENvbW1hbmRIYW5kbGVyPiA9IHtcbiAgJy9oZWxwJzogKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSA9PiBjb21tYW5kSGVscChwbHVnaW4sIHNldHRpbmdzKSxcbiAgJy9tb2RlbCc6IChpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbikgPT4gY29tbWFuZE1vZGVsKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSxcbiAgJy9wcm9maWxlJzogKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSA9PiBjb21tYW5kUHJvZmlsZShpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbiksXG4gICcvcHJvbXB0JzogKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSA9PiBjb21tYW5kUHJvbXB0KGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSxcbiAgJy9yZWZlcmVuY2UnOiAoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pID0+IGNvbW1hbmRSZWZlcmVuY2UoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pLFxuICAnL3RlbXBlcmF0dXJlJzogKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSA9PiBjb21tYW5kVGVtcGVyYXR1cmUoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pLFxuICAnL21heHRva2Vucyc6IChpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbikgPT4gY29tbWFuZE1heFRva2VucyhpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbiksXG4gICcvYXBwZW5kJzogKGlucHV0LCBzZXR0aW5ncywgcGx1Z2luKSA9PiBjb21tYW5kQXBwZW5kKHBsdWdpbiwgc2V0dGluZ3MpLFxuICAnL3NhdmUnOiAoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pID0+IGNvbW1hbmRTYXZlKHBsdWdpbiwgc2V0dGluZ3MpLFxuICAnL2xvYWQnOiAoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pID0+IGNvbW1hbmRMb2FkKGlucHV0LCBwbHVnaW4sIHNldHRpbmdzKSxcbiAgJy9jbGVhcic6IChpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbikgPT4gcmVtb3ZlTWVzc2FnZVRocmVhZChwbHVnaW4sIDApLFxuICAnL3N0b3AnOiAoaW5wdXQsIHNldHRpbmdzLCBwbHVnaW4pID0+IGNvbW1hbmRTdG9wKClcbn07XG5cbi8vIFBvcHVsYXRlIGNvbW1hbmRNYXAgd2l0aCBhbGlhc2VzIGZvciBjbGVhbmVyIGFjY2Vzc1xuZXhwb3J0IGNvbnN0IGFsaWFzZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgJy9oZWxwJzogWycvaCcsICcvbWFuJywgJy9tYW51YWwnLCAnL2NvbW1hbmRzJ10sXG4gICcvbW9kZWwnOiBbJy9tJywgJy9tb2RlbHMnXSxcbiAgJy9wcm9maWxlJzogWycvcCcsICcvcHJvZicsICcvcHJvZmlsZXMnXSxcbiAgJy9wcm9tcHQnOiBbJy9wcm9tcHRzJ10sXG4gICcvcmVmZXJlbmNlJzogWycvcmVmJ10sXG4gICcvdGVtcGVyYXR1cmUnOiBbJy90ZW1wJywgJyddLFxuICAnL2NsZWFyJzogWycvYyddLFxuICAnL3N0b3AnOiBbJy9zJ11cbn07XG5cbk9iamVjdC5lbnRyaWVzKGFsaWFzZXMpLmZvckVhY2goKFtjb21tYW5kLCBhbGlhc0xpc3RdKSA9PiB7XG4gIGFsaWFzTGlzdC5mb3JFYWNoKGFsaWFzID0+IGNvbW1hbmRNYXBbYWxpYXNdID0gY29tbWFuZE1hcFtjb21tYW5kXSk7XG59KTtcblxuLy8gQ29tbWFuZCBleGVjdXRpb24gZnVuY3Rpb24gd2l0aCBjb3JyZWN0IHR5cGluZ1xuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGVDb21tYW5kKGlucHV0OiBzdHJpbmcsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcGx1Z2luOiBCTU9HUFQpOiB2b2lkIHwgUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvbW1hbmQgPSBpbnB1dC5zcGxpdCgnICcpWzBdO1xuICBjb25zdCBoYW5kbGVyID0gY29tbWFuZE1hcFtjb21tYW5kXSB8fCAoKCkgPT4gY29tbWFuZEZhbHNlKCkpO1xuICByZXR1cm4gaGFuZGxlcihpbnB1dCwgc2V0dGluZ3MsIHBsdWdpbik7XG59XG5cblxuLy8gRnVuY3Rpb24gdG8gY3JlYXRlIGFuZCBhcHBlbmQgYSBib3QgbWVzc2FnZVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvdE1lc3NhZ2Uoc2V0dGluZ3M6IEJNT1NldHRpbmdzKTogSFRNTERpdkVsZW1lbnQge1xuICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgY29uc3QgYm90TWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBib3RNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2JvdE1lc3NhZ2UnKTtcbiAgYm90TWVzc2FnZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRvSGV4KFxuICAgIHNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvciB8fFxuICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yKS50cmltKClcbiAgKTtcbiAgbWVzc2FnZUNvbnRhaW5lcj8uYXBwZW5kQ2hpbGQoYm90TWVzc2FnZSk7XG5cbiAgY29uc3QgYm90TmFtZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGJvdE5hbWVTcGFuLnRleHRDb250ZW50ID0gc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZSB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWU7XG4gIGJvdE5hbWVTcGFuLmNsYXNzTmFtZSA9ICdjaGF0Ym90TmFtZSc7XG4gIGJvdE1lc3NhZ2UuYXBwZW5kQ2hpbGQoYm90TmFtZVNwYW4pO1xuXG4gIGNvbnN0IG1lc3NhZ2VCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBtZXNzYWdlQmxvY2suY2xhc3NMaXN0LmFkZCgnbWVzc2FnZUJsb2NrJyk7XG4gIGJvdE1lc3NhZ2UuYXBwZW5kQ2hpbGQobWVzc2FnZUJsb2NrKTtcblxuICByZXR1cm4gbWVzc2FnZUJsb2NrO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWFuZEZhbHNlKCkge1xuICBuZXcgTm90aWNlKCdDb21tYW5kIG5vdCByZWNvZ25pemVkLiBUeXBlIGAvaGVscGAgZm9yIGNvbW1hbmRzLicpO1xuXG4gIGNvbnN0IGNoYXRib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJveCB0ZXh0YXJlYScpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG5cbiAgY2hhdGJveC52YWx1ZSA9ICcnO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09IENPTU1BTkQgRlVOQ1RJT05TID09PT09PT09PT09PT09PT09PT1cblxuLy8gYC9oZWxwYCBmb3IgaGVscCBjb21tYW5kc1xuZXhwb3J0IGZ1bmN0aW9uIGNvbW1hbmRIZWxwKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MpIHtcbiAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgYm90TWVzc2FnZURpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZSc7XG4gIGJvdE1lc3NhZ2VEaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChzZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgfHxcbiAgICAgIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvcikudHJpbSgpKTtcblxuICBjb25zdCBib3RNZXNzYWdlVG9vbEJhckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBib3RNZXNzYWdlVG9vbEJhckRpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZVRvb2xCYXInO1xuXG4gIGNvbnN0IGJvdE5hbWVTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOyBcbiAgYm90TmFtZVNwYW4udGV4dENvbnRlbnQgPSBzZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZTtcbiAgYm90TmFtZVNwYW4uY2xhc3NOYW1lID0gJ2NoYXRib3ROYW1lJztcblxuICBjb25zdCBtZXNzYWdlQmxvY2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbWVzc2FnZUJsb2NrRGl2LmNsYXNzTmFtZSA9ICdtZXNzYWdlQmxvY2snO1xuXG4gIGNvbnN0IGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuY2xhc3NOYW1lID0gJ2NvbW1hbmRCb3RNZXNzYWdlJztcblxuICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICBoZWFkZXIudGV4dENvbnRlbnQgPSAnTWFudWFsJztcbiAgaGVhZGVyLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcblxuICBjb25zdCBnZW5lcmFsQ29tbWFuZEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2g0Jyk7XG4gIGdlbmVyYWxDb21tYW5kSGVhZGVyLnRleHRDb250ZW50ID0gJ0dlbmVyYWwgQ29tbWFuZHMnO1xuICBnZW5lcmFsQ29tbWFuZEhlYWRlci5zdHlsZS50ZXh0QWxpZ24gPSAnbGVmdCc7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChnZW5lcmFsQ29tbWFuZEhlYWRlcik7XG5cbiAgY29uc3QgY29tbWFuZENsZWFyUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZENsZWFyUC5pbm5lckhUTUwgPSAnPGNvZGU+L2NsZWFyPC9jb2RlPiBvciA8Y29kZT4vYzwvY29kZT4gLSBDbGVhciBjaGF0IGhpc3RvcnkuJztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGNvbW1hbmRDbGVhclApO1xuXG4gIGNvbnN0IGNvbW1hbmRSZWZPblAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1hbmRSZWZPblAuaW5uZXJIVE1MID0gJzxjb2RlPi9yZWYgb248L2NvZGU+IC0gVHVybiBvbiBcInJlZmVyZW5jZSBjdXJyZW50IG5vdGVcIi4nO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoY29tbWFuZFJlZk9uUCk7XG5cbiAgY29uc3QgY29tbWFuZFJlZk9mZlAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1hbmRSZWZPZmZQLmlubmVySFRNTCA9ICc8Y29kZT4vcmVmIG9mZjwvY29kZT4gLSBUdXJuIG9mZiBcInJlZmVyZW5jZSBjdXJyZW50IG5vdGVcIi4nO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoY29tbWFuZFJlZk9mZlApO1xuXG4gIGNvbnN0IGNvbW1hbmRNYXhUb2tlbnNQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kTWF4VG9rZW5zUC5pbm5lckhUTUwgPSAnPGNvZGU+L21heHRva2VucyBbVkFMVUVdPC9jb2RlPiAtIFNldCBtYXggdG9rZW5zLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kTWF4VG9rZW5zUCk7XG5cbiAgY29uc3QgY29tbWFuZFRlbXBQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kVGVtcFAuaW5uZXJIVE1MID0gJzxjb2RlPi90ZW1wIFtWQUxVRV08L2NvZGU+IC0gQ2hhbmdlIHRlbXBlcmF0dXJlIHJhbmdlIGZyb20gMCB0byAyLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kVGVtcFApO1xuXG4gIGNvbnN0IHByb2ZpbGVDb21tYW5kSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKTtcbiAgcHJvZmlsZUNvbW1hbmRIZWFkZXIudGV4dENvbnRlbnQgPSAnUHJvZmlsZSBDb21tYW5kcyc7XG4gIHByb2ZpbGVDb21tYW5kSGVhZGVyLnN0eWxlLnRleHRBbGlnbiA9ICdsZWZ0JztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKHByb2ZpbGVDb21tYW5kSGVhZGVyKTtcblxuICBjb25zdCBjb21tYW5kUHJvZmlsZUxpc3RQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kUHJvZmlsZUxpc3RQLmlubmVySFRNTCA9ICc8Y29kZT4vcHJvZmlsZTwvY29kZT4gLSBMaXN0IHByb2ZpbGUuJztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGNvbW1hbmRQcm9maWxlTGlzdFApO1xuXG4gIGNvbnN0IGNvbW1hbmRQcm9maWxlQ2hhbmdlUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZFByb2ZpbGVDaGFuZ2VQLmlubmVySFRNTCA9ICc8Y29kZT4vcHJvZmlsZSBbUFJPRklMRS1OQU1FXSBvciBbVkFMVUVdPC9jb2RlPiAtIENoYW5nZSBwcm9maWxlLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kUHJvZmlsZUNoYW5nZVApO1xuXG4gIGNvbnN0IG1vZGVsQ29tbWFuZEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2g0Jyk7XG4gIG1vZGVsQ29tbWFuZEhlYWRlci50ZXh0Q29udGVudCA9ICdNb2RlbCBDb21tYW5kcyc7XG4gIG1vZGVsQ29tbWFuZEhlYWRlci5zdHlsZS50ZXh0QWxpZ24gPSAnbGVmdCc7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChtb2RlbENvbW1hbmRIZWFkZXIpO1xuXG4gIGNvbnN0IGNvbW1hbmRNb2RlbExpc3RQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kTW9kZWxMaXN0UC5pbm5lckhUTUwgPSAnPGNvZGU+L21vZGVsPC9jb2RlPiAtIExpc3QgbW9kZWwuJztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGNvbW1hbmRNb2RlbExpc3RQKTtcblxuICBjb25zdCBjb21tYW5kTW9kZWxDaGFuZ2VQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kTW9kZWxDaGFuZ2VQLmlubmVySFRNTCA9ICc8Y29kZT4vbW9kZWwgW01PREVMLU5BTUVdIG9yIFtWQUxVRV08L2NvZGU+IC0gQ2hhbmdlIG1vZGVsLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kTW9kZWxDaGFuZ2VQKTtcblxuICBjb25zdCBwcm9tcHRDb21tYW5kSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKTtcbiAgcHJvbXB0Q29tbWFuZEhlYWRlci50ZXh0Q29udGVudCA9ICdQcm9tcHQgQ29tbWFuZHMnO1xuICBwcm9tcHRDb21tYW5kSGVhZGVyLnN0eWxlLnRleHRBbGlnbiA9ICdsZWZ0JztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKHByb21wdENvbW1hbmRIZWFkZXIpO1xuXG4gIGNvbnN0IGNvbW1hbmRQcm9tcHRMaXN0UCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZFByb21wdExpc3RQLmlubmVySFRNTCA9ICc8Y29kZT4vcHJvbXB0PC9jb2RlPiAtIExpc3QgcHJvbXB0cy4nO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoY29tbWFuZFByb21wdExpc3RQKTtcblxuICBjb25zdCBjb21tYW5kUHJvbXB0Q2hhbmdlUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZFByb21wdENoYW5nZVAuaW5uZXJIVE1MID0gJzxjb2RlPi9wcm9tcHQgW1BST01QVC1OQU1FXSBvciBbVkFMVUVdPC9jb2RlPiAtIENoYW5nZSBwcm9tcHRzLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kUHJvbXB0Q2hhbmdlUCk7XG5cbiAgY29uc3QgY29tbWFuZFByb21wdENsZWFyUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZFByb21wdENsZWFyUC5pbm5lckhUTUwgPSAnPGNvZGU+L3Byb21wdCBjbGVhcjwvY29kZT4gLSBDbGVhciBwcm9tcHQuJztcbiAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGNvbW1hbmRQcm9tcHRDbGVhclApO1xuXG4gIGNvbnN0IGVkaXRvckNvbW1hbmRIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNCcpO1xuICBlZGl0b3JDb21tYW5kSGVhZGVyLnRleHRDb250ZW50ID0gJ0VkaXRvciBDb21tYW5kcyc7XG4gIGVkaXRvckNvbW1hbmRIZWFkZXIuc3R5bGUudGV4dEFsaWduID0gJ2xlZnQnO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoZWRpdG9yQ29tbWFuZEhlYWRlcik7XG5cbiAgY29uc3QgY29tbWFuZEFwcGVuZFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1hbmRBcHBlbmRQLmlubmVySFRNTCA9ICc8Y29kZT4vYXBwZW5kPC9jb2RlPiAtIEFwcGVuZCBjdXJyZW50IGNoYXQgaGlzdG9yeSB0byBjdXJyZW50IGFjdGl2ZSBub3RlLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kQXBwZW5kUCk7XG5cbiAgY29uc3QgY29tbWFuZFNhdmVQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tYW5kU2F2ZVAuaW5uZXJIVE1MID0gJzxjb2RlPi9zYXZlPC9jb2RlPiAtIFNhdmUgY3VycmVudCBjaGF0IGhpc3RvcnkgdG8gYSBub3RlLic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kU2F2ZVApO1xuXG4gIGNvbnN0IGNvbW1hbmRMb2FkUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWFuZExvYWRQLmlubmVySFRNTCA9ICc8Y29kZT4vbG9hZDwvY29kZT4gLSBMaXN0IG9yIGxvYWQgYSBjaGF0IGhpc3RvcnkgaW50byB2aWV3Lic7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChjb21tYW5kTG9hZFApO1xuXG4gIGNvbnN0IHN0cmVhbUNvbW1hbmRIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNCcpO1xuICBzdHJlYW1Db21tYW5kSGVhZGVyLnRleHRDb250ZW50ID0gJ1Jlc3BvbnNlIENvbW1hbmRzJztcbiAgc3RyZWFtQ29tbWFuZEhlYWRlci5zdHlsZS50ZXh0QWxpZ24gPSAnbGVmdCc7XG4gIGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChzdHJlYW1Db21tYW5kSGVhZGVyKTtcblxuICBjb25zdCBjb21tYW5kU3RvcFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1hbmRTdG9wUC5pbm5lckhUTUwgPSAnPGNvZGU+L3N0b3A8L2NvZGU+IG9yIDxjb2RlPi9zPC9jb2RlPiAtIFN0b3AgZmV0Y2hpbmcgcmVzcG9uc2UuIFdhcm5pbmc6IEFudGhyb3ByaWMgbW9kZWxzIGNhbm5vdCBiZSBhYm9ydGVkLiBQbGVhc2UgdXNlIHdpdGggY2F1dGlvbi4nO1xuICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoY29tbWFuZFN0b3BQKTtcblxuICBtZXNzYWdlQmxvY2tEaXYuYXBwZW5kQ2hpbGQoZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2KTtcbiAgYm90TWVzc2FnZVRvb2xCYXJEaXYuYXBwZW5kQ2hpbGQoYm90TmFtZVNwYW4pO1xuICBib3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VUb29sQmFyRGl2KTtcbiAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2tEaXYpO1xuXG4gIGNvbnN0IGluZGV4ID0gbWVzc2FnZUhpc3RvcnkubGVuZ3RoIC0gMTtcblxuICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZUJsb2NrRGl2LmlubmVySFRNTCwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuXG4gIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG59XG5cbi8vIGAvbW9kZWwgXCJbVkFMVUVdXCJgIHRvIGNoYW5nZSBtb2RlbC5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21tYW5kTW9kZWwoaW5wdXQ6IHN0cmluZywgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBwbHVnaW46IEJNT0dQVCkge1xuICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIC8vIEdldCBtb2RlbHMgYXMgYXJyYXlzXG4gICAgY29uc3Qgb2xsYW1hTW9kZWxzID0gc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMubWFwKG1vZGVsID0+IG1vZGVsKTtcbiAgICBjb25zdCBSRVNUQVBJTW9kZWxzID0gc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTE1vZGVscy5tYXAobW9kZWwgPT4gbW9kZWwpO1xuICAgIGNvbnN0IGFudGhyb3BpY01vZGVscyA9IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5hbnRocm9waWNNb2RlbHMubWFwKG1vZGVsID0+IG1vZGVsKTtcbiAgICBjb25zdCBnb29nbGVHZW1pbmlNb2RlbHMgPSBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzLm1hcChtb2RlbCA9PiBtb2RlbCk7XG4gICAgY29uc3QgbWlzdHJhbE1vZGVscyA9IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwubWlzdHJhbE1vZGVscy5tYXAobW9kZWwgPT4gbW9kZWwpO1xuICAgIGNvbnN0IG9wZW5BSUJhc2VNb2RlbHMgPSBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZU1vZGVscy5tYXAobW9kZWwgPT4gbW9kZWwpO1xuICAgIGNvbnN0IG9wZW5Sb3V0ZXJNb2RlbHMgPSBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMubWFwKG1vZGVsID0+IG1vZGVsKTtcblxuICAgIC8vIENvbWJpbmUgYWxsIG1vZGVsc1xuICAgIGNvbnN0IGFsbE1vZGVscyA9IFtcbiAgICAgIC4uLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzLFxuICAgICAgLi4uc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTE1vZGVscyxcbiAgICAgIC4uLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5hbnRocm9waWNNb2RlbHMsXG4gICAgICAuLi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzLFxuICAgICAgLi4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLFxuICAgICAgLi4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMsXG4gICAgICAuLi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHNcbiAgXTtcbiAgXG4gIC8vIENoZWNrIGlmIHRoZSB1c2VyIGhhcyBub3Qgc3BlY2lmaWVkIGEgbW9kZWwgYWZ0ZXIgdGhlIFwiL21vZGVsXCIgY29tbWFuZFxuICBpZiAoIWlucHV0LnNwbGl0KCcgJylbMV0pIHtcblxuICAgIGxldCBjdXJyZW50TW9kZWwgPSBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsO1xuXG4gICAgLy8gQ2hlY2sgaWYgY3VycmVudE1vZGVsIGlzIGVtcHR5LCBhbmQgc2V0IGl0IHRvIFwiRW1wdHlcIiBpZiBpdCBpc1xuICAgIGlmICghY3VycmVudE1vZGVsKSB7XG4gICAgICBjdXJyZW50TW9kZWwgPSAnRW1wdHknO1xuICAgIH1cblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBib3RNZXNzYWdlRGl2LmNsYXNzTmFtZSA9ICdib3RNZXNzYWdlJztcbiAgICBib3RNZXNzYWdlRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yVG9IZXgoc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yIHx8XG4gICAgICAgIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvcikudHJpbSgpKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VUb29sQmFyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYm90TWVzc2FnZVRvb2xCYXJEaXYuY2xhc3NOYW1lID0gJ2JvdE1lc3NhZ2VUb29sQmFyJztcblxuICAgIGNvbnN0IGJvdE5hbWVTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOyBcbiAgICBib3ROYW1lU3Bhbi50ZXh0Q29udGVudCA9IHNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWUgfHwgREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lO1xuICAgIGJvdE5hbWVTcGFuLmNsYXNzTmFtZSA9ICdjaGF0Ym90TmFtZSc7XG5cbiAgICBjb25zdCBtZXNzYWdlQmxvY2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBtZXNzYWdlQmxvY2tEaXYuY2xhc3NOYW1lID0gJ21lc3NhZ2VCbG9jayc7XG5cbiAgICBjb25zdCBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuY2xhc3NOYW1lID0gJ2NvbW1hbmRCb3RNZXNzYWdlJztcblxuICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgaGVhZGVyLnRleHRDb250ZW50ID0gJ01vZGVsIExpc3QnO1xuICAgIGhlYWRlci5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcblxuICAgIGNvbnN0IGN1cnJlbnRNb2RlbFAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgY3VycmVudE1vZGVsUC5pbm5lckhUTUwgPSBgPGI+Q3VycmVudCBNb2RlbDo8L2I+ICR7Y3VycmVudE1vZGVsfWA7XG4gICAgY3VycmVudE1vZGVsUC5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoY3VycmVudE1vZGVsUCk7XG5cbiAgICBjb25zdCBhcGlMaXN0cyA9IFtcbiAgICAgIHsgaGVhZGVyOiAnT2xsYW1hIE1vZGVscycsIGl0ZW1zOiBvbGxhbWFNb2RlbHMgfSxcbiAgICAgIHsgaGVhZGVyOiAnUkVTVCBBUEkgTW9kZWxzJywgaXRlbXM6IFJFU1RBUElNb2RlbHMgfSxcbiAgICAgIHsgaGVhZGVyOiAnQW50aHJvcGljIE1vZGVscycsIGl0ZW1zOiBhbnRocm9waWNNb2RlbHN9LFxuICAgICAgeyBoZWFkZXI6ICdHb29nbGUgR2VtaW5pIE1vZGVscycsIGl0ZW1zOiBnb29nbGVHZW1pbmlNb2RlbHMgfSxcbiAgICAgIHsgaGVhZGVyOiAnTWlzdHJhbCBNb2RlbHMnLCBpdGVtczogbWlzdHJhbE1vZGVscyB9LFxuICAgICAgeyBoZWFkZXI6ICdPcGVuQUktQmFzZWQgTW9kZWxzJywgaXRlbXM6IG9wZW5BSUJhc2VNb2RlbHMgfSxcbiAgICAgIHsgaGVhZGVyOiAnT3BlblJvdXRlciBNb2RlbHMnLCBpdGVtczogb3BlblJvdXRlck1vZGVscyB9XG4gICAgXTtcbiAgICBcbiAgICBsZXQgY3VycmVudFN0YXJ0SW5kZXggPSAxO1xuICAgIFxuICAgIGFwaUxpc3RzLmZvckVhY2goYXBpID0+IHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGFwaS5pdGVtcykgJiYgYXBpLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNCcpO1xuICAgICAgICBoZWFkZXIudGV4dENvbnRlbnQgPSBhcGkuaGVhZGVyO1xuICAgICAgICBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcbiAgICBcbiAgICAgICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29sJyk7XG4gICAgICAgIGxpc3Quc2V0QXR0cmlidXRlKCdzdGFydCcsIFN0cmluZyhjdXJyZW50U3RhcnRJbmRleCkpO1xuICAgIFxuICAgICAgICBhcGkuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICBjb25zdCBsaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgbGlzdEl0ZW0udGV4dENvbnRlbnQgPSBpdGVtO1xuICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQobGlzdEl0ZW0pO1xuICAgICAgICB9KTtcbiAgICBcbiAgICAgICAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGxpc3QpO1xuICAgIFxuICAgICAgICAvLyBVcGRhdGUgdGhlIGN1cnJlbnRTdGFydEluZGV4IGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgaXRlbXMgaW4gdGhlIGxpc3RcbiAgICAgICAgY3VycmVudFN0YXJ0SW5kZXggKz0gYXBpLml0ZW1zLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBcblxuICAgIG1lc3NhZ2VCbG9ja0Rpdi5hcHBlbmRDaGlsZChkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2VEaXYpO1xuICAgIGJvdE1lc3NhZ2VUb29sQmFyRGl2LmFwcGVuZENoaWxkKGJvdE5hbWVTcGFuKTtcbiAgICBib3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VUb29sQmFyRGl2KTtcbiAgICBib3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKG1lc3NhZ2VCbG9ja0Rpdik7XG5cbiAgICBjb25zdCBpbmRleCA9IG1lc3NhZ2VIaXN0b3J5Lmxlbmd0aCAtIDE7XG5cbiAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZUJsb2NrRGl2LmlubmVySFRNTCwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHRoZSB1c2VyIGhhcyBzcGVjaWZpZWQgYSBtb2RlbCBhZnRlciB0aGUgXCIvbW9kZWxcIiBjb21tYW5kXG4gIGlmIChpbnB1dC5zcGxpdCgnICcpWzFdICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBpbnB1dE1vZGVsID0gaW5wdXQuc3BsaXQoJyAnKVsxXS5yZXBsYWNlKC9eXCIoLiopXCIkLywgJyQxJyk7XG5cbiAgICBjb25zdCBtb2RlbEFsaWFzZXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7fTtcblxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGFsbE1vZGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgbW9kZWwgPSBhbGxNb2RlbHNbaSAtIDFdO1xuICAgICAgbW9kZWxBbGlhc2VzW2ldID0gbW9kZWw7XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5lbnRyaWVzKG1vZGVsQWxpYXNlcykuZmluZCgoW2tleSwgdmFsXSkgPT4ga2V5ID09PSBpbnB1dE1vZGVsKSl7XG4gICAgICBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsID0gbW9kZWxBbGlhc2VzW2lucHV0TW9kZWxdO1xuICAgICAgbmV3IE5vdGljZShgVXBkYXRlZCBtb2RlbCB0byAke3NldHRpbmdzLmdlbmVyYWwubW9kZWx9YCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKE9iamVjdC5lbnRyaWVzKG1vZGVsQWxpYXNlcykuZmluZCgoW2tleSwgdmFsXSkgPT4gdmFsID09PSBpbnB1dE1vZGVsKSkge1xuICAgICAgc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCA9IG1vZGVsQWxpYXNlc1tPYmplY3Qua2V5cyhtb2RlbEFsaWFzZXMpLmZpbmQoa2V5ID0+IG1vZGVsQWxpYXNlc1trZXldID09PSBpbnB1dE1vZGVsKSB8fCAnJ107XG4gICAgICBuZXcgTm90aWNlKGBVcGRhdGVkIG1vZGVsIHRvICR7c2V0dGluZ3MuZ2VuZXJhbC5tb2RlbH1gKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBuZXcgTm90aWNlKCdJbnZhbGlkIG1vZGVsLicpO1xuICAgIH1cblxuICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgfVxufVxuXG4vLyBgL3Byb2ZpbGUgXCJbVkFMVUVdXCJgIHRvIGNoYW5nZSBwcm9maWxlLlxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbW1hbmRQcm9maWxlKGlucHV0OiBzdHJpbmcsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcGx1Z2luOiBCTU9HUFQpIHtcbiAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5cbiAgaWYgKCFzZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCkge1xuICAgIG5ldyBOb3RpY2UoJ1Byb2ZpbGUgZm9sZGVyIHBhdGggbm90IHNldC4nKTtcbiAgICBjb25zdCBjb21tYW5kQm90TWVzc2FnZSA9ICc8cD5Qcm9maWxlIGZvbGRlciBwYXRoIG5vdCBzZXQuPC9wPic7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBjb21tYW5kQm90TWVzc2FnZSk7XG4gICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBGZXRjaGluZyBmaWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZm9sZGVyXG4gIGNvbnN0IGZpbGVzID0gcGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZmlsZSkgPT4gZmlsZS5wYXRoLnN0YXJ0c1dpdGgocGx1Z2luLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoKSk7XG5cbiAgLy8gU29ydGluZyB0aGUgZmlsZXMgYXJyYXkgYWxwaGFiZXRpY2FsbHkgYnkgZmlsZSBuYW1lXG4gIGZpbGVzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xuXG4gIGxldCBjdXJyZW50UHJvZmlsZSA9IHNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG5cbiAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIgaGFzIG5vdCBzcGVjaWZpZWQgYSBwcm9maWxlXG4gIGlmICghaW5wdXQuc3BsaXQoJyAnKVsxXSkge1xuXG4gICAgLy8gTG9vcCB0aHJvdWdoIGZpbGVzIGFuZCBjcmVhdGUgbGlzdCBpdGVtcywgcmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG4gICAgY29uc3QgZmlsZUxpc3RJdGVtcyA9IGZpbGVzLm1hcChmaWxlID0+IHtcbiAgICAgIGNvbnN0IGZpbGVOYW1lV2l0aG91dEV4dGVuc2lvbiA9IGZpbGUubmFtZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpOyAvLyBSZW1vdmluZyB0aGUgbGFzdCBkb3QgYW5kIHdoYXQgZm9sbG93c1xuICAgICAgcmV0dXJuIGA8bGk+JHtmaWxlTmFtZVdpdGhvdXRFeHRlbnNpb259PC9saT5gO1xuICAgIH0pLmpvaW4oJycpO1xuXG4gICAgLy8gQ2hlY2sgaWYgY3VycmVudFByb2ZpbGUgaXMgZW1wdHksIGFuZCBzZXQgaXQgdG8gXCJFbXB0eVwiIGlmIGl0IGlzXG4gICAgaWYgKCFjdXJyZW50UHJvZmlsZSkge1xuICAgICAgY3VycmVudFByb2ZpbGUgPSAnRW1wdHknO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmRCb3RNZXNzYWdlID0gXG4gICAgYDxoMiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjtcIj5Qcm9maWxlczwvaDI+XG4gICAgICA8cCBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjtcIj48Yj5DdXJyZW50IHByb2ZpbGU6PC9iPiAke2N1cnJlbnRQcm9maWxlfTwvcD5cbiAgICAgIDxvbD4ke2ZpbGVMaXN0SXRlbXN9PC9vbD5gO1xuXG4gICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgY29tbWFuZEJvdE1lc3NhZ2UpO1xuICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDaGVjayBpZiB0aGUgdXNlciBoYXMgc3BlY2lmaWVkIGEgcHJvZmlsZVxuICBpZiAoaW5wdXQuc3RhcnRzV2l0aCgnL3AnKSB8fCBcbiAgICAgIGlucHV0LnN0YXJ0c1dpdGgoJy9wcm9mJykgfHwgXG4gICAgICBpbnB1dC5zdGFydHNXaXRoKCcvcHJvZmlsZScpIHx8IFxuICAgICAgaW5wdXQuc3RhcnRzV2l0aCgnL3Byb2ZpbGVzJykpIHtcbiAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0LnNwbGl0KCcgJykuc2xpY2UoMSkuam9pbignICcpLnRyaW0oKTtcblxuICAgIC8vIFJlbW92ZSBxdW90YXRpb24gbWFya3MgaWYgcHJlc2VudFxuICAgIGlmICgoaW5wdXRWYWx1ZS5zdGFydHNXaXRoKCdcIicpICYmIGlucHV0VmFsdWUuZW5kc1dpdGgoJ1wiJykpIHx8XG4gICAgICAgIChpbnB1dFZhbHVlLnN0YXJ0c1dpdGgoJ1xcJycpICYmIGlucHV0VmFsdWUuZW5kc1dpdGgoJ1xcJycpKSkge1xuICAgICAgaW5wdXRWYWx1ZSA9IGlucHV0VmFsdWUuc3Vic3RyaW5nKDEsIGlucHV0VmFsdWUubGVuZ3RoIC0gMSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHByb2ZpbGVBbGlhc2VzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge307XG4gICAgXG4gICAgLy8gQ3JlYXRlIGFsaWFzZXMgZm9yIGVhY2ggZmlsZSAocHJvZmlsZSlcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBmaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uID0gZmlsZXNbaSAtIDFdLm5hbWUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTtcbiAgICAgIHByb2ZpbGVBbGlhc2VzW2kudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpXSA9IGZpbGVOYW1lV2l0aG91dEV4dGVuc2lvbjtcbiAgICB9XG5cbiAgICBpZiAocHJvZmlsZUFsaWFzZXNbaW5wdXRWYWx1ZV0pIHtcbiAgICAgIC8vIElmIGlucHV0IG1hdGNoZXMgYSBrZXkgaW4gcHJvZmlsZUFsaWFzZXNcbiAgICAgIHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlID0gcHJvZmlsZUFsaWFzZXNbaW5wdXRWYWx1ZV0gKyAnLm1kJztcbiAgICAgIGNvbnN0IHByb2ZpbGVGaWxlUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCArICcvJyArIHByb2ZpbGVBbGlhc2VzW2lucHV0VmFsdWVdICsgJy5tZCc7XG4gICAgICBjb25zdCBjdXJyZW50UHJvZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHByb2ZpbGVGaWxlUGF0aCkgYXMgVEZpbGU7XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRQcm9maWxlTmFtZSA9IHNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG4gIFxuICAgICAgLy8gRmluZGluZyB0aGUgaW5kZXggb2YgdGhlIGN1cnJlbnRQcm9maWxlIGluIHRoZSBwcm9maWxlRmlsZXMgYXJyYXlcbiAgICAgIGNvbnN0IHByb2ZpbGVJbmRleCA9IGZpbGVzLmZpbmRJbmRleCgoZmlsZSkgPT4gZmlsZS5iYXNlbmFtZSA9PT0gY3VycmVudFByb2ZpbGVOYW1lKTtcblxuICAgICAgc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aCA9IHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtwcm9maWxlSW5kZXhdO1xuXG4gICAgICAvLyBuZXcgTm90aWNlKGBQcm9maWxlIHVwZGF0ZWQgdG8gJyR7cHJvZmlsZUFsaWFzZXNbaW5wdXRWYWx1ZV19J2ApO1xuICAgICAgcGx1Z2luLmFjdGl2YXRlVmlldygpO1xuICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIocGx1Z2luLCBjdXJyZW50UHJvZmlsZSk7XG4gICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSBlbHNlIGlmIChPYmplY3QudmFsdWVzKHByb2ZpbGVBbGlhc2VzKS5tYXAodiA9PiB2LnRvTG93ZXJDYXNlKCkpLmluY2x1ZGVzKGlucHV0VmFsdWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgLy8gSWYgaW5wdXQgbWF0Y2hlcyBhIHZhbHVlIGluIHByb2ZpbGVBbGlhc2VzIChjYXNlLWluc2Vuc2l0aXZlKVxuICAgICAgICBjb25zdCBtYXRjaGVkUHJvZmlsZSA9IE9iamVjdC5lbnRyaWVzKHByb2ZpbGVBbGlhc2VzKS5maW5kKChba2V5LCB2YWx1ZV0pID0+IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IGlucHV0VmFsdWUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChtYXRjaGVkUHJvZmlsZSkge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUgPSBtYXRjaGVkUHJvZmlsZVsxXSArICcubWQnO1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZUZpbGVQYXRoID0gcGx1Z2luLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoICsgJy8nICsgbWF0Y2hlZFByb2ZpbGVbMV0gKyAnLm1kJztcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQcm9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJvZmlsZUZpbGVQYXRoKSBhcyBURmlsZTtcblxuICAgICAgICAgICAgY29uc3QgY3VycmVudFByb2ZpbGVOYW1lID0gc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpOyAvLyBSZW1vdmluZyB0aGUgZmlsZSBleHRlbnNpb25cbiAgXG4gICAgICAgICAgICAvLyBGaW5kaW5nIHRoZSBpbmRleCBvZiB0aGUgY3VycmVudFByb2ZpbGUgaW4gdGhlIHByb2ZpbGVGaWxlcyBhcnJheVxuICAgICAgICAgICAgY29uc3QgcHJvZmlsZUluZGV4ID0gZmlsZXMuZmluZEluZGV4KChmaWxlKSA9PiBmaWxlLmJhc2VuYW1lID09PSBjdXJyZW50UHJvZmlsZU5hbWUpO1xuICAgICAgXG4gICAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoID0gc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5W3Byb2ZpbGVJbmRleF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHBsdWdpbi5hY3RpdmF0ZVZpZXcoKTtcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNldHRpbmdzRnJvbUZyb250TWF0dGVyKHBsdWdpbiwgY3VycmVudFByb2ZpbGUpO1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCBwcm9maWxlLicpO1xuICAgIH1cblxuICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgfVxuXG59XG5cbi8vIGAvcHJvbXB0IFwiW1ZBTFVFXVwiYCB0byBjaGFuZ2UgcHJvbXB0LlxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbW1hbmRQcm9tcHQoaW5wdXQ6IHN0cmluZywgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBwbHVnaW46IEJNT0dQVCkge1xuICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICBpZiAoIXNldHRpbmdzLnByb21wdHMucHJvbXB0Rm9sZGVyUGF0aCkge1xuICAgIG5ldyBOb3RpY2UoJ1Byb21wdCBmb2xkZXIgcGF0aCBub3Qgc2V0LicpO1xuICAgIGNvbnN0IGNvbW1hbmRCb3RNZXNzYWdlID0gJzxwPlByb21wdCBmb2xkZXIgcGF0aCBub3Qgc2V0LjwvcD4nO1xuXG4gICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgY29tbWFuZEJvdE1lc3NhZ2UpO1xuICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlclxuICBjb25zdCBmaWxlcyA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHBsdWdpbi5zZXR0aW5ncy5wcm9tcHRzLnByb21wdEZvbGRlclBhdGgpKTtcblxuICAvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcbiAgZmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIgaGFzIG5vdCBzcGVjaWZpZWQgYSBwcm9tcHQgYWZ0ZXIgdGhlIFwiL3Byb21wdFwiIGNvbW1hbmRcbiAgaWYgKCFpbnB1dC5zcGxpdCgnICcpWzFdKSB7XG5cbiAgICAvLyBMb29wIHRocm91Z2ggZmlsZXMgYW5kIGNyZWF0ZSBsaXN0IGl0ZW1zLCByZW1vdmluZyB0aGUgZmlsZSBleHRlbnNpb25cbiAgICBjb25zdCBmaWxlTGlzdEl0ZW1zID0gZmlsZXMubWFwKGZpbGUgPT4ge1xuICAgICAgY29uc3QgZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uID0gZmlsZS5uYW1lLnJlcGxhY2UoL1xcLlteLy5dKyQvLCAnJyk7IC8vIFJlbW92aW5nIHRoZSBsYXN0IGRvdCBhbmQgd2hhdCBmb2xsb3dzXG4gICAgICByZXR1cm4gYDxsaT4ke2ZpbGVOYW1lV2l0aG91dEV4dGVuc2lvbn08L2xpPmA7XG4gICAgfSkuam9pbignJyk7XG5cbiAgICBsZXQgY3VycmVudFByb21wdCA9IHNldHRpbmdzLnByb21wdHMucHJvbXB0O1xuXG4gICAgLy8gQ2hlY2sgaWYgY3VycmVudFByb21wdCBpcyBlbXB0eSwgYW5kIHNldCBpdCB0byBcIkVtcHR5XCIgaWYgaXQgaXNcbiAgICBpZiAoIWN1cnJlbnRQcm9tcHQpIHtcbiAgICAgIGN1cnJlbnRQcm9tcHQgPSAnRW1wdHknO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmRCb3RNZXNzYWdlID0gXG4gICAgYDxoMiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjtcIj5Qcm9tcHRzPC9oMj5cbiAgICAgIDxwIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyO1wiPjxiPkN1cnJlbnQgcHJvbXB0OjwvYj4gJHtjdXJyZW50UHJvbXB0LnJlcGxhY2UoJy5tZCcsICcnKSB9PC9wPlxuICAgICAgPG9sPiR7ZmlsZUxpc3RJdGVtc308L29sPmA7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBjb21tYW5kQm90TWVzc2FnZSk7XG4gICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHRoZSB1c2VyIGhhcyBzcGVjaWZpZWQgYSBwcm9tcHQgYWZ0ZXIgdGhlIFwiL3Byb21wdFwiIGNvbW1hbmRcbiAgaWYgKGlucHV0LnN0YXJ0c1dpdGgoJy9wcm9tcHQnKSkge1xuICAgIGxldCBpbnB1dFZhbHVlID0gaW5wdXQuc3BsaXQoJyAnKS5zbGljZSgxKS5qb2luKCcgJykudHJpbSgpO1xuXG4gICAgLy8gUmVtb3ZlIHF1b3RhdGlvbiBtYXJrcyBpZiBwcmVzZW50XG4gICAgaWYgKChpbnB1dFZhbHVlLnN0YXJ0c1dpdGgoJ1wiJykgJiYgaW5wdXRWYWx1ZS5lbmRzV2l0aCgnXCInKSkgfHxcbiAgICAgICAgKGlucHV0VmFsdWUuc3RhcnRzV2l0aCgnXFwnJykgJiYgaW5wdXRWYWx1ZS5lbmRzV2l0aCgnXFwnJykpKSB7XG4gICAgICBpbnB1dFZhbHVlID0gaW5wdXRWYWx1ZS5zdWJzdHJpbmcoMSwgaW5wdXRWYWx1ZS5sZW5ndGggLSAxKTtcbiAgICB9XG5cbiAgICAvLyBTZXQgdG8gZGVmYXVsdCBvciBlbXB0eSBpZiB0aGUgaW5wdXQgaXMgJ2NsZWFyJyBvciAnYydcbiAgICBpZiAoaW5wdXRWYWx1ZSA9PT0gJ2NsZWFyJyB8fCBpbnB1dFZhbHVlID09PSAnYycpIHtcbiAgICAgIHNldHRpbmdzLnByb21wdHMucHJvbXB0ID0gJyc7IC8vIFNldCB0byBkZWZhdWx0IG9yIGVtcHR5XG4gICAgICBuZXcgTm90aWNlKCdQcm9tcHQgY2xlYXJlZC4nKTtcblxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBwcm9tcHRBbGlhc2VzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge307XG4gICAgXG4gICAgLy8gQ3JlYXRlIGFsaWFzZXMgZm9yIGVhY2ggZmlsZSAocHJvbXB0KVxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBmaWxlTmFtZVdpdGhvdXRFeHRlbnNpb24gPSBmaWxlc1tpIC0gMV0ubmFtZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpO1xuICAgICAgcHJvbXB0QWxpYXNlc1tpLnRvU3RyaW5nKCldID0gZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uO1xuICAgIH1cbiAgXG5cbiAgICBsZXQgY3VycmVudE1vZGVsO1xuICAgIGlmIChwcm9tcHRBbGlhc2VzW2lucHV0VmFsdWVdKSB7XG4gICAgICAvLyBJZiBpbnB1dCBtYXRjaGVzIGEga2V5IGluIHByb21wdEFsaWFzZXNcbiAgICAgIHNldHRpbmdzLnByb21wdHMucHJvbXB0ID0gcHJvbXB0QWxpYXNlc1tpbnB1dFZhbHVlXSArICcubWQnO1xuICAgICAgY3VycmVudE1vZGVsID0gc2V0dGluZ3MucHJvbXB0cy5wcm9tcHQucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG4gICAgICBuZXcgTm90aWNlKGBQcm9tcHQgdXBkYXRlZCB0byAnJHtjdXJyZW50TW9kZWx9J2ApO1xuICAgIH0gZWxzZSBpZiAoT2JqZWN0LnZhbHVlcyhwcm9tcHRBbGlhc2VzKS5tYXAodiA9PiB2LnRvTG93ZXJDYXNlKCkpLmluY2x1ZGVzKGlucHV0VmFsdWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIC8vIElmIGlucHV0IG1hdGNoZXMgYSB2YWx1ZSBpbiBwcm9maWxlQWxpYXNlcyAoY2FzZS1pbnNlbnNpdGl2ZSlcbiAgICAgIGNvbnN0IG1hdGNoZWRQcm9maWxlID0gT2JqZWN0LmVudHJpZXMocHJvbXB0QWxpYXNlcykuZmluZCgoW2tleSwgdmFsdWVdKSA9PiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBpbnB1dFZhbHVlLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgaWYgKG1hdGNoZWRQcm9maWxlKSB7XG4gICAgICAgIHNldHRpbmdzLnByb21wdHMucHJvbXB0ID0gbWF0Y2hlZFByb2ZpbGVbMV0gKyAnLm1kJztcbiAgICAgICAgY3VycmVudE1vZGVsID0gc2V0dGluZ3MucHJvbXB0cy5wcm9tcHQucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG4gICAgICAgIG5ldyBOb3RpY2UoYFByb21wdCB1cGRhdGVkIHRvICcke2N1cnJlbnRNb2RlbH0nYCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpbnB1dFZhbHVlICE9PSAnY2xlYXInICYmIGlucHV0VmFsdWUgIT09ICdjJykge1xuICAgICAgICBuZXcgTm90aWNlKCdJbnZhbGlkIHByb21wdC4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gIH1cblxufVxuXG4vLyBgL3JlZmAgdG8gdHVybiBvbi9vZmYgcmVmZXJlbmNlQ3VycmVudE5vdGUuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWFuZFJlZmVyZW5jZShpbnB1dDogc3RyaW5nLCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIHBsdWdpbjogQk1PR1BUKSB7XG4gIGNvbnN0IHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWZlcmVuY2VDdXJyZW50Tm90ZScpO1xuICBjb25zdCBpbnB1dFZhbHVlID0gaW5wdXQuc3BsaXQoJyAnKVsxXT8udG9Mb3dlckNhc2UoKTtcblxuICBpZiAoaW5wdXRWYWx1ZSA9PT0gJ3RydWUnIHx8IGlucHV0VmFsdWUgPT09ICdvbicpIHtcbiAgICBzZXR0aW5ncy5nZW5lcmFsLmVuYWJsZVJlZmVyZW5jZUN1cnJlbnROb3RlID0gdHJ1ZTtcbiAgICAgIGlmIChyZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQpIHtcbiAgICAgICAgICByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB9XG4gICAgICBuZXcgTm90aWNlKCdSZWZlcmVuY2UgY3VycmVudCBub3RlOiBvbi4nKTtcbiAgfSBlbHNlIGlmIChpbnB1dFZhbHVlID09PSAnZmFsc2UnIHx8IGlucHV0VmFsdWUgPT09ICdvZmYnKSB7XG4gICAgc2V0dGluZ3MuZ2VuZXJhbC5lbmFibGVSZWZlcmVuY2VDdXJyZW50Tm90ZSA9IGZhbHNlO1xuICAgICAgaWYgKHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudCkge1xuICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfVxuICAgICAgbmV3IE5vdGljZSAoJ1JlZmVyZW5jZSBjdXJyZW50IG5vdGU6IG9mZi4nKTtcbiAgfSBlbHNlIHtcbiAgICBuZXcgTm90aWNlKCdUeXBlIGAvcmVmIG9uYCBvciBgL3JlZiBvZmZgIHRvIHR1cm4gb24vb2ZmIHJlZmVyZW5jZSBjdXJyZW50IG5vdGUuJyk7XG4gIH1cblxuICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG59XG5cbi8vIGAvdGVtcCBcIlZBTFVFXCJgIHRvIGNoYW5nZSB0aGUgdGVtcGVyYXR1cmUuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWFuZFRlbXBlcmF0dXJlKGlucHV0OiBzdHJpbmcsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcGx1Z2luOiBCTU9HUFQpIHtcbiAgY29uc3QgaW5wdXRWYWx1ZSA9IGlucHV0LnNwbGl0KCcgJylbMV07XG4gIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0VmFsdWUpO1xuXG4gIGlmIChzZXR0aW5ncyAmJiAhaXNOYU4oZmxvYXRWYWx1ZSkpIHtcbiAgICBpZiAoZmxvYXRWYWx1ZSA8IDAuMDApIHtcbiAgICAgIHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUgPSAnMC4wMCc7XG4gICAgfSBlbHNlIGlmIChmbG9hdFZhbHVlID4gMi4wMCkge1xuICAgICAgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9ICcyLjAwJztcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9IGZsb2F0VmFsdWUudG9GaXhlZCgyKTtcbiAgICB9XG4gICAgbmV3IE5vdGljZShgVGVtcGVyYXR1cmUgdXBkYXRlZDogJHtzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlfWApO1xuICB9IGVsc2Uge1xuICAgIG5ldyBOb3RpY2UoYEN1cnJlbnQgdGVtcGVyYXR1cmU6ICR7c2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZX1gKTtcbiAgfVxuXG4gIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbn1cblxuLy8gYC9tYXh0b2tlbnNgIHRvIGNoYW5nZSBtYXhfdG9rZW5zLlxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbW1hbmRNYXhUb2tlbnMoaW5wdXQ6IHN0cmluZywgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBwbHVnaW46IEJNT0dQVCkge1xuICAvLyBsZXQgY29tbWFuZEJvdE1lc3NhZ2UgPSAnJztcbiAgY29uc3QgY29tbWFuZFBhcnRzID0gaW5wdXQuc3BsaXQoJyAnKTtcbiAgY29uc3QgY29tbWFuZEFjdGlvbiA9IGNvbW1hbmRQYXJ0c1sxXSA/IGNvbW1hbmRQYXJ0c1sxXS50b0xvd2VyQ2FzZSgpIDogJyc7XG4gIC8vIGxldCBtYXhUb2tlbnNTZXR0aW5nTWVzc2FnZTogc3RyaW5nO1xuXG4gIC8vIENoZWNrIGZvciBjbGVhciBjb21tYW5kIGZpcnN0XG4gIGlmIChjb21tYW5kQWN0aW9uID09PSAnYycgfHwgY29tbWFuZEFjdGlvbiA9PT0gJ2NsZWFyJykge1xuICAgIHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucyA9ICcnO1xuICAgIG5ldyBOb3RpY2UoJ01heCB0b2tlbnMgY2xlYXJlZC4nKTtcbiAgfSBlbHNlIGlmIChjb21tYW5kQWN0aW9uICE9PSAnJykge1xuICAgIGNvbnN0IGlucHV0VmFsdWUgPSBwYXJzZUludChjb21tYW5kQWN0aW9uKTtcblxuICAgIGlmICghaXNOYU4oaW5wdXRWYWx1ZSkgJiYgaW5wdXRWYWx1ZSA+PSAwKSB7XG4gICAgICAvLyBVcGRhdGUgbWF4X3Rva2VucyB3aXRoIHRoZSB2YWxpZCBpbnRlZ2VyIHZhbHVlXG4gICAgICBzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMgPSBpbnB1dFZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICBuZXcgTm90aWNlKGBNYXggdG9rZW5zIHVwZGF0ZWQ6ICR7aW5wdXRWYWx1ZX1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW5wdXQgaXMgbm90IGEgdmFsaWQgaW50ZWdlciBvciBpcyBuZWdhdGl2ZVxuICAgICAgbmV3IE5vdGljZSgnTWF4IHRva2VucyB1cGRhdGU6IGludmFsaWQnKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gTm8gYWN0aW9uIHNwZWNpZmllZFxuICAgIGlmIChzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMgPT09ICcnKSB7XG4gICAgICBuZXcgTm90aWNlKCdDdXJyZW50IG1heCB0b2tlbnM6IEVtcHR5Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ldyBOb3RpY2UoYEN1cnJlbnQgbWF4IHRva2VuczogJHtzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnN9YCk7XG4gICAgfVxuICB9XG5cbiAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xufVxuXG4vLyBgL2FwcGVuZGAgdG8gYXBwZW5kIGN1cnJlbnQgY2hhdCBoaXN0b3J5IHRvIGN1cnJlbnQgYWN0aXZlIG5vdGUuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWFuZEFwcGVuZChwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzKSB7XG4gIGxldCBtYXJrZG93bkNvbnRlbnQgPSAnJztcblxuICBjb25zdCBhY3RpdmVGaWxlID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXG4gIGlmIChhY3RpdmVGaWxlPy5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICBjb25zdCBleGlzdGluZ0NvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoYWN0aXZlRmlsZSk7XG5cbiAgICAvLyBSZXRyaWV2ZSB1c2VyIGFuZCBjaGF0Ym90IG5hbWVzXG4gICAgY29uc3QgdXNlck5hbWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVzZXJOYW1lJykgYXMgTm9kZUxpc3RPZjxIVE1MSGVhZGluZ0VsZW1lbnQ+O1xuXG4gICAgbGV0IHVzZXJOYW1lVGV4dCA9ICdVU0VSJztcbiAgICBpZiAodXNlck5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdXNlck5hbWVOb2RlID0gdXNlck5hbWVzWzBdO1xuICAgICAgICBBcnJheS5mcm9tKHVzZXJOYW1lTm9kZS5jaGlsZE5vZGVzKS5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgbm9kZSBpcyBhIHRleHQgbm9kZSBhbmQgaXRzIHRleHRDb250ZW50IGlzIG5vdCBudWxsXG4gICAgICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgJiYgbm9kZS50ZXh0Q29udGVudCkge1xuICAgICAgICAgICAgICAgIHVzZXJOYW1lVGV4dCA9IG5vZGUudGV4dENvbnRlbnQudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGNoYXRib3ROYW1lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGF0Ym90TmFtZScpIGFzIE5vZGVMaXN0T2Y8SFRNTEhlYWRpbmdFbGVtZW50PjtcbiAgICBjb25zdCBjaGF0Ym90TmFtZVRleHQgPSBjaGF0Ym90TmFtZXMubGVuZ3RoID4gMCAmJiBjaGF0Ym90TmFtZXNbMF0udGV4dENvbnRlbnQgPyBjaGF0Ym90TmFtZXNbMF0udGV4dENvbnRlbnQudG9VcHBlckNhc2UoKSA6ICdBU1NJU1RBTlQnO1xuXG5cbiAgICAvLyBDaGVjayBhbmQgcmVhZCB0aGUgSlNPTiBmaWxlXG4gICAgaWYgKGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKGZpbGVOYW1lTWVzc2FnZUhpc3RvcnlKc29uKHBsdWdpbikpKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBqc29uQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChmaWxlTmFtZU1lc3NhZ2VIaXN0b3J5SnNvbihwbHVnaW4pKTtcbiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBKU09OLnBhcnNlKGpzb25Db250ZW50KTtcblxuICAgICAgICAvLyBGaWx0ZXIgb3V0IG1lc3NhZ2VzIHN0YXJ0aW5nIHdpdGggJy8nLCBhbmQgdGhlIGFzc2lzdGFudCdzIHJlc3BvbnNlIGltbWVkaWF0ZWx5IGZvbGxvd2luZyBpdFxuICAgICAgICBsZXQgc2tpcE5leHQgPSBmYWxzZTtcbiAgICAgICAgbWFya2Rvd25Db250ZW50ICs9IG1lc3NhZ2VzXG4gICAgICAgIC5maWx0ZXIoKG1lc3NhZ2VIaXN0b3J5OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyB9LCBpbmRleDogbnVtYmVyLCBhcnJheTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZzsgfVtdKSA9PiB7XG4gICAgICAgICAgaWYgKHNraXBOZXh0ICYmIG1lc3NhZ2VIaXN0b3J5LnJvbGUgPT09ICdhc3Npc3RhbnQnKSB7XG4gICAgICAgICAgICBza2lwTmV4dCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWVzc2FnZUhpc3RvcnkuY29udGVudC5zdGFydHNXaXRoKCcvJykgfHwgbWVzc2FnZUhpc3RvcnkuY29udGVudC5pbmNsdWRlcygnZXJyb3JCb3RNZXNzYWdlJykpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIG5leHQgbWVzc2FnZSBpcyBhbHNvIGZyb20gdXNlciBhbmQgc3RhcnRzIHdpdGggJy8nIG9yIGlmIGN1cnJlbnQgYXNzaXN0YW50IG1lc3NhZ2UgY29udGFpbnMgXCJkaXNwbGF5RXJyb3JCb3RNZXNzYWdlXCJcbiAgICAgICAgICAgIHNraXBOZXh0ID0gKGluZGV4ICsgMSA8IGFycmF5Lmxlbmd0aCAmJiBhcnJheVtpbmRleCArIDFdLnJvbGUgPT09ICdhc3Npc3RhbnQnKSB8fCBtZXNzYWdlSGlzdG9yeS5yb2xlID09PSAnYXNzaXN0YW50JztcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pXG4gICAgICAgIC5tYXAoKG1lc3NhZ2U6IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IH0pID0+IHtcbiAgICAgICAgICBsZXQgcm9sZVRleHQgPSBtZXNzYWdlLnJvbGUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICByb2xlVGV4dCA9IHJvbGVUZXh0ID09PSAnVVNFUicgPyB1c2VyTmFtZVRleHQgOiByb2xlVGV4dDtcbiAgICAgICAgICByb2xlVGV4dCA9IHJvbGVUZXh0ID09PSAnQVNTSVNUQU5UJyA/IGNoYXRib3ROYW1lVGV4dCA6IHJvbGVUZXh0O1xuICAgICAgICAgIHJldHVybiBgIyMjIyMjICR7cm9sZVRleHR9XFxuJHttZXNzYWdlLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgfSlcbiAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5Q29tbWFuZEJvdE1lc3NhZ2UocGx1Z2luLCBzZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIGVycm9yKTtcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBtZXNzYWdlIGhpc3Rvcnk6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IGV4aXN0aW5nQ29udGVudCArICdcXG4nICsgbWFya2Rvd25Db250ZW50O1xuXG4gICAgLy8gU2F2ZSB0aGUgdXBkYXRlZCBjb250ZW50IGJhY2sgdG8gdGhlIGFjdGl2ZSBmaWxlXG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoYWN0aXZlRmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgIG5ldyBOb3RpY2UoJ0FwcGVuZGVkIGNvbnZlcnNhdGlvbi4nKTtcbiAgfVxuICBlbHNlIHtcbiAgICBuZXcgTm90aWNlKCdObyBhY3RpdmUgTWFya2Rvd24gZmlsZSBkZXRlY3RlZC4nKTtcbiAgfVxufVxuXG5cbi8vIGAvc2F2ZWAgdG8gc2F2ZSBjdXJyZW50IGNoYXQgaGlzdG9yeSB0byBhIG5vdGUuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWFuZFNhdmUocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncykge1xuICBuZXcgTm90aWNlKCdTYXZpbmcgY29udmVyc2F0aW9uLi4uJylcblxuICBsZXQgZm9sZGVyTmFtZSA9IHNldHRpbmdzLmNoYXRIaXN0b3J5LmNoYXRIaXN0b3J5UGF0aDtcbiAgLy8gQ2hlY2sgaWYgdGhlIGZvbGRlciBleGlzdHMsIGNyZWF0ZSBpdCBpZiBub3RcbiAgaWYgKCFhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKGZvbGRlck5hbWUpKSB7XG4gICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyTmFtZSk7XG4gIH1cbiAgY29uc3QgYmFzZUZpbGVOYW1lID0gJ0NoYXQgSGlzdG9yeSc7XG4gIGNvbnN0IGZpbGVFeHRlbnNpb24gPSAnLm1kJztcblxuICBpZiAoZm9sZGVyTmFtZSAmJiAhZm9sZGVyTmFtZS5lbmRzV2l0aCgnLycpKSB7XG4gICAgZm9sZGVyTmFtZSArPSAnLyc7XG4gIH1cbiAgXG4gIC8vIENyZWF0ZSBhIGRhdGV0aW1lIHN0cmluZyB0byBhcHBlbmQgdG8gdGhlIGZpbGUgbmFtZVxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBkYXRlVGltZVN0YW1wID0gbm93LmdldEZ1bGxZZWFyKCkgKyAnLScgXG4gICAgICAgICAgICAgICAgICAgICAgICArIChub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArICctJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICsgbm93LmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnICcgXG4gICAgICAgICAgICAgICAgICAgICAgICArIG5vdy5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArICctJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICsgbm93LmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnLScgXG4gICAgICAgICAgICAgICAgICAgICAgICArIG5vdy5nZXRTZWNvbmRzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpO1xuXG4gIHRyeSB7XG4gICAgbGV0IG1hcmtkb3duQ29udGVudCA9ICcnO1xuICAgIGNvbnN0IGFsbEZpbGVzID0gcGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpOyAvLyBSZXRyaWV2ZSBhbGwgZmlsZXMgZnJvbSB0aGUgdmF1bHRcblxuICAgIGNvbnN0IHRlbXBsYXRlRmlsZSA9IGFsbEZpbGVzLmZpbmQoZmlsZSA9PiBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKSA9PT0gc2V0dGluZ3MuY2hhdEhpc3RvcnkudGVtcGxhdGVGaWxlUGF0aC50b0xvd2VyQ2FzZSgpKTtcblxuICAgIGlmICh0ZW1wbGF0ZUZpbGUpIHtcbiAgICAgIGxldCBmaWxlQ29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZCh0ZW1wbGF0ZUZpbGUpO1xuICBcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBmaWxlIGNvbnRlbnQgaGFzIFlBTUwgZnJvbnQgbWF0dGVyXG4gICAgICBpZiAoL14tLS1cXHMqW1xcc1xcU10qPy0tLS8udGVzdChmaWxlQ29udGVudCkpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIG1vZGVsIHByb3BlcnR5IGFscmVhZHkgZXhpc3RzIGluIHRoZSBmcm9udCBtYXR0ZXJcbiAgICAgICAgaWYgKCEvXm1vZGVsOlxccy9tLnRlc3QoZmlsZUNvbnRlbnQpKSB7XG4gICAgICAgICAgLy8gSW5zZXJ0IG1vZGVsIG5hbWUgaW50byBleGlzdGluZyBmcm9udCBtYXR0ZXIgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICAgIGZpbGVDb250ZW50ID0gZmlsZUNvbnRlbnQucmVwbGFjZSgvXi0tLS8sIGAtLS1cXG5tb2RlbDogJHtzZXR0aW5ncy5nZW5lcmFsLm1vZGVsfWApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFByZXBlbmQgbmV3IGZyb250IG1hdHRlclxuICAgICAgICAgIGZpbGVDb250ZW50ID0gYC0tLVxuICBtb2RlbDogJHtzZXR0aW5ncy5nZW5lcmFsLm1vZGVsfVxuLS0tXFxuYCArIGZpbGVDb250ZW50O1xuICAgICAgfVxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGZpbGVDb250ZW50O1xuICB9IGVsc2Uge1xuICAgICAgLy8gWUFNTCBmcm9udCBtYXR0ZXJcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBcbiAgICAgIGAtLS1cbiAgbW9kZWw6ICR7c2V0dGluZ3MuZ2VuZXJhbC5tb2RlbH1cbi0tLVxcbmA7XG4gIH1cblxuICAgIC8vIFJldHJpZXZlIHVzZXIgYW5kIGNoYXRib3QgbmFtZXNcbiAgICBjb25zdCB1c2VyTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudXNlck5hbWUnKSBhcyBOb2RlTGlzdE9mPEhUTUxIZWFkaW5nRWxlbWVudD47XG5cbiAgICBsZXQgdXNlck5hbWVUZXh0ID0gJ1VTRVInO1xuICAgIGlmICh1c2VyTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCB1c2VyTmFtZU5vZGUgPSB1c2VyTmFtZXNbMF07XG4gICAgICAgIEFycmF5LmZyb20odXNlck5hbWVOb2RlLmNoaWxkTm9kZXMpLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBub2RlIGlzIGEgdGV4dCBub2RlIGFuZCBpdHMgdGV4dENvbnRlbnQgaXMgbm90IG51bGxcbiAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBub2RlLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdXNlck5hbWVUZXh0ID0gbm9kZS50ZXh0Q29udGVudC50cmltKCkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgY2hhdGJvdE5hbWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNoYXRib3ROYW1lJykgYXMgTm9kZUxpc3RPZjxIVE1MSGVhZGluZ0VsZW1lbnQ+O1xuICAgIGNvbnN0IGNoYXRib3ROYW1lVGV4dCA9IGNoYXRib3ROYW1lcy5sZW5ndGggPiAwICYmIGNoYXRib3ROYW1lc1swXS50ZXh0Q29udGVudCA/IGNoYXRib3ROYW1lc1swXS50ZXh0Q29udGVudC50b1VwcGVyQ2FzZSgpIDogJ0FTU0lTVEFOVCc7XG5cbiAgICAvLyBDaGVjayBhbmQgcmVhZCB0aGUgSlNPTiBmaWxlXG4gICAgaWYgKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGpzb25Db250ZW50ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLnJlYWQoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gSlNPTi5wYXJzZShqc29uQ29udGVudCk7XG5cbiAgICAgICAgLy8gRmlsdGVyIG91dCBtZXNzYWdlcyBzdGFydGluZyB3aXRoICcvJywgYW5kIHRoZSBhc3Npc3RhbnQncyByZXNwb25zZSBpbW1lZGlhdGVseSBmb2xsb3dpbmcgaXRcbiAgICAgICAgbGV0IHNraXBOZXh0ID0gZmFsc2U7XG4gICAgICAgIG1hcmtkb3duQ29udGVudCArPSBtZXNzYWdlc1xuICAgICAgICAuZmlsdGVyKChtZXNzYWdlSGlzdG9yeTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZzsgfSwgaW5kZXg6IG51bWJlciwgYXJyYXk6IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IH1bXSkgPT4ge1xuICAgICAgICAgIGlmIChza2lwTmV4dCAmJiBtZXNzYWdlSGlzdG9yeS5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgc2tpcE5leHQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1lc3NhZ2VIaXN0b3J5LmNvbnRlbnQuc3RhcnRzV2l0aCgnLycpIHx8IG1lc3NhZ2VIaXN0b3J5LmNvbnRlbnQuaW5jbHVkZXMoJ2Vycm9yQm90TWVzc2FnZScpKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBuZXh0IG1lc3NhZ2UgaXMgYWxzbyBmcm9tIHVzZXIgYW5kIHN0YXJ0cyB3aXRoICcvJyBvciBpZiBjdXJyZW50IGFzc2lzdGFudCBtZXNzYWdlIGNvbnRhaW5zIFwiZGlzcGxheUVycm9yQm90TWVzc2FnZVwiXG4gICAgICAgICAgICBza2lwTmV4dCA9IChpbmRleCArIDEgPCBhcnJheS5sZW5ndGggJiYgYXJyYXlbaW5kZXggKyAxXS5yb2xlID09PSAnYXNzaXN0YW50JykgfHwgbWVzc2FnZUhpc3Rvcnkucm9sZSA9PT0gJ2Fzc2lzdGFudCc7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KVxuICAgICAgICAubWFwKChtZXNzYWdlOiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyB9KSA9PiB7XG4gICAgICAgICAgbGV0IHJvbGVUZXh0ID0gbWVzc2FnZS5yb2xlLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgcm9sZVRleHQgPSByb2xlVGV4dCA9PT0gJ1VTRVInID8gdXNlck5hbWVUZXh0IDogcm9sZVRleHQ7XG4gICAgICAgICAgcm9sZVRleHQgPSByb2xlVGV4dCA9PT0gJ0FTU0lTVEFOVCcgPyBjaGF0Ym90TmFtZVRleHQgOiByb2xlVGV4dDtcblxuICAgICAgICAgIC8vIFJlbW92ZSB0aGUgcmVuZGVyZWQgYmxvY2sgZnJvbSB0aGUgbWVzc2FnZSBjb250ZW50XG4gICAgICAgICAgY29uc3QgcmVnZXhSZW5kZXJlZEJsb2NrID0gLzxibG9jay1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL2Jsb2NrLXJlbmRlcmVkPi9nO1xuICAgICAgICAgIG1lc3NhZ2UuY29udGVudCA9IG1lc3NhZ2UuY29udGVudC5yZXBsYWNlKHJlZ2V4UmVuZGVyZWRCbG9jaywgJycpLnRyaW0oKTtcblxuICAgICAgICAgIC8vIFJlbW92ZSByZW5kZXJlZCBub3RlIHRhZ3MgZnJvbSB0aGUgbWVzc2FnZSBjb250ZW50XG4gICAgICAgICAgY29uc3QgcmVnZXhSZW5kZXJlZE5vdGUgPSAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nO1xuICAgICAgICAgIG1lc3NhZ2UuY29udGVudCA9IG1lc3NhZ2UuY29udGVudC5yZXBsYWNlKHJlZ2V4UmVuZGVyZWROb3RlLCAnJykudHJpbSgpO1xuXG5cbiAgICAgICAgICByZXR1cm4gYCMjIyMjIyAke3JvbGVUZXh0fVxcbiR7bWVzc2FnZS5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pXG4gICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAvLyBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBlcnJvcik7XG4gICAgICAgIC8vIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgbWVzc2FnZSBoaXN0b3J5OicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgZmlsZU5hbWUgPSAnJztcblxuICAgIGlmIChzZXR0aW5ncy5jaGF0SGlzdG9yeS5hbGxvd1JlbmFtZU5vdGVUaXRsZSkge1xuICAgICAgbGV0IHVuaXF1ZU5hbWVGb3VuZCA9IGZhbHNlO1xuICAgICAgbGV0IG1vZGVsUmVuYW1lVGl0bGU7XG5cbiAgICAgIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgZmlsZSBuYW1lIGFscmVhZHkgZXhpc3RzXG4gICAgICBjb25zdCBmaWxlTmFtZUV4aXN0cyA9IChuYW1lOiBzdHJpbmcgfCBudWxsKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGFsbEZpbGVzLnNvbWUoKGZpbGUpID0+IGZpbGUucGF0aCA9PT0gZm9sZGVyTmFtZSArIG5hbWUgKyBmaWxlRXh0ZW5zaW9uKTtcbiAgICAgIH07XG4gICAgXG4gICAgICB3aGlsZSAoIXVuaXF1ZU5hbWVGb3VuZCkge1xuICAgICAgICAgIG1vZGVsUmVuYW1lVGl0bGUgPSBhd2FpdCBmZXRjaE1vZGVsUmVuYW1lVGl0bGUoc2V0dGluZ3MsICBtYXJrZG93bkNvbnRlbnQpO1xuICAgICAgXG4gICAgICAgICAgaWYgKCFmaWxlTmFtZUV4aXN0cyhtb2RlbFJlbmFtZVRpdGxlKSkge1xuICAgICAgICAgICAgICB1bmlxdWVOYW1lRm91bmQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZmlsZU5hbWUgPSBmb2xkZXJOYW1lICsgbW9kZWxSZW5hbWVUaXRsZSArIGZpbGVFeHRlbnNpb247XG4gICAgICBcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBmaWxlTmFtZSA9IGZvbGRlck5hbWUgKyBiYXNlRmlsZU5hbWUgKyAnICcgKyBkYXRlVGltZVN0YW1wICsgZmlsZUV4dGVuc2lvbjtcbiAgICB9XG4gIFxuICAgIC8vIFVwZGF0ZSBpZiBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoIGlzIG5vdCBudWxsXG4gICAgaWYgKHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGggIT09IG51bGwpIHtcbiAgICAgIGxhc3RMb2FkZWRDaGF0SGlzdG9yeUZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoKSBhcyBURmlsZTtcbiAgICB9XG5cbiAgICBpZiAobGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZSA9PT0gbnVsbCkge1xuICAgICAgICAvLyBDcmVhdGUgdGhlIG5ldyBub3RlIHdpdGggZm9ybWF0dGVkIE1hcmtkb3duIGNvbnRlbnRcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY3JlYXRlKGZpbGVOYW1lLCBtYXJrZG93bkNvbnRlbnQpO1xuICAgICAgICAvLyBGZXRjaGluZyBmaWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZm9sZGVyIChwcm9maWxlcylcbiAgICAgICAgY29uc3QgcHJvZmlsZUZpbGVzID0gcGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZmlsZSkgPT4gZmlsZS5wYXRoLnN0YXJ0c1dpdGgoc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGgpKTtcblxuICAgICAgICAvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcbiAgICAgICAgcHJvZmlsZUZpbGVzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xuICAgICAgICBjb25zdCBjdXJyZW50UHJvZmlsZSA9IHNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTsgLy8gUmVtb3ZpbmcgdGhlIGZpbGUgZXh0ZW5zaW9uXG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kaW5nIHRoZSBpbmRleCBvZiB0aGUgY3VycmVudFByb2ZpbGUgaW4gdGhlIHByb2ZpbGVGaWxlcyBhcnJheVxuICAgICAgICBjb25zdCBwcm9maWxlSW5kZXggPSBwcm9maWxlRmlsZXMuZmluZEluZGV4KChmaWxlKSA9PiBmaWxlLmJhc2VuYW1lID09PSBjdXJyZW50UHJvZmlsZSk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbcHJvZmlsZUluZGV4XSA9IGZpbGUucGF0aDtcbiAgICAgICAgICAvLyBPcGVuIHRoZSBuZXdseSBjcmVhdGVkIG5vdGUgaW4gYSBuZXcgcGFuZVxuICAgICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlTmFtZSwgJycsIHRydWUsIHsgYWN0aXZlOiB0cnVlIH0pO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVwZGF0ZSB0aGUgZXhpc3Rpbmcgbm90ZSB3aXRoIHRoZSBmb3JtYXR0ZWQgTWFya2Rvd24gY29udGVudFxuICAgICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkobGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZSwgbWFya2Rvd25Db250ZW50KTtcbiAgICAgIC8vIEdldCBhY3RpdmUgZmlsZVxuICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblxuICAgICAgLy8gTG9nIHRoZSBhY3RpdmUgZmlsZXMgdG8gdGhlIGNvbnNvbGVcbiAgICAgIGlmIChhY3RpdmVGaWxlPy5wYXRoICE9PSBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlGaWxlLnBhdGgpIHtcbiAgICAgICAgcGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGxhc3RMb2FkZWRDaGF0SGlzdG9yeUZpbGUucGF0aCwgbGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZS5wYXRoLCB0cnVlLCB7IGFjdGl2ZTogdHJ1ZSB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgbmV3IE5vdGljZShgU2F2ZWQgdG8gJyR7bGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZT8ubmFtZX0nYCk7XG4gICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgbm90ZTonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8gYC9sb2FkYCB0byBsb2FkIGNoYXQgaGlzdG9yeS5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21tYW5kTG9hZChpbnB1dDogc3RyaW5nLCBwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzKSB7XG4gIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICBjb25zdCBmb2xkZXJQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNoYXRIaXN0b3J5LmNoYXRIaXN0b3J5UGF0aC50cmltKCkgfHwgREVGQVVMVF9TRVRUSU5HUy5jaGF0SGlzdG9yeS5jaGF0SGlzdG9yeVBhdGg7ICAgICAgXG5cbiAgLy8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlclxuICBjb25zdCBmaWxlcyA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKGZvbGRlclBhdGgpKTtcblxuICAvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcbiAgZmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cbiAgLy8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlciAocHJvZmlsZXMpXG4gIGNvbnN0IHByb2ZpbGVGaWxlcyA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCkpO1xuXG4gIC8vIFNvcnRpbmcgdGhlIGZpbGVzIGFycmF5IGFscGhhYmV0aWNhbGx5IGJ5IGZpbGUgbmFtZVxuICBwcm9maWxlRmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cbiAgY29uc3QgY3VycmVudFByb2ZpbGUgPSBzZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlLnJlcGxhY2UoL1xcLlteLy5dKyQvLCAnJyk7IC8vIFJlbW92aW5nIHRoZSBmaWxlIGV4dGVuc2lvblxuXG4gIC8vIEZpbmRpbmcgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50UHJvZmlsZSBpbiB0aGUgcHJvZmlsZUZpbGVzIGFycmF5XG4gIGNvbnN0IHByb2ZpbGVJbmRleCA9IHByb2ZpbGVGaWxlcy5maW5kSW5kZXgoKGZpbGUpID0+IGZpbGUuYmFzZW5hbWUgPT09IGN1cnJlbnRQcm9maWxlKTtcblxuXG4vLyBDaGVjayBpZiB0aGUgdXNlciBoYXMgbm90IHNwZWNpZmllZCBhIHByb2ZpbGVcbmlmICghaW5wdXQuc3BsaXQoJyAnKVsxXSkge1xuICAvLyBHcm91cCBmaWxlcyB3aXRoIHRoZSBzYW1lIG5hbWUgYW5kIGNyZWF0ZSBsaXN0IGl0ZW1zXG4gIGNvbnN0IGZpbGVHcm91cHM6IHsgW2tleTogc3RyaW5nXTogeyBjb3VudDogbnVtYmVyIH0gfSA9IGZpbGVzLnJlZHVjZSgoYWNjLCBmaWxlKSA9PiB7XG4gICAgY29uc3QgZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uID0gZmlsZS5uYW1lLnJlcGxhY2UoL1xcLlteLy5dKyQvLCAnJyk7XG4gICAgaWYgKGFjY1tmaWxlTmFtZVdpdGhvdXRFeHRlbnNpb25dKSB7XG4gICAgICBhY2NbZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uXS5jb3VudCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBhY2NbZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uXSA9IHsgY291bnQ6IDEgfTtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30gYXMgeyBba2V5OiBzdHJpbmddOiB7IGNvdW50OiBudW1iZXIgfSB9KTtcblxuICBjb25zdCBmaWxlTGlzdEl0ZW1zID0gT2JqZWN0LmVudHJpZXMoZmlsZUdyb3VwcylcbiAgICAubWFwKChbZmlsZU5hbWUsIHsgY291bnQgfV0pID0+IHtcbiAgICAgIHJldHVybiBjb3VudCA+IDEgPyBgPGxpPiR7ZmlsZU5hbWV9IFske2NvdW50fSBmaWxlcyBmb3VuZF08L2xpPmAgOiBgPGxpPiR7ZmlsZU5hbWV9PC9saT5gO1xuICAgIH0pXG4gICAgLmpvaW4oJycpO1xuXG4gIGNvbnN0IGNvbW1hbmRCb3RNZXNzYWdlID0gXG4gIGA8aDIgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7XCI+Q2hhdCBIaXN0b3J5PC9oMj5cbiAgIDxwIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyO1wiPjxiPkN1cnJlbnQgQ2hhdCBIaXN0b3J5OjwvYj4gJHtzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbcHJvZmlsZUluZGV4XSA/IHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVtwcm9maWxlSW5kZXhdIDogJ0VtcHR5J308L3A+XG4gICAgPG9sPiR7ZmlsZUxpc3RJdGVtc308L29sPmA7XG5cbiAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlDb21tYW5kQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgY29tbWFuZEJvdE1lc3NhZ2UpO1xuICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VEaXYpO1xuXG4gIHJldHVybjtcbn1cblxuLy8gQ2hlY2sgaWYgdGhlIHVzZXIgaGFzIHNwZWNpZmllZCBhIHByb21wdCBhZnRlciB0aGUgXCIvcHJvbXB0XCIgY29tbWFuZFxuaWYgKGlucHV0LnN0YXJ0c1dpdGgoJy9sb2FkJykpIHtcbiAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dC5zcGxpdCgnICcpLnNsaWNlKDEpLmpvaW4oJyAnKS50cmltKCk7XG5cbiAgLy8gUmVtb3ZlIHF1b3RhdGlvbiBtYXJrcyBpZiBwcmVzZW50XG4gIGlmICgoaW5wdXRWYWx1ZS5zdGFydHNXaXRoKCdcIicpICYmIGlucHV0VmFsdWUuZW5kc1dpdGgoJ1wiJykpIHx8XG4gICAgICAoaW5wdXRWYWx1ZS5zdGFydHNXaXRoKCdcXCcnKSAmJiBpbnB1dFZhbHVlLmVuZHNXaXRoKCdcXCcnKSkpIHtcbiAgICBpbnB1dFZhbHVlID0gaW5wdXRWYWx1ZS5zdWJzdHJpbmcoMSwgaW5wdXRWYWx1ZS5sZW5ndGggLSAxKTtcbiAgfVxuXG4gIGNvbnN0IGxvYWRBbGlhc2VzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge307XG4gIGxldCBjdXJyZW50SW5kZXggPSAxO1xuICBcbiAgLy8gQ3JlYXRlIGFsaWFzZXMgZm9yIGVhY2ggZmlsZVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgZmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uID0gZmlsZXNbaV0ubmFtZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpO1xuICBcbiAgICAvLyBDaGVjayBpZiBhbiBlbnRyeSB3aXRoIHRoZSBzYW1lIGZpbGUgbmFtZSBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nS2V5ID0gT2JqZWN0LnZhbHVlcyhsb2FkQWxpYXNlcykuZmluZChcbiAgICAgIHZhbHVlID0+IHZhbHVlID09PSBmaWxlTmFtZVdpdGhvdXRFeHRlbnNpb25cbiAgICApO1xuICBcbiAgICBpZiAoIWV4aXN0aW5nS2V5KSB7XG4gICAgICAvLyBBZGQgdGhlIGVudHJ5IG9ubHkgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgbG9hZEFsaWFzZXNbY3VycmVudEluZGV4LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKV0gPSBmaWxlTmFtZVdpdGhvdXRFeHRlbnNpb247XG4gICAgICBjdXJyZW50SW5kZXgrKztcbiAgICB9XG4gIH1cbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9W10gPSBbXTtcblxuICAgIGNvbnN0IGxvYWRDaGF0SGlzdG9yeSA9IGFzeW5jIChmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50TG9hZCA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKSBhcyBURmlsZTtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGN1cnJlbnRMb2FkKTtcbiAgICAgIGNvbnN0IGNvbnRlbnRXaXRob3V0RnJvbnRtYXR0ZXIgPSBmaWxlQ29udGVudC5yZXBsYWNlKC9eLS0tXFxuW1xcc1xcU10qP1xcbi0tLVxcbi8sICcnKTtcbiAgICBcbiAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudFdpdGhvdXRGcm9udG1hdHRlci5zcGxpdCgnXFxuJyk7XG4gICAgICBsZXQgY3VycmVudFJvbGUgPSAnJztcbiAgICAgIGxldCBjdXJyZW50Q29udGVudCA9ICcnO1xuICAgICAgbGV0IGhlYWRlckNvdW50ID0gMDtcbiAgICBcbiAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCcjIyMjIyMgJykpIHtcbiAgICAgICAgICBoZWFkZXJDb3VudCsrO1xuICAgICAgICAgIGlmIChjdXJyZW50Q29udGVudCkge1xuICAgICAgICAgICAgbWVzc2FnZUhpc3RvcnkucHVzaCh7XG4gICAgICAgICAgICAgIHJvbGU6IGN1cnJlbnRSb2xlLFxuICAgICAgICAgICAgICBjb250ZW50OiBjdXJyZW50Q29udGVudC50cmltKCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3VycmVudFJvbGUgPSBjdXJyZW50Um9sZSA9PT0gJ3VzZXInID8gJ2Fzc2lzdGFudCcgOiAndXNlcic7XG4gICAgICAgICAgY3VycmVudENvbnRlbnQgPSAnJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdXJyZW50Q29udGVudCArPSBsaW5lICsgJ1xcbic7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBcbiAgICAgIGlmIChjdXJyZW50Q29udGVudCkge1xuICAgICAgICBtZXNzYWdlSGlzdG9yeS5wdXNoKHtcbiAgICAgICAgICByb2xlOiBjdXJyZW50Um9sZSxcbiAgICAgICAgICBjb250ZW50OiBjdXJyZW50Q29udGVudC50cmltKCksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIFxuICAgICAgaWYgKGhlYWRlckNvdW50ICUgMiAhPT0gMCkge1xuICAgICAgICBuZXcgTm90aWNlKCdJbmNvcnJlY3QgZm9ybWF0dGluZy4nKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIFxuICAgICAgY29uc3QgdXBkYXRlZEpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlSGlzdG9yeSwgbnVsbCwgNCk7XG4gICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSwgdXBkYXRlZEpzb25TdHJpbmcpO1xuICAgICAgcGx1Z2luLmFjdGl2YXRlVmlldygpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICBpZiAobG9hZEFsaWFzZXNbaW5wdXRWYWx1ZV0pIHsgICAgXG4gICAgICBjb25zdCBtYXRjaGluZ0ZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5uYW1lLmluY2x1ZGVzKGxvYWRBbGlhc2VzW2lucHV0VmFsdWVdKSk7XG5cbiAgICAgIC8vIENyZWF0ZSBtb2RhbCBjb250ZW50XG4gICAgICBjb25zdCBtb2RhbCA9IG5ldyBNb2RhbChwbHVnaW4uYXBwKTtcbiAgICAgIGNvbnN0IG1vZGFsQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgbW9kYWxDb250ZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsLWNvbnRlbnQnKTtcbiAgICBcbiAgICAgIGNvbnN0IGhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICAgICAgaGVhZGluZy50ZXh0Q29udGVudCA9ICdMb2FkIENoYXQgSGlzdG9yeSc7XG4gICAgICBtb2RhbENvbnRlbnQuYXBwZW5kQ2hpbGQoaGVhZGluZyk7XG4gICAgXG4gICAgICBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgLy8gRGlzcGxheSBjb25maXJtYXRpb24gbWVzc2FnZSBmb3IgYSBzaW5nbGUgZmlsZVxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICBtZXNzYWdlLnRleHRDb250ZW50ID0gYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBvdmVycmlkZSB5b3VyIGN1cnJlbnQgY2hhdCBoaXN0b3J5IHdpdGggXCIke21hdGNoaW5nRmlsZXNbMF0ubmFtZX1cIj9gO1xuICAgICAgICBtb2RhbENvbnRlbnQuYXBwZW5kQ2hpbGQobWVzc2FnZSk7XG4gICAgXG4gICAgICAgIGNvbnN0IGNvbmZpcm1Mb2FkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGNvbmZpcm1Mb2FkQnV0dG9uLmlkID0gJ2NvbmZpcm1Mb2FkJztcbiAgICAgICAgY29uZmlybUxvYWRCdXR0b24udGV4dENvbnRlbnQgPSAnQ29uZmlybSc7XG4gICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChjb25maXJtTG9hZEJ1dHRvbik7XG4gICAgXG4gICAgICAgIGNvbmZpcm1Mb2FkQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjb25zdCBzZWxlY3RlZEZpbGUgPSBtYXRjaGluZ0ZpbGVzWzBdO1xuICAgICAgICAgIGNvbnN0IGNoYXRIaXN0b3J5RmlsZVBhdGggPSBzZWxlY3RlZEZpbGUucGF0aDtcbiAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgbG9hZENoYXRIaXN0b3J5KGNoYXRIaXN0b3J5RmlsZVBhdGgpO1xuICAgICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBTd2l0Y2hlZCB0byAnJHtzZWxlY3RlZEZpbGUucGF0aH0nIGNoYXQgaGlzdG9yeS5gKTtcbiAgICAgICAgICAgIGxhc3RMb2FkZWRDaGF0SGlzdG9yeUZpbGUgPSBzZWxlY3RlZEZpbGU7XG5cbiAgICAgICAgICAgIHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGggPSBzZWxlY3RlZEZpbGUucGF0aDtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoIGZvciB0aGUgY3VycmVudCBwcm9maWxlXG4gICAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbcHJvZmlsZUluZGV4XSA9IHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGg7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRGlzcGxheSBmaWxlIG9wdGlvbnMgZm9yIG11bHRpcGxlIG1hdGNoaW5nIGZpbGVzXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICAgIG1lc3NhZ2UudGV4dENvbnRlbnQgPSAnU2VsZWN0IGEgY2hhdCBoaXN0b3J5IHRvIG92ZXJyaWRlOic7XG4gICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChtZXNzYWdlKTtcbiAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGEgY29udGFpbmVyIGZvciBmaWxlIG9wdGlvbnNcbiAgICAgICAgY29uc3Qgb3B0aW9uc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBvcHRpb25zQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2ZpbGUtb3B0aW9ucycpO1xuICAgICAgICBvcHRpb25zQ29udGFpbmVyLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxNnB4JztcbiAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGEgcmFkaW8gYnV0dG9uIGFuZCBsYWJlbCBmb3IgZWFjaCBtYXRjaGluZyBmaWxlXG4gICAgICAgIG1hdGNoaW5nRmlsZXMuZm9yRWFjaCgoZmlsZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICBjb25zdCByYWRpb0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgIHJhZGlvRWxlbWVudC50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgICByYWRpb0VsZW1lbnQubmFtZSA9ICdmaWxlT3B0aW9uJztcbiAgICAgICAgICByYWRpb0VsZW1lbnQudmFsdWUgPSBmaWxlLnBhdGg7XG4gICAgICAgICAgcmFkaW9FbGVtZW50LmlkID0gYGZpbGUtJHtpbmRleH1gO1xuICAgIFxuICAgICAgICAgIGNvbnN0IGxhYmVsRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICAgICAgbGFiZWxFbGVtZW50Lmh0bWxGb3IgPSBgZmlsZS0ke2luZGV4fWA7XG4gICAgICAgICAgbGFiZWxFbGVtZW50LnRleHRDb250ZW50ID0gZmlsZS5wYXRoO1xuICAgIFxuICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQocmFkaW9FbGVtZW50KTtcbiAgICAgICAgICBvcHRpb25zQ29udGFpbmVyLmFwcGVuZENoaWxkKGxhYmVsRWxlbWVudCk7XG4gICAgICAgICAgb3B0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTtcbiAgICAgICAgfSk7XG4gICAgXG4gICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChvcHRpb25zQ29udGFpbmVyKTtcbiAgICBcbiAgICAgICAgY29uc3QgY29uZmlybUxvYWRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgY29uZmlybUxvYWRCdXR0b24uaWQgPSAnY29uZmlybUxvYWQnO1xuICAgICAgICBjb25maXJtTG9hZEJ1dHRvbi50ZXh0Q29udGVudCA9ICdMb2FkJztcbiAgICAgICAgbW9kYWxDb250ZW50LmFwcGVuZENoaWxkKGNvbmZpcm1Mb2FkQnV0dG9uKTtcbiAgICBcbiAgICAgICAgY29uZmlybUxvYWRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNvbnN0IHNlbGVjdGVkUmFkaW8gPSBvcHRpb25zQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXTpjaGVja2VkJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICBpZiAoc2VsZWN0ZWRSYWRpbykge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGaWxlUGF0aCA9IHNlbGVjdGVkUmFkaW8udmFsdWU7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZEZpbGUgPSBtYXRjaGluZ0ZpbGVzLmZpbmQoZmlsZSA9PiBmaWxlLnBhdGggPT09IHNlbGVjdGVkRmlsZVBhdGgpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRmlsZSkge1xuICAgICAgICAgICAgICBjb25zdCBjaGF0SGlzdG9yeUZpbGVQYXRoID0gc2VsZWN0ZWRGaWxlLnBhdGg7XG4gICAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBsb2FkQ2hhdEhpc3RvcnkoY2hhdEhpc3RvcnlGaWxlUGF0aCk7XG4gICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgU3dpdGNoZWQgdG8gJyR7c2VsZWN0ZWRGaWxlLnBhdGh9JyBjaGF0IGhpc3RvcnkuYCk7XG4gICAgICAgICAgICAgICAgbGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZSA9IHNlbGVjdGVkRmlsZTtcbiAgICBcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoID0gc2VsZWN0ZWRGaWxlLnBhdGg7XG4gICAgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoIGZvciB0aGUgY3VycmVudCBwcm9maWxlXG4gICAgICAgICAgICAgICAgc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5W3Byb2ZpbGVJbmRleF0gPSBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoO1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgXG4gICAgICBtb2RhbC5jb250ZW50RWwuYXBwZW5kQ2hpbGQobW9kYWxDb250ZW50KTtcbiAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICB9IGVsc2UgaWYgKE9iamVjdC52YWx1ZXMobG9hZEFsaWFzZXMpLm1hcCh2ID0+IHYudG9Mb3dlckNhc2UoKSkuaW5jbHVkZXMoaW5wdXRWYWx1ZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgY29uc3QgbWF0Y2hlZEZpbGUgPSBPYmplY3QuZW50cmllcyhsb2FkQWxpYXNlcykuZmluZCgoW2tleSwgdmFsdWVdKSA9PiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBpbnB1dFZhbHVlLnRvTG93ZXJDYXNlKCkpO1xuICAgIFxuICAgICAgaWYgKG1hdGNoZWRGaWxlKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoaW5nRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLm5hbWUuaW5jbHVkZXMobWF0Y2hlZEZpbGVbMV0pKTtcbiAgICBcbiAgICAgICAgLy8gbWF0Y2hpbmdGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICAvLyAgIGNvbnNvbGUubG9nKGZpbGUucGF0aCk7XG4gICAgICAgIC8vIH0pO1xuICAgIFxuICAgICAgICAvLyBDcmVhdGUgbW9kYWwgY29udGVudFxuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBNb2RhbChwbHVnaW4uYXBwKTtcbiAgICAgICAgY29uc3QgbW9kYWxDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG1vZGFsQ29udGVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbC1jb250ZW50Jyk7XG4gICAgXG4gICAgICAgIGNvbnN0IGhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICAgICAgICBoZWFkaW5nLnRleHRDb250ZW50ID0gJ0xvYWQgQ2hhdCBIaXN0b3J5JztcbiAgICAgICAgbW9kYWxDb250ZW50LmFwcGVuZENoaWxkKGhlYWRpbmcpO1xuICAgIFxuICAgICAgICBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAvLyBEaXNwbGF5IGNvbmZpcm1hdGlvbiBtZXNzYWdlIGZvciBhIHNpbmdsZSBmaWxlXG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgICBtZXNzYWdlLnRleHRDb250ZW50ID0gYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBvdmVycmlkZSB5b3VyIGN1cnJlbnQgY2hhdCBoaXN0b3J5IHdpdGggXCIke21hdGNoaW5nRmlsZXNbMF0ubmFtZX1cIj9gO1xuICAgICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChtZXNzYWdlKTtcbiAgICAgIFxuICAgICAgICAgIGNvbnN0IGNvbmZpcm1Mb2FkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgY29uZmlybUxvYWRCdXR0b24uaWQgPSAnY29uZmlybUxvYWQnO1xuICAgICAgICAgIGNvbmZpcm1Mb2FkQnV0dG9uLnRleHRDb250ZW50ID0gJ0NvbmZpcm0nO1xuICAgICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChjb25maXJtTG9hZEJ1dHRvbik7XG4gICAgXG4gICAgICAgICAgY29uZmlybUxvYWRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGaWxlID0gbWF0Y2hpbmdGaWxlc1swXTtcbiAgICAgICAgICAgIGNvbnN0IGNoYXRIaXN0b3J5RmlsZVBhdGggPSBzZWxlY3RlZEZpbGUucGF0aDtcbiAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBsb2FkQ2hhdEhpc3RvcnkoY2hhdEhpc3RvcnlGaWxlUGF0aCk7XG4gICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICBuZXcgTm90aWNlKGBTd2l0Y2hlZCB0byAnJHtzZWxlY3RlZEZpbGUucGF0aH0nIGNoYXQgaGlzdG9yeS5gKTtcbiAgICAgICAgICAgICAgbGFzdExvYWRlZENoYXRIaXN0b3J5RmlsZSA9IHNlbGVjdGVkRmlsZTtcbiAgXG4gICAgICAgICAgICAgIHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGggPSBzZWxlY3RlZEZpbGUucGF0aDtcbiAgXG4gICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aCBmb3IgdGhlIGN1cnJlbnQgcHJvZmlsZVxuICAgICAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlbcHJvZmlsZUluZGV4XSA9IHNldHRpbmdzLnByb2ZpbGVzLmxhc3RMb2FkZWRDaGF0SGlzdG9yeVBhdGg7XG4gICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRGlzcGxheSBmaWxlIG9wdGlvbnMgZm9yIG11bHRpcGxlIG1hdGNoaW5nIGZpbGVzXG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgICBtZXNzYWdlLnRleHRDb250ZW50ID0gJ1NlbGVjdCBhIGNoYXQgaGlzdG9yeSB0byBvdmVycmlkZTonO1xuICAgICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChtZXNzYWdlKTtcbiAgICBcbiAgICAgICAgICAvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIGZpbGUgb3B0aW9uc1xuICAgICAgICAgIGNvbnN0IG9wdGlvbnNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICBvcHRpb25zQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2ZpbGUtb3B0aW9ucycpO1xuICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuc3R5bGUubWFyZ2luQm90dG9tID0gJzE2cHgnO1xuICAgIFxuICAgICAgICAgIC8vIENyZWF0ZSBhIHJhZGlvIGJ1dHRvbiBhbmQgbGFiZWwgZm9yIGVhY2ggbWF0Y2hpbmcgZmlsZVxuICAgICAgICAgIG1hdGNoaW5nRmlsZXMuZm9yRWFjaCgoZmlsZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJhZGlvRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgICAgICByYWRpb0VsZW1lbnQudHlwZSA9ICdyYWRpbyc7XG4gICAgICAgICAgICByYWRpb0VsZW1lbnQubmFtZSA9ICdmaWxlT3B0aW9uJztcbiAgICAgICAgICAgIHJhZGlvRWxlbWVudC52YWx1ZSA9IGZpbGUucGF0aDtcbiAgICAgICAgICAgIHJhZGlvRWxlbWVudC5pZCA9IGBmaWxlLSR7aW5kZXh9YDtcbiAgICBcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICAgICAgICBsYWJlbEVsZW1lbnQuaHRtbEZvciA9IGBmaWxlLSR7aW5kZXh9YDtcbiAgICAgICAgICAgIGxhYmVsRWxlbWVudC50ZXh0Q29udGVudCA9IGZpbGUucGF0aDtcbiAgICBcbiAgICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQocmFkaW9FbGVtZW50KTtcbiAgICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQobGFiZWxFbGVtZW50KTtcbiAgICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7XG4gICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgbW9kYWxDb250ZW50LmFwcGVuZENoaWxkKG9wdGlvbnNDb250YWluZXIpO1xuICAgIFxuICAgICAgICAgIGNvbnN0IGNvbmZpcm1Mb2FkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgY29uZmlybUxvYWRCdXR0b24uaWQgPSAnY29uZmlybUxvYWQnO1xuICAgICAgICAgIGNvbmZpcm1Mb2FkQnV0dG9uLnRleHRDb250ZW50ID0gJ0xvYWQnO1xuICAgICAgICAgIG1vZGFsQ29udGVudC5hcHBlbmRDaGlsZChjb25maXJtTG9hZEJ1dHRvbik7XG4gICAgXG4gICAgICAgICAgY29uZmlybUxvYWRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRSYWRpbyA9IG9wdGlvbnNDb250YWluZXIucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cInJhZGlvXCJdOmNoZWNrZWQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkUmFkaW8pIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGaWxlUGF0aCA9IHNlbGVjdGVkUmFkaW8udmFsdWU7XG4gICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRmlsZSA9IG1hdGNoaW5nRmlsZXMuZmluZChmaWxlID0+IGZpbGUucGF0aCA9PT0gc2VsZWN0ZWRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGF0SGlzdG9yeUZpbGVQYXRoID0gc2VsZWN0ZWRGaWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IGxvYWRDaGF0SGlzdG9yeShjaGF0SGlzdG9yeUZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgU3dpdGNoZWQgdG8gJyR7c2VsZWN0ZWRGaWxlLnBhdGh9JyBjaGF0IGhpc3RvcnkuYCk7XG4gICAgICAgICAgICAgICAgICBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlGaWxlID0gc2VsZWN0ZWRGaWxlO1xuICAgICAgXG4gICAgICAgICAgICAgICAgICBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoID0gc2VsZWN0ZWRGaWxlLnBhdGg7XG4gICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aCBmb3IgdGhlIGN1cnJlbnQgcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5W3Byb2ZpbGVJbmRleF0gPSBzZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoO1xuICAgICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgbW9kYWwuY29udGVudEVsLmFwcGVuZENoaWxkKG1vZGFsQ29udGVudCk7XG4gICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbmV3IE5vdGljZSgnRmlsZSBkb2VzIG5vdCBleGlzdC4nKTtcbiAgICB9XG5cbiAgfVxufVxuXG4vLyBgL3N0b3BgIHRvIHN0b3AgZmV0Y2hpbmcgcmVzcG9uc2VcbmV4cG9ydCBmdW5jdGlvbiBjb21tYW5kU3RvcCgpIHtcbiAgY29uc3QgY29udHJvbGxlciA9IGdldEFib3J0Q29udHJvbGxlcigpO1xuICBpZiAoY29udHJvbGxlcikge1xuICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVNZXNzYWdlVGhyZWFkKHBsdWdpbjogQk1PR1BULCBpbmRleDogbnVtYmVyKSB7XG4gIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuXG4gIGNvbnN0IGRpdkVsZW1lbnRzID0gbWVzc2FnZUNvbnRhaW5lcj8ucXVlcnlTZWxlY3RvckFsbCgnZGl2LmJvdE1lc3NhZ2UsIGRpdi51c2VyTWVzc2FnZScpO1xuXG4gIGlmIChkaXZFbGVtZW50cyAmJiBkaXZFbGVtZW50cy5sZW5ndGggPiAwICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCBkaXZFbGVtZW50cy5sZW5ndGgpIHtcbiAgICBmb3IgKGxldCBpID0gaW5kZXg7IGkgPCBkaXZFbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgbWVzc2FnZUNvbnRhaW5lcj8ucmVtb3ZlQ2hpbGQoZGl2RWxlbWVudHNbaV0pO1xuICAgIH1cbiAgfVxuXG4gIG1lc3NhZ2VIaXN0b3J5LnNwbGljZShpbmRleCk7XG4gIGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlSGlzdG9yeSwgbnVsbCwgNCk7XG5cbiAgdHJ5IHtcbiAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci53cml0ZShmaWxlTmFtZU1lc3NhZ2VIaXN0b3J5SnNvbihwbHVnaW4pLCBqc29uU3RyaW5nKTtcbiAgICAgICAgLy8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlciAocHJvZmlsZXMpXG4gICAgICAgIGNvbnN0IHByb2ZpbGVGaWxlcyA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpID0+IGZpbGUucGF0aC5zdGFydHNXaXRoKHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCkpO1xuXG4gICAgICAgIC8vIFNvcnRpbmcgdGhlIGZpbGVzIGFycmF5IGFscGhhYmV0aWNhbGx5IGJ5IGZpbGUgbmFtZVxuICAgICAgICBwcm9maWxlRmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cbiAgICAgICAgY29uc3QgY3VycmVudFByb2ZpbGUgPSBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpOyAvLyBSZW1vdmluZyB0aGUgZmlsZSBleHRlbnNpb25cblxuICAgICAgICAvLyBGaW5kaW5nIHRoZSBpbmRleCBvZiB0aGUgY3VycmVudFByb2ZpbGUgaW4gdGhlIHByb2ZpbGVGaWxlcyBhcnJheVxuICAgICAgICBjb25zdCBwcm9maWxlSW5kZXggPSBwcm9maWxlRmlsZXMuZmluZEluZGV4KChmaWxlKSA9PiBmaWxlLmJhc2VuYW1lID09PSBjdXJyZW50UHJvZmlsZSk7XG4gICAgICBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlGaWxlID0gbnVsbDtcbiAgICAgIHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5sYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoID0gbnVsbDtcblxuICAgICAgLy8gVXBkYXRlIHRoZSBsYXN0TG9hZGVkQ2hhdEhpc3RvcnlQYXRoIGZvciB0aGUgY3VycmVudCBwcm9maWxlXG4gICAgICBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5W3Byb2ZpbGVJbmRleF0gPSBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMubGFzdExvYWRlZENoYXRIaXN0b3J5UGF0aDtcblxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgbmV3IE5vdGljZSgnQ2hhdCBoaXN0b3J5IGNsZWFyZWQuJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIG1lc3NhZ2VIaXN0b3J5Lmpzb24nLCBlcnJvcik7XG4gIH1cbn0iLCAiLy8gRnVuY3Rpb24gdG8gY29udmVydCBIU0wgb3IgUkdCIHRvIEhFWFxuZXhwb3J0IGZ1bmN0aW9uIGNvbG9yVG9IZXgoY29sb3JWYWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoY29sb3JWYWx1ZS5zdGFydHNXaXRoKCdoc2wnKSkge1xuICAgICAgLy8gQ29udmVydCBIU0wgdG8gSEVYXG4gICAgICBjb25zdCBtYXRjaCA9IGNvbG9yVmFsdWUubWF0Y2goLyhcXGQrKFxcLlxcZCspPyklPy9nKTtcbiAgICAgIGlmIChtYXRjaCA9PT0gbnVsbCB8fCBtYXRjaC5sZW5ndGggPCAzKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEhTTCB2YWx1ZScpO1xuXHR9XG5cbiAgICAgIGNvbnN0IGggPSBwYXJzZUludChtYXRjaFswXSkgLyAzNjA7XG4gICAgICBjb25zdCBzID0gcGFyc2VJbnQobWF0Y2hbMV0pIC8gMTAwO1xuICAgICAgY29uc3QgbCA9IHBhcnNlSW50KG1hdGNoWzJdKSAvIDEwMDtcbiAgXG4gICAgICBjb25zdCBxID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcbiAgICAgIGNvbnN0IHAgPSAyICogbCAtIHE7XG4gICAgICBjb25zdCByID0gaHVlMnJnYihwLCBxLCBoICsgMSAvIDMpO1xuICAgICAgY29uc3QgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XG4gICAgICBjb25zdCBiID0gaHVlMnJnYihwLCBxLCBoIC0gMSAvIDMpO1xuICBcbiAgICAgIGNvbnN0IHRvSGV4ID0gZnVuY3Rpb24gKGM6IG51bWJlcikge1xuICAgICAgICBjb25zdCBoZXggPSBNYXRoLnJvdW5kKGMgKiAyNTUpLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgcmV0dXJuIGhleC5sZW5ndGggPT09IDEgPyAnMCcgKyBoZXggOiBoZXg7XG4gICAgICB9O1xuICBcbiAgICAgIGNvbnN0IGhleCA9ICcjJyArIHRvSGV4KHIpICsgdG9IZXgoZykgKyB0b0hleChiKTtcbiAgICAgIHJldHVybiBoZXg7XG4gICAgfSBlbHNlIGlmIChjb2xvclZhbHVlLnN0YXJ0c1dpdGgoJ3JnYicpKSB7XG4gICAgICAvLyBDb252ZXJ0IFJHQiB0byBIRVhcbiAgICAgIGNvbnN0IHNlcCA9IGNvbG9yVmFsdWUuaW5kZXhPZignLCcpID4gLTEgPyAnLCcgOiAnICc7XG4gICAgICBjb25zdCByZ2JBcnJheSA9IGNvbG9yVmFsdWUuc3Vic3RyKDQpLnNwbGl0KCcpJylbMF0uc3BsaXQoc2VwKTtcbiAgXG4gICAgICBsZXQgciA9ICgrcmdiQXJyYXlbMF0pLnRvU3RyaW5nKDE2KSxcbiAgICAgICAgZyA9ICgrcmdiQXJyYXlbMV0pLnRvU3RyaW5nKDE2KSxcbiAgICAgICAgYiA9ICgrcmdiQXJyYXlbMl0pLnRvU3RyaW5nKDE2KTtcbiAgXG4gICAgICBpZiAoci5sZW5ndGggPT0gMSlcbiAgICAgICAgciA9ICcwJyArIHI7XG4gICAgICBpZiAoZy5sZW5ndGggPT0gMSlcbiAgICAgICAgZyA9ICcwJyArIGc7XG4gICAgICBpZiAoYi5sZW5ndGggPT0gMSlcbiAgICAgICAgYiA9ICcwJyArIGI7XG4gIFxuICAgICAgcmV0dXJuICcjJyArIHIgKyBnICsgYjtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgdGhlIGNvbG9yVmFsdWUgaXMgbmVpdGhlciBSR0Igbm9yIEhTTCwgcmV0dXJuIHRoZSBpbnB1dFxuICAgICAgcmV0dXJuIGNvbG9yVmFsdWU7XG4gICAgfVxufVxuXG4vLyBGdW5jdGlvbiB0byBjb252ZXJ0IEhTTCB0byBSR0JcbmZ1bmN0aW9uIGh1ZTJyZ2IocDogbnVtYmVyLCBxOiBudW1iZXIsIHQ6IG51bWJlcikge1xuXHRpZiAodCA8IDApIHQgKz0gMTtcblx0aWYgKHQgPiAxKSB0IC09IDE7XG5cdGlmICh0IDwgMSAvIDYpIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0O1xuXHRpZiAodCA8IDEgLyAyKSByZXR1cm4gcTtcblx0aWYgKHQgPCAyIC8gMykgcmV0dXJuIHAgKyAocSAtIHApICogKDIgLyAzIC0gdCkgKiA2O1xuXHRyZXR1cm4gcDtcbn1cblxuZXhwb3J0IGNvbnN0IGlzVmFsaWRIZXhDb2xvciA9IChjb2xvcjogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gIGNvbnN0IGhleENvbG9yUmVnZXggPSAvXlswLTlBLUZhLWZdezZ9JC87XG4gIHJldHVybiBoZXhDb2xvclJlZ2V4LnRlc3QoY29sb3IpO1xufTsiLCAiaW1wb3J0IHsgTWFya2Rvd25SZW5kZXJlciwgTm90aWNlLCByZXF1ZXN0VXJsLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEJNT0dQVCwgeyBCTU9TZXR0aW5ncyB9IGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgbWVzc2FnZUhpc3RvcnkgfSBmcm9tICcuLi92aWV3JztcbmltcG9ydCB7IGFkZE1lc3NhZ2UsIGFkZFBhcmFncmFwaEJyZWFrcywgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3MgfSBmcm9tICcuL2NoYXQvTWVzc2FnZSc7XG5pbXBvcnQgeyBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlLCBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2UgfSBmcm9tICcuL2NoYXQvQm90TWVzc2FnZSc7XG5pbXBvcnQgeyBnZXRBY3RpdmVGaWxlQ29udGVudCwgZ2V0Q3VycmVudE5vdGVDb250ZW50IH0gZnJvbSAnLi9lZGl0b3IvUmVmZXJlbmNlQ3VycmVudE5vdGUnO1xuaW1wb3J0IHsgZ2V0UHJvbXB0IH0gZnJvbSAnLi9jaGF0L1Byb21wdCc7XG5cbmxldCBhYm9ydENvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlciB8IG51bGwgPSBudWxsO1xuXG4vLyBGZXRjaCByZXNwb25zZSBmcm9tIE9sbGFtYVxuLy8gTk9URTogQWJvcnQgZG9lcyBub3Qgd29yayBmb3IgcmVxdWVzdFVybFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoT2xsYW1hUmVzcG9uc2UocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgaW5kZXg6IG51bWJlcikge1xuICAgIGNvbnN0IG9sbGFtYVJFU1RBUElVUkwgPSBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkw7XG5cbiAgICBpZiAoIW9sbGFtYVJFU1RBUElVUkwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHByb21wdCA9IGF3YWl0IGdldFByb21wdChwbHVnaW4sIHNldHRpbmdzKTtcblxuICAgIGNvbnN0IGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkgPSBmaWx0ZXJNZXNzYWdlSGlzdG9yeShtZXNzYWdlSGlzdG9yeSk7XG4gICAgY29uc3QgbWVzc2FnZUhpc3RvcnlBdEluZGV4ID0gcmVtb3ZlQ29uc2VjdXRpdmVVc2VyUm9sZXMoZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSk7XG5cbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbERpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVzc2FnZUNvbnRhaW5lciBkaXYudXNlck1lc3NhZ2UsICNtZXNzYWdlQ29udGFpbmVyIGRpdi5ib3RNZXNzYWdlJyk7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUxvYWRpbmdCb3RNZXNzYWdlKHNldHRpbmdzKTtcblxuICAgIG1lc3NhZ2VDb250YWluZXJFbD8uaW5zZXJ0QmVmb3JlKGJvdE1lc3NhZ2VEaXYsIG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXgrMV0pO1xuICAgIGJvdE1lc3NhZ2VEaXYuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuXG4gICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gZ2V0Q3VycmVudE5vdGVDb250ZW50KCk7XG5cbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgLy8gQ2hhbmdlIGJ1dHRvbiB0ZXh0IHRvIFwiQ2FuY2VsXCJcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ3NxdWFyZScpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzdG9wJztcblxuICAgIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbi50aXRsZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0QWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChvbGxhbWFSRVNUQVBJVVJMICsgJy9hcGkvY2hhdCcsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHJlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudCArIHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAgICAgLi4ubWVzc2FnZUhpc3RvcnlBdEluZGV4XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9sbGFtYVBhcmFtZXRlcnNPcHRpb25zKHNldHRpbmdzKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGxldCBtZXNzYWdlID0gcmVzcG9uc2VEYXRhLm1lc3NhZ2UuY29udGVudDtcblxuICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgaWYgKG1lc3NhZ2VCbG9jaykge1xuICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlQ2hpbGQobG9hZGluZ0VsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlIHx8ICcnLCBtZXNzYWdlQmxvY2sgYXMgSFRNTEVsZW1lbnQsICcvJywgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb3B5Q29kZUJsb2NrcyA9IG1lc3NhZ2VCbG9jay5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1jb2RlLWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihjb3B5Q29kZUJsb2NrLCAnY29weScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LmFwcGVuZENoaWxkKG1lc3NhZ2VCbG9jayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCBtZXNzYWdlLnRyaW0oKSwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgICAgLy8gUmVxdWVzdCB3YXMgYWJvcnRlZCwgaGFuZGxlIGFjY29yZGluZ2x5XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBhYm9ydGVkJyk7XG4gICAgICAgICAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgICAgICAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc2VuZCc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2sgJiYgbG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay50ZXh0Q29udGVudCA9ICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJywgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBvdGhlciBlcnJvcnNcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlFcnJvckJvdE1lc3NhZ2UocGx1Z2luLCBzZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIGVycm9yKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBSZXNldCB0aGUgYWJvcnQgY29udHJvbGxlclxuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgIH1cbn1cblxuLy8gRmV0Y2ggcmVzcG9uc2UgZnJvbSBPbGxhbWEgKHN0cmVhbSlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE9sbGFtYVJlc3BvbnNlU3RyZWFtKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBvbGxhbWFSRVNUQVBJVVJMID0gc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5SRVNUQVBJVVJMO1xuXG4gICAgaWYgKCFvbGxhbWFSRVNUQVBJVVJMKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7XG5cbiAgICBjb25zdCB1cmwgPSBvbGxhbWFSRVNUQVBJVVJMICsgJy9hcGkvY2hhdCc7XG5cbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuXG4gICAgbGV0IGlzU2Nyb2xsID0gZmFsc2U7XG5cbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3RvcnkobWVzc2FnZUhpc3RvcnkpO1xuXG4gICAgY29uc3QgbWVzc2FnZUhpc3RvcnlBdEluZGV4ID0gcmVtb3ZlQ29uc2VjdXRpdmVVc2VyUm9sZXMoZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSk7XG4gICAgXG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWxEaXZzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21lc3NhZ2VDb250YWluZXIgZGl2LnVzZXJNZXNzYWdlLCAjbWVzc2FnZUNvbnRhaW5lciBkaXYuYm90TWVzc2FnZScpO1xuXG4gICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlMb2FkaW5nQm90TWVzc2FnZShzZXR0aW5ncyk7XG5cbiAgICBtZXNzYWdlQ29udGFpbmVyRWw/Lmluc2VydEJlZm9yZShib3RNZXNzYWdlRGl2LCBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4KzFdKTtcbiAgICBib3RNZXNzYWdlRGl2LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcblxuICAgIGF3YWl0IGdldEFjdGl2ZUZpbGVDb250ZW50KHBsdWdpbiwgc2V0dGluZ3MpO1xuICAgIGNvbnN0IHJlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudCA9IGdldEN1cnJlbnROb3RlQ29udGVudCgpO1xuXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1Ym1pdC1idXR0b24nKSBhcyBIVE1MRWxlbWVudDtcbiAgICAvLyBDaGFuZ2UgdGhlIHN1Ym1pdCBidXR0b24gdG8gYSBzdG9wIGJ1dHRvblxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuICAgIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbi50aXRsZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0QWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnR9LFxuICAgICAgICAgICAgICAgICAgICAuLi5tZXNzYWdlSGlzdG9yeUF0SW5kZXhcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHN0cmVhbTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBrZWVwX2FsaXZlOiBwYXJzZUludChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMua2VlcF9hbGl2ZSksXG4gICAgICAgICAgICAgICAgb3B0aW9uczogb2xsYW1hUGFyYW1ldGVyc09wdGlvbnMoc2V0dGluZ3MpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzaWduYWw6IGFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgICAgICAgfSlcblxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKTtcbiAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgICAgICBsZXQgcmVhZGluZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUgKHJlYWRpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSkgfHwgJyc7XG4gICAgICAgICAgICAvLyBTcGxpdHRpbmcgdGhlIGNodW5rIHRvIHBhcnNlIEpTT04gbWVzc2FnZXMgc2VwYXJhdGVseVxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBjaHVuay5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMuZmlsdGVyKEJvb2xlYW4pKSB7IC8vIEZpbHRlciBvdXQgZW1wdHkgcGFydHNcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkQ2h1bms7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSBKU09OLnBhcnNlKHBhcnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkQ2h1bmsuZG9uZSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IHBhcnNlZENodW5rLm1lc3NhZ2UuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEpTT046JywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQYXJ0IHdpdGggZXJyb3I6JywgcGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWRDaHVuayA9IHtyZXNwb25zZTogJ3tfZV99J307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VCbG9jayA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlQmxvY2snKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcjbG9hZGluZycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VCbG9jaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgbWVzc2FnZUJsb2NrIGZvciByZS1yZW5kZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRG9jdW1lbnRGcmFnbWVudCB0byByZW5kZXIgbWFya2Rvd24gb2ZmLURPTVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0ZW1wQ29udGFpbmVyKTtcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbmRlciB0aGUgYWNjdW11bGF0ZWQgbWVzc2FnZSB0byB0aGUgdGVtcG9yYXJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlLCB0ZW1wQ29udGFpbmVyLCAnLycsIHBsdWdpbik7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIHJlbmRlcmluZyBpcyBjb21wbGV0ZSwgbW92ZSB0aGUgY29udGVudCB0byB0aGUgYWN0dWFsIG1lc3NhZ2UgYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weUNvZGVCbG9ja3MgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmNvcHktY29kZS1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEljb24oY29weUNvZGVCbG9jaywgJ2NvcHknKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lckVsLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50OiBXaGVlbEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSB1c2VyIHNjcm9sbHMgdXAgb3IgZG93biwgc3RvcCBhdXRvLXNjcm9sbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGVsdGFZIDwgMCB8fCBldmVudC5kZWx0YVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1Njcm9sbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghaXNTY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ2F1dG8nLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcblxuICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSGFuZGxlIG90aGVyIGVycm9yc1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmUoKTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3IpO1xuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXNzYWdlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgcmVzcG9uc2UgZnJvbSBPbGxhbWE6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFJlc2V0IHRoZSBhYm9ydCBjb250cm9sbGVyXG4gICAgICAgIGFib3J0Q29udHJvbGxlciA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hhbmdlIHRoZSBzdWJtaXQgYnV0dG9uIGJhY2sgdG8gYSBzZW5kIGJ1dHRvblxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdzZW5kJztcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xufVxuXG4vLyBGZXRjaCByZXNwb25zZSBmcm9tIG9wZW5haS1iYXNlZCByZXN0IGFwaSB1cmxcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFJFU1RBUElVUkxSZXNwb25zZShwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBpbmRleDogbnVtYmVyKSB7XG4gICAgY29uc3QgcHJvbXB0ID0gYXdhaXQgZ2V0UHJvbXB0KHBsdWdpbiwgc2V0dGluZ3MpO1xuICAgIGNvbnN0IG5vSW1hZ2VNZXNzYWdlSGlzdG9yeSA9IG1lc3NhZ2VIaXN0b3J5Lm1hcCgoeyByb2xlLCBjb250ZW50IH0pID0+ICh7IHJvbGUsIGNvbnRlbnQgfSkpO1xuICAgIGNvbnN0IGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkgPSBmaWx0ZXJNZXNzYWdlSGlzdG9yeShub0ltYWdlTWVzc2FnZUhpc3RvcnkpO1xuICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5QXRJbmRleCA9IHJlbW92ZUNvbnNlY3V0aXZlVXNlclJvbGVzKGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkpO1xuICAgIFxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcbiBcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgdXJsOiBzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMICsgJy9jaGF0L2NvbXBsZXRpb25zJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uQVBJS2V5fWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZ2VuZXJhbC5zeXN0ZW1fcm9sZSArIHByb21wdCArIHJlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudCB8fCAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50Lid9LFxuICAgICAgICAgICAgICAgICAgICAuLi5tZXNzYWdlSGlzdG9yeUF0SW5kZXhcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucykgfHwgLTEsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBtZXNzYWdlID0gcmVzcG9uc2UuanNvbi5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblxuICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcbiAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIG1lc3NhZ2UgfHwgJycsIG1lc3NhZ2VCbG9jayBhcyBIVE1MRWxlbWVudCwgJy8nLCBwbHVnaW4pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVVucmVzb2x2ZWRJbnRlcm5hbExpbmtzKHBsdWdpbiwgbWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uYXBwZW5kQ2hpbGQobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmaW5lIHJlZ2V4IHBhdHRlcm5zIGZvciB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICBjb25zdCByZWdleFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLzxibG9jay1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL2Jsb2NrLXJlbmRlcmVkPi9nLFxuICAgICAgICAgICAgLzxub3RlLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvbm90ZS1yZW5kZXJlZD4vZ1xuICAgICAgICBdO1xuXG4gICAgICAgIC8vIENsZWFuIHRoZSBtZXNzYWdlIGNvbnRlbnQgYnkgcmVtb3ZpbmcgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgcmVnZXhQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShwYXR0ZXJuLCAnJykudHJpbSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlKCk7XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBlcnJvcik7XG4gICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG5cbiAgICB9XG59XG5cbi8vIEZldGNoIHJlc3BvbnNlIGZyb20gb3BlbmFpLWJhc2VkIHJlc3QgYXBpIHVybCAoc3RyZWFtKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoUkVTVEFQSVVSTFJlc3BvbnNlU3RyZWFtKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBSRVNUQVBJVVJMID0gc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTDtcblxuICAgIGlmICghUkVTVEFQSVVSTCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0ID0gYXdhaXQgZ2V0UHJvbXB0KHBsdWdpbiwgc2V0dGluZ3MpO1xuXG4gICAgY29uc3QgdXJsID0gUkVTVEFQSVVSTCArICcvY2hhdC9jb21wbGV0aW9ucyc7XG5cbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuXG4gICAgbGV0IGlzU2Nyb2xsID0gZmFsc2U7XG5cbiAgICBjb25zdCBub0ltYWdlTWVzc2FnZUhpc3RvcnkgPSBtZXNzYWdlSGlzdG9yeS5tYXAoKHsgcm9sZSwgY29udGVudCB9KSA9PiAoeyByb2xlLCBjb250ZW50IH0pKTtcbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3Rvcnkobm9JbWFnZU1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcblxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBDaGFuZ2UgdGhlIHN1Ym1pdCBidXR0b24gdG8gYSBzdG9wIGJ1dHRvblxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5BUElLZXl9YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBtb2RlbDogc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzZXR0aW5ncy5nZW5lcmFsLnN5c3RlbV9yb2xlICsgcHJvbXB0ICsgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50IHx8ICdZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQuJ30sXG4gICAgICAgICAgICAgICAgICAgIC4uLm1lc3NhZ2VIaXN0b3J5QXRJbmRleFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgc3RyZWFtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpIHx8IDQwOTYsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbFxuICAgICAgICB9KVxuXG4gICAgICAgIFxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKTtcbiAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgICAgICBsZXQgcmVhZGluZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUgKHJlYWRpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IGZhbHNlIH0pIHx8ICcnO1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnY2h1bmsnLGNodW5rKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBjaHVuay5zcGxpdCgnXFxuJyk7XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwicGFydHNcIiwgcGFydHMpXG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cy5maWx0ZXIoQm9vbGVhbikpIHsgLy8gRmlsdGVyIG91dCBlbXB0eSBwYXJ0c1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGNodW5rIGNvbnRhaW5zICdkYXRhOiBbRE9ORV0nXG4gICAgICAgICAgICAgICAgaWYgKHBhcnQuaW5jbHVkZXMoJ2RhdGE6IFtET05FXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkQ2h1bms7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSBKU09OLnBhcnNlKHBhcnQucmVwbGFjZSgvXmRhdGE6IC8sICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocGFyc2VkQ2h1bmsuY2hvaWNlc1swXS5maW5pc2hfcmVhc29uICE9PSAnc3RvcCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gcGFyc2VkQ2h1bmsuY2hvaWNlc1swXS5kZWx0YS5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSArPSBjb250ZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgSlNPTjonLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUGFydCB3aXRoIGVycm9yOicsIHBhcnQpO1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWRDaHVuayA9IHtyZXNwb25zZTogJ3tfZV99J307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXJFbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlQ2hpbGQobG9hZGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIG1lc3NhZ2VCbG9jayBmb3IgcmUtcmVuZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50RnJhZ21lbnQgdG8gcmVuZGVyIG1hcmtkb3duIG9mZi1ET01cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGVtcENvbnRhaW5lcik7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIGFjY3VtdWxhdGVkIG1lc3NhZ2UgdG8gdGhlIHRlbXBvcmFyeSBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIocGx1Z2luLmFwcCwgbWVzc2FnZSwgdGVtcENvbnRhaW5lciwgJy8nLCBwbHVnaW4pO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gT25jZSByZW5kZXJpbmcgaXMgY29tcGxldGUsIG1vdmUgdGhlIGNvbnRlbnQgdG8gdGhlIGFjdHVhbCBtZXNzYWdlIGJsb2NrXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh0ZW1wQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5hcHBlbmRDaGlsZCh0ZW1wQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3MocGx1Z2luLCBtZXNzYWdlQmxvY2spO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2sudGV4dENvbnRlbnQgPSAnQ29weSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXJFbC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudDogV2hlZWxFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdXNlciBzY3JvbGxzIHVwIG9yIGRvd24sIHN0b3AgYXV0by1zY3JvbGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRlbHRhWSA8IDAgfHwgZXZlbnQuZGVsdGFZID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlzU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdhdXRvJywgYmxvY2s6ICdzdGFydCcgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCBtZXNzYWdlLnRyaW0oKSwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSGFuZGxlIG90aGVyIGVycm9yc1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmUoKTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3IpO1xuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXNzYWdlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgcmVzcG9uc2UgZnJvbSBPbGxhbWE6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFJlc2V0IHRoZSBhYm9ydCBjb250cm9sbGVyXG4gICAgICAgIGFib3J0Q29udHJvbGxlciA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hhbmdlIHRoZSBzdWJtaXQgYnV0dG9uIGJhY2sgdG8gYSBzZW5kIGJ1dHRvblxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdzZW5kJztcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xufVxuXG4vLyBGZXRjaCByZXNwb25zZSBmcm9tIEFudGhyb3BpY1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQW50aHJvcGljUmVzcG9uc2UocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgaW5kZXg6IG51bWJlcikge1xuICAgIGNvbnN0IHByb21wdCA9IGF3YWl0IGdldFByb21wdChwbHVnaW4sIHNldHRpbmdzKTtcblxuICAgIGNvbnN0IG5vSW1hZ2VNZXNzYWdlSGlzdG9yeSA9IG1lc3NhZ2VIaXN0b3J5Lm1hcCgoeyByb2xlLCBjb250ZW50IH0pID0+ICh7IHJvbGUsIGNvbnRlbnQgfSkpO1xuICAgIGNvbnN0IGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkgPSBmaWx0ZXJNZXNzYWdlSGlzdG9yeShub0ltYWdlTWVzc2FnZUhpc3RvcnkpO1xuICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5QXRJbmRleCA9IHJlbW92ZUNvbnNlY3V0aXZlVXNlclJvbGVzKGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkpO1xuICAgIFxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBDaGFuZ2UgYnV0dG9uIHRleHQgdG8gXCJDYW5jZWxcIlxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMScsXG4gICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAneC1hcGkta2V5Jzogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgc3lzdGVtOiBzZXR0aW5ncy5nZW5lcmFsLnN5c3RlbV9yb2xlICsgcHJvbXB0ICsgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50LFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgIC4uLm1lc3NhZ2VIaXN0b3J5QXRJbmRleFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgbWF4X3Rva2VuczogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKSB8fCA0MDk2LFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgbWVzc2FnZSA9IHJlc3BvbnNlLmpzb24uY29udGVudFswXS50ZXh0O1xuXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcjbG9hZGluZycpO1xuICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2spIHtcbiAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIocGx1Z2luLmFwcCwgbWVzc2FnZSB8fCAnJywgbWVzc2FnZUJsb2NrIGFzIEhUTUxFbGVtZW50LCAnLycsIHBsdWdpbik7XG5cbiAgICAgICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb3B5Q29kZUJsb2NrcyA9IG1lc3NhZ2VCbG9jay5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1jb2RlLWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihjb3B5Q29kZUJsb2NrLCAnY29weScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LmFwcGVuZENoaWxkKG1lc3NhZ2VCbG9jayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSByZWdleCBwYXR0ZXJucyBmb3IgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgY29uc3QgcmVnZXhQYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC88YmxvY2stcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ibG9jay1yZW5kZXJlZD4vZyxcbiAgICAgICAgICAgIC88bm90ZS1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL25vdGUtcmVuZGVyZWQ+L2dcbiAgICAgICAgXTtcblxuICAgICAgICAvLyBDbGVhbiB0aGUgbWVzc2FnZSBjb250ZW50IGJ5IHJlbW92aW5nIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIHJlZ2V4UGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UocGF0dGVybiwgJycpLnRyaW0oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2UudHJpbSgpLCAnYm90TWVzc2FnZScsIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgIHJldHVybjtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZSgpO1xuXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3IpO1xuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VEaXYpO1xuICAgIH1cblxufVxuXG4vLyBGZXRjaCByZXNwb25zZSBmcm9tIEdvb2dsZSBHZW1pbmlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSA9IGZpbHRlck1lc3NhZ2VIaXN0b3J5KG1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcbiAgICBcbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbERpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVzc2FnZUNvbnRhaW5lciBkaXYudXNlck1lc3NhZ2UsICNtZXNzYWdlQ29udGFpbmVyIGRpdi5ib3RNZXNzYWdlJyk7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUxvYWRpbmdCb3RNZXNzYWdlKHNldHRpbmdzKTtcblxuICAgIG1lc3NhZ2VDb250YWluZXJFbD8uaW5zZXJ0QmVmb3JlKGJvdE1lc3NhZ2VEaXYsIG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXgrMV0pO1xuICAgIGJvdE1lc3NhZ2VEaXYuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuXG4gICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gZ2V0Q3VycmVudE5vdGVDb250ZW50KCk7XG5cbiAgICAvLyBGdW5jdGlvbiB0byBjb252ZXJ0IG1lc3NhZ2VIaXN0b3J5IHRvIEdvb2dsZSBHZW1pbmkgZm9ybWF0XG4gICAgY29uc3QgY29udmVydE1lc3NhZ2VIaXN0b3J5ID0gKG1lc3NhZ2VIaXN0b3J5OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH1bXSkgPT4ge1xuICAgICAgICAvLyBDbG9uZSB0aGUgbWVzc2FnZUhpc3RvcnkgdG8gYXZvaWQgbXV0YXRpbmcgdGhlIG9yaWdpbmFsIGFycmF5XG4gICAgICAgIGNvbnN0IG1vZGlmaWVkTWVzc2FnZUhpc3RvcnkgPSBbLi4ubWVzc2FnZUhpc3RvcnldO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udmVydGVkTWVzc2FnZUhpc3RvcnkgPSBtb2RpZmllZE1lc3NhZ2VIaXN0b3J5Lm1hcCgoeyByb2xlLCBjb250ZW50IH0pID0+ICh7XG4gICAgICAgICAgICByb2xlOiByb2xlID09PSAnYXNzaXN0YW50JyA/ICdtb2RlbCcgOiByb2xlLFxuICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6IGNvbnRlbnQgfV1cbiAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udGVudHMgPSBbXG4gICAgICAgICAgICAuLi5jb252ZXJ0ZWRNZXNzYWdlSGlzdG9yeVxuICAgICAgICBdO1xuXG4gICAgICAgIHJldHVybiB7IGNvbnRlbnRzIH07XG4gICAgfTtcbiAgICBcbiAgICAvLyBVc2UgdGhlIGZ1bmN0aW9uIHRvIGNvbnZlcnQgeW91ciBtZXNzYWdlIGhpc3RvcnlcbiAgICBjb25zdCBjb252ZXJ0ZWRNZXNzYWdlSGlzdG9yeSA9IGNvbnZlcnRNZXNzYWdlSGlzdG9yeShtZXNzYWdlSGlzdG9yeUF0SW5kZXgpO1xuXG4gICAgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1Ym1pdC1idXR0b24nKSBhcyBIVE1MRWxlbWVudDtcblxuICAgIC8vIENoYW5nZSBidXR0b24gdGV4dCB0byBcIkNhbmNlbFwiXG4gICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdzcXVhcmUnKTtcbiAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc3RvcCc7XG5cbiAgICBzdWJtaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChzdWJtaXRCdXR0b24udGl0bGUgPT09ICdzdG9wJykge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGdldEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHRyeSB7ICAgICAgICBcbiAgICAgICAgY29uc3QgQVBJX0tFWSA9IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5BUElLZXk7XG4gICAgICAgIGNvbnN0IE1PREVMID0gc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbDtcbiAgICBcbiAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS8nICsgTU9ERUwgKyAnOmdlbmVyYXRlQ29udGVudD9rZXk9JyArIEFQSV9LRVk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBjb250ZW50czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtIHByb21wdDogXFxuXFxuICR7cGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGV9ICR7cHJvbXB0fSAke3JlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudH0gUmVzcG9uZCB1bmRlcnN0b29kIGlmIHlvdSBnb3QgaXQuYCB9XSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHJvbGU6ICdtb2RlbCcsXG4gICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogJ1VuZGVyc3Rvb2QuJyB9XSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC4uLmNvbnZlcnRlZE1lc3NhZ2VIaXN0b3J5LmNvbnRlbnRzLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgc3RvcFNlcXVlbmNlczogJycsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICAgICAgICAgIG1heE91dHB1dFRva2Vuczogc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zIHx8IDQwOTYsXG4gICAgICAgICAgICAgICAgdG9wUDogMC44LFxuICAgICAgICAgICAgICAgIHRvcEs6IDEwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXI/LnNpZ25hbCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICBsZXQgbWVzc2FnZSA9IHJlc3BvbnNlRGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dDtcblxuICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcbiAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIG1lc3NhZ2UgfHwgJycsIG1lc3NhZ2VCbG9jayBhcyBIVE1MRWxlbWVudCwgJy8nLCBwbHVnaW4pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVVucmVzb2x2ZWRJbnRlcm5hbExpbmtzKHBsdWdpbiwgbWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uYXBwZW5kQ2hpbGQobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmaW5lIHJlZ2V4IHBhdHRlcm5zIGZvciB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICBjb25zdCByZWdleFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLzxibG9jay1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL2Jsb2NrLXJlbmRlcmVkPi9nLFxuICAgICAgICAgICAgLzxub3RlLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvbm90ZS1yZW5kZXJlZD4vZ1xuICAgICAgICBdO1xuXG4gICAgICAgIC8vIENsZWFuIHRoZSBtZXNzYWdlIGNvbnRlbnQgYnkgcmVtb3ZpbmcgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgcmVnZXhQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShwYXR0ZXJuLCAnJykudHJpbSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWQsIGhhbmRsZSBhY2NvcmRpbmdseVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlcXVlc3QgYWJvcnRlZCcpO1xuICAgICAgICAgICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgICAgICAgICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgb3RoZXIgZXJyb3JzXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBlcnJvcik7XG4gICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VEaXYpO1xuICAgICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgLy8gUmVzZXQgdGhlIGFib3J0IGNvbnRyb2xsZXJcbiAgICAgICAgYWJvcnRDb250cm9sbGVyID0gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlU3RyZWFtKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7XG5cbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuXG4gICAgbGV0IGlzU2Nyb2xsID0gZmFsc2U7XG5cbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3RvcnkobWVzc2FnZUhpc3RvcnkpO1xuICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5QXRJbmRleCA9IHJlbW92ZUNvbnNlY3V0aXZlVXNlclJvbGVzKGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkpO1xuICAgIFxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIC8vIEZ1bmN0aW9uIHRvIGNvbnZlcnQgbWVzc2FnZUhpc3RvcnkgdG8gR29vZ2xlIEdlbWluaSBmb3JtYXRcbiAgICBjb25zdCBjb252ZXJ0TWVzc2FnZUhpc3RvcnkgPSAobWVzc2FnZUhpc3Rvcnk6IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfVtdKSA9PiB7XG4gICAgICAgIC8vIENsb25lIHRoZSBtZXNzYWdlSGlzdG9yeSB0byBhdm9pZCBtdXRhdGluZyB0aGUgb3JpZ2luYWwgYXJyYXlcbiAgICAgICAgY29uc3QgbW9kaWZpZWRNZXNzYWdlSGlzdG9yeSA9IFsuLi5tZXNzYWdlSGlzdG9yeV07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb252ZXJ0ZWRNZXNzYWdlSGlzdG9yeSA9IG1vZGlmaWVkTWVzc2FnZUhpc3RvcnkubWFwKCh7IHJvbGUsIGNvbnRlbnQgfSkgPT4gKHtcbiAgICAgICAgICAgIHJvbGU6IHJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6IHJvbGUsXG4gICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogY29udGVudCB9XVxuICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb250ZW50cyA9IFtcbiAgICAgICAgICAgIC4uLmNvbnZlcnRlZE1lc3NhZ2VIaXN0b3J5XG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIHsgY29udGVudHMgfTtcbiAgICB9O1xuXG4gICAgY29uc3QgY29udmVydGVkTWVzc2FnZUhpc3RvcnkgPSBjb252ZXJ0TWVzc2FnZUhpc3RvcnkobWVzc2FnZUhpc3RvcnlBdEluZGV4KTtcblxuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBDaGFuZ2UgYnV0dG9uIHRleHQgdG8gXCJDYW5jZWxcIlxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBBUElfS0VZID0gc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLkFQSUtleTtcbiAgICAgICAgY29uc3QgTU9ERUwgPSBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsO1xuICAgIFxuICAgICAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhLycgKyBNT0RFTCArICc6c3RyZWFtR2VuZXJhdGVDb250ZW50P2FsdD1zc2Uma2V5PScgKyBBUElfS0VZO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgY29udGVudHM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogYFN5c3RlbSBwcm9tcHQ6IFxcblxcbiAke3BsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLnN5c3RlbV9yb2xlfSAke3Byb21wdH0gJHtyZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnR9IFJlc3BvbmQgdW5kZXJzdG9vZCBpZiB5b3UgZ290IGl0LmAgfV0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICByb2xlOiAnbW9kZWwnLFxuICAgICAgICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6ICdVbmRlcnN0b29kLicgfV0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAuLi5jb252ZXJ0ZWRNZXNzYWdlSGlzdG9yeS5jb250ZW50cyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHN0b3BTZXF1ZW5jZXM6ICcnLFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucyB8fCA0MDk2LFxuICAgICAgICAgICAgICAgIHRvcFA6IDAuOCxcbiAgICAgICAgICAgICAgICB0b3BLOiAxMFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyPy5zaWduYWwsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUmVzcG9uc2UgYm9keSBpcyBudWxsIG9yIHVuZGVmaW5lZC4nKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzcG9uc2UgYm9keSBpcyBudWxsIG9yIHVuZGVmaW5lZC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCk7XG4gICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgbGV0IHJlYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgIHdoaWxlIChyZWFkaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICByZWFkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNodW5rID0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pIHx8ICcnO1xuICAgICAgICAgICAgLy8gU3BsaXR0aW5nIHRoZSBjaHVuayB0byBwYXJzZSBKU09OIG1lc3NhZ2VzIHNlcGFyYXRlbHlcbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gY2h1bmsuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMuZmlsdGVyKEJvb2xlYW4pKSB7IC8vIEZpbHRlciBvdXQgZW1wdHkgcGFydHNcbiAgICAgICAgICAgICAgICBpZiAocGFydC5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IHBhcnQuc2xpY2UoNik7IC8vIFJlbW92ZSB0aGUgXCJkYXRhOiBcIiBwcmVmaXhcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcnNlZENodW5rO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSBKU09OLnBhcnNlKGpzb25EYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZWRDaHVuay5kb25lICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IHBhcnNlZENodW5rLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEpTT046JywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQYXJ0IHdpdGggZXJyb3I6JywganNvbkRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSB7IHJlc3BvbnNlOiAne19lX30nIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VCbG9jayA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlQmxvY2snKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcjbG9hZGluZycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VCbG9jaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgbWVzc2FnZUJsb2NrIGZvciByZS1yZW5kZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRG9jdW1lbnRGcmFnbWVudCB0byByZW5kZXIgbWFya2Rvd24gb2ZmLURPTVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0ZW1wQ29udGFpbmVyKTtcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbmRlciB0aGUgYWNjdW11bGF0ZWQgbWVzc2FnZSB0byB0aGUgdGVtcG9yYXJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlLCB0ZW1wQ29udGFpbmVyLCAnLycsIHBsdWdpbik7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIHJlbmRlcmluZyBpcyBjb21wbGV0ZSwgbW92ZSB0aGUgY29udGVudCB0byB0aGUgYWN0dWFsIG1lc3NhZ2UgYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weUNvZGVCbG9ja3MgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmNvcHktY29kZS1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEljb24oY29weUNvZGVCbG9jaywgJ2NvcHknKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lckVsLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50OiBXaGVlbEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSB1c2VyIHNjcm9sbHMgdXAgb3IgZG93biwgc3RvcCBhdXRvLXNjcm9sbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGVsdGFZIDwgMCB8fCBldmVudC5kZWx0YVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1Njcm9sbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghaXNTY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ2F1dG8nLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcblxuICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSGFuZGxlIG90aGVyIGVycm9yc1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmUoKTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3IpO1xuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXNzYWdlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgcmVzcG9uc2UgZnJvbSBHb29nbGUgR2VtaW5pOicsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBSZXNldCB0aGUgYWJvcnQgY29udHJvbGxlclxuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIENoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiBiYWNrIHRvIGEgc2VuZCBidXR0b25cbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnc2VuZCc7XG4gICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzZW5kJztcbn1cblxuLy8gRmV0Y2ggcmVzcG9uc2UgZnJvbSBNaXN0cmFsXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hNaXN0cmFsUmVzcG9uc2UocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgaW5kZXg6IG51bWJlcikge1xuICAgIGNvbnN0IHByb21wdCA9IGF3YWl0IGdldFByb21wdChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCBub0ltYWdlTWVzc2FnZUhpc3RvcnkgPSBtZXNzYWdlSGlzdG9yeS5tYXAoKHsgcm9sZSwgY29udGVudCB9KSA9PiAoeyByb2xlLCBjb250ZW50IH0pKTtcbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3Rvcnkobm9JbWFnZU1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcbiAgICBcbiAgICBcbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbERpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVzc2FnZUNvbnRhaW5lciBkaXYudXNlck1lc3NhZ2UsICNtZXNzYWdlQ29udGFpbmVyIGRpdi5ib3RNZXNzYWdlJyk7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUxvYWRpbmdCb3RNZXNzYWdlKHNldHRpbmdzKTtcblxuICAgIG1lc3NhZ2VDb250YWluZXJFbD8uaW5zZXJ0QmVmb3JlKGJvdE1lc3NhZ2VEaXYsIG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXgrMV0pO1xuICAgIGJvdE1lc3NhZ2VEaXYuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuXG4gICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gZ2V0Q3VycmVudE5vdGVDb250ZW50KCk7XG5cbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgLy8gQ2hhbmdlIGJ1dHRvbiB0ZXh0IHRvIFwiQ2FuY2VsXCJcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ3NxdWFyZScpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzdG9wJztcblxuICAgIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbi50aXRsZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0QWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkubWlzdHJhbC5haS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLkFQSUtleX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZ2VuZXJhbC5zeXN0ZW1fcm9sZSArIHByb21wdCArIHJlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudCB9LFxuICAgICAgICAgICAgICAgIC4uLm1lc3NhZ2VIaXN0b3J5QXRJbmRleFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgbWF4X3Rva2VuczogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKSB8fCA0MDk2LFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXI/LnNpZ25hbCxcbiAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcjbG9hZGluZycpO1xuICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2spIHtcbiAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIG1lc3NhZ2UgfHwgJycsIG1lc3NhZ2VCbG9jayBhcyBIVE1MRWxlbWVudCwgJy8nLCBwbHVnaW4pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVVucmVzb2x2ZWRJbnRlcm5hbExpbmtzKHBsdWdpbiwgbWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uYXBwZW5kQ2hpbGQobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmaW5lIHJlZ2V4IHBhdHRlcm5zIGZvciB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICBjb25zdCByZWdleFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLzxibG9jay1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL2Jsb2NrLXJlbmRlcmVkPi9nLFxuICAgICAgICAgICAgLzxub3RlLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvbm90ZS1yZW5kZXJlZD4vZ1xuICAgICAgICBdO1xuXG4gICAgICAgIC8vIENsZWFuIHRoZSBtZXNzYWdlIGNvbnRlbnQgYnkgcmVtb3ZpbmcgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgcmVnZXhQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShwYXR0ZXJuLCAnJykudHJpbSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgICAgLy8gUmVxdWVzdCB3YXMgYWJvcnRlZCwgaGFuZGxlIGFjY29yZGluZ2x5XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBhYm9ydGVkJyk7XG4gICAgICAgICAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgICAgICAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc2VuZCc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2sgJiYgbG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay50ZXh0Q29udGVudCA9ICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJywgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBvdGhlciBlcnJvcnNcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlFcnJvckJvdE1lc3NhZ2UocGx1Z2luLCBzZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIGVycm9yKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBSZXNldCB0aGUgYWJvcnQgY29udHJvbGxlclxuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgIH1cblxufVxuXG4vLyBGZXRjaCByZXNwb25zZSBNaXN0cmFsIChzdHJlYW0pXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hNaXN0cmFsUmVzcG9uc2VTdHJlYW0ocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgaW5kZXg6IG51bWJlcikge1xuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7XG5cbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuXG4gICAgbGV0IGlzU2Nyb2xsID0gZmFsc2U7XG5cbiAgICBjb25zdCBub0ltYWdlTWVzc2FnZUhpc3RvcnkgPSBtZXNzYWdlSGlzdG9yeS5tYXAoKHsgcm9sZSwgY29udGVudCB9KSA9PiAoeyByb2xlLCBjb250ZW50IH0pKTtcbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3Rvcnkobm9JbWFnZU1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcblxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBDaGFuZ2UgYnV0dG9uIHRleHQgdG8gXCJDYW5jZWxcIlxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5taXN0cmFsLmFpL3YxL2NoYXQvY29tcGxldGlvbnMnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3NldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuQVBJS2V5fWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZ2VuZXJhbC5zeXN0ZW1fcm9sZSArIHByb21wdCArIHJlZmVyZW5jZUN1cnJlbnROb3RlQ29udGVudH0sXG4gICAgICAgICAgICAgICAgICAgIC4uLm1lc3NhZ2VIaXN0b3J5QXRJbmRleFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgc3RyZWFtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpIHx8IDQwOTYsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbFxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIENoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiB0byBhIHN0b3AgYnV0dG9uXG4gICAgICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzdG9wJztcblxuICAgICAgICBcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUmVzcG9uc2UgYm9keSBpcyBudWxsIG9yIHVuZGVmaW5lZC4nKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzcG9uc2UgYm9keSBpcyBudWxsIG9yIHVuZGVmaW5lZC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCk7XG4gICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgbGV0IHJlYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgIHdoaWxlIChyZWFkaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICByZWFkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNodW5rID0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiBmYWxzZSB9KSB8fCAnJztcblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2NodW5rJyxjaHVuayk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gY2h1bmsuc3BsaXQoJ1xcbicpO1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInBhcnRzXCIsIHBhcnRzKVxuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMuZmlsdGVyKEJvb2xlYW4pKSB7IC8vIEZpbHRlciBvdXQgZW1wdHkgcGFydHNcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjaHVuayBjb250YWlucyAnZGF0YTogW0RPTkVdJ1xuICAgICAgICAgICAgICAgIGlmIChwYXJ0LmluY2x1ZGVzKCdkYXRhOiBbRE9ORV0nKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IHBhcnNlZENodW5rO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlZENodW5rID0gSlNPTi5wYXJzZShwYXJ0LnJlcGxhY2UoL15kYXRhOiAvLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHBhcnNlZENodW5rLmNob2ljZXNbMF0uZmluaXNoX3JlYXNvbiAhPT0gJ3N0b3AnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IHBhcnNlZENodW5rLmNob2ljZXNbMF0uZGVsdGEuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEpTT046JywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BhcnQgd2l0aCBlcnJvcjonLCBwYXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSB7cmVzcG9uc2U6ICd7X2VffSd9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIHRoZSBtZXNzYWdlQmxvY2sgZm9yIHJlLXJlbmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2suaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudEZyYWdtZW50IHRvIHJlbmRlciBtYXJrZG93biBvZmYtRE9NXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbmRlciB0aGUgYWNjdW11bGF0ZWQgbWVzc2FnZSB0byB0aGUgdGVtcG9yYXJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlLCB0ZW1wQ29udGFpbmVyLCAnLycsIHBsdWdpbik7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIHJlbmRlcmluZyBpcyBjb21wbGV0ZSwgbW92ZSB0aGUgY29udGVudCB0byB0aGUgYWN0dWFsIG1lc3NhZ2UgYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weUNvZGVCbG9ja3MgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmNvcHktY29kZS1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEljb24oY29weUNvZGVCbG9jaywgJ2NvcHknKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lckVsLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50OiBXaGVlbEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSB1c2VyIHNjcm9sbHMgdXAgb3IgZG93biwgc3RvcCBhdXRvLXNjcm9sbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGVsdGFZIDwgMCB8fCBldmVudC5kZWx0YVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1Njcm9sbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghaXNTY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ2F1dG8nLCBibG9jazogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSByZWdleCBwYXR0ZXJucyBmb3IgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgY29uc3QgcmVnZXhQYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC88YmxvY2stcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ibG9jay1yZW5kZXJlZD4vZyxcbiAgICAgICAgICAgIC88bm90ZS1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL25vdGUtcmVuZGVyZWQ+L2dcbiAgICAgICAgXTtcblxuICAgICAgICAvLyBDbGVhbiB0aGUgbWVzc2FnZSBjb250ZW50IGJ5IHJlbW92aW5nIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIHJlZ2V4UGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UocGF0dGVybiwgJycpLnRyaW0oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2UudHJpbSgpLCAnYm90TWVzc2FnZScsIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWRcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2sgJiYgbG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay50ZXh0Q29udGVudCA9ICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgb3RoZXIgZXJyb3JzXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBlcnJvcik7XG4gICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VEaXYpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJywgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpOyAvLyBUaGlzIHdpbGwgc2F2ZSBtaWQtc3RyZWFtIGNvbnZlcnNhdGlvbi5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCBtZXNzYWdlLnRyaW0oKSwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpOyAvLyBUaGlzIHdpbGwgc2F2ZSBtaWQtc3RyZWFtIGNvbnZlcnNhdGlvbi5cbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKCdTdHJlYW0gc3RvcHBlZC4nKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2hhdCByZXNwb25zZSBmcm9tIE1pc3RyYWw6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFJlc2V0IHRoZSBhYm9ydCBjb250cm9sbGVyXG4gICAgICAgIGFib3J0Q29udHJvbGxlciA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hhbmdlIHRoZSBzdWJtaXQgYnV0dG9uIGJhY2sgdG8gYSBzZW5kIGJ1dHRvblxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdzZW5kJztcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xufVxuXG4vLyBGZXRjaCBPcGVuQUktQmFzZWQgQVBJXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hPcGVuQUlBUElSZXNwb25zZShwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBpbmRleDogbnVtYmVyKSB7XG4gICAgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG4gICAgY29uc3QgcHJvbXB0ID0gYXdhaXQgZ2V0UHJvbXB0KHBsdWdpbiwgc2V0dGluZ3MpO1xuXG4gICAgY29uc3QgZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSA9IGZpbHRlck1lc3NhZ2VIaXN0b3J5KG1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcblxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuICAgIFxuICAgIG1lc3NhZ2VDb250YWluZXJFbD8uaW5zZXJ0QmVmb3JlKGJvdE1lc3NhZ2VEaXYsIG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXgrMV0pO1xuICAgIGJvdE1lc3NhZ2VEaXYuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuXG4gICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gZ2V0Q3VycmVudE5vdGVDb250ZW50KCk7XG5cbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgLy8gQ2hhbmdlIGJ1dHRvbiB0ZXh0IHRvIFwiQ2FuY2VsXCJcbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ3NxdWFyZScpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzdG9wJztcblxuICAgIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbi50aXRsZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0QWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VVcmx9L2NoYXQvY29tcGxldGlvbnNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7cGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5BUElLZXl9YCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpLFxuICAgICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxuICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAuLi5tZXNzYWdlSGlzdG9yeUF0SW5kZXgsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbCxcbiAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGxldCBtZXNzYWdlID0gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAnJztcbiAgICAgICAgXG4gICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcjbG9hZGluZycpO1xuXG4gICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIG1lc3NhZ2UgfHwgJycsIG1lc3NhZ2VCbG9jayBhcyBIVE1MRWxlbWVudCwgJy8nLCBwbHVnaW4pO1xuXG4gICAgICAgICAgICAgICAgYWRkUGFyYWdyYXBoQnJlYWtzKG1lc3NhZ2VCbG9jayk7XG4gICAgICAgICAgICAgICAgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3MocGx1Z2luLCBtZXNzYWdlQmxvY2spO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29weUNvZGVCbG9ja3MgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmNvcHktY29kZS1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcbiAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2Nrcy5mb3JFYWNoKChjb3B5Q29kZUJsb2NrKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2sudGV4dENvbnRlbnQgPSAnQ29weSc7XG4gICAgICAgICAgICAgICAgICAgIHNldEljb24oY29weUNvZGVCbG9jaywgJ2NvcHknKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gRGVmaW5lIHJlZ2V4IHBhdHRlcm5zIGZvciB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICAgICAgY29uc3QgcmVnZXhQYXR0ZXJucyA9IFtcbiAgICAgICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAgICAgLzxub3RlLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvbm90ZS1yZW5kZXJlZD4vZyxcbiAgICAgICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAvLyBDbGVhbiB0aGUgbWVzc2FnZSBjb250ZW50IGJ5IHJlbW92aW5nIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShwYXR0ZXJuLCAnJykudHJpbSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgICAgLy8gUmVxdWVzdCB3YXMgYWJvcnRlZCwgaGFuZGxlIGFjY29yZGluZ2x5XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBhYm9ydGVkJyk7XG4gICAgICAgICAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ2Fycm93LXVwJyk7XG4gICAgICAgICAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc2VuZCc7XG5cbiAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWRcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2sgJiYgbG9hZGluZ0VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay50ZXh0Q29udGVudCA9ICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJztcbiAgICAgICAgICAgICAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sICdTWVNURU06IFJlc3BvbnNlIGFib3J0ZWQuJywgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBvdGhlciBlcnJvcnNcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRpc3BsYXlFcnJvckJvdE1lc3NhZ2UocGx1Z2luLCBzZXR0aW5ncywgbWVzc2FnZUhpc3RvcnksIGVycm9yKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoYm90TWVzc2FnZURpdik7XG4gICAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBSZXNldCB0aGUgYWJvcnQgY29udHJvbGxlclxuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgIH1cbn1cblxuLy8gRmV0Y2ggT3BlbkFJLUJhc2VkIEFQSSBTdHJlYW1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlU3RyZWFtKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7XG5cbiAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgIGxldCBpc1Njcm9sbCA9IGZhbHNlO1xuXG4gICAgY29uc3QgZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSA9IGZpbHRlck1lc3NhZ2VIaXN0b3J5KG1lc3NhZ2VIaXN0b3J5KTtcbiAgICBjb25zdCBtZXNzYWdlSGlzdG9yeUF0SW5kZXggPSByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcblxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgLy8gQ2hhbmdlIHRoZSBzdWJtaXQgYnV0dG9uIHRvIGEgc3RvcCBidXR0b25cbiAgICBzZXRJY29uKHN1Ym1pdEJ1dHRvbiwgJ3NxdWFyZScpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzdG9wJztcbiAgICBzdWJtaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmIChzdWJtaXRCdXR0b24udGl0bGUgPT09ICdzdG9wJykge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGdldEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7cGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3BsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuQVBJS2V5fWAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBtb2RlbDogc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCxcbiAgICAgICAgICAgICAgbWF4X3Rva2VuczogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKSxcbiAgICAgICAgICAgICAgc3RyZWFtOiB0cnVlLFxuICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAuLi5tZXNzYWdlSGlzdG9yeUF0SW5kZXgsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogYWJvcnRDb250cm9sbGVyLnNpZ25hbCxcbiAgICAgICAgfSk7XG5cblxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xufVxuXG4gICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCk7XG4gICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgbGV0IHJlYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgIHdoaWxlIChyZWFkaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICByZWFkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNodW5rID0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pIHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBjaHVuay5zcGxpdCgnXFxuJyk7XG5cblxuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnQuaW5jbHVkZXMoJ2RhdGE6IFtET05FXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyaW1tZWRQYXJ0ID0gcGFydC5yZXBsYWNlKC9eZGF0YTogLywgJycpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyaW1tZWRQYXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZSh0cmltbWVkUGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5jaG9pY2VzICYmIGRhdGEuY2hvaWNlc1swXS5kZWx0YSAmJiBkYXRhLmNob2ljZXNbMF0uZGVsdGEuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkYXRhLmNob2ljZXNbMF0uZGVsdGEuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBKU09OOicsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQYXJ0IHdpdGggZXJyb3I6JywgcGFydCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZUNoaWxkKGxvYWRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIHRoZSBtZXNzYWdlQmxvY2sgZm9yIHJlLXJlbmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2suaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudEZyYWdtZW50IHRvIHJlbmRlciBtYXJrZG93biBvZmYtRE9NXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIpO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVuZGVyIHRoZSBhY2N1bXVsYXRlZCBtZXNzYWdlIHRvIHRoZSB0ZW1wb3JhcnkgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIG1lc3NhZ2UsIHRlbXBDb250YWluZXIsICcvJywgcGx1Z2luKTtcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIE9uY2UgcmVuZGVyaW5nIGlzIGNvbXBsZXRlLCBtb3ZlIHRoZSBjb250ZW50IHRvIHRoZSBhY3R1YWwgbWVzc2FnZSBibG9ja1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAodGVtcENvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2suYXBwZW5kQ2hpbGQodGVtcENvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYWRkUGFyYWdyYXBoQnJlYWtzKG1lc3NhZ2VCbG9jayk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVVucmVzb2x2ZWRJbnRlcm5hbExpbmtzKHBsdWdpbiwgbWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb3B5Q29kZUJsb2NrcyA9IG1lc3NhZ2VCbG9jay5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1jb2RlLWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuICAgICAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2Nrcy5mb3JFYWNoKChjb3B5Q29kZUJsb2NrKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihjb3B5Q29kZUJsb2NrLCAnY29weScpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCAoZXZlbnQ6IFdoZWVsRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHVzZXIgc2Nyb2xscyB1cCBvciBkb3duLCBzdG9wIGF1dG8tc2Nyb2xsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kZWx0YVkgPCAwIHx8IGV2ZW50LmRlbHRhWSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpc1Njcm9sbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnYXV0bycsIGJsb2NrOiAnc3RhcnQnIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICBpZiAoYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2UudHJpbSgpLCAnYm90TWVzc2FnZScsIHNldHRpbmdzLCBpbmRleCk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSGFuZGxlIG90aGVyIGVycm9yc1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmUoKTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlSGlzdG9yeSwgZXJyb3IpO1xuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChib3RNZXNzYWdlRGl2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXNzYWdlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHBsdWdpbiwgbWVzc2FnZS50cmltKCksICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTsgLy8gVGhpcyB3aWxsIHNhdmUgbWlkLXN0cmVhbSBjb252ZXJzYXRpb24uXG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgcmVzcG9uc2UgZnJvbSBPcGVuQUktQmFzZWQgTW9kZWxzOicsIGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBSZXNldCB0aGUgYWJvcnQgY29udHJvbGxlclxuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIENoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiBiYWNrIHRvIGEgc2VuZCBidXR0b25cbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnc2VuZCc7XG4gICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzZW5kJztcbn1cblxuLy8gRmV0Y2ggcmVzcG9uc2UgZnJvbSBPcGVuUm91dGVyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hPcGVuUm91dGVyUmVzcG9uc2UocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgaW5kZXg6IG51bWJlcikge1xuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb25zdCBwcm9tcHQgPSBhd2FpdCBnZXRQcm9tcHQocGx1Z2luLCBzZXR0aW5ncyk7ICBcbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gZmlsdGVyTWVzc2FnZUhpc3RvcnkobWVzc2FnZUhpc3RvcnkpO1xuICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5QXRJbmRleCA9IHJlbW92ZUNvbnNlY3V0aXZlVXNlclJvbGVzKGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkpO1xuICAgIFxuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsRGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKTtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5TG9hZGluZ0JvdE1lc3NhZ2Uoc2V0dGluZ3MpO1xuXG4gICAgbWVzc2FnZUNvbnRhaW5lckVsPy5pbnNlcnRCZWZvcmUoYm90TWVzc2FnZURpdiwgbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleCsxXSk7XG4gICAgYm90TWVzc2FnZURpdi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG5cbiAgICBhd2FpdCBnZXRBY3RpdmVGaWxlQ29udGVudChwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnV0dG9uJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAvLyBDaGFuZ2UgYnV0dG9uIHRleHQgdG8gXCJDYW5jZWxcIlxuICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnc3F1YXJlJyk7XG4gICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3N0b3AnO1xuXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLkFQSUtleX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgfHwgJ1lvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudC4nfSxcbiAgICAgICAgICAgICAgICAgICAgLi4ubWVzc2FnZUhpc3RvcnlBdEluZGV4XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpIHx8IDQwOTYsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzaWduYWw6IGFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBsZXQgbWVzc2FnZSA9IGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXJFbCkge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VCbG9jayA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJy5tZXNzYWdlQmxvY2snKTtcbiAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2VCbG9jaykge1xuICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlQ2hpbGQobG9hZGluZ0VsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlIHx8ICcnLCBtZXNzYWdlQmxvY2sgYXMgSFRNTEVsZW1lbnQsICcvJywgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW4sIG1lc3NhZ2VCbG9jayk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb3B5Q29kZUJsb2NrcyA9IG1lc3NhZ2VCbG9jay5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1jb2RlLWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29weUNvZGVCbG9jay50ZXh0Q29udGVudCA9ICdDb3B5JztcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihjb3B5Q29kZUJsb2NrLCAnY29weScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LmFwcGVuZENoaWxkKG1lc3NhZ2VCbG9jayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSByZWdleCBwYXR0ZXJucyBmb3IgdGhlIHVud2FudGVkIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgICAgICAgY29uc3QgcmVnZXhQYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC88YmxvY2stcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ibG9jay1yZW5kZXJlZD4vZyxcbiAgICAgICAgICAgIC88bm90ZS1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL25vdGUtcmVuZGVyZWQ+L2dcbiAgICAgICAgXTtcblxuICAgICAgICAvLyBDbGVhbiB0aGUgbWVzc2FnZSBjb250ZW50IGJ5IHJlbW92aW5nIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIHJlZ2V4UGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UocGF0dGVybiwgJycpLnRyaW0oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2UudHJpbSgpLCAnYm90TWVzc2FnZScsIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgIHJldHVybjtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgIC8vIFJlcXVlc3Qgd2FzIGFib3J0ZWQsIGhhbmRsZSBhY2NvcmRpbmdseVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlcXVlc3QgYWJvcnRlZCcpO1xuICAgICAgICAgICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgICAgICAgICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xuXG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBhYm9ydGVkXG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VXNlck1lc3NhZ2UgPSBtZXNzYWdlQ29udGFpbmVyRWxEaXZzW2luZGV4XTtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRCb3RNZXNzYWdlID0gdGFyZ2V0VXNlck1lc3NhZ2UubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUJsb2NrID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignLm1lc3NhZ2VCbG9jaycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdFbCA9IHRhcmdldEJvdE1lc3NhZ2U/LnF1ZXJ5U2VsZWN0b3IoJyNsb2FkaW5nJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUJsb2NrICYmIGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRCb3RNZXNzYWdlPy5yZW1vdmVDaGlsZChsb2FkaW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQmxvY2sudGV4dENvbnRlbnQgPSAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCAnU1lTVEVNOiBSZXNwb25zZSBhYm9ydGVkLicsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgb3RoZXIgZXJyb3JzXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVc2VyTWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnJlbW92ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5LCBlcnJvcik7XG4gICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VEaXYpO1xuICAgICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgLy8gUmVzZXQgdGhlIGFib3J0IGNvbnRyb2xsZXJcbiAgICAgICAgYWJvcnRDb250cm9sbGVyID0gbnVsbDtcbiAgICB9XG59XG5cbi8vIEZldGNoIHJlc3BvbnNlIGZyb20gb3BlbmFpLWJhc2VkIHJlc3QgYXBpIHVybCAoc3RyZWFtKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoT3BlblJvdXRlclJlc3BvbnNlU3RyZWFtKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MS9jaGF0L2NvbXBsZXRpb25zJztcblxuICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxuICAgIGNvbnN0IHByb21wdCA9IGF3YWl0IGdldFByb21wdChwbHVnaW4sIHNldHRpbmdzKTtcblxuICAgIGxldCBtZXNzYWdlID0gJyc7XG5cbiAgICBsZXQgaXNTY3JvbGwgPSBmYWxzZTtcblxuICAgIGNvbnN0IGZpbHRlcmVkTWVzc2FnZUhpc3RvcnkgPSBmaWx0ZXJNZXNzYWdlSGlzdG9yeShtZXNzYWdlSGlzdG9yeSk7XG4gICAgY29uc3QgbWVzc2FnZUhpc3RvcnlBdEluZGV4ID0gcmVtb3ZlQ29uc2VjdXRpdmVVc2VyUm9sZXMoZmlsdGVyZWRNZXNzYWdlSGlzdG9yeSk7XG5cbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbERpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVzc2FnZUNvbnRhaW5lciBkaXYudXNlck1lc3NhZ2UsICNtZXNzYWdlQ29udGFpbmVyIGRpdi5ib3RNZXNzYWdlJyk7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZGlzcGxheUxvYWRpbmdCb3RNZXNzYWdlKHNldHRpbmdzKTtcblxuICAgIG1lc3NhZ2VDb250YWluZXJFbD8uaW5zZXJ0QmVmb3JlKGJvdE1lc3NhZ2VEaXYsIG1lc3NhZ2VDb250YWluZXJFbERpdnNbaW5kZXgrMV0pO1xuICAgIGJvdE1lc3NhZ2VEaXYuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pO1xuXG4gICAgYXdhaXQgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gZ2V0Q3VycmVudE5vdGVDb250ZW50KCk7XG5cbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xuICAgIC8vIENoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiB0byBhIHN0b3AgYnV0dG9uXG4gICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdzcXVhcmUnKTtcbiAgICBzdWJtaXRCdXR0b24udGl0bGUgPSAnc3RvcCc7XG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBpZiAoc3VibWl0QnV0dG9uLnRpdGxlID09PSAnc3RvcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLkFQSUtleX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHNldHRpbmdzLmdlbmVyYWwuc3lzdGVtX3JvbGUgKyBwcm9tcHQgKyByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgfHwgJ1lvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudC4nfSxcbiAgICAgICAgICAgICAgICAgICAgLi4ubWVzc2FnZUhpc3RvcnlBdEluZGV4XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzdHJlYW06IHRydWUsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucykgfHwgNDA5NixcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsXG4gICAgICAgIH0pXG4gICAgICAgIFxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSBib2R5IGlzIG51bGwgb3IgdW5kZWZpbmVkLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKTtcbiAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgICAgICBsZXQgcmVhZGluZyA9IHRydWU7XG5cbiAgICAgICAgd2hpbGUgKHJlYWRpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IGZhbHNlIH0pIHx8ICcnO1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnY2h1bmsnLGNodW5rKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBjaHVuay5zcGxpdCgnXFxuJyk7XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwicGFydHNcIiwgcGFydHMpXG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cy5maWx0ZXIoQm9vbGVhbikpIHsgLy8gRmlsdGVyIG91dCBlbXB0eSBwYXJ0c1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGNodW5rIGNvbnRhaW5zICdkYXRhOiBbRE9ORV0nXG4gICAgICAgICAgICAgICAgaWYgKHBhcnQuaW5jbHVkZXMoJ2RhdGE6IFtET05FXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkQ2h1bms7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkQ2h1bmsgPSBKU09OLnBhcnNlKHBhcnQucmVwbGFjZSgvXmRhdGE6IC8sICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocGFyc2VkQ2h1bmsuY2hvaWNlc1swXS5maW5pc2hfcmVhc29uICE9PSAnc3RvcCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gcGFyc2VkQ2h1bmsuY2hvaWNlc1swXS5kZWx0YS5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSArPSBjb250ZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgSlNPTjonLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUGFydCB3aXRoIGVycm9yOicsIHBhcnQpO1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWRDaHVuayA9IHtyZXNwb25zZTogJ3tfZV99J307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXJFbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Qm90TWVzc2FnZSA9IHRhcmdldFVzZXJNZXNzYWdlLm5leHRFbGVtZW50U2libGluZztcbiAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQmxvY2sgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsID0gdGFyZ2V0Qm90TWVzc2FnZT8ucXVlcnlTZWxlY3RvcignI2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdFbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Qm90TWVzc2FnZT8ucmVtb3ZlQ2hpbGQobG9hZGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIG1lc3NhZ2VCbG9jayBmb3IgcmUtcmVuZGVyaW5nXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50RnJhZ21lbnQgdG8gcmVuZGVyIG1hcmtkb3duIG9mZi1ET01cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGVtcENvbnRhaW5lcik7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIGFjY3VtdWxhdGVkIG1lc3NhZ2UgdG8gdGhlIHRlbXBvcmFyeSBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIocGx1Z2luLmFwcCwgbWVzc2FnZSwgdGVtcENvbnRhaW5lciwgJy8nLCBwbHVnaW4pO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gT25jZSByZW5kZXJpbmcgaXMgY29tcGxldGUsIG1vdmUgdGhlIGNvbnRlbnQgdG8gdGhlIGFjdHVhbCBtZXNzYWdlIGJsb2NrXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh0ZW1wQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5hcHBlbmRDaGlsZCh0ZW1wQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVW5yZXNvbHZlZEludGVybmFsTGlua3MocGx1Z2luLCBtZXNzYWdlQmxvY2spO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2sudGV4dENvbnRlbnQgPSAnQ29weSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXJFbC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChldmVudDogV2hlZWxFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdXNlciBzY3JvbGxzIHVwIG9yIGRvd24sIHN0b3AgYXV0by1zY3JvbGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRlbHRhWSA8IDAgfHwgZXZlbnQuZGVsdGFZID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlzU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEJvdE1lc3NhZ2U/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdhdXRvJywgYmxvY2s6ICdzdGFydCcgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgcmVnZXggcGF0dGVybnMgZm9yIHRoZSB1bndhbnRlZCB0YWdzIGFuZCB0aGVpciBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlZ2V4UGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+L2csXG4gICAgICAgICAgICAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQ2xlYW4gdGhlIG1lc3NhZ2UgY29udGVudCBieSByZW1vdmluZyB0aGUgdW53YW50ZWQgdGFncyBhbmQgdGhlaXIgY29udGVudFxuICAgICAgICByZWdleFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHBhdHRlcm4sICcnKS50cmltKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2UudHJpbSgpLCAnYm90TWVzc2FnZScsIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGFkZE1lc3NhZ2UocGx1Z2luLCBtZXNzYWdlLnRyaW0oKSwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5ncywgaW5kZXgpOyAvLyBUaGlzIHdpbGwgc2F2ZSBtaWQtc3RyZWFtIGNvbnZlcnNhdGlvbi5cbiAgICAgICAgbmV3IE5vdGljZSgnU3RyZWFtIHN0b3BwZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cblxuICAgIC8vIENoYW5nZSB0aGUgc3VibWl0IGJ1dHRvbiBiYWNrIHRvIGEgc2VuZCBidXR0b25cbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnc2VuZCc7XG4gICAgc2V0SWNvbihzdWJtaXRCdXR0b24sICdhcnJvdy11cCcpO1xuICAgIHN1Ym1pdEJ1dHRvbi50aXRsZSA9ICdzZW5kJztcbn1cblxuLy8gQWJvcnQgY29udHJvbGxlclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFib3J0Q29udHJvbGxlcigpIHtcbiAgICByZXR1cm4gYWJvcnRDb250cm9sbGVyO1xufVxuXG5mdW5jdGlvbiBvbGxhbWFQYXJhbWV0ZXJzT3B0aW9ucyhzZXR0aW5nczogQk1PU2V0dGluZ3MpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBtaXJvc3RhdDogcGFyc2VJbnQoc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0KSxcbiAgICAgICAgbWlyb3N0YXRfZXRhOiBwYXJzZUZsb2F0KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGEpLFxuICAgICAgICBtaXJvc3RhdF90YXU6IHBhcnNlRmxvYXQoc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X3RhdSksXG4gICAgICAgIG51bV9jdHg6IHBhcnNlSW50KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fY3R4KSxcbiAgICAgICAgbnVtX2dxYTogcGFyc2VJbnQoc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9ncWEpLFxuICAgICAgICBudW1fdGhyZWFkOiBwYXJzZUludChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX3RocmVhZCksXG4gICAgICAgIHJlcGVhdF9sYXN0X246IHBhcnNlSW50KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfbGFzdF9uKSxcbiAgICAgICAgcmVwZWF0X3BlbmFsdHk6IHBhcnNlRmxvYXQoc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9wZW5hbHR5KSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlSW50KHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICBzZWVkOiBwYXJzZUludChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc2VlZCksXG4gICAgICAgIHN0b3A6IHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zdG9wLFxuICAgICAgICB0ZnNfejogcGFyc2VGbG9hdChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3opLFxuICAgICAgICBudW1fcHJlZGljdDogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKSB8fCAtMSxcbiAgICAgICAgdG9wX2s6IHBhcnNlSW50KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfayksXG4gICAgICAgIHRvcF9wOiBwYXJzZUZsb2F0KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfcCksXG4gICAgICAgIG1pbl9wOiBwYXJzZUZsb2F0KHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taW5fcCksXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyTWVzc2FnZUhpc3RvcnkobWVzc2FnZUhpc3Rvcnk6IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IGltYWdlcz86IFVpbnQ4QXJyYXlbXSB8IHN0cmluZ1tdIH1bXSkge1xuICAgIGNvbnN0IHNraXBJbmRleGVzID0gbmV3IFNldCgpOyAvLyBTdG9yZSBpbmRleGVzIG9mIG1lc3NhZ2VzIHRvIHNraXBcblxuICAgIG1lc3NhZ2VIaXN0b3J5LmZvckVhY2goKG1lc3NhZ2UsIGluZGV4LCAgYXJyYXkpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHVzZXIgbWVzc2FnZSB3aXRoIHNsYXNoXG4gICAgICAgIGlmIChtZXNzYWdlLnJvbGUgPT09ICd1c2VyJyAmJiBtZXNzYWdlLmNvbnRlbnQuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICBza2lwSW5kZXhlcy5hZGQoaW5kZXgpOyAvLyBTa2lwIHRoaXMgbWVzc2FnZVxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbmV4dCBtZXNzYWdlIGlzIGZyb20gdGhlIGFzc2lzdGFudCBhbmQgc2tpcCBpdCBhcyB3ZWxsXG4gICAgICAgICAgICBpZiAoaW5kZXggKyAxIDwgYXJyYXkubGVuZ3RoICYmIGFycmF5W2luZGV4ICsgMV0ucm9sZSA9PT0gJ2Fzc2lzdGFudCcpIHtcbiAgICAgICAgICAgICAgICBza2lwSW5kZXhlcy5hZGQoaW5kZXggKyAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBmb3IgYXNzaXN0YW50IG1lc3NhZ2Ugd2l0aCBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlXG4gICAgICAgIGVsc2UgaWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcgJiYgbWVzc2FnZS5jb250ZW50LmluY2x1ZGVzKCdlcnJvckJvdE1lc3NhZ2UnKSkge1xuICAgICAgICAgICAgc2tpcEluZGV4ZXMuYWRkKGluZGV4KTsgLy8gU2tpcCB0aGlzIG1lc3NhZ2VcbiAgICAgICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICBza2lwSW5kZXhlcy5hZGQoaW5kZXggLSAxKTsgLy8gQWxzbyBza2lwIHByZXZpb3VzIG1lc3NhZ2UgaWYgaXQgZXhpc3RzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEZpbHRlciB0aGUgbWVzc2FnZSBoaXN0b3J5LCBza2lwcGluZyBtYXJrZWQgbWVzc2FnZXNcbiAgICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5ID0gbWVzc2FnZUhpc3RvcnkuZmlsdGVyKChfLCBpbmRleCkgPT4gIXNraXBJbmRleGVzLmhhcyhpbmRleCkpO1xuXG4gICAgLy8gY29uc29sZS5sb2coJ0ZpbHRlcmVkIG1lc3NhZ2UgaGlzdG9yeTonLCBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5KTtcblxuICAgIHJldHVybiBmaWx0ZXJlZE1lc3NhZ2VIaXN0b3J5O1xufVxuXG5mdW5jdGlvbiByZW1vdmVDb25zZWN1dGl2ZVVzZXJSb2xlcyhtZXNzYWdlSGlzdG9yeTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZzsgfVtdKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgbGV0IGZvdW5kVXNlck1lc3NhZ2UgPSBmYWxzZTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZUhpc3RvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VIaXN0b3J5W2ldLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgICAgICAgaWYgKCFmb3VuZFVzZXJNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgLy8gRmlyc3QgdXNlciBtZXNzYWdlLCBhZGQgdG8gcmVzdWx0XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobWVzc2FnZUhpc3RvcnlbaV0pO1xuICAgICAgICAgICAgICAgIGZvdW5kVXNlck1lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBTZWNvbmQgY29uc2VjdXRpdmUgdXNlciBtZXNzYWdlIGZvdW5kLCBzdG9wIGFkZGluZyB0byByZXN1bHRcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE5vbi11c2VyIG1lc3NhZ2UsIGFkZCB0byByZXN1bHRcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKG1lc3NhZ2VIaXN0b3J5W2ldKTtcbiAgICAgICAgICAgIGZvdW5kVXNlck1lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufSIsICJpbXBvcnQgeyBNYXJrZG93blJlbmRlcmVyLCBNb2RhbCwgTm90aWNlLCBURmlsZSwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBCTU9HUFQsIHsgQk1PU2V0dGluZ3MsIGNoZWNrQWN0aXZlRmlsZSB9IGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IEFOVEhST1BJQ19NT0RFTFMsIE9QRU5BSV9NT0RFTFMsIGFjdGl2ZUVkaXRvciwgZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24sIGxhc3RDdXJzb3JQb3NpdGlvbiwgbGFzdEN1cnNvclBvc2l0aW9uRmlsZSwgbWVzc2FnZUhpc3RvcnkgfSBmcm9tICdzcmMvdmlldyc7XG5pbXBvcnQgeyBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlU3RyZWFtLCBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlLCBmZXRjaE9sbGFtYVJlc3BvbnNlLCBmZXRjaE9sbGFtYVJlc3BvbnNlU3RyZWFtLCBmZXRjaEFudGhyb3BpY1Jlc3BvbnNlLCBmZXRjaFJFU1RBUElVUkxSZXNwb25zZSwgZmV0Y2hSRVNUQVBJVVJMUmVzcG9uc2VTdHJlYW0sIGZldGNoTWlzdHJhbFJlc3BvbnNlU3RyZWFtLCBmZXRjaE1pc3RyYWxSZXNwb25zZSwgZmV0Y2hHb29nbGVHZW1pbmlSZXNwb25zZSwgZmV0Y2hPcGVuUm91dGVyUmVzcG9uc2VTdHJlYW0sIGZldGNoT3BlblJvdXRlclJlc3BvbnNlLCBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlU3RyZWFtIH0gZnJvbSAnLi4vRmV0Y2hNb2RlbFJlc3BvbnNlJztcbmltcG9ydCB7IGdldEFjdGl2ZUZpbGVDb250ZW50IH0gZnJvbSAnLi4vZWRpdG9yL1JlZmVyZW5jZUN1cnJlbnROb3RlJztcbmltcG9ydCB7IGFkZFBhcmFncmFwaEJyZWFrcyB9IGZyb20gJy4vTWVzc2FnZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdlbmVyYXRlVXNlckJ1dHRvbihwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzKSB7XG4gICAgY29uc3QgcmVnZW5lcmF0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIHJlZ2VuZXJhdGVCdXR0b24udGV4dENvbnRlbnQgPSAncmVnZW5lcmF0ZSc7XG4gICAgc2V0SWNvbihyZWdlbmVyYXRlQnV0dG9uLCAncmVmcmVzaC1jY3cnKTtcbiAgICByZWdlbmVyYXRlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3JlZ2VuZXJhdGUtYnV0dG9uJyk7XG4gICAgcmVnZW5lcmF0ZUJ1dHRvbi50aXRsZSA9ICdyZWdlbmVyYXRlJztcblxuICAgIGxldCBsYXN0Q2xpY2tlZEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgICByZWdlbmVyYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBsYXN0Q2xpY2tlZEVsZW1lbnQgPSBldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAgICAgd2hpbGUgKGxhc3RDbGlja2VkRWxlbWVudCAmJiAhbGFzdENsaWNrZWRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygndXNlck1lc3NhZ2UnKSkge1xuICAgICAgICAgICAgbGFzdENsaWNrZWRFbGVtZW50ID0gbGFzdENsaWNrZWRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaW5kZXggPSAtMTtcblxuICAgICAgICBpZiAobGFzdENsaWNrZWRFbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIC51c2VyTWVzc2FnZScpKTtcbiAgICAgICAgICAgIGluZGV4ID0gdXNlck1lc3NhZ2VzLmluZGV4T2YobGFzdENsaWNrZWRFbGVtZW50KSAqIDI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBkZWxldGVNZXNzYWdlKHBsdWdpbiwgaW5kZXgrMSk7XG4gICAgICAgICAgICBpZiAoT1BFTkFJX01PREVMUy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSB8fCBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuZW5hYmxlU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlU3RyZWFtKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTsgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgY29tcGxldGlvbjogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkwgJiYgc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPbGxhbWFSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9sbGFtYVJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKXtcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uZW5hYmxlU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoUkVTVEFQSVVSTFJlc3BvbnNlU3RyZWFtKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoUkVTVEFQSVVSTFJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpe1xuICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5Sb3V0ZXJSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5Sb3V0ZXJSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuZW5hYmxlU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE1pc3RyYWxSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE1pc3RyYWxSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01pc3RyYWwgRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5nZW1pbmlNb2RlbHMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hHb29nbGVHZW1pbmlSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignR29vZ2xlIEdlbWluaSBFcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoQU5USFJPUElDX01PREVMUy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoQW50aHJvcGljUmVzcG9uc2UocGx1Z2luLCBzZXR0aW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQW50aHJvcGljIEVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBtb2RlbHMgZGV0ZWN0ZWQuJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVnZW5lcmF0ZUJ1dHRvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BsYXlVc2VyRWRpdEJ1dHRvbiAocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncywgdXNlclByZTogSFRNTFByZUVsZW1lbnQpIHtcbiAgICBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgZWRpdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdlZGl0JztcbiAgICBzZXRJY29uKGVkaXRCdXR0b24sICdlZGl0Jyk7IC8vIEFzc3VtaW5nIHNldEljb24gaXMgZGVmaW5lZCBlbHNld2hlcmVcbiAgICBlZGl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2VkaXQtYnV0dG9uJyk7XG4gICAgZWRpdEJ1dHRvbi50aXRsZSA9ICdlZGl0JztcblxuICAgIGxldCBsYXN0Q2xpY2tlZEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWRpdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdlZGl0LWNvbnRhaW5lcicpO1xuICAgICAgICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG4gICAgICAgIHRleHRBcmVhLmNsYXNzTGlzdC5hZGQoJ2VkaXQtdGV4dGFyZWEnKTtcbiAgICAgICAgdGV4dEFyZWEudmFsdWUgPSB1c2VyUHJlLnRleHRDb250ZW50ID8/ICcnOyAvLyBDaGVjayBpZiB1c2VyUC50ZXh0Q29udGVudCBpcyBudWxsIGFuZCBwcm92aWRlIGEgZGVmYXVsdCB2YWx1ZVxuXG4gICAgICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dEFyZWEpO1xuXG4gICAgICAgIGNvbnN0IHRleHRhcmVhRWRpdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICB0ZXh0YXJlYUVkaXRCdXR0b24udGV4dENvbnRlbnQgPSAnRWRpdCc7XG4gICAgICAgIHRleHRhcmVhRWRpdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd0ZXh0YXJlYS1lZGl0LWJ1dHRvbicpO1xuICAgICAgICB0ZXh0YXJlYUVkaXRCdXR0b24udGl0bGUgPSAnZWRpdCc7XG5cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi50ZXh0Q29udGVudCA9ICdDYW5jZWwnO1xuICAgICAgICBjYW5jZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgndGV4dGFyZWEtY2FuY2VsLWJ1dHRvbicpO1xuICAgICAgICBjYW5jZWxCdXR0b24udGl0bGUgPSAnY2FuY2VsJztcblxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgbGFzdENsaWNrZWRFbGVtZW50ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgIHdoaWxlIChsYXN0Q2xpY2tlZEVsZW1lbnQgJiYgIWxhc3RDbGlja2VkRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3VzZXJNZXNzYWdlJykpIHtcbiAgICAgICAgICAgIGxhc3RDbGlja2VkRWxlbWVudCA9IGxhc3RDbGlja2VkRWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgdGV4dGFyZWFFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdXNlclByZS50ZXh0Q29udGVudCA9IHRleHRBcmVhLnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGVkaXRDb250YWluZXIucmVwbGFjZVdpdGgodXNlclByZSk7XG5cbiAgICAgICAgICAgIGlmIChsYXN0Q2xpY2tlZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIC51c2VyTWVzc2FnZScpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlck1lc3NhZ2VzLmluZGV4T2YobGFzdENsaWNrZWRFbGVtZW50KSAqIDI7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VIaXN0b3J5W2luZGV4XS5jb250ZW50ID0gdGV4dEFyZWEudmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVNZXNzYWdlKHBsdWdpbiwgaW5kZXgrMSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGlucHV0IGNvbnRhaW5zIGFueSBpbnRlcm5hbCBsaW5rcyBhbmQgcmVwbGFjZSB0aGVtIHdpdGggdGhlIGNvbnRlbnQgb2YgdGhlIGxpbmtlZCBmaWxlIChbW11dLCAhW1tdXSwgW1sjXV0pXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gLyghPylcXFtcXFsoLio/KVxcXVxcXS9nO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlcztcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0TW9kaWZpZWQgPSBtZXNzYWdlSGlzdG9yeVtpbmRleF0uY29udGVudDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZSBhbGwgcmVwbGFjZW1lbnRzIHRvIGJlIG1hZGVcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRzID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcblxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKG1hdGNoZXMgPSByZWdleC5leGVjKG1lc3NhZ2VIaXN0b3J5W2luZGV4XS5jb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2xhbWF0aW9uID0gbWF0Y2hlc1sxXTsgLy8gQ2FwdHVyZSB0aGUgb3B0aW9uYWwgZXhjbGFtYXRpb24gbWFya1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua3RleHQgPSBtYXRjaGVzWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3BsaXQgdGhlIGxpbmt0ZXh0IGludG8gcGF0aCBhbmQgc3VicGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgW3BhdGgsIHN1YnBhdGhdID0gbGlua3RleHQuc3BsaXQoJyMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChwYXRoLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoOyAvLyBBc3N1bWluZyBmaWxlIG9iamVjdCBoYXMgYSBwYXRoIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVFeHRlbnNpb24gPSBmaWxlUGF0aC5zcGxpdCgnLicpLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZmlsZSBleHRlbnNpb24gaXMgLm1kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlRXh0ZW5zaW9uICE9PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0ltYWdlRmlsZSA9IC9cXC4oanBnfGpwZWd8cG5nfGdpZnx3ZWJwfGJtcHx0aWZmfHRpZnxzdmcpJC9pLnRlc3QoZmlsZVBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5pbmNsdWRlcyhwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMuc2V0KG1hdGNoZXNbMF0sIGAke2V4Y2xhbWF0aW9ufVtbJHttYXRjaGVzWzJdfV1dPG5vdGUtcmVuZGVyZWQ+RVJST1I6IEZpbGUgY2Fubm90IGJlIHJlYWQuPC9ub3RlLXJlbmRlcmVkPmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMuaW5jbHVkZXMocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0ltYWdlRmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMuc2V0KG1hdGNoZXNbMF0sIGAke2V4Y2xhbWF0aW9ufVtbJHttYXRjaGVzWzJdfV1dPG5vdGUtcmVuZGVyZWQ+RVJST1I6IEZpbGUgY2Fubm90IGJlIHJlYWQuPC9ub3RlLXJlbmRlcmVkPmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBTa2lwIHRvIHRoZSBuZXh0IGl0ZXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRUb0luc2VydCA9IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBzdWJwYXRoLCBmaW5kIHRoZSByZWxldmFudCBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluU3VicGF0aCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VicGF0aENvbnRlbnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdWJwYXRoTGV2ZWwgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eIysvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGluZ0xldmVsID0gbWF0Y2ggPyBtYXRjaFswXS5sZW5ndGggOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpblN1YnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWFkaW5nTGV2ZWwgPD0gc3VicGF0aExldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluU3VicGF0aCAmJiBsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc3VicGF0aC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5TdWJwYXRoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhMZXZlbCA9IGhlYWRpbmdMZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpblN1YnBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicGF0aENvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0luc2VydCA9IHN1YnBhdGhDb250ZW50LmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJlcGFyZSB0aGUgcmVwbGFjZW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMuc2V0KG1hdGNoZXNbMF0sIGAke2V4Y2xhbWF0aW9ufVtbJHttYXRjaGVzWzJdfV1dPG5vdGUtcmVuZGVyZWQ+JHtjb250ZW50VG9JbnNlcnR9PC9ub3RlLXJlbmRlcmVkPmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcmVhZCB0aGUgY29udGVudCBvZiBcIiR7cGF0aH1cIjogJHtlcnJ9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgY2FzZSB3aGVyZSB0aGUgZmlsZSBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYSBURmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5zZXQobWF0Y2hlc1swXSwgYCR7ZXhjbGFtYXRpb259W1ske21hdGNoZXNbMl19XV08bm90ZS1yZW5kZXJlZD5GaWxlIGNhbm5vdCBiZSByZWFkLjwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGFsbCByZXBsYWNlbWVudHMgdG8gaW5wdXRNb2RpZmllZFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtvcmlnaW5hbCwgcmVwbGFjZW1lbnRdIG9mIHJlcGxhY2VtZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRNb2RpZmllZCA9IGlucHV0TW9kaWZpZWQuc3BsaXQob3JpZ2luYWwpLmpvaW4ocmVwbGFjZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgaW4gdGhlIGZpbmFsIG91dHB1dFxuICAgICAgICAgICAgICAgICAgICBpbnB1dE1vZGlmaWVkID0gaW5wdXRNb2RpZmllZC5yZXBsYWNlKC8oPG5vdGUtcmVuZGVyZWQ+RmlsZSBjYW5ub3QgYmUgcmVhZC48XFwvbm90ZS1yZW5kZXJlZD4pKy9nLCAnPG5vdGUtcmVuZGVyZWQ+RmlsZSBjYW5ub3QgYmUgcmVhZC48L25vdGUtcmVuZGVyZWQ+Jyk7XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgTW9kaWZpZWQgaW5wdXQ6ICR7aW5wdXRNb2RpZmllZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUhpc3RvcnlbaW5kZXhdLmNvbnRlbnQgPSBpbnB1dE1vZGlmaWVkO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24uUkVTVEFQSVVSTCAmJiBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24uZW5hYmxlU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPbGxhbWFSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9sbGFtYVJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaFJFU1RBUElVUkxSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaFJFU1RBUElVUkxSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoQU5USFJPUElDX01PREVMUy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaEFudGhyb3BpY1Jlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FudGhyb3BpYyBFcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmdlbWluaU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlU3RyZWFtKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaEdvb2dsZUdlbWluaVJlc3BvbnNlKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdHb29nbGUgR2VtaW5pRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE1pc3RyYWxSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE1pc3RyYWxSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTWlzdHJhbCBFcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoT1BFTkFJX01PREVMUy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSB8fCBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLmVuYWJsZVN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5BSUFQSVJlc3BvbnNlU3RyZWFtKHBsdWdpbiwgc2V0dGluZ3MsIGluZGV4KTsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hPcGVuQUlBUElSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgY29tcGxldGlvbjogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIub3BlblJvdXRlck1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5lbmFibGVTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5Sb3V0ZXJSZXNwb25zZVN0cmVhbShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaE9wZW5Sb3V0ZXJSZXNwb25zZShwbHVnaW4sIHNldHRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIG1vZGVscyBkZXRlY3RlZC4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWRpdENvbnRhaW5lci5yZXBsYWNlV2l0aCh1c2VyUHJlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZWRpdENvbnRhaW5lci5hcHBlbmRDaGlsZCh0ZXh0YXJlYUVkaXRCdXR0b24pO1xuICAgICAgICBlZGl0Q29udGFpbmVyLmFwcGVuZENoaWxkKGNhbmNlbEJ1dHRvbik7XG5cbiAgICAgICAgaWYgKHVzZXJQcmUucGFyZW50Tm9kZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdXNlclByZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChlZGl0Q29udGFpbmVyLCB1c2VyUHJlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVkaXRCdXR0b247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNwbGF5Qm90RWRpdEJ1dHRvbiAocGx1Z2luOiBCTU9HUFQsIG1lc3NhZ2U6IHN0cmluZykge1xuICAgIGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBlZGl0QnV0dG9uLnRleHRDb250ZW50ID0gJ2VkaXQnO1xuICAgIHNldEljb24oZWRpdEJ1dHRvbiwgJ2VkaXQnKTtcbiAgICBlZGl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2VkaXQtYnV0dG9uJyk7XG4gICAgZWRpdEJ1dHRvbi50aXRsZSA9ICdlZGl0JztcblxuICAgIGxldCBsYXN0Q2xpY2tlZEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWRpdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdlZGl0LWNvbnRhaW5lcicpO1xuICAgICAgICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG4gICAgICAgIHRleHRBcmVhLmNsYXNzTGlzdC5hZGQoJ2VkaXQtdGV4dGFyZWEnKTtcblxuICAgICAgICAvLyBJbnNlcnQgY3VycmVudCBib3QgbWVzc2FnZSBpbnRvIHRoZSB0ZXh0YXJlYS5cbiAgICAgICAgdGV4dEFyZWEudmFsdWUgPSBtZXNzYWdlO1xuXG4gICAgICAgIGNvbnN0IHRleHRhcmVhRWRpdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICB0ZXh0YXJlYUVkaXRCdXR0b24udGV4dENvbnRlbnQgPSAnRWRpdCc7XG4gICAgICAgIHRleHRhcmVhRWRpdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd0ZXh0YXJlYS1lZGl0LWJ1dHRvbicpO1xuICAgICAgICB0ZXh0YXJlYUVkaXRCdXR0b24udGl0bGUgPSAnZWRpdCc7XG5cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi50ZXh0Q29udGVudCA9ICdDYW5jZWwnO1xuICAgICAgICBjYW5jZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgndGV4dGFyZWEtY2FuY2VsLWJ1dHRvbicpO1xuICAgICAgICBjYW5jZWxCdXR0b24udGl0bGUgPSAnY2FuY2VsJztcblxuICAgICAgICBlZGl0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRleHRBcmVhKTtcblxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgbGFzdENsaWNrZWRFbGVtZW50ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgIHdoaWxlIChsYXN0Q2xpY2tlZEVsZW1lbnQgJiYgIWxhc3RDbGlja2VkRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2JvdE1lc3NhZ2UnKSkge1xuICAgICAgICAgICAgbGFzdENsaWNrZWRFbGVtZW50ID0gbGFzdENsaWNrZWRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbWVzc2FnZUJsb2NrID0gbGFzdENsaWNrZWRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKCcubWVzc2FnZUJsb2NrJyk7XG4gICAgICAgIGlmIChtZXNzYWdlQmxvY2spIHtcbiAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5hcHBlbmRDaGlsZChlZGl0Q29udGFpbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtZXNzYWdlQmxvY2sgbm90IGZvdW5kLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGV4dGFyZWFFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbWVzc2FnZSA9IHRleHRBcmVhLnZhbHVlO1xuICAgICAgICAgICAgZWRpdENvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIG1lc3NhZ2VCbG9jaz8ucmVtb3ZlKCk7XG4gICAgICAgICAgICBtZXNzYWdlQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIG1lc3NhZ2VCbG9jay5jbGFzc05hbWUgPSAnbWVzc2FnZUJsb2NrJztcbiAgICAgICAgICAgIGxhc3RDbGlja2VkRWxlbWVudD8uYXBwZW5kQ2hpbGQobWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIocGx1Z2luLmFwcCwgbWVzc2FnZSwgbWVzc2FnZUJsb2NrIGFzIEhUTUxFbGVtZW50LCAnLycsIHBsdWdpbik7XG4gICAgICAgICAgICBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrKTtcblxuICAgICAgICAgICAgY29uc3QgY29weUNvZGVCbG9ja3MgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgnLmNvcHktY29kZS1idXR0b24nKSBhcyBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjtcbiAgICAgICAgICAgIGNvcHlDb2RlQmxvY2tzLmZvckVhY2goKGNvcHlDb2RlQmxvY2spID0+IHtcbiAgICAgICAgICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICAgICAgICAgIHNldEljb24oY29weUNvZGVCbG9jaywgJ2NvcHknKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAobGFzdENsaWNrZWRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWxsTWVzc2FnZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZXNzYWdlQ29udGFpbmVyIGRpdi51c2VyTWVzc2FnZSwgI21lc3NhZ2VDb250YWluZXIgZGl2LmJvdE1lc3NhZ2UnKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBhbGxNZXNzYWdlcy5pbmRleE9mKGxhc3RDbGlja2VkRWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBpbnB1dCBjb250YWlucyBhbnkgaW50ZXJuYWwgbGlua3MgYW5kIHJlcGxhY2UgdGhlbSB3aXRoIHRoZSBjb250ZW50IG9mIHRoZSBsaW5rZWQgZmlsZSAoW1tdXSwgIVtbXV0sIFtbI11dKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWdleCA9IC8oIT8pXFxbXFxbKC4qPylcXF1cXF0vZztcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXM7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpbnB1dE1vZGlmaWVkID0gdGV4dEFyZWEudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgYWxsIHJlcGxhY2VtZW50cyB0byBiZSBtYWRlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50cyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChtYXRjaGVzID0gcmVnZXguZXhlYyh0ZXh0QXJlYS52YWx1ZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNsYW1hdGlvbiA9IG1hdGNoZXNbMV07IC8vIENhcHR1cmUgdGhlIG9wdGlvbmFsIGV4Y2xhbWF0aW9uIG1hcmtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmt0ZXh0ID0gbWF0Y2hlc1syXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNwbGl0IHRoZSBsaW5rdGV4dCBpbnRvIHBhdGggYW5kIHN1YnBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtwYXRoLCBzdWJwYXRoXSA9IGxpbmt0ZXh0LnNwbGl0KCcjJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDsgLy8gQXNzdW1pbmcgZmlsZSBvYmplY3QgaGFzIGEgcGF0aCBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gZmlsZVBhdGguc3BsaXQoJy4nKS5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGZpbGUgZXh0ZW5zaW9uIGlzIC5tZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUV4dGVuc2lvbiAhPT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNJbWFnZUZpbGUgPSAvXFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8d2VicHxibXB8dGlmZnx0aWZ8c3ZnKSQvaS50ZXN0KGZpbGVQYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMuaW5jbHVkZXMocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnNldChtYXRjaGVzWzBdLCBgJHtleGNsYW1hdGlvbn1bWyR7bWF0Y2hlc1syXX1dXTxub3RlLXJlbmRlcmVkPkVSUk9SOiBGaWxlIGNhbm5vdCBiZSByZWFkLjwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzLmluY2x1ZGVzKHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNJbWFnZUZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnNldChtYXRjaGVzWzBdLCBgJHtleGNsYW1hdGlvbn1bWyR7bWF0Y2hlc1syXX1dXTxub3RlLXJlbmRlcmVkPkVSUk9SOiBGaWxlIGNhbm5vdCBiZSByZWFkLjwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gU2tpcCB0byB0aGUgbmV4dCBpdGVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50VG9JbnNlcnQgPSBjb250ZW50O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGEgc3VicGF0aCwgZmluZCB0aGUgcmVsZXZhbnQgc2VjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicGF0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpblN1YnBhdGggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnBhdGhDb250ZW50ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3VicGF0aExldmVsID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXiMrLyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdMZXZlbCA9IG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5TdWJwYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGluZ0xldmVsIDw9IHN1YnBhdGhMZXZlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpblN1YnBhdGggJiYgbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHN1YnBhdGgudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluU3VicGF0aCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYXRoTGV2ZWwgPSBoZWFkaW5nTGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5TdWJwYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9JbnNlcnQgPSBzdWJwYXRoQ29udGVudC5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXBhcmUgdGhlIHJlcGxhY2VtZW50IGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnNldChtYXRjaGVzWzBdLCBgJHtleGNsYW1hdGlvbn1bWyR7bWF0Y2hlc1syXX1dXTxub3RlLXJlbmRlcmVkPiR7Y29udGVudFRvSW5zZXJ0fTwvbm90ZS1yZW5kZXJlZD5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHJlYWQgdGhlIGNvbnRlbnQgb2YgXCIke3BhdGh9XCI6ICR7ZXJyfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGNhc2Ugd2hlcmUgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGEgVEZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMuc2V0KG1hdGNoZXNbMF0sIGAke2V4Y2xhbWF0aW9ufVtbJHttYXRjaGVzWzJdfV1dPG5vdGUtcmVuZGVyZWQ+RmlsZSBjYW5ub3QgYmUgcmVhZC48L25vdGUtcmVuZGVyZWQ+YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSBhbGwgcmVwbGFjZW1lbnRzIHRvIGlucHV0TW9kaWZpZWRcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbb3JpZ2luYWwsIHJlcGxhY2VtZW50XSBvZiByZXBsYWNlbWVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TW9kaWZpZWQgPSBpbnB1dE1vZGlmaWVkLnNwbGl0KG9yaWdpbmFsKS5qb2luKHJlcGxhY2VtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGluIHRoZSBmaW5hbCBvdXRwdXRcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRNb2RpZmllZCA9IGlucHV0TW9kaWZpZWQucmVwbGFjZSgvKDxub3RlLXJlbmRlcmVkPkZpbGUgY2Fubm90IGJlIHJlYWQuPFxcL25vdGUtcmVuZGVyZWQ+KSsvZywgJzxub3RlLXJlbmRlcmVkPkZpbGUgY2Fubm90IGJlIHJlYWQuPC9ub3RlLXJlbmRlcmVkPicpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYE1vZGlmaWVkIGlucHV0OiAke2lucHV0TW9kaWZpZWR9YCk7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VIaXN0b3J5W2luZGV4XS5jb250ZW50ID0gaW5wdXRNb2RpZmllZDtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZUhpc3RvcnksIG51bGwsIDQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSwganNvblN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIHRvIG1lc3NhZ2UgaGlzdG9yeSBmaWxlOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gbW9kZWxzIGRldGVjdGVkLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlZGl0Q29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgbWVzc2FnZUJsb2NrPy5yZW1vdmUoKTtcbiAgICAgICAgICAgIG1lc3NhZ2VCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgbWVzc2FnZUJsb2NrLmNsYXNzTmFtZSA9ICdtZXNzYWdlQmxvY2snO1xuICAgICAgICAgICAgbGFzdENsaWNrZWRFbGVtZW50Py5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2spO1xuXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHJlbmRlcmVkIGJsb2NrIGZyb20gdGhlIG1lc3NhZ2UgY29udGVudFxuICAgICAgICAgICAgY29uc3QgcmVnZXhSZW5kZXJlZEJsb2NrID0gLzxibG9jay1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL2Jsb2NrLXJlbmRlcmVkPi9nO1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShyZWdleFJlbmRlcmVkQmxvY2ssICcnKS50cmltKCk7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSByZW5kZXJlZCBub3RlIHRhZ3MgZnJvbSB0aGUgbWVzc2FnZSBjb250ZW50XG4gICAgICAgICAgICBjb25zdCByZWdleFJlbmRlcmVkTm90ZSA9IC88bm90ZS1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL25vdGUtcmVuZGVyZWQ+L2c7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHJlZ2V4UmVuZGVyZWROb3RlLCAnJykudHJpbSgpO1xuXG4gICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlLCBtZXNzYWdlQmxvY2sgYXMgSFRNTEVsZW1lbnQsICcvJywgcGx1Z2luKTtcbiAgICAgICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2spO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBjb3B5Q29kZUJsb2NrcyA9IG1lc3NhZ2VCbG9jay5xdWVyeVNlbGVjdG9yQWxsKCcuY29weS1jb2RlLWJ1dHRvbicpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuICAgICAgICAgICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICAgICAgICAgIGNvcHlDb2RlQmxvY2sudGV4dENvbnRlbnQgPSAnQ29weSc7XG4gICAgICAgICAgICAgICAgc2V0SWNvbihjb3B5Q29kZUJsb2NrLCAnY29weScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dGFyZWFFZGl0QnV0dG9uKTtcbiAgICAgICAgZWRpdENvbnRhaW5lci5hcHBlbmRDaGlsZChjYW5jZWxCdXR0b24pO1xuXG4gICAgICAgIC8vIGlmIChtZXNzYWdlQmxvY2sgIT09IG51bGwpIHtcbiAgICAgICAgLy8gICAgIG1lc3NhZ2VCbG9jaz8ucmVwbGFjZUNoaWxkKGVkaXRDb250YWluZXIsIG1lc3NhZ2VCbG9jayk7XG4gICAgICAgIC8vIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBlZGl0QnV0dG9uO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheVVzZXJDb3B5QnV0dG9uICh1c2VyUHJlOiBIVE1MUHJlRWxlbWVudCkge1xuICAgIGNvbnN0IGNvcHlCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjb3B5QnV0dG9uLnRleHRDb250ZW50ID0gJ2NvcHknO1xuICAgIHNldEljb24oY29weUJ1dHRvbiwgJ2NvcHknKTtcbiAgICBjb3B5QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NvcHktYnV0dG9uJyk7XG4gICAgY29weUJ1dHRvbi50aXRsZSA9ICdjb3B5JztcblxuICAgIGNvcHlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VUZXh0ID0gdXNlclByZS50ZXh0Q29udGVudDtcblxuICAgICAgICBpZiAobWVzc2FnZVRleHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvcHlNZXNzYWdlVG9DbGlwYm9hcmQobWVzc2FnZVRleHQpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnQ29waWVkIHVzZXIgbWVzc2FnZS4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01lc3NhZ2UgY29udGVudCBpcyBudWxsLiBDYW5ub3QgY29weS4nKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBjb3B5QnV0dG9uO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheUJvdENvcHlCdXR0b24gKHNldHRpbmdzOiBCTU9TZXR0aW5ncywgbWVzc2FnZTogc3RyaW5nKSB7XG4gICAgY29uc3QgY29weUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGNvcHlCdXR0b24udGV4dENvbnRlbnQgPSAnY29weSc7XG4gICAgc2V0SWNvbihjb3B5QnV0dG9uLCAnY29weScpO1xuICAgIGNvcHlCdXR0b24uY2xhc3NMaXN0LmFkZCgnY29weS1idXR0b24nKTtcbiAgICBjb3B5QnV0dG9uLnRpdGxlID0gJ2NvcHknO1xuXG4gICAgY29weUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG1lc3NhZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvcHlNZXNzYWdlVG9DbGlwYm9hcmQobWVzc2FnZSk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdDb3BpZWQgYm90IG1lc3NhZ2UuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNZXNzYWdlIGNvbnRlbnQgaXMgbnVsbC4gQ2Fubm90IGNvcHkuJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY29weUJ1dHRvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlNZXNzYWdlVG9DbGlwYm9hcmQobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobWVzc2FnZSkudGhlbihmdW5jdGlvbigpIHtcbiAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuYWJsZSB0byBjb3B5IG1lc3NhZ2U6ICcsIGVycik7XG4gICAgfSk7XG59XG5cbi8vIEFwcGVuZCBidXR0b24gdG8gZWRpdG9yXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheUFwcGVuZEJ1dHRvbihwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBhcHBlbmRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBhcHBlbmRCdXR0b24udGV4dENvbnRlbnQgPSAnYXBwZW5kJztcbiAgICBzZXRJY29uKGFwcGVuZEJ1dHRvbiwgJ3BsdXMtc3F1YXJlJyk7XG4gICAgYXBwZW5kQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FwcGVuZC1idXR0b24nKTtcbiAgICBhcHBlbmRCdXR0b24udGl0bGUgPSAnYXBwZW5kJztcblxuICAgIGNvbnN0IG1lc3NhZ2VUZXh0ID0gbWVzc2FnZTtcblxuICAgIGFwcGVuZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoY2hlY2tBY3RpdmVGaWxlPy5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBhY3RpdmUgZmlsZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgZmlsZSBvZiB0aGUgbGFzdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgIGlmICgoY2hlY2tBY3RpdmVGaWxlICE9PSBsYXN0Q3Vyc29yUG9zaXRpb25GaWxlKSkge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byB0aGUgYm90dG9tIG9mIHRoZSBmaWxlXG4gICAgICAgICAgICAgICAgZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luLCBzZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDb250ZW50ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGNoZWNrQWN0aXZlRmlsZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSBleGlzdGluZ0NvbnRlbnQgKyAnXFxuJyArIG1lc3NhZ2VUZXh0O1xuICAgICAgICAgICAgICAgIHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGNoZWNrQWN0aXZlRmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgYXQgdGhlIGxhc3QgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYWN0aXZlRWRpdG9yPy5yZXBsYWNlUmFuZ2UobWVzc2FnZVRleHQsIGxhc3RDdXJzb3JQb3NpdGlvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnQXBwZW5kZWQgcmVzcG9uc2UuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBhY3RpdmUgTWFya2Rvd24gZmlsZSBkZXRlY3RlZC4nKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGFwcGVuZEJ1dHRvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BsYXlUcmFzaEJ1dHRvbiAocGx1Z2luOiBCTU9HUFQpIHtcbiAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIHRyYXNoQnV0dG9uLnRleHRDb250ZW50ID0gJ3RyYXNoJztcbiAgICBzZXRJY29uKHRyYXNoQnV0dG9uLCAndHJhc2gnKTtcbiAgICB0cmFzaEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd0cmFzaC1idXR0b24nKTtcbiAgICB0cmFzaEJ1dHRvbi50aXRsZSA9ICd0cmFzaCc7XG5cbiAgICBsZXQgbGFzdENsaWNrZWRFbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGxhc3RDbGlja2VkRWxlbWVudCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblxuICAgICAgICB3aGlsZSAobGFzdENsaWNrZWRFbGVtZW50ICYmICFsYXN0Q2xpY2tlZEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCd1c2VyTWVzc2FnZScpKSB7XG4gICAgICAgICAgICBsYXN0Q2xpY2tlZEVsZW1lbnQgPSBsYXN0Q2xpY2tlZEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsYXN0Q2xpY2tlZEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21lc3NhZ2VDb250YWluZXIgLnVzZXJNZXNzYWdlJykpO1xuICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlck1lc3NhZ2VzLmluZGV4T2YobGFzdENsaWNrZWRFbGVtZW50KSAqIDI7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE1vZGFsKHBsdWdpbi5hcHApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG1vZGFsLmNvbnRlbnRFbC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGgyPkRlbGV0ZSBNZXNzYWdlIEJsb2NrLjwvaDI+XG4gICAgICAgICAgICAgICAgICAgIDxwPkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBtZXNzYWdlIGJsb2NrPzwvcD5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cImNvbmZpcm1EZWxldGVcIj5Db25maXJtIERlbGV0ZTwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIGA7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb25maXJtRGVsZXRlQnV0dG9uID0gbW9kYWwuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3IoJyNjb25maXJtRGVsZXRlJyk7XG4gICAgICAgICAgICAgICAgY29uZmlybURlbGV0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZU1lc3NhZ2UocGx1Z2luLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01lc3NhZ2UgZGVsZXRlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGlkZUFsbERyb3Bkb3ducygpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0cmFzaEJ1dHRvbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU1lc3NhZ2UocGx1Z2luOiBCTU9HUFQsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcblxuICAgIGNvbnN0IGRpdkVsZW1lbnRzID0gbWVzc2FnZUNvbnRhaW5lcj8ucXVlcnlTZWxlY3RvckFsbCgnZGl2LmJvdE1lc3NhZ2UsIGRpdi51c2VyTWVzc2FnZScpO1xuXG4gICAgaWYgKGRpdkVsZW1lbnRzICYmIGRpdkVsZW1lbnRzLmxlbmd0aCA+IDAgJiYgaW5kZXggPj0gMCAmJiBpbmRleCA8IGRpdkVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIHNwZWNpZmllZCBtZXNzYWdlIGFuZCB0aGUgbmV4dCBvbmUgaWYgaXQgZXhpc3RzXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXI/LnJlbW92ZUNoaWxkKGRpdkVsZW1lbnRzW2luZGV4XSk7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBuZXh0IG1lc3NhZ2UgaXMgZnJvbSB0aGUgYXNzaXN0YW50IGFuZCByZW1vdmUgaXQgaWYgaXQgaXNcbiAgICAgICAgaWYgKGluZGV4ICsgMSA8IGRpdkVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbmV4dE1lc3NhZ2UgPSBkaXZFbGVtZW50c1tpbmRleCArIDFdO1xuICAgICAgICAgICAgaWYgKG5leHRNZXNzYWdlLmNsYXNzTGlzdC5jb250YWlucygnYm90TWVzc2FnZScpKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lcj8ucmVtb3ZlQ2hpbGQobmV4dE1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSBtZXNzYWdlSGlzdG9yeSBieSByZW1vdmluZyB0aGUgc3BlY2lmaWVkIGluZGV4IGFuZCBwb3RlbnRpYWxseSB0aGUgbmV4dCBvbmVcbiAgICBpZiAobWVzc2FnZUhpc3RvcnlbaW5kZXggKyAxXSAmJiBtZXNzYWdlSGlzdG9yeVtpbmRleCArIDFdLnJvbGUgPT09ICdhc3Npc3RhbnQnKSB7XG4gICAgICAgIG1lc3NhZ2VIaXN0b3J5LnNwbGljZShpbmRleCwgMik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbWVzc2FnZUhpc3Rvcnkuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QganNvblN0cmluZyA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VIaXN0b3J5LCBudWxsLCA0KTtcblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci53cml0ZShmaWxlTmFtZU1lc3NhZ2VIaXN0b3J5SnNvbihwbHVnaW4pLCBqc29uU3RyaW5nKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIG1lc3NhZ2VIaXN0b3J5Lmpzb24nLCBlcnJvcik7XG4gICAgfVxufSIsICJpbXBvcnQgQk1PR1BULCB7IEJNT1NldHRpbmdzIH0gZnJvbSAnc3JjL21haW4nO1xuXG5sZXQgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gJyc7XG5cbi8vIFJlZmVyZW5jZSBDdXJyZW50IE5vdGUgSW5kaWNhdG9yXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWN0aXZlRmlsZUNvbnRlbnQocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncykge1xuICAgIGNvbnN0IGRvdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZG90SW5kaWNhdG9yJyk7XG4gICAgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gJyc7XG4gICAgaWYgKHNldHRpbmdzLmdlbmVyYWwuZW5hYmxlUmVmZXJlbmNlQ3VycmVudE5vdGUgPT09IHRydWUpIHtcbiAgICAgICAgaWYgKGRvdEVsZW1lbnQpIHtcbiAgICAgICAgICAgIChkb3RFbGVtZW50IGFzIEhUTUxFbGVtZW50KS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2RhMmMyYyc7XG4gICAgICAgICAgICByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSAnJztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoYWN0aXZlRmlsZT8uZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICBpZiAoZG90RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIChkb3RFbGVtZW50IGFzIEhUTUxFbGVtZW50KS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFyWWFtbENvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLy0tLVtcXHNcXFNdKz8tLS0vLCAnJykudHJpbSgpO1xuICAgICAgICAgICAgcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50ID0gJ1xcblxcbicgKyAnQWRkaXRpb25hbCBOb3RlOicgKyAnXFxuXFxuJyArIGNsZWFyWWFtbENvbnRlbnQgKyAnXFxuXFxuJztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudE5vdGVDb250ZW50KCkge1xuICAgIHJldHVybiByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQ7XG59IiwgImltcG9ydCB7IGZpbGVOYW1lTWVzc2FnZUhpc3RvcnlKc29uLCBtZXNzYWdlSGlzdG9yeSB9IGZyb20gJ3NyYy92aWV3JztcbmltcG9ydCB7IGRpc3BsYXlBcHBlbmRCdXR0b24sIGRpc3BsYXlCb3RDb3B5QnV0dG9uLCBkaXNwbGF5Qm90RWRpdEJ1dHRvbiB9IGZyb20gJy4vQnV0dG9ucyc7XG5pbXBvcnQgQk1PR1BULCB7IEJNT1NldHRpbmdzIH0gZnJvbSAnc3JjL21haW4nO1xuaW1wb3J0IHsgZ2V0Q3VycmVudE5vdGVDb250ZW50IH0gZnJvbSAnLi4vZWRpdG9yL1JlZmVyZW5jZUN1cnJlbnROb3RlJztcbmltcG9ydCB7aHRtbFRvTWFya2Rvd24sIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5cbi8vIEFkZCBhIG5ldyBtZXNzYWdlIHRvIHRoZSBtZXNzYWdlSGlzdG9yeSBhcnJheSBhbmQgc2F2ZSBpdCB0byB0aGUgZmlsZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZE1lc3NhZ2UocGx1Z2luOiBCTU9HUFQsIGlucHV0OiBzdHJpbmcsIG1lc3NhZ2VUeXBlOiAndXNlck1lc3NhZ2UnIHwgJ2JvdE1lc3NhZ2UnLCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBtZXNzYWdlT2JqOiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyBpbWFnZXM6IFVpbnQ4QXJyYXlbXSB8IHN0cmluZ1tdIH0gPSB7XG4gICAgICAgIHJvbGU6ICcnLFxuICAgICAgICBjb250ZW50OiAnJyxcbiAgICAgICAgaW1hZ2VzOiBbXSxcbiAgICB9O1xuXG5cbiAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgPSBnZXRDdXJyZW50Tm90ZUNvbnRlbnQoKSB8fCAnJztcbiAgICBjb25zdCBmdWxsSW5wdXQgPSByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQgKyBpbnB1dDtcblxuICAgIC8vIC8vIEluaXRpYWxpemUgYW4gYXJyYXkgdG8gaG9sZCB0aGUgYWJzb2x1dGUgVVJMc1xuICAgIGNvbnN0IGltYWdlc1ZhdWx0UGF0aDogVWludDhBcnJheVtdIHwgc3RyaW5nW10gfCBudWxsID0gW107XG5cbiAgICBpZiAocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzLmluY2x1ZGVzKHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAvLyBFeHRyYWN0IGltYWdlIGxpbmtzIGZyb20gdGhlIGlucHV0XG4gICAgICAgIGNvbnN0IGltYWdlTWF0Y2ggPSBmdWxsSW5wdXQubWF0Y2goLyE/XFxbXFxbKC4qPylcXF1cXF0vZyk7XG4gICAgICAgIGNvbnN0IGltYWdlTGluayA9IGltYWdlTWF0Y2ggXG4gICAgICAgID8gaW1hZ2VNYXRjaFxuICAgICAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0uc3RhcnRzV2l0aCgnIScpID8gaXRlbS5zbGljZSgzLCAtMikgOiBpdGVtLnNsaWNlKDIsIC0yKSlcbiAgICAgICAgICAgIC5maWx0ZXIobGluayA9PiAvXFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8d2VicHxibXB8dGlmZnx0aWZ8c3ZnKSQvaS50ZXN0KGxpbmspKVxuICAgICAgICA6IFtdO1xuXG4gICAgICAgIC8vIExvb3AgdGhyb3VnaCBlYWNoIGltYWdlIGxpbmsgdG8gZ2V0IHRoZSBmdWxsIHBhdGhcbiAgICAgICAgaWYgKGltYWdlTGluay5sZW5ndGggPiAwKSB7XG4gICAgICAgIGltYWdlTGluay5mb3JFYWNoKGxpbmsgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VGaWxlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rLCAnJyk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZSA9IGltYWdlRmlsZSA/IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuZ2V0RnVsbFBhdGgoaW1hZ2VGaWxlLnBhdGgpIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgIGltYWdlc1ZhdWx0UGF0aC5wdXNoKGltYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjb25zb2xlLmxvZygnSW1hZ2UgcGF0aDonLCBpbWFnZXNWYXVsdFBhdGgpO1xuICAgIH1cblxuICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gJ3VzZXJNZXNzYWdlJykge1xuICAgICAgICBtZXNzYWdlT2JqLnJvbGUgPSAndXNlcic7XG4gICAgICAgIG1lc3NhZ2VPYmouY29udGVudCA9IGlucHV0O1xuICAgICAgICBtZXNzYWdlT2JqLmltYWdlcyA9IGltYWdlc1ZhdWx0UGF0aDtcbiAgICB9IGVsc2UgaWYgKG1lc3NhZ2VUeXBlID09PSAnYm90TWVzc2FnZScpIHtcbiAgICAgICAgbWVzc2FnZU9iai5yb2xlID0gJ2Fzc2lzdGFudCc7ICBcbiAgICAgICAgbWVzc2FnZU9iai5jb250ZW50ID0gaW5wdXQ7XG5cbiAgICAgICAgLy8gQWRkIGJ1dHRvbnMgdG8gYm90TWVzc2FnZSBhZnRlciBmZXRjaGluZyBtZXNzYWdlXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXJFbERpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVzc2FnZUNvbnRhaW5lciBkaXYudXNlck1lc3NhZ2UsICNtZXNzYWdlQ29udGFpbmVyIGRpdi5ib3RNZXNzYWdlJyk7XG4gICAgICAgIGNvbnN0IHRhcmdldFVzZXJNZXNzYWdlID0gbWVzc2FnZUNvbnRhaW5lckVsRGl2c1tpbmRleF07XG4gICAgICAgIGNvbnN0IHRhcmdldEJvdE1lc3NhZ2UgPSB0YXJnZXRVc2VyTWVzc2FnZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgY29uc3QgYm90TWVzc2FnZVRvb2xCYXJEaXYgPSB0YXJnZXRCb3RNZXNzYWdlPy5xdWVyeVNlbGVjdG9yKCcuYm90TWVzc2FnZVRvb2xCYXInKTtcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lckRpdi5jbGFzc05hbWUgPSAnYnV0dG9uLWNvbnRhaW5lcic7XG4gICAgICAgIGJvdE1lc3NhZ2VUb29sQmFyRGl2Py5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXJEaXYpO1xuXG4gICAgICAgIC8vIENoYW5nZSBzdWJtaXQgYnV0dG9uIHRvIHNlbmQgaWNvblxuICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VibWl0LWJ1dHRvbicpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnc2VuZCc7XG4gICAgICAgIHNldEljb24oc3VibWl0QnV0dG9uLCAnYXJyb3ctdXAnKTtcbiAgICAgICAgc3VibWl0QnV0dG9uLnRpdGxlID0gJ3NlbmQnO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFtZXNzYWdlT2JqLmNvbnRlbnQuaW5jbHVkZXMoJ2NvbW1hbmRCb3RNZXNzYWdlJykgJiYgIW1lc3NhZ2VPYmouY29udGVudC5pbmNsdWRlcygnZXJyb3JCb3RNZXNzYWdlJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRCdXR0b24gPSBkaXNwbGF5Qm90RWRpdEJ1dHRvbihwbHVnaW4sIG1lc3NhZ2VPYmouY29udGVudCk7XG4gICAgICAgICAgICBjb25zdCBjb3B5Qm90QnV0dG9uID0gZGlzcGxheUJvdENvcHlCdXR0b24oc2V0dGluZ3MsIG1lc3NhZ2VPYmouY29udGVudCk7XG4gICAgICAgICAgICBjb25zdCBhcHBlbmRCdXR0b24gPSBkaXNwbGF5QXBwZW5kQnV0dG9uKHBsdWdpbiwgc2V0dGluZ3MsIG1lc3NhZ2VPYmouY29udGVudCk7XG4gICAgICAgICAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQoY29weUJvdEJ1dHRvbik7XG4gICAgICAgICAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQoYXBwZW5kQnV0dG9uKTtcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICAgIG1lc3NhZ2VIaXN0b3J5LnNwbGljZShpbmRleCArIDEsIDAsIG1lc3NhZ2VPYmopO1xuICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZUhpc3RvcnksIG51bGwsIDQpO1xuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSwganNvblN0cmluZyk7XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2VDb250YWluZXInKTtcblxuICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lckVsKSB7XG5cbiAgICAgICAgICAgIC8vIEdldCBsYXN0IGJvdE1lc3NhZ2UgZGl2XG4gICAgICAgICAgICBjb25zdCBsYXN0Qm90TWVzc2FnZSA9IG1lc3NhZ2VDb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuYm90TWVzc2FnZTpsYXN0LWNoaWxkJyk7XG5cbiAgICAgICAgICAgIGlmIChsYXN0Qm90TWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdldEJsb2NrTGFuZ3VhZ2UgPSBsYXN0Qm90TWVzc2FnZS5xdWVyeVNlbGVjdG9yQWxsKCdkaXZbY2xhc3NePVwiYmxvY2stbGFuZ3VhZ2UtXCJdJyk7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VkTGFuZ2F1Z2VCbG9ja3MgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAgICAgICAgICAgICAgIGdldEJsb2NrTGFuZ3VhZ2UuZm9yRWFjaChhc3luYyBibG9jayA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYmxvY2sucXVlcnlTZWxlY3RvcignLnJlbmRlcmVkLW1hcmtkb3duLW91dHB1dCcpICYmIG1lc3NhZ2VUeXBlID09PSAnYm90TWVzc2FnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrVG9NYXJrZG93biA9IGh0bWxUb01hcmtkb3duKGJsb2NrIGFzIEhUTUxFbGVtZW50IHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hcmtkb3duTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Rvd25Ob2RlLmNsYXNzTGlzdC5hZGQoJ3JlbmRlcmVkLW1hcmtkb3duLW91dHB1dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Rvd25Ob2RlLnRleHRDb250ZW50ID0gYFxcblxcbjxibG9jay1yZW5kZXJlZD5cXG4ke2Jsb2NrVG9NYXJrZG93bn1cXG48L2Jsb2NrLXJlbmRlcmVkPlxcblxcbmA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVuZGVyZWRNYXJrZG93bk91dHB1dCA9IG1hcmtkb3duTm9kZS50ZXh0Q29udGVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBbXSgpIHdpdGggW1tdXSBpbiB0aGUgcmVuZGVyZWQgbWFya2Rvd24gb3V0cHV0XG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlZE1hcmtkb3duT3V0cHV0ID0gcmVuZGVyZWRNYXJrZG93bk91dHB1dC5yZXBsYWNlKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpL2csIChtYXRjaCwgcDEsIHAyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXh0cmFjdCB0aGUgZmlsZW5hbWUgd2l0aG91dCB0aGUgcGF0aCBhbmQgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBwMi5zcGxpdCgnLycpLnBvcCgpLnJlcGxhY2UoJy5tZCcsICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFtbJHtmaWxlbmFtZX1dXWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3JlbmRlcmVkTWFya2Rvd25PdXRwdXQnLCByZW5kZXJlZE1hcmtkb3duT3V0cHV0KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4dHJhY3RCbG9ja3MgPSAobWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVnZXggPSAvYGBgKFxcdyspXFxuKFtcXHNcXFNdKj8pYGBgKFxccyooPGJsb2NrLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvYmxvY2stcmVuZGVyZWQ+XFxzKik/KS9nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVkTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBbLi4ubWVzc2FnZS5tYXRjaEFsbChyZWdleCldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9sZEJsb2NrID0gbWF0Y2hbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrQ29udGVudCA9IG1hdGNoWzJdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBibG9jayBoYXMgYWxyZWFkeSBiZWVuIHJlcGxhY2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlZExhbmdhdWdlQmxvY2tzLmhhcyhvbGRCbG9jaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBTa2lwIGlmIGFscmVhZHkgcmVwbGFjZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQgdGhlIG5ldyBibG9jayB3aXRoIHJlbmRlcmVkTWFya2Rvd25PdXRwdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3QmxvY2sgPSBgXFxgXFxgXFxgJHttYXRjaFsxXX1cXG4ke2Jsb2NrQ29udGVudH1cXG5cXGBcXGBcXGAke3JlbmRlcmVkTWFya2Rvd25PdXRwdXR9YDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBvbmx5IHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIG9sZEJsb2NrIGluIHVwZGF0ZWRNZXNzYWdlIHdpdGggbmV3QmxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE1lc3NhZ2UgPSB1cGRhdGVkTWVzc2FnZS5yZXBsYWNlKG9sZEJsb2NrLCBuZXdCbG9jayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoaXMgYmxvY2sgYXMgcmVwbGFjZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRMYW5nYXVnZUJsb2Nrcy5hZGQobmV3QmxvY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gU3RvcCB0aGUgbG9vcCBhZnRlciB1cGRhdGluZyB0aGUgZmlyc3QgZWxpZ2libGUgYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRNZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRNZXNzYWdlQ29udGVudCA9IGV4dHJhY3RCbG9ja3MobWVzc2FnZU9iai5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cGRhdGVkTWVzc2FnZUNvbnRlbnQnLCB1cGRhdGVkTWVzc2FnZUNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBtZXNzYWdlIGNvbnRlbnQgd2l0aCB0aGUgcmVuZGVyZWQgbWFya2Rvd24gb3V0cHV0XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlT2JqLmNvbnRlbnQgPSB1cGRhdGVkTWVzc2FnZUNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIHRoZSB1cGRhdGVkIG1lc3NhZ2UgaGlzdG9yeVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZEpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlSGlzdG9yeSwgbnVsbCwgNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoZmlsZU5hbWVNZXNzYWdlSGlzdG9yeUpzb24ocGx1Z2luKSwgdXBkYXRlZEpzb25TdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIGNvbnN0IGdldE5vdGVDb250ZW50ID0gbGFzdEJvdE1lc3NhZ2UucXVlcnlTZWxlY3RvckFsbCgnLmludGVybmFsLWVtYmVkLm1hcmtkb3duLWVtYmVkLmlubGluZS1lbWJlZC5pcy1sb2FkZWQnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VkTm90ZUJsb2NrcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gICAgICAgICAgICAgICAgZ2V0Tm90ZUNvbnRlbnQuZm9yRWFjaChhc3luYyBsaW5rID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaW5rLnF1ZXJ5U2VsZWN0b3IoJy5yZW5kZXJlZC1tYXJrZG93bi1vdXRwdXQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvY2tUb01hcmtkb3duID0gaHRtbFRvTWFya2Rvd24obGluayBhcyBIVE1MRWxlbWVudCB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJrZG93bk5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtkb3duTm9kZS5jbGFzc0xpc3QuYWRkKCdyZW5kZXJlZC1tYXJrZG93bi1vdXRwdXQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtkb3duTm9kZS50ZXh0Q29udGVudCA9IGBcXG5cXG48bm90ZS1yZW5kZXJlZD5cXG4ke2Jsb2NrVG9NYXJrZG93bn1cXG48L25vdGUtcmVuZGVyZWQ+XFxuXFxuYDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkTWFya2Rvd25PdXRwdXQgPSBtYXJrZG93bk5vZGUudGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHRyYWN0TGlua3MgPSAobWVzc2FnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWF0Y2ggdGhlIG5vdGUgbGluayBhbmQgdGhlIHJlbmRlcmVkIG1hcmtkb3duIG91dHB1dCAoZS5nICFbW11dIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWdleCA9IC8oIVxcW1xcWy4qP1xcXVxcXSkoXFxzKig8bm90ZS1yZW5kZXJlZD5bXFxzXFxTXSo/PFxcL25vdGUtcmVuZGVyZWQ+XFxzKik/KS9nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVkTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ21lc3NhZ2UnLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIFsuLi5tZXNzYWdlLm1hdGNoQWxsKHJlZ2V4KV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2xkTGluayA9IG1hdGNoWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlTGluayA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGJsb2NrIGhhcyBhbHJlYWR5IGJlZW4gcmVwbGFjZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VkTm90ZUJsb2Nrcy5oYXMob2xkTGluaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBTa2lwIGlmIGFscmVhZHkgcmVwbGFjZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQgdGhlIG5ldyBibG9jayB3aXRoIHJlbmRlcmVkTWFya2Rvd25PdXRwdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3TGluayA9IGAke25vdGVMaW5rfVxcbiR7cmVuZGVyZWRNYXJrZG93bk91dHB1dH1gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIG9ubHkgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2Ygb2xkQmxvY2sgaW4gdXBkYXRlZE1lc3NhZ2Ugd2l0aCBuZXdCbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkTWVzc2FnZSA9IHVwZGF0ZWRNZXNzYWdlLnJlcGxhY2Uob2xkTGluaywgbmV3TGluayk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhpcyBibG9jayBhcyByZXBsYWNlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlZE5vdGVCbG9ja3MuYWRkKG5ld0xpbmspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gU3RvcCB0aGUgbG9vcCBhZnRlciB1cGRhdGluZyB0aGUgZmlyc3QgZWxpZ2libGUgYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRNZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRNZXNzYWdlQ29udGVudCA9IGV4dHJhY3RMaW5rcyhtZXNzYWdlT2JqLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZWRNZXNzYWdlQ29udGVudCcsIHVwZGF0ZWRNZXNzYWdlQ29udGVudCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIG1lc3NhZ2UgY29udGVudCB3aXRoIHRoZSByZW5kZXJlZCBtYXJrZG93biBvdXRwdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VPYmouY29udGVudCA9IHVwZGF0ZWRNZXNzYWdlQ29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHVwZGF0ZWQgbWVzc2FnZSBoaXN0b3J5XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkSnNvblN0cmluZyA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VIaXN0b3J5LCBudWxsLCA0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci53cml0ZShmaWxlTmFtZU1lc3NhZ2VIaXN0b3J5SnNvbihwbHVnaW4pLCB1cGRhdGVkSnNvblN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gICBcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHdyaXRpbmcgdG8gbWVzc2FnZSBoaXN0b3J5IGZpbGU6JywgZXJyb3IpO1xuICAgIH1cbn1cblxuLy8gQWRkIGxpbmUgYnJlYWsgYmV0d2VlbiBjb25zZWN1dGl2ZSA8cD4gZWxlbWVudHNcbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXJhZ3JhcGhCcmVha3MobWVzc2FnZUJsb2NrOiB7IHF1ZXJ5U2VsZWN0b3JBbGw6IChhcmcwOiBzdHJpbmcpID0+ICBOb2RlTGlzdE9mPEhUTUxFbGVtZW50PjsgfSkge1xuICAgIGNvbnN0IHBhcmFncmFwaHMgPSBtZXNzYWdlQmxvY2sucXVlcnlTZWxlY3RvckFsbCgncCcpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYWdyYXBocy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBwID0gcGFyYWdyYXBoc1tpXTtcbiAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSBwLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgaWYgKG5leHRTaWJsaW5nICYmIG5leHRTaWJsaW5nLm5vZGVOYW1lID09PSAnUCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKTtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IHAucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGJyLCBuZXh0U2libGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVVbnJlc29sdmVkSW50ZXJuYWxMaW5rcyhwbHVnaW46IEJNT0dQVCwgZGl2QmxvY2s6IEVsZW1lbnQpIHtcbiAgICBjb25zdCBpbnRlcm5hbExpbmtzID0gZGl2QmxvY2sucXVlcnlTZWxlY3RvckFsbCgnYScpO1xuXG4gICAgaW50ZXJuYWxMaW5rcy5mb3JFYWNoKGxpbmsgPT4ge1xuICAgICAgICBsZXQgbGlua0hyZWYgPSBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8IGxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLWhyZWYnKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rSHJlZikge1xuICAgICAgICAgICAgLy8gR2V0IHRoZSBjb250ZW50IGJlZm9yZSB0aGUgI1xuICAgICAgICAgICAgaWYgKGxpbmtIcmVmLmluY2x1ZGVzKCcjJykpIHtcbiAgICAgICAgICAgICAgICBsaW5rSHJlZiA9IGxpbmtIcmVmLnNwbGl0KCcjJylbMF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGxpbmtFeGlzdHMgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua0hyZWYsICcnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFsaW5rRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgbGluay5zdHlsZS5jb2xvciA9ICdncmV5JztcbiAgICAgICAgICAgIH0gXG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsICJpbXBvcnQgQk1PR1BULCB7IEJNT1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc3JjL21haW4nO1xuaW1wb3J0IHsgY29sb3JUb0hleCB9IGZyb20gJ3NyYy91dGlscy9Db2xvckNvbnZlcnRlcic7XG5pbXBvcnQgeyBkaXNwbGF5QXBwZW5kQnV0dG9uLCBkaXNwbGF5Qm90Q29weUJ1dHRvbiwgZGlzcGxheUJvdEVkaXRCdXR0b24gfSBmcm9tICcuL0J1dHRvbnMnO1xuaW1wb3J0IHsgYWRkTWVzc2FnZSwgYWRkUGFyYWdyYXBoQnJlYWtzIH0gZnJvbSAnLi9NZXNzYWdlJztcbmltcG9ydCB7IE1hcmtkb3duUmVuZGVyZXIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNwbGF5Qm90TWVzc2FnZShwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBtZXNzYWdlSGlzdG9yeTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9W10sIG1lc3NhZ2U6IHN0cmluZykge1xuICAgIGNvbnN0IGJvdE1lc3NhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBib3RNZXNzYWdlRGl2LmNsYXNzTmFtZSA9ICdib3RNZXNzYWdlJztcblxuICAgIGJvdE1lc3NhZ2VEaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChzZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgfHxcbiAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yKS50cmltKCkpO1xuXG4gICAgYm90TWVzc2FnZURpdi5zdHlsZS5jb2xvciA9IHNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvciB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm90TWVzc2FnZUZvbnRDb2xvcjtcblxuICAgIGNvbnN0IGJvdE1lc3NhZ2VUb29sQmFyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYm90TWVzc2FnZVRvb2xCYXJEaXYuY2xhc3NOYW1lID0gJ2JvdE1lc3NhZ2VUb29sQmFyJztcblxuICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJ1dHRvbkNvbnRhaW5lckRpdi5jbGFzc05hbWUgPSAnYnV0dG9uLWNvbnRhaW5lcic7XG5cbiAgICBjb25zdCBib3ROYW1lU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgXG4gICAgYm90TmFtZVNwYW4udGV4dENvbnRlbnQgPSBzZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZTtcbiAgICBib3ROYW1lU3Bhbi5jbGFzc05hbWUgPSAnY2hhdGJvdE5hbWUnO1xuXG4gICAgYm90TWVzc2FnZVRvb2xCYXJEaXYuYXBwZW5kQ2hpbGQoYm90TmFtZVNwYW4pO1xuICAgIGJvdE1lc3NhZ2VUb29sQmFyRGl2LmFwcGVuZENoaWxkKGJ1dHRvbkNvbnRhaW5lckRpdik7XG4gICAgY29uc3QgbWVzc2FnZUJsb2NrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbWVzc2FnZUJsb2NrRGl2LmNsYXNzTmFtZSA9ICdtZXNzYWdlQmxvY2snO1xuXG4gICAgLy8gUmVtb3ZlIHRoZSByZW5kZXJlZCBibG9jayB0YWdzIGZyb20gdGhlIG1lc3NhZ2UgY29udGVudFxuICAgIGNvbnN0IHJlZ2V4UmVuZGVyZWRCbG9jayA9IC88YmxvY2stcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ibG9jay1yZW5kZXJlZD4vZztcbiAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKHJlZ2V4UmVuZGVyZWRCbG9jaywgJycpLnRyaW0oKTtcblxuICAgIC8vIFJlbW92ZSByZW5kZXJlZCBub3RlIHRhZ3MgZnJvbSB0aGUgbWVzc2FnZSBjb250ZW50XG4gICAgY29uc3QgcmVnZXhSZW5kZXJlZE5vdGUgPSAvPG5vdGUtcmVuZGVyZWQ+W1xcc1xcU10qPzxcXC9ub3RlLXJlbmRlcmVkPi9nO1xuICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UocmVnZXhSZW5kZXJlZE5vdGUsICcnKS50cmltKCk7XG5cbiAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBtZXNzYWdlLCBtZXNzYWdlQmxvY2tEaXYsICcnLCBwbHVnaW4pO1xuXG4gICAgLy8gQWRkIGJ1dHRvbnMgdG8gdGhlIGJvdCBtZXNzYWdlXG4gICAgaWYgKCFtZXNzYWdlLmluY2x1ZGVzKCdjb21tYW5kQm90TWVzc2FnZScpICYmICFtZXNzYWdlLmluY2x1ZGVzKCdlcnJvckJvdE1lc3NhZ2UnKSkge1xuICAgICAgICBjb25zdCBlZGl0QnV0dG9uID0gZGlzcGxheUJvdEVkaXRCdXR0b24ocGx1Z2luLCBtZXNzYWdlKTtcbiAgICAgICAgY29uc3QgY29weUJvdEJ1dHRvbiA9IGRpc3BsYXlCb3RDb3B5QnV0dG9uKHNldHRpbmdzLCBtZXNzYWdlKTtcbiAgICAgICAgY29uc3QgYXBwZW5kQnV0dG9uID0gZGlzcGxheUFwcGVuZEJ1dHRvbihwbHVnaW4sIHNldHRpbmdzLCBtZXNzYWdlKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQoY29weUJvdEJ1dHRvbik7XG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChhcHBlbmRCdXR0b24pO1xuXG4gICAgICAgIGFkZFBhcmFncmFwaEJyZWFrcyhtZXNzYWdlQmxvY2tEaXYpOyBcbiAgICB9IFxuICAgIFxuICAgIGNvbnN0IGNvcHlDb2RlQmxvY2tzID0gbWVzc2FnZUJsb2NrRGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb3B5LWNvZGUtYnV0dG9uJykgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG4gICAgY29weUNvZGVCbG9ja3MuZm9yRWFjaCgoY29weUNvZGVCbG9jaykgPT4ge1xuICAgICAgICBjb3B5Q29kZUJsb2NrLnRleHRDb250ZW50ID0gJ0NvcHknO1xuICAgICAgICBzZXRJY29uKGNvcHlDb2RlQmxvY2ssICdjb3B5Jyk7XG4gICAgfSk7XG5cbiAgICBib3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKGJvdE1lc3NhZ2VUb29sQmFyRGl2KTtcbiAgICBib3RNZXNzYWdlRGl2LmFwcGVuZENoaWxkKG1lc3NhZ2VCbG9ja0Rpdik7XG5cbiAgICByZXR1cm4gYm90TWVzc2FnZURpdjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BsYXlMb2FkaW5nQm90TWVzc2FnZShzZXR0aW5nczogQk1PU2V0dGluZ3MpIHtcbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYm90TWVzc2FnZURpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZSc7XG4gICAgYm90TWVzc2FnZURpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRvSGV4KHNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvciB8fFxuICAgICAgICBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKSk7XG5cbiAgICBib3RNZXNzYWdlRGl2LnN0eWxlLmNvbG9yID0gc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yO1xuXG4gICAgY29uc3QgYm90TWVzc2FnZVRvb2xCYXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBib3RNZXNzYWdlVG9vbEJhckRpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZVRvb2xCYXInO1xuXG4gICAgY29uc3QgYm90TmFtZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7IFxuICAgIGJvdE5hbWVTcGFuLnRleHRDb250ZW50ID0gc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZSB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWU7XG4gICAgYm90TmFtZVNwYW4uY2xhc3NOYW1lID0gJ2NoYXRib3ROYW1lJztcblxuICAgIGNvbnN0IG1lc3NhZ2VCbG9ja0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG1lc3NhZ2VCbG9ja0Rpdi5jbGFzc05hbWUgPSAnbWVzc2FnZUJsb2NrJztcblxuICAgIGNvbnN0IGxvYWRpbmdFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBsb2FkaW5nRWwuc2V0QXR0cmlidXRlKCdpZCcsICdsb2FkaW5nJyk7IFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGRvdFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIGRvdFNwYW4udGV4dENvbnRlbnQgPSAnLic7XG4gICAgICAgIGxvYWRpbmdFbC5hcHBlbmRDaGlsZChkb3RTcGFuKTtcbiAgICB9XG5cbiAgICBib3RNZXNzYWdlVG9vbEJhckRpdi5hcHBlbmRDaGlsZChib3ROYW1lU3Bhbik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChib3RNZXNzYWdlVG9vbEJhckRpdik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2tEaXYpO1xuXG4gICAgLy8gRGlzcGFseSBsb2FkaW5nIGFuaW1hdGlvblxuICAgIGJvdE1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQobG9hZGluZ0VsKTtcblxuICAgIHJldHVybiBib3RNZXNzYWdlRGl2O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MsIG1lc3NhZ2VIaXN0b3J5OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH1bXSwgbWVzc2FnZTogc3RyaW5nKXtcbiAgICBjb25zdCBib3RNZXNzYWdlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYm90TWVzc2FnZURpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZSc7XG4gICAgYm90TWVzc2FnZURpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRvSGV4KHNldHRpbmdzLmFwcGVhcmFuY2UuYm90TWVzc2FnZUJhY2tncm91bmRDb2xvciB8fFxuICAgICAgICBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKSk7XG5cbiAgICBjb25zdCBib3RNZXNzYWdlVG9vbEJhckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJvdE1lc3NhZ2VUb29sQmFyRGl2LmNsYXNzTmFtZSA9ICdib3RNZXNzYWdlVG9vbEJhcic7XG5cbiAgICBjb25zdCBib3ROYW1lU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgXG4gICAgYm90TmFtZVNwYW4udGV4dENvbnRlbnQgPSBzZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRib3ROYW1lIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZTtcbiAgICBib3ROYW1lU3Bhbi5jbGFzc05hbWUgPSAnY2hhdGJvdE5hbWUnO1xuXG4gICAgY29uc3QgbWVzc2FnZUJsb2NrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbWVzc2FnZUJsb2NrRGl2LmNsYXNzTmFtZSA9ICdtZXNzYWdlQmxvY2snO1xuXG4gICAgY29uc3QgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmNsYXNzTmFtZSA9ICdjb21tYW5kQm90TWVzc2FnZSc7XG4gICAgZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2LmlubmVySFRNTCA9IG1lc3NhZ2U7XG5cbiAgICBtZXNzYWdlQmxvY2tEaXYuYXBwZW5kQ2hpbGQoZGlzcGxheUNvbW1hbmRCb3RNZXNzYWdlRGl2KTtcbiAgICBib3RNZXNzYWdlVG9vbEJhckRpdi5hcHBlbmRDaGlsZChib3ROYW1lU3Bhbik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChib3RNZXNzYWdlVG9vbEJhckRpdik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2tEaXYpO1xuXG4gICAgY29uc3QgaW5kZXggPSBtZXNzYWdlSGlzdG9yeS5sZW5ndGggLSAxO1xuXG4gICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2VCbG9ja0Rpdi5pbm5lckhUTUwsICdib3RNZXNzYWdlJywgc2V0dGluZ3MsIGluZGV4KTtcblxuICAgIHJldHVybiBib3RNZXNzYWdlRGl2O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheUVycm9yQm90TWVzc2FnZShwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBtZXNzYWdlSGlzdG9yeTogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9W10sIG1lc3NhZ2U6IHN0cmluZyl7XG4gICAgY29uc3QgYm90TWVzc2FnZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJvdE1lc3NhZ2VEaXYuY2xhc3NOYW1lID0gJ2JvdE1lc3NhZ2UnO1xuICAgIGJvdE1lc3NhZ2VEaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JUb0hleChzZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgfHxcbiAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yKS50cmltKCkpO1xuXG4gICAgY29uc3QgYm90TWVzc2FnZVRvb2xCYXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBib3RNZXNzYWdlVG9vbEJhckRpdi5jbGFzc05hbWUgPSAnYm90TWVzc2FnZVRvb2xCYXInO1xuXG4gICAgY29uc3QgYm90TmFtZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7IFxuICAgIGJvdE5hbWVTcGFuLnRleHRDb250ZW50ID0gc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90TmFtZSB8fCBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdGJvdE5hbWU7XG4gICAgYm90TmFtZVNwYW4uY2xhc3NOYW1lID0gJ2NoYXRib3ROYW1lJztcblxuICAgIGNvbnN0IG1lc3NhZ2VCbG9ja0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG1lc3NhZ2VCbG9ja0Rpdi5jbGFzc05hbWUgPSAnbWVzc2FnZUJsb2NrJztcblxuICAgIGNvbnN0IGRpc3BsYXlFcnJvckJvdE1lc3NhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXNwbGF5RXJyb3JCb3RNZXNzYWdlRGl2LmNsYXNzTmFtZSA9ICdlcnJvckJvdE1lc3NhZ2UnO1xuXG4gICAgY29uc3QgQm90UCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBCb3RQLnRleHRDb250ZW50ID0gbWVzc2FnZTtcblxuICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG5cbiAgICBtZXNzYWdlQmxvY2tEaXYuYXBwZW5kQ2hpbGQoZGlzcGxheUVycm9yQm90TWVzc2FnZURpdik7XG4gICAgZGlzcGxheUVycm9yQm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChCb3RQKTtcbiAgICBib3RNZXNzYWdlVG9vbEJhckRpdi5hcHBlbmRDaGlsZChib3ROYW1lU3Bhbik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChib3RNZXNzYWdlVG9vbEJhckRpdik7XG4gICAgYm90TWVzc2FnZURpdi5hcHBlbmRDaGlsZChtZXNzYWdlQmxvY2tEaXYpO1xuXG4gICAgY29uc3QgaW5kZXggPSBtZXNzYWdlSGlzdG9yeS5sZW5ndGggLSAxO1xuXG4gICAgYWRkTWVzc2FnZShwbHVnaW4sIG1lc3NhZ2VCbG9ja0Rpdi5pbm5lckhUTUwsICdib3RNZXNzYWdlJywgdGhpcy5zZXR0aW5ncywgaW5kZXgpO1xuXG4gICAgcmV0dXJuIGJvdE1lc3NhZ2VEaXY7XG59IiwgImltcG9ydCBCTU9HUFQsIHsgQk1PU2V0dGluZ3MgfSBmcm9tICdzcmMvbWFpbic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9tcHQocGx1Z2luOiBCTU9HUFQsIHNldHRpbmdzOiBCTU9TZXR0aW5ncykge1xuXG4gICAgaWYgKHNldHRpbmdzLnByb21wdHMucHJvbXB0LnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIGNvbnN0IHByb21wdEZpbGVQYXRoID0gc2V0dGluZ3MucHJvbXB0cy5wcm9tcHRGb2xkZXJQYXRoICsgJy8nICsgc2V0dGluZ3MucHJvbXB0cy5wcm9tcHQ7XG5cbiAgICB0cnkge1xuICAgICAgICAvLyBBd2FpdCB0aGUgcmVhZGluZyBvZiB0aGUgZmlsZSBhbmQgcmV0dXJuIGl0cyBjb250ZW50XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChwcm9tcHRGaWxlUGF0aCk7XG4gICAgICAgIC8vIFJlbW92ZSBZQU1MIGZyb250IG1hdHRlciBpZiBwcmVzZW50XG4gICAgICAgIGNvbnN0IGNsZWFyWWFtbENvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLy0tLVtcXHNcXFNdKz8tLS0vLCAnJykudHJpbSgpO1xuICAgICAgICByZXR1cm4gJ1xcblxcbicgKyBjbGVhcllhbWxDb250ZW50ICsgJ1xcblxcbic7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVhZGluZyBmaWxlICR7cHJvbXB0RmlsZVBhdGh9OmAsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7IFxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RpY2UsIHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBPbGxhbWEgfSBmcm9tICdvbGxhbWEnO1xuaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknO1xuaW1wb3J0IHsgQk1PU2V0dGluZ3MgfSBmcm9tICdzcmMvbWFpbic7XG5pbXBvcnQgeyBBTlRIUk9QSUNfTU9ERUxTLCBPUEVOQUlfTU9ERUxTIH0gZnJvbSAnc3JjL3ZpZXcnO1xuXG4vLyBSZW5hbWUgbm90ZSB0aXRsZSBiYXNlZCBvbiBzcGVjaWZpZWQgbW9kZWxcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE1vZGVsUmVuYW1lVGl0bGUoc2V0dGluZ3M6IEJNT1NldHRpbmdzLCByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQ6IHN0cmluZykge1xuICAgIGNvbnN0IGNsZWFyWWFtbENvbnRlbnQgPSByZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQucmVwbGFjZSgvLS0tW1xcc1xcU10rPy0tLS8sICcnKS50cmltKCk7XG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gYFlvdSBhcmUgYSB0aXRsZSBnZW5lcmF0b3IuIFlvdSB3aWxsIGdpdmUgc3VjY2luY3QgdGl0bGVzIHRoYXQgZG9lcyBub3QgY29udGFpbiBiYWNrc2xhc2hlcyxcbiAgICAgICAgICAgICAgICAgICAgZm9yd2FyZCBzbGFzaGVzLCBvciBjb2xvbnMuIE9ubHkgZ2VuZXJhdGUgYSB0aXRsZSBhcyB5b3VyIHJlc3BvbnNlIGZvcjpcXG5cXG5gO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24uUkVTVEFQSVVSTCAmJiBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBvbGxhbWEgPSBuZXcgT2xsYW1hKHsgaG9zdDogc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5SRVNUQVBJVVJMfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvbGxhbWEuZ2VuZXJhdGUoe1xuICAgICAgICAgICAgICAgICAgICBtb2RlbDogc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtOiBwcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHByb21wdDogY2xlYXJZYW1sQ29udGVudCArICdcXG5cXG4nLFxuICAgICAgICAgICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1fcHJlZGljdDogNDAsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCB0aXRsZSA9IHJlc3BvbnNlLnJlc3BvbnNlO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYmFja3NsYXNoZXMsIGZvcndhcmQgc2xhc2hlcywgY29sb25zLCBhbmQgcXVvdGVzXG4gICAgICAgICAgICAgICAgaWYgKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZSgvW1xcXFwvOlwiXS9nLCAnJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gdGl0bGU7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIGdlbmVyYXRpbmcgdGl0bGU6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgdGl0bGU6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ICAgICAgICBcbiAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTE1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkwgKyAnL2NoYXQvY29tcGxldGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3NldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLkFQSUtleX1gXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBwcm9tcHQgKyBjbGVhcllhbWxDb250ZW50fSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ1xcbid9XG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3Rva2VuczogNDAsXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgIFxuICAgICAgICAgICAgICAgIGxldCB0aXRsZSA9IHJlc3BvbnNlLmpzb24uY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYmFja3NsYXNoZXMsIGZvcndhcmQgc2xhc2hlcywgY29sb25zLCBhbmQgcXVvdGVzXG4gICAgICAgICAgICAgICAgaWYgKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZSgvW1xcXFwvOlwiXS9nLCAnJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aXRsZTtcbiAgICBcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFraW5nIEFQSSByZXF1ZXN0OicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKEFOVEhST1BJQ19NT0RFTFMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAneC1hcGkta2V5Jzogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW06IHByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGAke2NsZWFyWWFtbENvbnRlbnR9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiA0MCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUludChzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGl0bGUgPSByZXNwb25zZS5qc29uLmNvbnRlbnRbMF0udGV4dDtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBiYWNrc2xhc2hlcywgZm9yd2FyZCBzbGFzaGVzLCBjb2xvbnMsIGFuZCBxdW90ZXNcbiAgICAgICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKC9bXFxcXC86XCJdL2csICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShlcnJvcik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICB0cnkgeyAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgQVBJX0tFWSA9IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5BUElLZXk7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50czogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3RleHQ6IHByb21wdCArIGNsZWFyWWFtbENvbnRlbnR9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzL2dlbWluaS1wcm86Z2VuZXJhdGVDb250ZW50P2tleT0ke0FQSV9LRVl9YCxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCB0aXRsZSA9IHJlc3BvbnNlLmpzb24uY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGJhY2tzbGFzaGVzLCBmb3J3YXJkIHNsYXNoZXMsIGNvbG9ucywgYW5kIHF1b3Rlc1xuICAgICAgICAgICAgICAgIGlmICh0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZSA9IHRpdGxlLnJlcGxhY2UoL1tcXFxcLzpcIl0vZywgJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGl0bGU7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwubWlzdHJhbE1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL2FwaS5taXN0cmFsLmFpL3YxL2NoYXQvY29tcGxldGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3NldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuQVBJS2V5fWBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHByb21wdCArIGNsZWFyWWFtbENvbnRlbnR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnXFxuJ31cbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiA0MCxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gcmVzcG9uc2UuanNvbi5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBiYWNrc2xhc2hlcywgZm9yd2FyZCBzbGFzaGVzLCBjb2xvbnMsIGFuZCBxdW90ZXNcbiAgICAgICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKC9bXFxcXC86XCJdL2csICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKE9QRU5BSV9NT0RFTFMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkgfHwgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSkge1xuICAgICAgICAgICAgY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7XG4gICAgICAgICAgICAgICAgYXBpS2V5OiBzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuQVBJS2V5LFxuICAgICAgICAgICAgICAgIGJhc2VVUkw6IHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsLFxuICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5QWxsb3dCcm93c2VyOiB0cnVlLCAvLyBhcGlLZXkgaXMgc3RvcmVkIHdpdGhpbiBkYXRhLmpzb25cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBjaGF0Q29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgbWF4X3Rva2VuczogNDAsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogcHJvbXB0ICsgY2xlYXJZYW1sQ29udGVudH0sXG4gICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnJ31cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCB0aXRsZSA9IGNoYXRDb21wbGV0aW9uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGJhY2tzbGFzaGVzLCBmb3J3YXJkIHNsYXNoZXMsIGNvbG9ucywgYW5kIHF1b3Rlc1xuICAgICAgICAgICAgaWYgKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKC9bXFxcXC86XCJdL2csICcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIub3BlblJvdXRlck1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxL2NoYXQvY29tcGxldGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3NldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIuQVBJS2V5fWBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHByb21wdCArIGNsZWFyWWFtbENvbnRlbnR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnXFxuJ31cbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiA0MCxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gcmVzcG9uc2UuanNvbi5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBiYWNrc2xhc2hlcywgZm9yd2FyZCBzbGFzaGVzLCBjb2xvbnMsIGFuZCBxdW90ZXNcbiAgICAgICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKC9bXFxcXC86XCJdL2csICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgIFxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYWtpbmcgQVBJIHJlcXVlc3Q6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbW9kZWwgc2VsZWN0ZWQgZm9yIHJlbmFtaW5nIG5vdGUgdGl0bGUuIFBsZWFzZSBjaGVjayB5b3VyIHNldHRpbmdzLicpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SJyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvci5yZXNwb25zZT8uZGF0YT8uZXJyb3IgfHwgZXJyb3IubWVzc2FnZSk7XG4gICAgfVxufSIsICIvKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90b3R5cGUtYnVpbHRpbnMgKi9cbnZhciBnID1cbiAgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWxUaGlzKSB8fFxuICAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYpIHx8XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuICAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsKSB8fFxuICB7fVxuXG52YXIgc3VwcG9ydCA9IHtcbiAgc2VhcmNoUGFyYW1zOiAnVVJMU2VhcmNoUGFyYW1zJyBpbiBnLFxuICBpdGVyYWJsZTogJ1N5bWJvbCcgaW4gZyAmJiAnaXRlcmF0b3InIGluIFN5bWJvbCxcbiAgYmxvYjpcbiAgICAnRmlsZVJlYWRlcicgaW4gZyAmJlxuICAgICdCbG9iJyBpbiBnICYmXG4gICAgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9KSgpLFxuICBmb3JtRGF0YTogJ0Zvcm1EYXRhJyBpbiBnLFxuICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBnXG59XG5cbmZ1bmN0aW9uIGlzRGF0YVZpZXcob2JqKSB7XG4gIHJldHVybiBvYmogJiYgRGF0YVZpZXcucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yob2JqKVxufVxuXG5pZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICB2YXIgdmlld0NsYXNzZXMgPSBbXG4gICAgJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQ2NEFycmF5XSdcbiAgXVxuXG4gIHZhciBpc0FycmF5QnVmZmVyVmlldyA9XG4gICAgQXJyYXlCdWZmZXIuaXNWaWV3IHx8XG4gICAgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU5hbWUobmFtZSkge1xuICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZSA9IFN0cmluZyhuYW1lKVxuICB9XG4gIGlmICgvW15hLXowLTlcXC0jJCUmJyorLl5fYHx+IV0vaS50ZXN0KG5hbWUpIHx8IG5hbWUgPT09ICcnKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWU6IFwiJyArIG5hbWUgKyAnXCInKVxuICB9XG4gIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKClcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVmFsdWUodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgfVxuICByZXR1cm4gdmFsdWVcbn1cblxuLy8gQnVpbGQgYSBkZXN0cnVjdGl2ZSBpdGVyYXRvciBmb3IgdGhlIHZhbHVlIGxpc3RcbmZ1bmN0aW9uIGl0ZXJhdG9yRm9yKGl0ZW1zKSB7XG4gIHZhciBpdGVyYXRvciA9IHtcbiAgICBuZXh0OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGl0ZW1zLnNoaWZ0KClcbiAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGl0ZXJhdG9yXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGl0ZXJhdG9yXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBIZWFkZXJzKGhlYWRlcnMpIHtcbiAgdGhpcy5tYXAgPSB7fVxuXG4gIGlmIChoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykge1xuICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgfSwgdGhpcylcbiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGhlYWRlcnMpKSB7XG4gICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgaWYgKGhlYWRlci5sZW5ndGggIT0gMikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdIZWFkZXJzIGNvbnN0cnVjdG9yOiBleHBlY3RlZCBuYW1lL3ZhbHVlIHBhaXIgdG8gYmUgbGVuZ3RoIDIsIGZvdW5kJyArIGhlYWRlci5sZW5ndGgpXG4gICAgICB9XG4gICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKGhlYWRlcnMpIHtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIGhlYWRlcnNbbmFtZV0pXG4gICAgfSwgdGhpcylcbiAgfVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICB2YWx1ZSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB2YXIgb2xkVmFsdWUgPSB0aGlzLm1hcFtuYW1lXVxuICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUgKyAnLCAnICsgdmFsdWUgOiB2YWx1ZVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBmdW5jdGlvbihuYW1lKSB7XG4gIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24oY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgIGlmICh0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB0aGlzLm1hcFtuYW1lXSwgbmFtZSwgdGhpcylcbiAgICB9XG4gIH1cbn1cblxuSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKG5hbWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUudmFsdWVzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGl0ZW1zLnB1c2godmFsdWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgSGVhZGVycy5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXNcbn1cblxuZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICBpZiAoYm9keS5fbm9Cb2R5KSByZXR1cm5cbiAgaWYgKGJvZHkuYm9keVVzZWQpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gIH1cbiAgYm9keS5ib2R5VXNlZCA9IHRydWVcbn1cblxuZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVzb2x2ZShyZWFkZXIucmVzdWx0KVxuICAgIH1cbiAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KHJlYWRlci5lcnJvcilcbiAgICB9XG4gIH0pXG59XG5cbmZ1bmN0aW9uIHJlYWRCbG9iQXNBcnJheUJ1ZmZlcihibG9iKSB7XG4gIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gIHZhciBwcm9taXNlID0gZmlsZVJlYWRlclJlYWR5KHJlYWRlcilcbiAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpXG4gIHJldHVybiBwcm9taXNlXG59XG5cbmZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICB2YXIgbWF0Y2ggPSAvY2hhcnNldD0oW0EtWmEtejAtOV8tXSspLy5leGVjKGJsb2IudHlwZSlcbiAgdmFyIGVuY29kaW5nID0gbWF0Y2ggPyBtYXRjaFsxXSA6ICd1dGYtOCdcbiAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYiwgZW5jb2RpbmcpXG4gIHJldHVybiBwcm9taXNlXG59XG5cbmZ1bmN0aW9uIHJlYWRBcnJheUJ1ZmZlckFzVGV4dChidWYpIHtcbiAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYpXG4gIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICBjaGFyc1tpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodmlld1tpXSlcbiAgfVxuICByZXR1cm4gY2hhcnMuam9pbignJylcbn1cblxuZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gIGlmIChidWYuc2xpY2UpIHtcbiAgICByZXR1cm4gYnVmLnNsaWNlKDApXG4gIH0gZWxzZSB7XG4gICAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYuYnl0ZUxlbmd0aClcbiAgICB2aWV3LnNldChuZXcgVWludDhBcnJheShidWYpKVxuICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICB9XG59XG5cbmZ1bmN0aW9uIEJvZHkoKSB7XG4gIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG4gIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgIC8qXG4gICAgICBmZXRjaC1tb2NrIHdyYXBzIHRoZSBSZXNwb25zZSBvYmplY3QgaW4gYW4gRVM2IFByb3h5IHRvXG4gICAgICBwcm92aWRlIHVzZWZ1bCB0ZXN0IGhhcm5lc3MgZmVhdHVyZXMgc3VjaCBhcyBmbHVzaC4gSG93ZXZlciwgb25cbiAgICAgIEVTNSBicm93c2VycyB3aXRob3V0IGZldGNoIG9yIFByb3h5IHN1cHBvcnQgcG9sbHlmaWxscyBtdXN0IGJlIHVzZWQ7XG4gICAgICB0aGUgcHJveHktcG9sbHlmaWxsIGlzIHVuYWJsZSB0byBwcm94eSBhbiBhdHRyaWJ1dGUgdW5sZXNzIGl0IGV4aXN0c1xuICAgICAgb24gdGhlIG9iamVjdCBiZWZvcmUgdGhlIFByb3h5IGlzIGNyZWF0ZWQuIFRoaXMgY2hhbmdlIGVuc3VyZXNcbiAgICAgIFJlc3BvbnNlLmJvZHlVc2VkIGV4aXN0cyBvbiB0aGUgaW5zdGFuY2UsIHdoaWxlIG1haW50YWluaW5nIHRoZVxuICAgICAgc2VtYW50aWMgb2Ygc2V0dGluZyBSZXF1ZXN0LmJvZHlVc2VkIGluIHRoZSBjb25zdHJ1Y3RvciBiZWZvcmVcbiAgICAgIF9pbml0Qm9keSBpcyBjYWxsZWQuXG4gICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1hc3NpZ25cbiAgICB0aGlzLmJvZHlVc2VkID0gdGhpcy5ib2R5VXNlZFxuICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgIGlmICghYm9keSkge1xuICAgICAgdGhpcy5fbm9Cb2R5ID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keUJsb2IgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmZvcm1EYXRhICYmIEZvcm1EYXRhLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LnNlYXJjaFBhcmFtcyAmJiBVUkxTZWFyY2hQYXJhbXMucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keS50b1N0cmluZygpXG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSBidWZmZXJDbG9uZShib2R5LmJ1ZmZlcilcbiAgICAgIC8vIElFIDEwLTExIGNhbid0IGhhbmRsZSBhIERhdGFWaWV3IGJvZHkuXG4gICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlciAmJiAoQXJyYXlCdWZmZXIucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkgfHwgaXNBcnJheUJ1ZmZlclZpZXcoYm9keSkpKSB7XG4gICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSBidWZmZXJDbG9uZShib2R5KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYm9keSlcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpKSB7XG4gICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QmxvYiAmJiB0aGlzLl9ib2R5QmxvYi50eXBlKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsIHRoaXMuX2JvZHlCbG9iLnR5cGUpXG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keUFycmF5QnVmZmVyXSkpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgYmxvYicpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICB2YXIgaXNDb25zdW1lZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICBpZiAoaXNDb25zdW1lZCkge1xuICAgICAgICByZXR1cm4gaXNDb25zdW1lZFxuICAgICAgfSBlbHNlIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcodGhpcy5fYm9keUFycmF5QnVmZmVyKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFxuICAgICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlci5idWZmZXIuc2xpY2UoXG4gICAgICAgICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIuYnl0ZU9mZnNldCxcbiAgICAgICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlci5ieXRlT2Zmc2V0ICsgdGhpcy5fYm9keUFycmF5QnVmZmVyLmJ5dGVMZW5ndGhcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUFycmF5QnVmZmVyKVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICByZXR1cm4gdGhpcy5ibG9iKCkudGhlbihyZWFkQmxvYkFzQXJyYXlCdWZmZXIpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgYXMgQXJyYXlCdWZmZXInKVxuICAgIH1cbiAgfVxuXG4gIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZWFkQXJyYXlCdWZmZXJBc1RleHQodGhpcy5fYm9keUFycmF5QnVmZmVyKSlcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIHRleHQnKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oZGVjb2RlKVxuICAgIH1cbiAgfVxuXG4gIHRoaXMuanNvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbnZhciBtZXRob2RzID0gWydDT05ORUNUJywgJ0RFTEVURScsICdHRVQnLCAnSEVBRCcsICdPUFRJT05TJywgJ1BBVENIJywgJ1BPU1QnLCAnUFVUJywgJ1RSQUNFJ11cblxuZnVuY3Rpb24gbm9ybWFsaXplTWV0aG9kKG1ldGhvZCkge1xuICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gIHJldHVybiBtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSA/IHVwY2FzZWQgOiBtZXRob2Rcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJlcXVlc3QoaW5wdXQsIG9wdGlvbnMpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJlcXVlc3QpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUGxlYXNlIHVzZSB0aGUgXCJuZXdcIiBvcGVyYXRvciwgdGhpcyBET00gb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi4nKVxuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHlcblxuICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBSZXF1ZXN0KSB7XG4gICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKVxuICAgIH1cbiAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgIHRoaXMuY3JlZGVudGlhbHMgPSBpbnB1dC5jcmVkZW50aWFsc1xuICAgIGlmICghb3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IGlucHV0Lm1ldGhvZFxuICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICB0aGlzLnNpZ25hbCA9IGlucHV0LnNpZ25hbFxuICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgYm9keSA9IGlucHV0Ll9ib2R5SW5pdFxuICAgICAgaW5wdXQuYm9keVVzZWQgPSB0cnVlXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRoaXMudXJsID0gU3RyaW5nKGlucHV0KVxuICB9XG5cbiAgdGhpcy5jcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHMgfHwgdGhpcy5jcmVkZW50aWFscyB8fCAnc2FtZS1vcmlnaW4nXG4gIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgfVxuICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IHRoaXMubW9kZSB8fCBudWxsXG4gIHRoaXMuc2lnbmFsID0gb3B0aW9ucy5zaWduYWwgfHwgdGhpcy5zaWduYWwgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJ0Fib3J0Q29udHJvbGxlcicgaW4gZykge1xuICAgICAgdmFyIGN0cmwgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICByZXR1cm4gY3RybC5zaWduYWw7XG4gICAgfVxuICB9KCkpO1xuICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gIGlmICgodGhpcy5tZXRob2QgPT09ICdHRVQnIHx8IHRoaXMubWV0aG9kID09PSAnSEVBRCcpICYmIGJvZHkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gIH1cbiAgdGhpcy5faW5pdEJvZHkoYm9keSlcblxuICBpZiAodGhpcy5tZXRob2QgPT09ICdHRVQnIHx8IHRoaXMubWV0aG9kID09PSAnSEVBRCcpIHtcbiAgICBpZiAob3B0aW9ucy5jYWNoZSA9PT0gJ25vLXN0b3JlJyB8fCBvcHRpb25zLmNhY2hlID09PSAnbm8tY2FjaGUnKSB7XG4gICAgICAvLyBTZWFyY2ggZm9yIGEgJ18nIHBhcmFtZXRlciBpbiB0aGUgcXVlcnkgc3RyaW5nXG4gICAgICB2YXIgcmVQYXJhbVNlYXJjaCA9IC8oWz8mXSlfPVteJl0qL1xuICAgICAgaWYgKHJlUGFyYW1TZWFyY2gudGVzdCh0aGlzLnVybCkpIHtcbiAgICAgICAgLy8gSWYgaXQgYWxyZWFkeSBleGlzdHMgdGhlbiBzZXQgdGhlIHZhbHVlIHdpdGggdGhlIGN1cnJlbnQgdGltZVxuICAgICAgICB0aGlzLnVybCA9IHRoaXMudXJsLnJlcGxhY2UocmVQYXJhbVNlYXJjaCwgJyQxXz0nICsgbmV3IERhdGUoKS5nZXRUaW1lKCkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgYWRkIGEgbmV3ICdfJyBwYXJhbWV0ZXIgdG8gdGhlIGVuZCB3aXRoIHRoZSBjdXJyZW50IHRpbWVcbiAgICAgICAgdmFyIHJlUXVlcnlTdHJpbmcgPSAvXFw/L1xuICAgICAgICB0aGlzLnVybCArPSAocmVRdWVyeVN0cmluZy50ZXN0KHRoaXMudXJsKSA/ICcmJyA6ICc/JykgKyAnXz0nICsgbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBSZXF1ZXN0KHRoaXMsIHtib2R5OiB0aGlzLl9ib2R5SW5pdH0pXG59XG5cbmZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKClcbiAgYm9keVxuICAgIC50cmltKClcbiAgICAuc3BsaXQoJyYnKVxuICAgIC5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICByZXR1cm4gZm9ybVxufVxuXG5mdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICB2YXIgaGVhZGVycyA9IG5ldyBIZWFkZXJzKClcbiAgLy8gUmVwbGFjZSBpbnN0YW5jZXMgb2YgXFxyXFxuIGFuZCBcXG4gZm9sbG93ZWQgYnkgYXQgbGVhc3Qgb25lIHNwYWNlIG9yIGhvcml6b250YWwgdGFiIHdpdGggYSBzcGFjZVxuICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICB2YXIgcHJlUHJvY2Vzc2VkSGVhZGVycyA9IHJhd0hlYWRlcnMucmVwbGFjZSgvXFxyP1xcbltcXHQgXSsvZywgJyAnKVxuICAvLyBBdm9pZGluZyBzcGxpdCB2aWEgcmVnZXggdG8gd29yayBhcm91bmQgYSBjb21tb24gSUUxMSBidWcgd2l0aCB0aGUgY29yZS1qcyAzLjYuMCByZWdleCBwb2x5ZmlsbFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2l0aHViL2ZldGNoL2lzc3Vlcy83NDhcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzc1MVxuICBwcmVQcm9jZXNzZWRIZWFkZXJzXG4gICAgLnNwbGl0KCdcXHInKVxuICAgIC5tYXAoZnVuY3Rpb24oaGVhZGVyKSB7XG4gICAgICByZXR1cm4gaGVhZGVyLmluZGV4T2YoJ1xcbicpID09PSAwID8gaGVhZGVyLnN1YnN0cigxLCBoZWFkZXIubGVuZ3RoKSA6IGhlYWRlclxuICAgIH0pXG4gICAgLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgICB2YXIga2V5ID0gcGFydHMuc2hpZnQoKS50cmltKClcbiAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKGtleSwgdmFsdWUpXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdSZXNwb25zZSAnICsgZXJyb3IubWVzc2FnZSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIHJldHVybiBoZWFkZXJzXG59XG5cbkJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuZXhwb3J0IGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBSZXNwb25zZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQbGVhc2UgdXNlIHRoZSBcIm5ld1wiIG9wZXJhdG9yLCB0aGlzIERPTSBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLicpXG4gIH1cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IHt9XG4gIH1cblxuICB0aGlzLnR5cGUgPSAnZGVmYXVsdCdcbiAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1cyA9PT0gdW5kZWZpbmVkID8gMjAwIDogb3B0aW9ucy5zdGF0dXNcbiAgaWYgKHRoaXMuc3RhdHVzIDwgMjAwIHx8IHRoaXMuc3RhdHVzID4gNTk5KSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdSZXNwb25zZSc6IFRoZSBzdGF0dXMgcHJvdmlkZWQgKDApIGlzIG91dHNpZGUgdGhlIHJhbmdlIFsyMDAsIDU5OV0uXCIpXG4gIH1cbiAgdGhpcy5vayA9IHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDMwMFxuICB0aGlzLnN0YXR1c1RleHQgPSBvcHRpb25zLnN0YXR1c1RleHQgPT09IHVuZGVmaW5lZCA/ICcnIDogJycgKyBvcHRpb25zLnN0YXR1c1RleHRcbiAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICB0aGlzLnVybCA9IG9wdGlvbnMudXJsIHx8ICcnXG4gIHRoaXMuX2luaXRCb2R5KGJvZHlJbml0KVxufVxuXG5Cb2R5LmNhbGwoUmVzcG9uc2UucHJvdG90eXBlKVxuXG5SZXNwb25zZS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgc3RhdHVzVGV4dDogdGhpcy5zdGF0dXNUZXh0LFxuICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgdXJsOiB0aGlzLnVybFxuICB9KVxufVxuXG5SZXNwb25zZS5lcnJvciA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UobnVsbCwge3N0YXR1czogMjAwLCBzdGF0dXNUZXh0OiAnJ30pXG4gIHJlc3BvbnNlLm9rID0gZmFsc2VcbiAgcmVzcG9uc2Uuc3RhdHVzID0gMFxuICByZXNwb25zZS50eXBlID0gJ2Vycm9yJ1xuICByZXR1cm4gcmVzcG9uc2Vcbn1cblxudmFyIHJlZGlyZWN0U3RhdHVzZXMgPSBbMzAxLCAzMDIsIDMwMywgMzA3LCAzMDhdXG5cblJlc3BvbnNlLnJlZGlyZWN0ID0gZnVuY3Rpb24odXJsLCBzdGF0dXMpIHtcbiAgaWYgKHJlZGlyZWN0U3RhdHVzZXMuaW5kZXhPZihzdGF0dXMpID09PSAtMSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHN0YXR1cyBjb2RlJylcbiAgfVxuXG4gIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwge3N0YXR1czogc3RhdHVzLCBoZWFkZXJzOiB7bG9jYXRpb246IHVybH19KVxufVxuXG5leHBvcnQgdmFyIERPTUV4Y2VwdGlvbiA9IGcuRE9NRXhjZXB0aW9uXG50cnkge1xuICBuZXcgRE9NRXhjZXB0aW9uKClcbn0gY2F0Y2ggKGVycikge1xuICBET01FeGNlcHRpb24gPSBmdW5jdGlvbihtZXNzYWdlLCBuYW1lKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZVxuICAgIHRoaXMubmFtZSA9IG5hbWVcbiAgICB2YXIgZXJyb3IgPSBFcnJvcihtZXNzYWdlKVxuICAgIHRoaXMuc3RhY2sgPSBlcnJvci5zdGFja1xuICB9XG4gIERPTUV4Y2VwdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSlcbiAgRE9NRXhjZXB0aW9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IERPTUV4Y2VwdGlvblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmV0Y2goaW5wdXQsIGluaXQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoaW5wdXQsIGluaXQpXG5cbiAgICBpZiAocmVxdWVzdC5zaWduYWwgJiYgcmVxdWVzdC5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgcmV0dXJuIHJlamVjdChuZXcgRE9NRXhjZXB0aW9uKCdBYm9ydGVkJywgJ0Fib3J0RXJyb3InKSlcbiAgICB9XG5cbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcblxuICAgIGZ1bmN0aW9uIGFib3J0WGhyKCkge1xuICAgICAgeGhyLmFib3J0KClcbiAgICB9XG5cbiAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICB9XG4gICAgICAvLyBUaGlzIGNoZWNrIGlmIHNwZWNpZmljYWxseSBmb3Igd2hlbiBhIHVzZXIgZmV0Y2hlcyBhIGZpbGUgbG9jYWxseSBmcm9tIHRoZSBmaWxlIHN5c3RlbVxuICAgICAgLy8gT25seSBpZiB0aGUgc3RhdHVzIGlzIG91dCBvZiBhIG5vcm1hbCByYW5nZVxuICAgICAgaWYgKHJlcXVlc3QudXJsLmluZGV4T2YoJ2ZpbGU6Ly8nKSA9PT0gMCAmJiAoeGhyLnN0YXR1cyA8IDIwMCB8fCB4aHIuc3RhdHVzID4gNTk5KSkge1xuICAgICAgICBvcHRpb25zLnN0YXR1cyA9IDIwMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9wdGlvbnMuc3RhdHVzID0geGhyLnN0YXR1cztcbiAgICAgIH1cbiAgICAgIG9wdGlvbnMudXJsID0gJ3Jlc3BvbnNlVVJMJyBpbiB4aHIgPyB4aHIucmVzcG9uc2VVUkwgOiBvcHRpb25zLmhlYWRlcnMuZ2V0KCdYLVJlcXVlc3QtVVJMJylcbiAgICAgIHZhciBib2R5ID0gJ3Jlc3BvbnNlJyBpbiB4aHIgPyB4aHIucmVzcG9uc2UgOiB4aHIucmVzcG9uc2VUZXh0XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSlcbiAgICAgIH0sIDApXG4gICAgfVxuXG4gICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgZmFpbGVkJykpXG4gICAgICB9LCAwKVxuICAgIH1cblxuICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgdGltZWQgb3V0JykpXG4gICAgICB9LCAwKVxuICAgIH1cblxuICAgIHhoci5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IERPTUV4Y2VwdGlvbignQWJvcnRlZCcsICdBYm9ydEVycm9yJykpXG4gICAgICB9LCAwKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpeFVybCh1cmwpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB1cmwgPT09ICcnICYmIGcubG9jYXRpb24uaHJlZiA/IGcubG9jYXRpb24uaHJlZiA6IHVybFxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gdXJsXG4gICAgICB9XG4gICAgfVxuXG4gICAgeGhyLm9wZW4ocmVxdWVzdC5tZXRob2QsIGZpeFVybChyZXF1ZXN0LnVybCksIHRydWUpXG5cbiAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZVxuICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ29taXQnKSB7XG4gICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyKSB7XG4gICAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYidcbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIHN1cHBvcnQuYXJyYXlCdWZmZXJcbiAgICAgICkge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJ1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbml0ICYmIHR5cGVvZiBpbml0LmhlYWRlcnMgPT09ICdvYmplY3QnICYmICEoaW5pdC5oZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycyB8fCAoZy5IZWFkZXJzICYmIGluaXQuaGVhZGVycyBpbnN0YW5jZW9mIGcuSGVhZGVycykpKSB7XG4gICAgICB2YXIgbmFtZXMgPSBbXTtcbiAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGluaXQuaGVhZGVycykuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgIG5hbWVzLnB1c2gobm9ybWFsaXplTmFtZShuYW1lKSlcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIobmFtZSwgbm9ybWFsaXplVmFsdWUoaW5pdC5oZWFkZXJzW25hbWVdKSlcbiAgICAgIH0pXG4gICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgICBpZiAobmFtZXMuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmVxdWVzdC5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIobmFtZSwgdmFsdWUpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LnNpZ25hbCkge1xuICAgICAgcmVxdWVzdC5zaWduYWwuYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydFhocilcblxuICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBET05FIChzdWNjZXNzIG9yIGZhaWx1cmUpXG4gICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgIHJlcXVlc3Quc2lnbmFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgYWJvcnRYaHIpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB4aHIuc2VuZCh0eXBlb2YgcmVxdWVzdC5fYm9keUluaXQgPT09ICd1bmRlZmluZWQnID8gbnVsbCA6IHJlcXVlc3QuX2JvZHlJbml0KVxuICB9KVxufVxuXG5mZXRjaC5wb2x5ZmlsbCA9IHRydWVcblxuaWYgKCFnLmZldGNoKSB7XG4gIGcuZmV0Y2ggPSBmZXRjaFxuICBnLkhlYWRlcnMgPSBIZWFkZXJzXG4gIGcuUmVxdWVzdCA9IFJlcXVlc3RcbiAgZy5SZXNwb25zZSA9IFJlc3BvbnNlXG59XG4iLCAiaW1wb3J0ICd3aGF0d2ctZmV0Y2gnO1xuXG5jb25zdCB2ZXJzaW9uID0gXCIwLjUuMVwiO1xuXG5jbGFzcyBSZXNwb25zZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihlcnJvciwgc3RhdHVzX2NvZGUpIHtcbiAgICBzdXBlcihlcnJvcik7XG4gICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgIHRoaXMuc3RhdHVzX2NvZGUgPSBzdGF0dXNfY29kZTtcbiAgICB0aGlzLm5hbWUgPSBcIlJlc3BvbnNlRXJyb3JcIjtcbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIFJlc3BvbnNlRXJyb3IpO1xuICAgIH1cbiAgfVxufVxuY29uc3QgY2hlY2tPayA9IGFzeW5jIChyZXNwb25zZSkgPT4ge1xuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgbGV0IG1lc3NhZ2UgPSBgRXJyb3IgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YDtcbiAgICBsZXQgZXJyb3JEYXRhID0gbnVsbDtcbiAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIik/LmluY2x1ZGVzKFwiYXBwbGljYXRpb24vanNvblwiKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBtZXNzYWdlID0gZXJyb3JEYXRhLmVycm9yIHx8IG1lc3NhZ2U7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBwYXJzZSBlcnJvciByZXNwb25zZSBhcyBKU09OXCIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkdldHRpbmcgdGV4dCBmcm9tIHJlc3BvbnNlXCIpO1xuICAgICAgICBjb25zdCB0ZXh0UmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIG1lc3NhZ2UgPSB0ZXh0UmVzcG9uc2UgfHwgbWVzc2FnZTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGdldCB0ZXh0IGZyb20gZXJyb3IgcmVzcG9uc2VcIik7XG4gICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBSZXNwb25zZUVycm9yKG1lc3NhZ2UsIHJlc3BvbnNlLnN0YXR1cyk7XG4gIH1cbn07XG5mdW5jdGlvbiBnZXRQbGF0Zm9ybSgpIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93Lm5hdmlnYXRvcikge1xuICAgIHJldHVybiBgJHt3aW5kb3cubmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKCl9IEJyb3dzZXIvJHtuYXZpZ2F0b3IudXNlckFnZW50fTtgO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgcmV0dXJuIGAke3Byb2Nlc3MuYXJjaH0gJHtwcm9jZXNzLnBsYXRmb3JtfSBOb2RlLmpzLyR7cHJvY2Vzcy52ZXJzaW9ufWA7XG4gIH1cbiAgcmV0dXJuIFwiXCI7XG59XG5jb25zdCBmZXRjaFdpdGhIZWFkZXJzID0gYXN5bmMgKGZldGNoLCB1cmwsIG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCBkZWZhdWx0SGVhZGVycyA9IHtcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIFwiVXNlci1BZ2VudFwiOiBgb2xsYW1hLWpzLyR7dmVyc2lvbn0gKCR7Z2V0UGxhdGZvcm0oKX0pYFxuICB9O1xuICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgIG9wdGlvbnMuaGVhZGVycyA9IHt9O1xuICB9XG4gIG9wdGlvbnMuaGVhZGVycyA9IHtcbiAgICAuLi5kZWZhdWx0SGVhZGVycyxcbiAgICAuLi5vcHRpb25zLmhlYWRlcnNcbiAgfTtcbiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucyk7XG59O1xuY29uc3QgZ2V0ID0gYXN5bmMgKGZldGNoLCBob3N0KSA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hXaXRoSGVhZGVycyhmZXRjaCwgaG9zdCk7XG4gIGF3YWl0IGNoZWNrT2socmVzcG9uc2UpO1xuICByZXR1cm4gcmVzcG9uc2U7XG59O1xuY29uc3QgaGVhZCA9IGFzeW5jIChmZXRjaCwgaG9zdCkgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoV2l0aEhlYWRlcnMoZmV0Y2gsIGhvc3QsIHtcbiAgICBtZXRob2Q6IFwiSEVBRFwiXG4gIH0pO1xuICBhd2FpdCBjaGVja09rKHJlc3BvbnNlKTtcbiAgcmV0dXJuIHJlc3BvbnNlO1xufTtcbmNvbnN0IHBvc3QgPSBhc3luYyAoZmV0Y2gsIGhvc3QsIGRhdGEsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgaXNSZWNvcmQgPSAoaW5wdXQpID0+IHtcbiAgICByZXR1cm4gaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ID09PSBcIm9iamVjdFwiICYmICFBcnJheS5pc0FycmF5KGlucHV0KTtcbiAgfTtcbiAgY29uc3QgZm9ybWF0dGVkRGF0YSA9IGlzUmVjb3JkKGRhdGEpID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiBkYXRhO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoV2l0aEhlYWRlcnMoZmV0Y2gsIGhvc3QsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IGZvcm1hdHRlZERhdGEsXG4gICAgc2lnbmFsOiBvcHRpb25zPy5zaWduYWxcbiAgfSk7XG4gIGF3YWl0IGNoZWNrT2socmVzcG9uc2UpO1xuICByZXR1cm4gcmVzcG9uc2U7XG59O1xuY29uc3QgZGVsID0gYXN5bmMgKGZldGNoLCBob3N0LCBkYXRhKSA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hXaXRoSGVhZGVycyhmZXRjaCwgaG9zdCwge1xuICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICB9KTtcbiAgYXdhaXQgY2hlY2tPayhyZXNwb25zZSk7XG4gIHJldHVybiByZXNwb25zZTtcbn07XG5jb25zdCBwYXJzZUpTT04gPSBhc3luYyBmdW5jdGlvbiogKGl0cikge1xuICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIik7XG4gIGxldCBidWZmZXIgPSBcIlwiO1xuICBjb25zdCByZWFkZXIgPSBpdHIuZ2V0UmVhZGVyKCk7XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgY29uc3QgeyBkb25lLCB2YWx1ZTogY2h1bmsgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgaWYgKGRvbmUpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUoY2h1bmspO1xuICAgIGNvbnN0IHBhcnRzID0gYnVmZmVyLnNwbGl0KFwiXFxuXCIpO1xuICAgIGJ1ZmZlciA9IHBhcnRzLnBvcCgpID8/IFwiXCI7XG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICB5aWVsZCBKU09OLnBhcnNlKHBhcnQpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiaW52YWxpZCBqc29uOiBcIiwgcGFydCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgcGFydCBvZiBidWZmZXIuc3BsaXQoXCJcXG5cIikuZmlsdGVyKChwKSA9PiBwICE9PSBcIlwiKSkge1xuICAgIHRyeSB7XG4gICAgICB5aWVsZCBKU09OLnBhcnNlKHBhcnQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJpbnZhbGlkIGpzb246IFwiLCBwYXJ0KTtcbiAgICB9XG4gIH1cbn07XG5jb25zdCBmb3JtYXRIb3N0ID0gKGhvc3QpID0+IHtcbiAgaWYgKCFob3N0KSB7XG4gICAgcmV0dXJuIFwiaHR0cDovLzEyNy4wLjAuMToxMTQzNFwiO1xuICB9XG4gIGxldCBpc0V4cGxpY2l0UHJvdG9jb2wgPSBob3N0LmluY2x1ZGVzKFwiOi8vXCIpO1xuICBpZiAoaG9zdC5zdGFydHNXaXRoKFwiOlwiKSkge1xuICAgIGhvc3QgPSBgaHR0cDovLzEyNy4wLjAuMSR7aG9zdH1gO1xuICAgIGlzRXhwbGljaXRQcm90b2NvbCA9IGZhbHNlO1xuICB9XG4gIGlmICghaXNFeHBsaWNpdFByb3RvY29sKSB7XG4gICAgaG9zdCA9IGBodHRwOi8vJHtob3N0fWA7XG4gIH1cbiAgY29uc3QgdXJsID0gbmV3IFVSTChob3N0KTtcbiAgbGV0IHBvcnQgPSB1cmwucG9ydDtcbiAgaWYgKCFwb3J0KSB7XG4gICAgaWYgKCFpc0V4cGxpY2l0UHJvdG9jb2wpIHtcbiAgICAgIHBvcnQgPSBcIjExNDM0XCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvcnQgPSB1cmwucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIjQ0M1wiIDogXCI4MFwiO1xuICAgIH1cbiAgfVxuICBsZXQgZm9ybWF0dGVkSG9zdCA9IGAke3VybC5wcm90b2NvbH0vLyR7dXJsLmhvc3RuYW1lfToke3BvcnR9JHt1cmwucGF0aG5hbWV9YDtcbiAgaWYgKGZvcm1hdHRlZEhvc3QuZW5kc1dpdGgoXCIvXCIpKSB7XG4gICAgZm9ybWF0dGVkSG9zdCA9IGZvcm1hdHRlZEhvc3Quc2xpY2UoMCwgLTEpO1xuICB9XG4gIHJldHVybiBmb3JtYXR0ZWRIb3N0O1xufTtcblxudmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3B1YmxpY0ZpZWxkID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBfX2RlZk5vcm1hbFByb3Aob2JqLCB0eXBlb2Yga2V5ICE9PSBcInN5bWJvbFwiID8ga2V5ICsgXCJcIiA6IGtleSwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xubGV0IE9sbGFtYSQxID0gY2xhc3MgT2xsYW1hIHtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImNvbmZpZ1wiKTtcbiAgICBfX3B1YmxpY0ZpZWxkKHRoaXMsIFwiZmV0Y2hcIik7XG4gICAgX19wdWJsaWNGaWVsZCh0aGlzLCBcImFib3J0Q29udHJvbGxlclwiKTtcbiAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IFwiXCJcbiAgICB9O1xuICAgIGlmICghY29uZmlnPy5wcm94eSkge1xuICAgICAgdGhpcy5jb25maWcuaG9zdCA9IGZvcm1hdEhvc3QoY29uZmlnPy5ob3N0ID8/IFwiaHR0cDovLzEyNy4wLjAuMToxMTQzNFwiKTtcbiAgICB9XG4gICAgdGhpcy5mZXRjaCA9IGZldGNoO1xuICAgIGlmIChjb25maWc/LmZldGNoICE9IG51bGwpIHtcbiAgICAgIHRoaXMuZmV0Y2ggPSBjb25maWcuZmV0Y2g7XG4gICAgfVxuICAgIHRoaXMuYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICB9XG4gIC8vIEFib3J0IGFueSBvbmdvaW5nIHJlcXVlc3RzIHRvIE9sbGFtYVxuICBhYm9ydCgpIHtcbiAgICB0aGlzLmFib3J0Q29udHJvbGxlci5hYm9ydCgpO1xuICAgIHRoaXMuYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICB9XG4gIGFzeW5jIHByb2Nlc3NTdHJlYW1hYmxlUmVxdWVzdChlbmRwb2ludCwgcmVxdWVzdCkge1xuICAgIHJlcXVlc3Quc3RyZWFtID0gcmVxdWVzdC5zdHJlYW0gPz8gZmFsc2U7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwb3N0KFxuICAgICAgdGhpcy5mZXRjaCxcbiAgICAgIGAke3RoaXMuY29uZmlnLmhvc3R9L2FwaS8ke2VuZHBvaW50fWAsXG4gICAgICB7XG4gICAgICAgIC4uLnJlcXVlc3RcbiAgICAgIH0sXG4gICAgICB7IHNpZ25hbDogdGhpcy5hYm9ydENvbnRyb2xsZXIuc2lnbmFsIH1cbiAgICApO1xuICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBib2R5XCIpO1xuICAgIH1cbiAgICBjb25zdCBpdHIgPSBwYXJzZUpTT04ocmVzcG9uc2UuYm9keSk7XG4gICAgaWYgKHJlcXVlc3Quc3RyZWFtKSB7XG4gICAgICByZXR1cm4gYXN5bmMgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgZm9yIGF3YWl0IChjb25zdCBtZXNzYWdlIG9mIGl0cikge1xuICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gbWVzc2FnZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UuZXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB5aWVsZCBtZXNzYWdlO1xuICAgICAgICAgIGlmIChtZXNzYWdlLmRvbmUgfHwgbWVzc2FnZS5zdGF0dXMgPT09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRpZCBub3QgcmVjZWl2ZSBkb25lIG9yIHN1Y2Nlc3MgcmVzcG9uc2UgaW4gc3RyZWFtLlwiKTtcbiAgICAgIH0oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IGl0ci5uZXh0KCk7XG4gICAgICBpZiAoIW1lc3NhZ2UudmFsdWUuZG9uZSAmJiBtZXNzYWdlLnZhbHVlLnN0YXR1cyAhPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgYSBjb21wbGV0ZWQgcmVzcG9uc2UuXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1lc3NhZ2UudmFsdWU7XG4gICAgfVxuICB9XG4gIGFzeW5jIGVuY29kZUltYWdlKGltYWdlKSB7XG4gICAgaWYgKHR5cGVvZiBpbWFnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgdWludDhBcnJheSA9IG5ldyBVaW50OEFycmF5KGltYWdlKTtcbiAgICAgIGNvbnN0IG51bWJlckFycmF5ID0gQXJyYXkuZnJvbSh1aW50OEFycmF5KTtcbiAgICAgIGNvbnN0IGJhc2U2NFN0cmluZyA9IGJ0b2EoU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBudW1iZXJBcnJheSkpO1xuICAgICAgcmV0dXJuIGJhc2U2NFN0cmluZztcbiAgICB9XG4gICAgcmV0dXJuIGltYWdlO1xuICB9XG4gIGFzeW5jIGdlbmVyYXRlKHJlcXVlc3QpIHtcbiAgICBpZiAocmVxdWVzdC5pbWFnZXMpIHtcbiAgICAgIHJlcXVlc3QuaW1hZ2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdC5pbWFnZXMubWFwKHRoaXMuZW5jb2RlSW1hZ2UuYmluZCh0aGlzKSkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzU3RyZWFtYWJsZVJlcXVlc3QoXCJnZW5lcmF0ZVwiLCByZXF1ZXN0KTtcbiAgfVxuICBhc3luYyBjaGF0KHJlcXVlc3QpIHtcbiAgICBpZiAocmVxdWVzdC5tZXNzYWdlcykge1xuICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHJlcXVlc3QubWVzc2FnZXMpIHtcbiAgICAgICAgaWYgKG1lc3NhZ2UuaW1hZ2VzKSB7XG4gICAgICAgICAgbWVzc2FnZS5pbWFnZXMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgIG1lc3NhZ2UuaW1hZ2VzLm1hcCh0aGlzLmVuY29kZUltYWdlLmJpbmQodGhpcykpXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzU3RyZWFtYWJsZVJlcXVlc3QoXCJjaGF0XCIsIHJlcXVlc3QpO1xuICB9XG4gIGFzeW5jIGNyZWF0ZShyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvY2Vzc1N0cmVhbWFibGVSZXF1ZXN0KFwiY3JlYXRlXCIsIHtcbiAgICAgIG5hbWU6IHJlcXVlc3QubW9kZWwsXG4gICAgICBzdHJlYW06IHJlcXVlc3Quc3RyZWFtLFxuICAgICAgbW9kZWxmaWxlOiByZXF1ZXN0Lm1vZGVsZmlsZSxcbiAgICAgIHF1YW50aXplOiByZXF1ZXN0LnF1YW50aXplXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgcHVsbChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvY2Vzc1N0cmVhbWFibGVSZXF1ZXN0KFwicHVsbFwiLCB7XG4gICAgICBuYW1lOiByZXF1ZXN0Lm1vZGVsLFxuICAgICAgc3RyZWFtOiByZXF1ZXN0LnN0cmVhbSxcbiAgICAgIGluc2VjdXJlOiByZXF1ZXN0Lmluc2VjdXJlXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgcHVzaChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHRoaXMucHJvY2Vzc1N0cmVhbWFibGVSZXF1ZXN0KFwicHVzaFwiLCB7XG4gICAgICBuYW1lOiByZXF1ZXN0Lm1vZGVsLFxuICAgICAgc3RyZWFtOiByZXF1ZXN0LnN0cmVhbSxcbiAgICAgIGluc2VjdXJlOiByZXF1ZXN0Lmluc2VjdXJlXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgZGVsZXRlKHJlcXVlc3QpIHtcbiAgICBhd2FpdCBkZWwodGhpcy5mZXRjaCwgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL2RlbGV0ZWAsIHtcbiAgICAgIG5hbWU6IHJlcXVlc3QubW9kZWxcbiAgICB9KTtcbiAgICByZXR1cm4geyBzdGF0dXM6IFwic3VjY2Vzc1wiIH07XG4gIH1cbiAgYXN5bmMgY29weShyZXF1ZXN0KSB7XG4gICAgYXdhaXQgcG9zdCh0aGlzLmZldGNoLCBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvY29weWAsIHsgLi4ucmVxdWVzdCB9KTtcbiAgICByZXR1cm4geyBzdGF0dXM6IFwic3VjY2Vzc1wiIH07XG4gIH1cbiAgYXN5bmMgbGlzdCgpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldCh0aGlzLmZldGNoLCBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvdGFnc2ApO1xuICAgIGNvbnN0IGxpc3RSZXNwb25zZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICByZXR1cm4gbGlzdFJlc3BvbnNlO1xuICB9XG4gIGFzeW5jIHNob3cocmVxdWVzdCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcG9zdCh0aGlzLmZldGNoLCBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvc2hvd2AsIHtcbiAgICAgIC4uLnJlcXVlc3RcbiAgICB9KTtcbiAgICBjb25zdCBzaG93UmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgcmV0dXJuIHNob3dSZXNwb25zZTtcbiAgfVxuICBhc3luYyBlbWJlZGRpbmdzKHJlcXVlc3QpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBvc3QodGhpcy5mZXRjaCwgYCR7dGhpcy5jb25maWcuaG9zdH0vYXBpL2VtYmVkZGluZ3NgLCB7XG4gICAgICAuLi5yZXF1ZXN0XG4gICAgfSk7XG4gICAgY29uc3QgZW1iZWRkaW5nc1Jlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBlbWJlZGRpbmdzUmVzcG9uc2U7XG4gIH1cbn07XG5jb25zdCBicm93c2VyID0gbmV3IE9sbGFtYSQxKCk7XG5cbmV4cG9ydCB7IE9sbGFtYSQxIGFzIE8sIGJyb3dzZXIgYXMgYiwgaGVhZCBhcyBoLCBwb3N0IGFzIHAgfTtcbiIsICJpbXBvcnQgeyBPIGFzIE9sbGFtYSQxLCBoIGFzIGhlYWQsIHAgYXMgcG9zdCB9IGZyb20gJy4vc2hhcmVkL29sbGFtYS4xNGU1ODY1Mi5tanMnO1xuaW1wb3J0IGZzLCB7IHByb21pc2VzLCBjcmVhdGVSZWFkU3RyZWFtIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHsgcmVzb2x2ZSwgam9pbiwgZGlybmFtZSB9IGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgeyBob21lZGlyIH0gZnJvbSAnb3MnO1xuaW1wb3J0ICd3aGF0d2ctZmV0Y2gnO1xuXG5jbGFzcyBPbGxhbWEgZXh0ZW5kcyBPbGxhbWEkMSB7XG4gIGFzeW5jIGVuY29kZUltYWdlKGltYWdlKSB7XG4gICAgaWYgKHR5cGVvZiBpbWFnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgcmVzdWx0ID0gQnVmZmVyLmZyb20oaW1hZ2UpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGltYWdlKSkge1xuICAgICAgICBjb25zdCBmaWxlQnVmZmVyID0gYXdhaXQgcHJvbWlzZXMucmVhZEZpbGUocmVzb2x2ZShpbWFnZSkpO1xuICAgICAgICByZXR1cm4gQnVmZmVyLmZyb20oZmlsZUJ1ZmZlcikudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgfVxuICAgIHJldHVybiBpbWFnZTtcbiAgfVxuICBhc3luYyBwYXJzZU1vZGVsZmlsZShtb2RlbGZpbGUsIG1mRGlyID0gcHJvY2Vzcy5jd2QoKSkge1xuICAgIGNvbnN0IG91dCA9IFtdO1xuICAgIGNvbnN0IGxpbmVzID0gbW9kZWxmaWxlLnNwbGl0KFwiXFxuXCIpO1xuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgY29uc3QgW2NvbW1hbmQsIGFyZ3NdID0gbGluZS5zcGxpdChcIiBcIiwgMik7XG4gICAgICBpZiAoW1wiRlJPTVwiLCBcIkFEQVBURVJcIl0uaW5jbHVkZXMoY29tbWFuZC50b1VwcGVyQ2FzZSgpKSkge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5yZXNvbHZlUGF0aChhcmdzLnRyaW0oKSwgbWZEaXIpO1xuICAgICAgICBpZiAoYXdhaXQgdGhpcy5maWxlRXhpc3RzKHBhdGgpKSB7XG4gICAgICAgICAgb3V0LnB1c2goYCR7Y29tbWFuZH0gQCR7YXdhaXQgdGhpcy5jcmVhdGVCbG9iKHBhdGgpfWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dC5wdXNoKGAke2NvbW1hbmR9ICR7YXJnc31gKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3V0LnB1c2gobGluZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQuam9pbihcIlxcblwiKTtcbiAgfVxuICByZXNvbHZlUGF0aChpbnB1dFBhdGgsIG1mRGlyKSB7XG4gICAgaWYgKGlucHV0UGF0aC5zdGFydHNXaXRoKFwiflwiKSkge1xuICAgICAgcmV0dXJuIGpvaW4oaG9tZWRpcigpLCBpbnB1dFBhdGguc2xpY2UoMSkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZShtZkRpciwgaW5wdXRQYXRoKTtcbiAgfVxuICBhc3luYyBmaWxlRXhpc3RzKHBhdGgpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHJvbWlzZXMuYWNjZXNzKHBhdGgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGFzeW5jIGNyZWF0ZUJsb2IocGF0aCkge1xuICAgIGlmICh0eXBlb2YgUmVhZGFibGVTdHJlYW0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0cmVhbWluZyB1cGxvYWRzIGFyZSBub3Qgc3VwcG9ydGVkIGluIHRoaXMgZW52aXJvbm1lbnQuXCIpO1xuICAgIH1cbiAgICBjb25zdCBmaWxlU3RyZWFtID0gY3JlYXRlUmVhZFN0cmVhbShwYXRoKTtcbiAgICBjb25zdCBzaGEyNTZzdW0gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZTIsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgaGFzaCA9IGNyZWF0ZUhhc2goXCJzaGEyNTZcIik7XG4gICAgICBmaWxlU3RyZWFtLm9uKFwiZGF0YVwiLCAoZGF0YSkgPT4gaGFzaC51cGRhdGUoZGF0YSkpO1xuICAgICAgZmlsZVN0cmVhbS5vbihcImVuZFwiLCAoKSA9PiByZXNvbHZlMihoYXNoLmRpZ2VzdChcImhleFwiKSkpO1xuICAgICAgZmlsZVN0cmVhbS5vbihcImVycm9yXCIsIHJlamVjdCk7XG4gICAgfSk7XG4gICAgY29uc3QgZGlnZXN0ID0gYHNoYTI1Njoke3NoYTI1NnN1bX1gO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBoZWFkKHRoaXMuZmV0Y2gsIGAke3RoaXMuY29uZmlnLmhvc3R9L2FwaS9ibG9icy8ke2RpZ2VzdH1gKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yICYmIGUubWVzc2FnZS5pbmNsdWRlcyhcIjQwNFwiKSkge1xuICAgICAgICBjb25zdCByZWFkYWJsZVN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgICAgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICAgICAgZmlsZVN0cmVhbS5vbihcImRhdGFcIiwgKGNodW5rKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZpbGVTdHJlYW0ub24oXCJlbmRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZpbGVTdHJlYW0ub24oXCJlcnJvclwiLCAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHBvc3QoXG4gICAgICAgICAgdGhpcy5mZXRjaCxcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5ob3N0fS9hcGkvYmxvYnMvJHtkaWdlc3R9YCxcbiAgICAgICAgICByZWFkYWJsZVN0cmVhbVxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRpZ2VzdDtcbiAgfVxuICBhc3luYyBjcmVhdGUocmVxdWVzdCkge1xuICAgIGxldCBtb2RlbGZpbGVDb250ZW50ID0gXCJcIjtcbiAgICBpZiAocmVxdWVzdC5wYXRoKSB7XG4gICAgICBtb2RlbGZpbGVDb250ZW50ID0gYXdhaXQgcHJvbWlzZXMucmVhZEZpbGUocmVxdWVzdC5wYXRoLCB7IGVuY29kaW5nOiBcInV0ZjhcIiB9KTtcbiAgICAgIG1vZGVsZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLnBhcnNlTW9kZWxmaWxlKFxuICAgICAgICBtb2RlbGZpbGVDb250ZW50LFxuICAgICAgICBkaXJuYW1lKHJlcXVlc3QucGF0aClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0Lm1vZGVsZmlsZSkge1xuICAgICAgbW9kZWxmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMucGFyc2VNb2RlbGZpbGUocmVxdWVzdC5tb2RlbGZpbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNdXN0IHByb3ZpZGUgZWl0aGVyIHBhdGggb3IgbW9kZWxmaWxlIHRvIGNyZWF0ZSBhIG1vZGVsXCIpO1xuICAgIH1cbiAgICByZXF1ZXN0Lm1vZGVsZmlsZSA9IG1vZGVsZmlsZUNvbnRlbnQ7XG4gICAgaWYgKHJlcXVlc3Quc3RyZWFtKSB7XG4gICAgICByZXR1cm4gc3VwZXIuY3JlYXRlKHJlcXVlc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc3VwZXIuY3JlYXRlKHJlcXVlc3QpO1xuICAgIH1cbiAgfVxufVxuY29uc3QgaW5kZXggPSBuZXcgT2xsYW1hKCk7XG5cbmV4cG9ydCB7IE9sbGFtYSwgaW5kZXggYXMgZGVmYXVsdCB9O1xuIiwgImV4cG9ydCBjb25zdCBWRVJTSU9OID0gJzQuNi4wJzsgLy8geC1yZWxlYXNlLXBsZWFzZS12ZXJzaW9uXG4iLCAiaW1wb3J0IHR5cGUgeyBSZXNwb25zZSB9IGZyb20gJy4vX3NoaW1zL2ZldGNoLmpzJztcblxudHlwZSBCeXRlcyA9IHN0cmluZyB8IEFycmF5QnVmZmVyIHwgVWludDhBcnJheSB8IEJ1ZmZlciB8IG51bGwgfCB1bmRlZmluZWQ7XG5cbnR5cGUgU2VydmVyU2VudEV2ZW50ID0ge1xuICBldmVudDogc3RyaW5nIHwgbnVsbDtcbiAgZGF0YTogc3RyaW5nO1xuICByYXc6IHN0cmluZ1tdO1xufTtcblxuZXhwb3J0IGNsYXNzIFN0cmVhbTxJdGVtPiBpbXBsZW1lbnRzIEFzeW5jSXRlcmFibGU8SXRlbT4ge1xuICBjb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXI7XG5cbiAgcHJpdmF0ZSByZXNwb25zZTogUmVzcG9uc2U7XG4gIHByaXZhdGUgZGVjb2RlcjogU1NFRGVjb2RlcjtcblxuICBjb25zdHJ1Y3RvcihyZXNwb25zZTogUmVzcG9uc2UsIGNvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlcikge1xuICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICB0aGlzLmNvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xuICAgIHRoaXMuZGVjb2RlciA9IG5ldyBTU0VEZWNvZGVyKCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jICppdGVyTWVzc2FnZXMoKTogQXN5bmNHZW5lcmF0b3I8U2VydmVyU2VudEV2ZW50LCB2b2lkLCB1bmtub3duPiB7XG4gICAgaWYgKCF0aGlzLnJlc3BvbnNlLmJvZHkpIHtcbiAgICAgIHRoaXMuY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlbXB0ZWQgdG8gaXRlcmF0ZSBvdmVyIGEgcmVzcG9uc2Ugd2l0aCBubyBib2R5YCk7XG4gICAgfVxuICAgIGNvbnN0IGxpbmVEZWNvZGVyID0gbmV3IExpbmVEZWNvZGVyKCk7XG5cbiAgICBjb25zdCBpdGVyID0gcmVhZGFibGVTdHJlYW1Bc3luY0l0ZXJhYmxlPEJ5dGVzPih0aGlzLnJlc3BvbnNlLmJvZHkpO1xuICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2YgaXRlcikge1xuICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVEZWNvZGVyLmRlY29kZShjaHVuaykpIHtcbiAgICAgICAgY29uc3Qgc3NlID0gdGhpcy5kZWNvZGVyLmRlY29kZShsaW5lKTtcbiAgICAgICAgaWYgKHNzZSkgeWllbGQgc3NlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lRGVjb2Rlci5mbHVzaCgpKSB7XG4gICAgICBjb25zdCBzc2UgPSB0aGlzLmRlY29kZXIuZGVjb2RlKGxpbmUpO1xuICAgICAgaWYgKHNzZSkgeWllbGQgc3NlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCk6IEFzeW5jSXRlcmF0b3I8SXRlbSwgYW55LCB1bmRlZmluZWQ+IHtcbiAgICBsZXQgZG9uZSA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IHNzZSBvZiB0aGlzLml0ZXJNZXNzYWdlcygpKSB7XG4gICAgICAgIGlmIChkb25lKSBjb250aW51ZTtcblxuICAgICAgICBpZiAoc3NlLmRhdGEuc3RhcnRzV2l0aCgnW0RPTkVdJykpIHtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzc2UuZXZlbnQgPT09IG51bGwpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgeWllbGQgSlNPTi5wYXJzZShzc2UuZGF0YSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgQ291bGQgbm90IHBhcnNlIG1lc3NhZ2UgaW50byBKU09OOmAsIHNzZS5kYXRhKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZyb20gY2h1bms6YCwgc3NlLnJhdyk7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZG9uZSA9IHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gSWYgdGhlIHVzZXIgY2FsbHMgYHN0cmVhbS5jb250cm9sbGVyLmFib3J0KClgLCB3ZSBzaG91bGQgZXhpdCB3aXRob3V0IHRocm93aW5nLlxuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBFcnJvciAmJiBlLm5hbWUgPT09ICdBYm9ydEVycm9yJykgcmV0dXJuO1xuICAgICAgdGhyb3cgZTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gSWYgdGhlIHVzZXIgYGJyZWFrYHMsIGFib3J0IHRoZSBvbmdvaW5nIHJlcXVlc3QuXG4gICAgICBpZiAoIWRvbmUpIHRoaXMuY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBTU0VEZWNvZGVyIHtcbiAgcHJpdmF0ZSBkYXRhOiBzdHJpbmdbXTtcbiAgcHJpdmF0ZSBldmVudDogc3RyaW5nIHwgbnVsbDtcbiAgcHJpdmF0ZSBjaHVua3M6IHN0cmluZ1tdO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZXZlbnQgPSBudWxsO1xuICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgIHRoaXMuY2h1bmtzID0gW107XG4gIH1cblxuICBkZWNvZGUobGluZTogc3RyaW5nKSB7XG4gICAgaWYgKGxpbmUuZW5kc1dpdGgoJ1xccicpKSB7XG4gICAgICBsaW5lID0gbGluZS5zdWJzdHJpbmcoMCwgbGluZS5sZW5ndGggLSAxKTtcbiAgICB9XG5cbiAgICBpZiAoIWxpbmUpIHtcbiAgICAgIC8vIGVtcHR5IGxpbmUgYW5kIHdlIGRpZG4ndCBwcmV2aW91c2x5IGVuY291bnRlciBhbnkgbWVzc2FnZXNcbiAgICAgIGlmICghdGhpcy5ldmVudCAmJiAhdGhpcy5kYXRhLmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICAgIGNvbnN0IHNzZTogU2VydmVyU2VudEV2ZW50ID0ge1xuICAgICAgICBldmVudDogdGhpcy5ldmVudCxcbiAgICAgICAgZGF0YTogdGhpcy5kYXRhLmpvaW4oJ1xcbicpLFxuICAgICAgICByYXc6IHRoaXMuY2h1bmtzLFxuICAgICAgfTtcblxuICAgICAgdGhpcy5ldmVudCA9IG51bGw7XG4gICAgICB0aGlzLmRhdGEgPSBbXTtcbiAgICAgIHRoaXMuY2h1bmtzID0gW107XG5cbiAgICAgIHJldHVybiBzc2U7XG4gICAgfVxuXG4gICAgdGhpcy5jaHVua3MucHVzaChsaW5lKTtcblxuICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgbGV0IFtmaWVsZG5hbWUsIF8sIHZhbHVlXSA9IHBhcnRpdGlvbihsaW5lLCAnOicpO1xuXG4gICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoJyAnKSkge1xuICAgICAgdmFsdWUgPSB2YWx1ZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuXG4gICAgaWYgKGZpZWxkbmFtZSA9PT0gJ2V2ZW50Jykge1xuICAgICAgdGhpcy5ldmVudCA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAoZmllbGRuYW1lID09PSAnZGF0YScpIHtcbiAgICAgIHRoaXMuZGF0YS5wdXNoKHZhbHVlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEEgcmUtaW1wbGVtZW50YXRpb24gb2YgaHR0cHgncyBgTGluZURlY29kZXJgIGluIFB5dGhvbiB0aGF0IGhhbmRsZXMgaW5jcmVtZW50YWxseVxuICogcmVhZGluZyBsaW5lcyBmcm9tIHRleHQuXG4gKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2VuY29kZS9odHRweC9ibG9iLzkyMDMzM2VhOTgxMThlOWNmNjE3ZjI0NjkwNWQ3YjIwMjUxMDk0MWMvaHR0cHgvX2RlY29kZXJzLnB5I0wyNThcbiAqL1xuY2xhc3MgTGluZURlY29kZXIge1xuICAvLyBwcmV0dGllci1pZ25vcmVcbiAgc3RhdGljIE5FV0xJTkVfQ0hBUlMgPSBuZXcgU2V0KFsnXFxuJywgJ1xccicsICdcXHgwYicsICdcXHgwYycsICdcXHgxYycsICdcXHgxZCcsICdcXHgxZScsICdcXHg4NScsICdcXHUyMDI4JywgJ1xcdTIwMjknXSk7XG4gIHN0YXRpYyBORVdMSU5FX1JFR0VYUCA9IC9cXHJcXG58W1xcblxcclxceDBiXFx4MGNcXHgxY1xceDFkXFx4MWVcXHg4NVxcdTIwMjhcXHUyMDI5XS9nO1xuXG4gIGJ1ZmZlcjogc3RyaW5nW107XG4gIHRyYWlsaW5nQ1I6IGJvb2xlYW47XG4gIHRleHREZWNvZGVyOiBhbnk7IC8vIFRleHREZWNvZGVyIGZvdW5kIGluIGJyb3dzZXJzOyBub3QgdHlwZWQgdG8gYXZvaWQgcHVsbGluZyBpbiBlaXRoZXIgXCJkb21cIiBvciBcIm5vZGVcIiB0eXBlcy5cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmJ1ZmZlciA9IFtdO1xuICAgIHRoaXMudHJhaWxpbmdDUiA9IGZhbHNlO1xuICB9XG5cbiAgZGVjb2RlKGNodW5rOiBCeXRlcyk6IHN0cmluZ1tdIHtcbiAgICBsZXQgdGV4dCA9IHRoaXMuZGVjb2RlVGV4dChjaHVuayk7XG5cbiAgICBpZiAodGhpcy50cmFpbGluZ0NSKSB7XG4gICAgICB0ZXh0ID0gJ1xccicgKyB0ZXh0O1xuICAgICAgdGhpcy50cmFpbGluZ0NSID0gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0ZXh0LmVuZHNXaXRoKCdcXHInKSkge1xuICAgICAgdGhpcy50cmFpbGluZ0NSID0gdHJ1ZTtcbiAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0xKTtcbiAgICB9XG5cbiAgICBpZiAoIXRleHQpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCB0cmFpbGluZ05ld2xpbmUgPSBMaW5lRGVjb2Rlci5ORVdMSU5FX0NIQVJTLmhhcyh0ZXh0W3RleHQubGVuZ3RoIC0gMV0gfHwgJycpO1xuICAgIGxldCBsaW5lcyA9IHRleHQuc3BsaXQoTGluZURlY29kZXIuTkVXTElORV9SRUdFWFApO1xuXG4gICAgaWYgKGxpbmVzLmxlbmd0aCA9PT0gMSAmJiAhdHJhaWxpbmdOZXdsaW5lKSB7XG4gICAgICB0aGlzLmJ1ZmZlci5wdXNoKGxpbmVzWzBdISk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgIGxpbmVzID0gW3RoaXMuYnVmZmVyLmpvaW4oJycpICsgbGluZXNbMF0sIC4uLmxpbmVzLnNsaWNlKDEpXTtcbiAgICAgIHRoaXMuYnVmZmVyID0gW107XG4gICAgfVxuXG4gICAgaWYgKCF0cmFpbGluZ05ld2xpbmUpIHtcbiAgICAgIHRoaXMuYnVmZmVyID0gW2xpbmVzLnBvcCgpIHx8ICcnXTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGluZXM7XG4gIH1cblxuICBkZWNvZGVUZXh0KGJ5dGVzOiBCeXRlcyk6IHN0cmluZyB7XG4gICAgaWYgKGJ5dGVzID09IG51bGwpIHJldHVybiAnJztcbiAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykgcmV0dXJuIGJ5dGVzO1xuXG4gICAgLy8gTm9kZTpcbiAgICBpZiAodHlwZW9mIEJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmIChieXRlcyBpbnN0YW5jZW9mIEJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gYnl0ZXMudG9TdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIGlmIChieXRlcyBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGJ5dGVzKS50b1N0cmluZygpO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBVbmV4cGVjdGVkOiByZWNlaXZlZCBub24tVWludDhBcnJheSAoJHtieXRlcy5jb25zdHJ1Y3Rvci5uYW1lfSkgc3RyZWFtIGNodW5rIGluIGFuIGVudmlyb25tZW50IHdpdGggYSBnbG9iYWwgXCJCdWZmZXJcIiBkZWZpbmVkLCB3aGljaCB0aGlzIGxpYnJhcnkgYXNzdW1lcyB0byBiZSBOb2RlLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IuYCxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQnJvd3NlclxuICAgIGlmICh0eXBlb2YgVGV4dERlY29kZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBpZiAoYnl0ZXMgaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8IGJ5dGVzIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgdGhpcy50ZXh0RGVjb2RlciA/Pz0gbmV3IFRleHREZWNvZGVyKCd1dGY4Jyk7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHREZWNvZGVyLmRlY29kZShieXRlcyk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFVuZXhwZWN0ZWQ6IHJlY2VpdmVkIG5vbi1VaW50OEFycmF5L0FycmF5QnVmZmVyICgke1xuICAgICAgICAgIChieXRlcyBhcyBhbnkpLmNvbnN0cnVjdG9yLm5hbWVcbiAgICAgICAgfSkgaW4gYSB3ZWIgcGxhdGZvcm0uIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvci5gLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgVW5leHBlY3RlZDogbmVpdGhlciBCdWZmZXIgbm9yIFRleHREZWNvZGVyIGFyZSBhdmFpbGFibGUgYXMgZ2xvYmFscy4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yLmAsXG4gICAgKTtcbiAgfVxuXG4gIGZsdXNoKCk6IHN0cmluZ1tdIHtcbiAgICBpZiAoIXRoaXMuYnVmZmVyLmxlbmd0aCAmJiAhdGhpcy50cmFpbGluZ0NSKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSBbdGhpcy5idWZmZXIuam9pbignJyldO1xuICAgIHRoaXMuYnVmZmVyID0gW107XG4gICAgdGhpcy50cmFpbGluZ0NSID0gZmFsc2U7XG4gICAgcmV0dXJuIGxpbmVzO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnRpdGlvbihzdHI6IHN0cmluZywgZGVsaW1pdGVyOiBzdHJpbmcpOiBbc3RyaW5nLCBzdHJpbmcsIHN0cmluZ10ge1xuICBjb25zdCBpbmRleCA9IHN0ci5pbmRleE9mKGRlbGltaXRlcik7XG4gIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICByZXR1cm4gW3N0ci5zdWJzdHJpbmcoMCwgaW5kZXgpLCBkZWxpbWl0ZXIsIHN0ci5zdWJzdHJpbmcoaW5kZXggKyBkZWxpbWl0ZXIubGVuZ3RoKV07XG4gIH1cblxuICByZXR1cm4gW3N0ciwgJycsICcnXTtcbn1cblxuLyoqXG4gKiBNb3N0IGJyb3dzZXJzIGRvbid0IHlldCBoYXZlIGFzeW5jIGl0ZXJhYmxlIHN1cHBvcnQgZm9yIFJlYWRhYmxlU3RyZWFtLFxuICogYW5kIE5vZGUgaGFzIGEgdmVyeSBkaWZmZXJlbnQgd2F5IG9mIHJlYWRpbmcgYnl0ZXMgZnJvbSBpdHMgXCJSZWFkYWJsZVN0cmVhbVwiLlxuICpcbiAqIFRoaXMgcG9seWZpbGwgd2FzIHB1bGxlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9NYXR0aWFzQnVlbGVucy93ZWItc3RyZWFtcy1wb2x5ZmlsbC9wdWxsLzEyMiNpc3N1ZWNvbW1lbnQtMTYyNzM1NDQ5MFxuICovXG5mdW5jdGlvbiByZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmFibGU8VD4oc3RyZWFtOiBhbnkpOiBBc3luY0l0ZXJhYmxlSXRlcmF0b3I8VD4ge1xuICBpZiAoc3RyZWFtW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSkgcmV0dXJuIHN0cmVhbTtcblxuICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gIHJldHVybiB7XG4gICAgYXN5bmMgbmV4dCgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgIGlmIChyZXN1bHQ/LmRvbmUpIHJlYWRlci5yZWxlYXNlTG9jaygpOyAvLyByZWxlYXNlIGxvY2sgd2hlbiBzdHJlYW0gYmVjb21lcyBjbG9zZWRcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVhZGVyLnJlbGVhc2VMb2NrKCk7IC8vIHJlbGVhc2UgbG9jayB3aGVuIHN0cmVhbSBiZWNvbWVzIGVycm9yZWRcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIHJldHVybigpIHtcbiAgICAgIGNvbnN0IGNhbmNlbFByb21pc2UgPSByZWFkZXIuY2FuY2VsKCk7XG4gICAgICByZWFkZXIucmVsZWFzZUxvY2soKTtcbiAgICAgIGF3YWl0IGNhbmNlbFByb21pc2U7XG4gICAgICByZXR1cm4geyBkb25lOiB0cnVlLCB2YWx1ZTogdW5kZWZpbmVkIH07XG4gICAgfSxcbiAgICBbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgfTtcbn1cbiIsICIvLyBGaWxlIGdlbmVyYXRlZCBmcm9tIG91ciBPcGVuQVBJIHNwZWMgYnkgU3RhaW5sZXNzLlxuXG5pbXBvcnQgeyBjYXN0VG9FcnJvciwgSGVhZGVycyB9IGZyb20gJy4vY29yZS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBBUElFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcmVhZG9ubHkgc3RhdHVzOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IGhlYWRlcnM6IEhlYWRlcnMgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IGVycm9yOiBPYmplY3QgfCB1bmRlZmluZWQ7XG5cbiAgcmVhZG9ubHkgY29kZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgcmVhZG9ubHkgcGFyYW06IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBzdGF0dXM6IG51bWJlciB8IHVuZGVmaW5lZCxcbiAgICBlcnJvcjogT2JqZWN0IHwgdW5kZWZpbmVkLFxuICAgIG1lc3NhZ2U6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICBoZWFkZXJzOiBIZWFkZXJzIHwgdW5kZWZpbmVkLFxuICApIHtcbiAgICBzdXBlcihBUElFcnJvci5tYWtlTWVzc2FnZShlcnJvciwgbWVzc2FnZSkpO1xuICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG5cbiAgICBjb25zdCBkYXRhID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgYW55PjtcbiAgICB0aGlzLmVycm9yID0gZGF0YTtcbiAgICB0aGlzLmNvZGUgPSBkYXRhPy5bJ2NvZGUnXTtcbiAgICB0aGlzLnBhcmFtID0gZGF0YT8uWydwYXJhbSddO1xuICAgIHRoaXMudHlwZSA9IGRhdGE/LlsndHlwZSddO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgbWFrZU1lc3NhZ2UoZXJyb3I6IGFueSwgbWVzc2FnZTogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGVycm9yPy5tZXNzYWdlID9cbiAgICAgICAgdHlwZW9mIGVycm9yLm1lc3NhZ2UgPT09ICdzdHJpbmcnID8gZXJyb3IubWVzc2FnZVxuICAgICAgICA6IEpTT04uc3RyaW5naWZ5KGVycm9yLm1lc3NhZ2UpXG4gICAgICA6IGVycm9yID8gSlNPTi5zdHJpbmdpZnkoZXJyb3IpXG4gICAgICA6IG1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnXG4gICAgKTtcbiAgfVxuXG4gIHN0YXRpYyBnZW5lcmF0ZShcbiAgICBzdGF0dXM6IG51bWJlciB8IHVuZGVmaW5lZCxcbiAgICBlcnJvclJlc3BvbnNlOiBPYmplY3QgfCB1bmRlZmluZWQsXG4gICAgbWVzc2FnZTogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgIGhlYWRlcnM6IEhlYWRlcnMgfCB1bmRlZmluZWQsXG4gICkge1xuICAgIGlmICghc3RhdHVzKSB7XG4gICAgICByZXR1cm4gbmV3IEFQSUNvbm5lY3Rpb25FcnJvcih7IGNhdXNlOiBjYXN0VG9FcnJvcihlcnJvclJlc3BvbnNlKSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBlcnJvciA9IChlcnJvclJlc3BvbnNlIGFzIFJlY29yZDxzdHJpbmcsIGFueT4pPy5bJ2Vycm9yJ107XG5cbiAgICBpZiAoc3RhdHVzID09PSA0MDApIHtcbiAgICAgIHJldHVybiBuZXcgQmFkUmVxdWVzdEVycm9yKHN0YXR1cywgZXJyb3IsIG1lc3NhZ2UsIGhlYWRlcnMpO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IDQwMSkge1xuICAgICAgcmV0dXJuIG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKHN0YXR1cywgZXJyb3IsIG1lc3NhZ2UsIGhlYWRlcnMpO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IDQwMykge1xuICAgICAgcmV0dXJuIG5ldyBQZXJtaXNzaW9uRGVuaWVkRXJyb3Ioc3RhdHVzLCBlcnJvciwgbWVzc2FnZSwgaGVhZGVycyk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXJyb3Ioc3RhdHVzLCBlcnJvciwgbWVzc2FnZSwgaGVhZGVycyk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gNDA5KSB7XG4gICAgICByZXR1cm4gbmV3IENvbmZsaWN0RXJyb3Ioc3RhdHVzLCBlcnJvciwgbWVzc2FnZSwgaGVhZGVycyk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gNDIyKSB7XG4gICAgICByZXR1cm4gbmV3IFVucHJvY2Vzc2FibGVFbnRpdHlFcnJvcihzdGF0dXMsIGVycm9yLCBtZXNzYWdlLCBoZWFkZXJzKTtcbiAgICB9XG5cbiAgICBpZiAoc3RhdHVzID09PSA0MjkpIHtcbiAgICAgIHJldHVybiBuZXcgUmF0ZUxpbWl0RXJyb3Ioc3RhdHVzLCBlcnJvciwgbWVzc2FnZSwgaGVhZGVycyk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA+PSA1MDApIHtcbiAgICAgIHJldHVybiBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvcihzdGF0dXMsIGVycm9yLCBtZXNzYWdlLCBoZWFkZXJzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEFQSUVycm9yKHN0YXR1cywgZXJyb3IsIG1lc3NhZ2UsIGhlYWRlcnMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBUElVc2VyQWJvcnRFcnJvciBleHRlbmRzIEFQSUVycm9yIHtcbiAgb3ZlcnJpZGUgcmVhZG9ubHkgc3RhdHVzOiB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3IoeyBtZXNzYWdlIH06IHsgbWVzc2FnZT86IHN0cmluZyB9ID0ge30pIHtcbiAgICBzdXBlcih1bmRlZmluZWQsIHVuZGVmaW5lZCwgbWVzc2FnZSB8fCAnUmVxdWVzdCB3YXMgYWJvcnRlZC4nLCB1bmRlZmluZWQpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBUElDb25uZWN0aW9uRXJyb3IgZXh0ZW5kcyBBUElFcnJvciB7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0YXR1czogdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHsgbWVzc2FnZSwgY2F1c2UgfTogeyBtZXNzYWdlPzogc3RyaW5nOyBjYXVzZT86IEVycm9yIHwgdW5kZWZpbmVkIH0pIHtcbiAgICBzdXBlcih1bmRlZmluZWQsIHVuZGVmaW5lZCwgbWVzc2FnZSB8fCAnQ29ubmVjdGlvbiBlcnJvci4nLCB1bmRlZmluZWQpO1xuICAgIC8vIGluIHNvbWUgZW52aXJvbm1lbnRzIHRoZSAnY2F1c2UnIHByb3BlcnR5IGlzIGFscmVhZHkgZGVjbGFyZWRcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKGNhdXNlKSB0aGlzLmNhdXNlID0gY2F1c2U7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFQSUNvbm5lY3Rpb25UaW1lb3V0RXJyb3IgZXh0ZW5kcyBBUElDb25uZWN0aW9uRXJyb3Ige1xuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgfTogeyBtZXNzYWdlPzogc3RyaW5nIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbWVzc2FnZTogbWVzc2FnZSA/PyAnUmVxdWVzdCB0aW1lZCBvdXQuJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQmFkUmVxdWVzdEVycm9yIGV4dGVuZHMgQVBJRXJyb3Ige1xuICBvdmVycmlkZSByZWFkb25seSBzdGF0dXM6IDQwMCA9IDQwMDtcbn1cblxuZXhwb3J0IGNsYXNzIEF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBBUElFcnJvciB7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0YXR1czogNDAxID0gNDAxO1xufVxuXG5leHBvcnQgY2xhc3MgUGVybWlzc2lvbkRlbmllZEVycm9yIGV4dGVuZHMgQVBJRXJyb3Ige1xuICBvdmVycmlkZSByZWFkb25seSBzdGF0dXM6IDQwMyA9IDQwMztcbn1cblxuZXhwb3J0IGNsYXNzIE5vdEZvdW5kRXJyb3IgZXh0ZW5kcyBBUElFcnJvciB7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0YXR1czogNDA0ID0gNDA0O1xufVxuXG5leHBvcnQgY2xhc3MgQ29uZmxpY3RFcnJvciBleHRlbmRzIEFQSUVycm9yIHtcbiAgb3ZlcnJpZGUgcmVhZG9ubHkgc3RhdHVzOiA0MDkgPSA0MDk7XG59XG5cbmV4cG9ydCBjbGFzcyBVbnByb2Nlc3NhYmxlRW50aXR5RXJyb3IgZXh0ZW5kcyBBUElFcnJvciB7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0YXR1czogNDIyID0gNDIyO1xufVxuXG5leHBvcnQgY2xhc3MgUmF0ZUxpbWl0RXJyb3IgZXh0ZW5kcyBBUElFcnJvciB7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHN0YXR1czogNDI5ID0gNDI5O1xufVxuXG5leHBvcnQgY2xhc3MgSW50ZXJuYWxTZXJ2ZXJFcnJvciBleHRlbmRzIEFQSUVycm9yIHt9XG4iLCAiLyoqXG4gKiBEaXNjbGFpbWVyOiBtb2R1bGVzIGluIF9zaGltcyBhcmVuJ3QgaW50ZW5kZWQgdG8gYmUgaW1wb3J0ZWQgYnkgU0RLIHVzZXJzLlxuICpcbiAqIFRoaXMgaXMgYSBzdHViIGZvciBub24tbm9kZSBlbnZpcm9ubWVudHMuXG4gKiBJbiBub2RlIGVudmlyb25tZW50cywgaXQgZ2V0cyByZXBsYWNlZCBhZ2VudC1ub2RlLnRzIGJ5IHRoZSBwYWNrYWdlIGV4cG9ydCBtYXBcbiAqL1xuXG5leHBvcnQgdHlwZSBBZ2VudCA9IGFueTtcblxuZXhwb3J0IGNvbnN0IGdldERlZmF1bHRBZ2VudCA9ICh1cmw6IHN0cmluZyk6IGFueSA9PiB7XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuIiwgIi8qKlxuICogRGlzY2xhaW1lcjogbW9kdWxlcyBpbiBfc2hpbXMgYXJlbid0IGludGVuZGVkIHRvIGJlIGltcG9ydGVkIGJ5IFNESyB1c2Vycy5cbiAqL1xuXG4vLyBJZiB3ZSBhY2NpZGVudGFsbHkgY2FsbCBmZXRjaCB3aXRoIHRoZSB3cm9uZyB0aGlzIGJpbmRpbmcsXG4vLyBpbiB0aGUgYnJvd3NlciBpdCB3b3VsZCB0aHJvdzpcbi8vICAgVHlwZUVycm9yOiBGYWlsZWQgdG8gZXhlY3V0ZSAnZmV0Y2gnIG9uICdXaW5kb3cnOiBJbGxlZ2FsIGludm9jYXRpb25cbmNvbnN0IF9mZXRjaCA9IGZldGNoLmJpbmQodW5kZWZpbmVkKTtcbmNvbnN0IF9SZXF1ZXN0ID0gUmVxdWVzdDtcbmNvbnN0IF9SZXNwb25zZSA9IFJlc3BvbnNlO1xuY29uc3QgX0hlYWRlcnMgPSBIZWFkZXJzO1xuXG5leHBvcnQgY29uc3QgaXNQb2x5ZmlsbGVkID0gZmFsc2U7XG5cbmV4cG9ydCB7IF9mZXRjaCBhcyBmZXRjaCwgX1JlcXVlc3QgYXMgUmVxdWVzdCwgX1Jlc3BvbnNlIGFzIFJlc3BvbnNlLCBfSGVhZGVycyBhcyBIZWFkZXJzIH07XG4iLCAiLyoqXG4gKiBEaXNjbGFpbWVyOiBtb2R1bGVzIGluIF9zaGltcyBhcmVuJ3QgaW50ZW5kZWQgdG8gYmUgaW1wb3J0ZWQgYnkgU0RLIHVzZXJzLlxuICovXG5cbmNvbnN0IF9Gb3JtRGF0YSA9IEZvcm1EYXRhO1xuY29uc3QgX0Jsb2IgPSBCbG9iO1xuXG5jb25zdCBfRmlsZSA9XG4gIHR5cGVvZiBGaWxlICE9PSAndW5kZWZpbmVkJyA/IEZpbGUgOiAoXG4gICAgLy8gQnVuIGRvZXNuJ3QgaW1wbGVtZW50IEZpbGUgeWV0LCBzbyBqdXN0IG1ha2UgYSBzaGltIHRoYXQgdGhyb3dzIGEgaGVscGZ1bCBlcnJvciBtZXNzYWdlXG4gICAgY2xhc3MgRmlsZSBleHRlbmRzIEJsb2Ige1xuICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgZmlsZSB1cGxvYWRzIGFyZW4ndCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudCB5ZXQgYXMgJ0ZpbGUnIGlzIG5vdCBkZWZpbmVkYCk7XG4gICAgICB9XG4gICAgfVxuICApO1xuXG5leHBvcnQgeyBfRm9ybURhdGEgYXMgRm9ybURhdGEsIF9GaWxlIGFzIEZpbGUsIF9CbG9iIGFzIEJsb2IgfTtcblxuZXhwb3J0IGNvbnN0IGlzUG9seWZpbGxlZCA9IGZhbHNlO1xuIiwgIi8qKlxuICogRGlzY2xhaW1lcjogbW9kdWxlcyBpbiBfc2hpbXMgYXJlbid0IGludGVuZGVkIHRvIGJlIGltcG9ydGVkIGJ5IFNESyB1c2Vycy5cbiAqL1xuXG5pbXBvcnQgeyBGb3JtRGF0YSB9IGZyb20gJy4vZm9ybS1kYXRhLmpzJztcbmltcG9ydCB0eXBlIHsgUmVxdWVzdE9wdGlvbnMgfSBmcm9tICcuLi9jb3JlLmpzJztcbmltcG9ydCB7IE11bHRpcGFydEJvZHkgfSBmcm9tICcuLi91cGxvYWRzLmpzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE11bHRpcGFydFJlcXVlc3RPcHRpb25zPFQgZXh0ZW5kcyB7fSA9IFJlY29yZDxzdHJpbmcsIHVua25vd24+PihcbiAgZm9ybTogRm9ybURhdGEsXG4gIG9wdHM6IFJlcXVlc3RPcHRpb25zPFQ+LFxuKTogUHJvbWlzZTxSZXF1ZXN0T3B0aW9uczxUPj4ge1xuICByZXR1cm4geyAuLi5vcHRzLCBib2R5OiBuZXcgTXVsdGlwYXJ0Qm9keShmb3JtKSBhcyBhbnkgfTtcbn1cbiIsICIvKipcbiAqIERpc2NsYWltZXI6IG1vZHVsZXMgaW4gX3NoaW1zIGFyZW4ndCBpbnRlbmRlZCB0byBiZSBpbXBvcnRlZCBieSBTREsgdXNlcnMuXG4gKlxuICogVGhpcyBpcyBhIHN0dWIgdGhhdCBnZXRzIHJlcGxhY2VkIGJ5IGZpbGVGcm9tUGF0aC1ub2RlLmpzIGZvciBub2RlIGVudmlyb25tZW50c1xuICogaW4gdGhlIHBhY2thZ2UgZXhwb3J0IG1hcFxuICovXG5cbmltcG9ydCB0eXBlIHsgRmlsZVByb3BlcnR5QmFnLCBGaWxlIH0gZnJvbSAnLi9mb3JtLWRhdGEuanMnO1xuXG5leHBvcnQgdHlwZSBGaWxlRnJvbVBhdGhPcHRpb25zID0gT21pdDxGaWxlUHJvcGVydHlCYWcsICdsYXN0TW9kaWZpZWQnPjtcblxuLyoqXG4gKiBUaGlzIGlzIGEgc3R1YiBmb3Igbm9uLW5vZGUgZW52aXJvbm1lbnRzIHRoYXQganVzdCB0aHJvd3MgYW4gZXJyb3IuXG4gKiBJbiBub2RlIGVudmlyb25tZW50cywgdGhpcyBtb2R1bGUgd2lsbCBiZSByZXBsYWNlZCBieSB1dGlsL25vZGUvZmlsZUZyb21QYXRoIGJ5IHRoZVxuICogcGFja2FnZSBpbXBvcnQgbWFwLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmlsZUZyb21QYXRoKHBhdGg6IHN0cmluZyk6IFByb21pc2U8RmlsZT47XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmlsZUZyb21QYXRoKHBhdGg6IHN0cmluZywgZmlsZW5hbWU/OiBzdHJpbmcpOiBQcm9taXNlPEZpbGU+O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbGVGcm9tUGF0aChwYXRoOiBzdHJpbmcsIG9wdGlvbnM/OiBGaWxlRnJvbVBhdGhPcHRpb25zKTogUHJvbWlzZTxGaWxlPjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaWxlRnJvbVBhdGgoXG4gIHBhdGg6IHN0cmluZyxcbiAgZmlsZW5hbWU/OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBGaWxlRnJvbVBhdGhPcHRpb25zLFxuKTogUHJvbWlzZTxGaWxlPjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaWxlRnJvbVBhdGgoKTogUHJvbWlzZTxGaWxlPiB7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICAnVGhlIGBmaWxlRnJvbVBhdGhgIGZ1bmN0aW9uIGlzIG9ubHkgc3VwcG9ydGVkIGluIE5vZGUuIFNlZSB0aGUgUkVBRE1FIGZvciBtb3JlIGRldGFpbHM6IGh0dHBzOi8vd3d3LmdpdGh1Yi5jb20vb3BlbmFpL29wZW5haS1ub2RlI2ZpbGUtdXBsb2FkcycsXG4gICk7XG59XG4iLCAiLyoqXG4gKiBEaXNjbGFpbWVyOiBtb2R1bGVzIGluIF9zaGltcyBhcmVuJ3QgaW50ZW5kZWQgdG8gYmUgaW1wb3J0ZWQgYnkgU0RLIHVzZXJzLlxuICovXG5cbi8vIHNoaW0gdGhlc2UgTm9kZSB0eXBlcyB0byBhdm9pZCBpbXBvcnRpbmcgQHR5cGVzL25vZGUgYW5kIHBvbGx1dGluZyB0aGUgdXNlcidzXG4vLyB0eXBlIGVudmlyb25tZW50IGluIG5vbi1ub2RlIHByb2plY3RzXG5cbmV4cG9ydCBkZWNsYXJlIGNsYXNzIFJlYWRhYmxlIHtcbiAgcmVhZGFibGU6IGJvb2xlYW47XG4gIHJlYWRvbmx5IHJlYWRhYmxlRW5kZWQ6IGJvb2xlYW47XG4gIHJlYWRvbmx5IHJlYWRhYmxlRmxvd2luZzogYm9vbGVhbiB8IG51bGw7XG4gIHJlYWRvbmx5IHJlYWRhYmxlSGlnaFdhdGVyTWFyazogbnVtYmVyO1xuICByZWFkb25seSByZWFkYWJsZUxlbmd0aDogbnVtYmVyO1xuICByZWFkb25seSByZWFkYWJsZU9iamVjdE1vZGU6IGJvb2xlYW47XG4gIGRlc3Ryb3llZDogYm9vbGVhbjtcbiAgcmVhZChzaXplPzogbnVtYmVyKTogYW55O1xuICBwYXVzZSgpOiB0aGlzO1xuICByZXN1bWUoKTogdGhpcztcbiAgaXNQYXVzZWQoKTogYm9vbGVhbjtcbiAgZGVzdHJveShlcnJvcj86IEVycm9yKTogdGhpcztcbiAgW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpOiBBc3luY0l0ZXJhYmxlSXRlcmF0b3I8YW55Pjtcbn1cblxuZXhwb3J0IGRlY2xhcmUgY2xhc3MgRnNSZWFkU3RyZWFtIGV4dGVuZHMgUmVhZGFibGUge1xuICBwYXRoOiB7fTsgLy8gbm9kZSB0eXBlIGlzIHN0cmluZyB8IEJ1ZmZlclxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGc1JlYWRTdHJlYW0odmFsdWU6IGFueSk6IHZhbHVlIGlzIEZzUmVhZFN0cmVhbSB7XG4gIHJldHVybiBmYWxzZTtcbn1cbiIsICJpbXBvcnQgeyB0eXBlIFJlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi9jb3JlLmpzJztcbmltcG9ydCB7IHR5cGUgUmVhZGFibGUgfSBmcm9tICcuL19zaGltcy9ub2RlLXJlYWRhYmxlLmpzJztcbmltcG9ydCB7IHR5cGUgQm9keUluaXQgfSBmcm9tICcuL19zaGltcy9mZXRjaC5qcyc7XG5pbXBvcnQgeyBGb3JtRGF0YSwgRmlsZSwgdHlwZSBCbG9iLCB0eXBlIEZpbGVQcm9wZXJ0eUJhZyB9IGZyb20gJy4vX3NoaW1zL2Zvcm0tZGF0YS5qcyc7XG5pbXBvcnQgeyBnZXRNdWx0aXBhcnRSZXF1ZXN0T3B0aW9ucyB9IGZyb20gJy4vX3NoaW1zL2dldE11bHRpcGFydFJlcXVlc3RPcHRpb25zLmpzJztcbmltcG9ydCB7IGZpbGVGcm9tUGF0aCB9IGZyb20gJy4vX3NoaW1zL2ZpbGVGcm9tUGF0aC5qcyc7XG5pbXBvcnQgeyB0eXBlIEZzUmVhZFN0cmVhbSwgaXNGc1JlYWRTdHJlYW0gfSBmcm9tICcuL19zaGltcy9ub2RlLXJlYWRhYmxlLmpzJztcblxuZXhwb3J0IHsgZmlsZUZyb21QYXRoIH07XG5cbnR5cGUgQmxvYkxpa2VQYXJ0ID0gc3RyaW5nIHwgQXJyYXlCdWZmZXIgfCBBcnJheUJ1ZmZlclZpZXcgfCBCbG9iTGlrZSB8IFVpbnQ4QXJyYXkgfCBEYXRhVmlldztcbmV4cG9ydCB0eXBlIEJsb2JQYXJ0ID0gc3RyaW5nIHwgQXJyYXlCdWZmZXIgfCBBcnJheUJ1ZmZlclZpZXcgfCBCbG9iIHwgVWludDhBcnJheSB8IERhdGFWaWV3O1xuXG4vKipcbiAqIFR5cGljYWxseSwgdGhpcyBpcyBhIG5hdGl2ZSBcIkZpbGVcIiBjbGFzcy5cbiAqXG4gKiBXZSBwcm92aWRlIHRoZSB7QGxpbmsgdG9GaWxlfSB1dGlsaXR5IHRvIGNvbnZlcnQgYSB2YXJpZXR5IG9mIG9iamVjdHNcbiAqIGludG8gdGhlIEZpbGUgY2xhc3MuXG4gKlxuICogRm9yIGNvbnZlbmllbmNlLCB5b3UgY2FuIGFsc28gcGFzcyBhIGZldGNoIFJlc3BvbnNlLCBvciBpbiBOb2RlLFxuICogdGhlIHJlc3VsdCBvZiBmcy5jcmVhdGVSZWFkU3RyZWFtKCkuXG4gKi9cbmV4cG9ydCB0eXBlIFVwbG9hZGFibGUgPSBGaWxlTGlrZSB8IFJlc3BvbnNlTGlrZSB8IEZzUmVhZFN0cmVhbTtcblxuLyoqXG4gKiBJbnRlbmRlZCB0byBtYXRjaCB3ZWIuQmxvYiwgbm9kZS5CbG9iLCBub2RlLWZldGNoLkJsb2IsIGV0Yy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCbG9iTGlrZSB7XG4gIC8qKiBbTUROIFJlZmVyZW5jZV0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZG9jcy9XZWIvQVBJL0Jsb2Ivc2l6ZSkgKi9cbiAgcmVhZG9ubHkgc2l6ZTogbnVtYmVyO1xuICAvKiogW01ETiBSZWZlcmVuY2VdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2RvY3MvV2ViL0FQSS9CbG9iL3R5cGUpICovXG4gIHJlYWRvbmx5IHR5cGU6IHN0cmluZztcbiAgLyoqIFtNRE4gUmVmZXJlbmNlXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9BUEkvQmxvYi90ZXh0KSAqL1xuICB0ZXh0KCk6IFByb21pc2U8c3RyaW5nPjtcbiAgLyoqIFtNRE4gUmVmZXJlbmNlXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9BUEkvQmxvYi9zbGljZSkgKi9cbiAgc2xpY2Uoc3RhcnQ/OiBudW1iZXIsIGVuZD86IG51bWJlcik6IEJsb2JMaWtlO1xuICAvLyB1bmZvcnR1bmF0ZWx5IEB0eXBlcy9ub2RlLWZldGNoQF4yLjYuNCBkb2Vzbid0IHR5cGUgdGhlIGFycmF5QnVmZmVyIG1ldGhvZFxufVxuXG4vKipcbiAqIEludGVuZGVkIHRvIG1hdGNoIHdlYi5GaWxlLCBub2RlLkZpbGUsIG5vZGUtZmV0Y2guRmlsZSwgZXRjLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVMaWtlIGV4dGVuZHMgQmxvYkxpa2Uge1xuICAvKiogW01ETiBSZWZlcmVuY2VdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2RvY3MvV2ViL0FQSS9GaWxlL2xhc3RNb2RpZmllZCkgKi9cbiAgcmVhZG9ubHkgbGFzdE1vZGlmaWVkOiBudW1iZXI7XG4gIC8qKiBbTUROIFJlZmVyZW5jZV0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZG9jcy9XZWIvQVBJL0ZpbGUvbmFtZSkgKi9cbiAgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xufVxuXG4vKipcbiAqIEludGVuZGVkIHRvIG1hdGNoIHdlYi5SZXNwb25zZSwgbm9kZS5SZXNwb25zZSwgbm9kZS1mZXRjaC5SZXNwb25zZSwgZXRjLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlc3BvbnNlTGlrZSB7XG4gIHVybDogc3RyaW5nO1xuICBibG9iKCk6IFByb21pc2U8QmxvYkxpa2U+O1xufVxuXG5leHBvcnQgY29uc3QgaXNSZXNwb25zZUxpa2UgPSAodmFsdWU6IGFueSk6IHZhbHVlIGlzIFJlc3BvbnNlTGlrZSA9PlxuICB2YWx1ZSAhPSBudWxsICYmXG4gIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgdHlwZW9mIHZhbHVlLnVybCA9PT0gJ3N0cmluZycgJiZcbiAgdHlwZW9mIHZhbHVlLmJsb2IgPT09ICdmdW5jdGlvbic7XG5cbmV4cG9ydCBjb25zdCBpc0ZpbGVMaWtlID0gKHZhbHVlOiBhbnkpOiB2YWx1ZSBpcyBGaWxlTGlrZSA9PlxuICB2YWx1ZSAhPSBudWxsICYmXG4gIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgdHlwZW9mIHZhbHVlLm5hbWUgPT09ICdzdHJpbmcnICYmXG4gIHR5cGVvZiB2YWx1ZS5sYXN0TW9kaWZpZWQgPT09ICdudW1iZXInICYmXG4gIGlzQmxvYkxpa2UodmFsdWUpO1xuXG4vKipcbiAqIFRoZSBCbG9iTGlrZSB0eXBlIG9taXRzIGFycmF5QnVmZmVyKCkgYmVjYXVzZSBAdHlwZXMvbm9kZS1mZXRjaEBeMi42LjQgbGFja3MgaXQ7IGJ1dCB0aGlzIGNoZWNrXG4gKiBhZGRzIHRoZSBhcnJheUJ1ZmZlcigpIG1ldGhvZCB0eXBlIGJlY2F1c2UgaXQgaXMgYXZhaWxhYmxlIGFuZCB1c2VkIGF0IHJ1bnRpbWVcbiAqL1xuZXhwb3J0IGNvbnN0IGlzQmxvYkxpa2UgPSAodmFsdWU6IGFueSk6IHZhbHVlIGlzIEJsb2JMaWtlICYgeyBhcnJheUJ1ZmZlcigpOiBQcm9taXNlPEFycmF5QnVmZmVyPiB9ID0+XG4gIHZhbHVlICE9IG51bGwgJiZcbiAgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJlxuICB0eXBlb2YgdmFsdWUuc2l6ZSA9PT0gJ251bWJlcicgJiZcbiAgdHlwZW9mIHZhbHVlLnR5cGUgPT09ICdzdHJpbmcnICYmXG4gIHR5cGVvZiB2YWx1ZS50ZXh0ID09PSAnZnVuY3Rpb24nICYmXG4gIHR5cGVvZiB2YWx1ZS5zbGljZSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICB0eXBlb2YgdmFsdWUuYXJyYXlCdWZmZXIgPT09ICdmdW5jdGlvbic7XG5cbmV4cG9ydCBjb25zdCBpc1VwbG9hZGFibGUgPSAodmFsdWU6IGFueSk6IHZhbHVlIGlzIFVwbG9hZGFibGUgPT4ge1xuICByZXR1cm4gaXNGaWxlTGlrZSh2YWx1ZSkgfHwgaXNSZXNwb25zZUxpa2UodmFsdWUpIHx8IGlzRnNSZWFkU3RyZWFtKHZhbHVlKTtcbn07XG5cbmV4cG9ydCB0eXBlIFRvRmlsZUlucHV0ID0gVXBsb2FkYWJsZSB8IEV4Y2x1ZGU8QmxvYkxpa2VQYXJ0LCBzdHJpbmc+IHwgQXN5bmNJdGVyYWJsZTxCbG9iTGlrZVBhcnQ+O1xuXG4vKipcbiAqIEhlbHBlciBmb3IgY3JlYXRpbmcgYSB7QGxpbmsgRmlsZX0gdG8gcGFzcyB0byBhbiBTREsgdXBsb2FkIG1ldGhvZCBmcm9tIGEgdmFyaWV0eSBvZiBkaWZmZXJlbnQgZGF0YSBmb3JtYXRzXG4gKiBAcGFyYW0gdmFsdWUgdGhlIHJhdyBjb250ZW50IG9mIHRoZSBmaWxlLiAgQ2FuIGJlIGFuIHtAbGluayBVcGxvYWRhYmxlfSwge0BsaW5rIEJsb2JMaWtlUGFydH0sIG9yIHtAbGluayBBc3luY0l0ZXJhYmxlfSBvZiB7QGxpbmsgQmxvYkxpa2VQYXJ0fXNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSB0aGUgbmFtZSBvZiB0aGUgZmlsZS4gSWYgb21pdHRlZCwgdG9GaWxlIHdpbGwgdHJ5IHRvIGRldGVybWluZSBhIGZpbGUgbmFtZSBmcm9tIGJpdHMgaWYgcG9zc2libGVcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0aW9ucyBhZGRpdGlvbmFsIHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0aW9ucy50eXBlIHRoZSBNSU1FIHR5cGUgb2YgdGhlIGNvbnRlbnRcbiAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0aW9ucy5sYXN0TW9kaWZpZWQgdGhlIGxhc3QgbW9kaWZpZWQgdGltZXN0YW1wXG4gKiBAcmV0dXJucyBhIHtAbGluayBGaWxlfSB3aXRoIHRoZSBnaXZlbiBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0b0ZpbGUoXG4gIHZhbHVlOiBUb0ZpbGVJbnB1dCB8IFByb21pc2VMaWtlPFRvRmlsZUlucHV0PixcbiAgbmFtZT86IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQsXG4gIG9wdGlvbnM6IEZpbGVQcm9wZXJ0eUJhZyB8IHVuZGVmaW5lZCA9IHt9LFxuKTogUHJvbWlzZTxGaWxlTGlrZT4ge1xuICAvLyBJZiBpdCdzIGEgcHJvbWlzZSwgcmVzb2x2ZSBpdC5cbiAgdmFsdWUgPSBhd2FpdCB2YWx1ZTtcblxuICBpZiAoaXNSZXNwb25zZUxpa2UodmFsdWUpKSB7XG4gICAgY29uc3QgYmxvYiA9IGF3YWl0IHZhbHVlLmJsb2IoKTtcbiAgICBuYW1lIHx8PSBuZXcgVVJMKHZhbHVlLnVybCkucGF0aG5hbWUuc3BsaXQoL1tcXFxcL10vKS5wb3AoKSA/PyAndW5rbm93bl9maWxlJztcblxuICAgIHJldHVybiBuZXcgRmlsZShbYmxvYiBhcyBhbnldLCBuYW1lLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbnN0IGJpdHMgPSBhd2FpdCBnZXRCeXRlcyh2YWx1ZSk7XG5cbiAgbmFtZSB8fD0gZ2V0TmFtZSh2YWx1ZSkgPz8gJ3Vua25vd25fZmlsZSc7XG5cbiAgaWYgKCFvcHRpb25zLnR5cGUpIHtcbiAgICBjb25zdCB0eXBlID0gKGJpdHNbMF0gYXMgYW55KT8udHlwZTtcbiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBvcHRpb25zID0geyAuLi5vcHRpb25zLCB0eXBlIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBGaWxlKGJpdHMsIG5hbWUsIG9wdGlvbnMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRCeXRlcyh2YWx1ZTogVG9GaWxlSW5wdXQpOiBQcm9taXNlPEFycmF5PEJsb2JQYXJ0Pj4ge1xuICBsZXQgcGFydHM6IEFycmF5PEJsb2JQYXJ0PiA9IFtdO1xuICBpZiAoXG4gICAgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fFxuICAgIEFycmF5QnVmZmVyLmlzVmlldyh2YWx1ZSkgfHwgLy8gaW5jbHVkZXMgVWludDhBcnJheSwgQnVmZmVyLCBldGMuXG4gICAgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlclxuICApIHtcbiAgICBwYXJ0cy5wdXNoKHZhbHVlKTtcbiAgfSBlbHNlIGlmIChpc0Jsb2JMaWtlKHZhbHVlKSkge1xuICAgIHBhcnRzLnB1c2goYXdhaXQgdmFsdWUuYXJyYXlCdWZmZXIoKSk7XG4gIH0gZWxzZSBpZiAoXG4gICAgaXNBc3luY0l0ZXJhYmxlSXRlcmF0b3IodmFsdWUpIC8vIGluY2x1ZGVzIFJlYWRhYmxlLCBSZWFkYWJsZVN0cmVhbSwgZXRjLlxuICApIHtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHZhbHVlKSB7XG4gICAgICBwYXJ0cy5wdXNoKGNodW5rIGFzIEJsb2JQYXJ0KTsgLy8gVE9ETywgY29uc2lkZXIgdmFsaWRhdGluZz9cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYFVuZXhwZWN0ZWQgZGF0YSB0eXBlOiAke3R5cGVvZiB2YWx1ZX07IGNvbnN0cnVjdG9yOiAke1xuICAgICAgICB2YWx1ZT8uY29uc3RydWN0b3I/Lm5hbWVcbiAgICAgIH07IHByb3BzOiAke3Byb3BzRm9yRXJyb3IodmFsdWUpfWAsXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBwYXJ0cztcbn1cblxuZnVuY3Rpb24gcHJvcHNGb3JFcnJvcih2YWx1ZTogYW55KTogc3RyaW5nIHtcbiAgY29uc3QgcHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh2YWx1ZSk7XG4gIHJldHVybiBgWyR7cHJvcHMubWFwKChwKSA9PiBgXCIke3B9XCJgKS5qb2luKCcsICcpfV1gO1xufVxuXG5mdW5jdGlvbiBnZXROYW1lKHZhbHVlOiBhbnkpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICByZXR1cm4gKFxuICAgIGdldFN0cmluZ0Zyb21NYXliZUJ1ZmZlcih2YWx1ZS5uYW1lKSB8fFxuICAgIGdldFN0cmluZ0Zyb21NYXliZUJ1ZmZlcih2YWx1ZS5maWxlbmFtZSkgfHxcbiAgICAvLyBGb3IgZnMuUmVhZFN0cmVhbVxuICAgIGdldFN0cmluZ0Zyb21NYXliZUJ1ZmZlcih2YWx1ZS5wYXRoKT8uc3BsaXQoL1tcXFxcL10vKS5wb3AoKVxuICApO1xufVxuXG5jb25zdCBnZXRTdHJpbmdGcm9tTWF5YmVCdWZmZXIgPSAoeDogc3RyaW5nIHwgQnVmZmVyIHwgdW5rbm93bik6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHJldHVybiB4O1xuICBpZiAodHlwZW9mIEJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgeCBpbnN0YW5jZW9mIEJ1ZmZlcikgcmV0dXJuIFN0cmluZyh4KTtcbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbmNvbnN0IGlzQXN5bmNJdGVyYWJsZUl0ZXJhdG9yID0gKHZhbHVlOiBhbnkpOiB2YWx1ZSBpcyBBc3luY0l0ZXJhYmxlSXRlcmF0b3I8dW5rbm93bj4gPT5cbiAgdmFsdWUgIT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPT09ICdmdW5jdGlvbic7XG5cbmV4cG9ydCBjbGFzcyBNdWx0aXBhcnRCb2R5IHtcbiAgY29uc3RydWN0b3IocHVibGljIGJvZHk6IFJlYWRhYmxlIHwgQm9keUluaXQpIHt9XG4gIGdldCBbU3ltYm9sLnRvU3RyaW5nVGFnXSgpOiBzdHJpbmcge1xuICAgIHJldHVybiAnTXVsdGlwYXJ0Qm9keSc7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGlzTXVsdGlwYXJ0Qm9keSA9IChib2R5OiBhbnkpOiBib2R5IGlzIE11bHRpcGFydEJvZHkgPT5cbiAgYm9keSAmJiB0eXBlb2YgYm9keSA9PT0gJ29iamVjdCcgJiYgYm9keS5ib2R5ICYmIGJvZHlbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PT0gJ011bHRpcGFydEJvZHknO1xuXG4vKipcbiAqIFJldHVybnMgYSBtdWx0aXBhcnQvZm9ybS1kYXRhIHJlcXVlc3QgaWYgYW55IHBhcnQgb2YgdGhlIGdpdmVuIHJlcXVlc3QgYm9keSBjb250YWlucyBhIEZpbGUgLyBCbG9iIHZhbHVlLlxuICogT3RoZXJ3aXNlIHJldHVybnMgdGhlIHJlcXVlc3QgYXMgaXMuXG4gKi9cbmV4cG9ydCBjb25zdCBtYXliZU11bHRpcGFydEZvcm1SZXF1ZXN0T3B0aW9ucyA9IGFzeW5jIDxUIGV4dGVuZHMge30gPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4oXG4gIG9wdHM6IFJlcXVlc3RPcHRpb25zPFQ+LFxuKTogUHJvbWlzZTxSZXF1ZXN0T3B0aW9uczxUIHwgTXVsdGlwYXJ0Qm9keT4+ID0+IHtcbiAgaWYgKCFoYXNVcGxvYWRhYmxlVmFsdWUob3B0cy5ib2R5KSkgcmV0dXJuIG9wdHM7XG5cbiAgY29uc3QgZm9ybSA9IGF3YWl0IGNyZWF0ZUZvcm0ob3B0cy5ib2R5KTtcbiAgcmV0dXJuIGdldE11bHRpcGFydFJlcXVlc3RPcHRpb25zKGZvcm0sIG9wdHMpO1xufTtcblxuZXhwb3J0IGNvbnN0IG11bHRpcGFydEZvcm1SZXF1ZXN0T3B0aW9ucyA9IGFzeW5jIDxUIGV4dGVuZHMge30gPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4oXG4gIG9wdHM6IFJlcXVlc3RPcHRpb25zPFQ+LFxuKTogUHJvbWlzZTxSZXF1ZXN0T3B0aW9uczxUIHwgTXVsdGlwYXJ0Qm9keT4+ID0+IHtcbiAgY29uc3QgZm9ybSA9IGF3YWl0IGNyZWF0ZUZvcm0ob3B0cy5ib2R5KTtcbiAgcmV0dXJuIGdldE11bHRpcGFydFJlcXVlc3RPcHRpb25zKGZvcm0sIG9wdHMpO1xufTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUZvcm0gPSBhc3luYyA8VCA9IFJlY29yZDxzdHJpbmcsIHVua25vd24+Pihib2R5OiBUIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxGb3JtRGF0YT4gPT4ge1xuICBjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gIGF3YWl0IFByb21pc2UuYWxsKE9iamVjdC5lbnRyaWVzKGJvZHkgfHwge30pLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBhZGRGb3JtVmFsdWUoZm9ybSwga2V5LCB2YWx1ZSkpKTtcbiAgcmV0dXJuIGZvcm07XG59O1xuXG5jb25zdCBoYXNVcGxvYWRhYmxlVmFsdWUgPSAodmFsdWU6IHVua25vd24pOiBib29sZWFuID0+IHtcbiAgaWYgKGlzVXBsb2FkYWJsZSh2YWx1ZSkpIHJldHVybiB0cnVlO1xuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHJldHVybiB2YWx1ZS5zb21lKGhhc1VwbG9hZGFibGVWYWx1ZSk7XG4gIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgZm9yIChjb25zdCBrIGluIHZhbHVlKSB7XG4gICAgICBpZiAoaGFzVXBsb2FkYWJsZVZhbHVlKCh2YWx1ZSBhcyBhbnkpW2tdKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IGFkZEZvcm1WYWx1ZSA9IGFzeW5jIChmb3JtOiBGb3JtRGF0YSwga2V5OiBzdHJpbmcsIHZhbHVlOiB1bmtub3duKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgIGBSZWNlaXZlZCBudWxsIGZvciBcIiR7a2V5fVwiOyB0byBwYXNzIG51bGwgaW4gRm9ybURhdGEsIHlvdSBtdXN0IHVzZSB0aGUgc3RyaW5nICdudWxsJ2AsXG4gICAgKTtcbiAgfVxuXG4gIC8vIFRPRE86IG1ha2UgbmVzdGVkIGZvcm1hdHMgY29uZmlndXJhYmxlXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICBmb3JtLmFwcGVuZChrZXksIFN0cmluZyh2YWx1ZSkpO1xuICB9IGVsc2UgaWYgKGlzVXBsb2FkYWJsZSh2YWx1ZSkpIHtcbiAgICBjb25zdCBmaWxlID0gYXdhaXQgdG9GaWxlKHZhbHVlKTtcbiAgICBmb3JtLmFwcGVuZChrZXksIGZpbGUgYXMgRmlsZSk7XG4gIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBhd2FpdCBQcm9taXNlLmFsbCh2YWx1ZS5tYXAoKGVudHJ5KSA9PiBhZGRGb3JtVmFsdWUoZm9ybSwga2V5ICsgJ1tdJywgZW50cnkpKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgT2JqZWN0LmVudHJpZXModmFsdWUpLm1hcCgoW25hbWUsIHByb3BdKSA9PiBhZGRGb3JtVmFsdWUoZm9ybSwgYCR7a2V5fVske25hbWV9XWAsIHByb3ApKSxcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICBgSW52YWxpZCB2YWx1ZSBnaXZlbiB0byBmb3JtLCBleHBlY3RlZCBhIHN0cmluZywgbnVtYmVyLCBib29sZWFuLCBvYmplY3QsIEFycmF5LCBGaWxlIG9yIEJsb2IgYnV0IGdvdCAke3ZhbHVlfSBpbnN0ZWFkYCxcbiAgICApO1xuICB9XG59O1xuIiwgImltcG9ydCB7IFZFUlNJT04gfSBmcm9tICcuL3ZlcnNpb24uanMnO1xuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSAnLi9zdHJlYW1pbmcuanMnO1xuaW1wb3J0IHsgQVBJRXJyb3IsIEFQSUNvbm5lY3Rpb25FcnJvciwgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvciwgQVBJVXNlckFib3J0RXJyb3IgfSBmcm9tICcuL2Vycm9yLmpzJztcbmltcG9ydCB0eXBlIHsgUmVhZGFibGUgfSBmcm9tICcuL19zaGltcy9ub2RlLXJlYWRhYmxlLmpzJztcbmltcG9ydCB7IGdldERlZmF1bHRBZ2VudCwgdHlwZSBBZ2VudCB9IGZyb20gJy4vX3NoaW1zL2FnZW50LmpzJztcbmltcG9ydCB7XG4gIGZldGNoLFxuICBpc1BvbHlmaWxsZWQgYXMgZmV0Y2hJc1BvbHlmaWxsZWQsXG4gIHR5cGUgUmVxdWVzdEluZm8sXG4gIHR5cGUgUmVxdWVzdEluaXQsXG4gIHR5cGUgUmVzcG9uc2UsXG4gIHR5cGUgSGVhZGVyc0luaXQsXG59IGZyb20gJy4vX3NoaW1zL2ZldGNoLmpzJztcbmV4cG9ydCB7IHR5cGUgUmVzcG9uc2UgfTtcbmltcG9ydCB7IGlzTXVsdGlwYXJ0Qm9keSB9IGZyb20gJy4vdXBsb2Fkcy5qcyc7XG5leHBvcnQge1xuICBtYXliZU11bHRpcGFydEZvcm1SZXF1ZXN0T3B0aW9ucyxcbiAgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zLFxuICBjcmVhdGVGb3JtLFxuICB0eXBlIFVwbG9hZGFibGUsXG59IGZyb20gJy4vdXBsb2Fkcy5qcyc7XG5cbmNvbnN0IE1BWF9SRVRSSUVTID0gMjtcblxuZXhwb3J0IHR5cGUgRmV0Y2ggPSAodXJsOiBSZXF1ZXN0SW5mbywgaW5pdD86IFJlcXVlc3RJbml0KSA9PiBQcm9taXNlPFJlc3BvbnNlPjtcblxudHlwZSBQcm9taXNlT3JWYWx1ZTxUPiA9IFQgfCBQcm9taXNlPFQ+O1xuXG50eXBlIEFQSVJlc3BvbnNlUHJvcHMgPSB7XG4gIHJlc3BvbnNlOiBSZXNwb25zZTtcbiAgb3B0aW9uczogRmluYWxSZXF1ZXN0T3B0aW9ucztcbiAgY29udHJvbGxlcjogQWJvcnRDb250cm9sbGVyO1xufTtcblxuYXN5bmMgZnVuY3Rpb24gZGVmYXVsdFBhcnNlUmVzcG9uc2U8VD4ocHJvcHM6IEFQSVJlc3BvbnNlUHJvcHMpOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgeyByZXNwb25zZSB9ID0gcHJvcHM7XG4gIGlmIChwcm9wcy5vcHRpb25zLnN0cmVhbSkge1xuICAgIC8vIE5vdGU6IHRoZXJlIGlzIGFuIGludmFyaWFudCBoZXJlIHRoYXQgaXNuJ3QgcmVwcmVzZW50ZWQgaW4gdGhlIHR5cGUgc3lzdGVtXG4gICAgLy8gdGhhdCBpZiB5b3Ugc2V0IGBzdHJlYW06IHRydWVgIHRoZSByZXNwb25zZSB0eXBlIG11c3QgYWxzbyBiZSBgU3RyZWFtPFQ+YFxuICAgIHJldHVybiBuZXcgU3RyZWFtKHJlc3BvbnNlLCBwcm9wcy5jb250cm9sbGVyKSBhcyBhbnk7XG4gIH1cblxuICBjb25zdCBjb250ZW50VHlwZSA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKTtcbiAgaWYgKGNvbnRlbnRUeXBlPy5pbmNsdWRlcygnYXBwbGljYXRpb24vanNvbicpKSB7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgIGRlYnVnKCdyZXNwb25zZScsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UudXJsLCByZXNwb25zZS5oZWFkZXJzLCBqc29uKTtcblxuICAgIHJldHVybiBqc29uIGFzIFQ7XG4gIH1cblxuICAvLyBUT0RPIGhhbmRsZSBibG9iLCBhcnJheWJ1ZmZlciwgb3RoZXIgY29udGVudCB0eXBlcywgZXRjLlxuICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICBkZWJ1ZygncmVzcG9uc2UnLCByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnVybCwgcmVzcG9uc2UuaGVhZGVycywgdGV4dCk7XG4gIHJldHVybiB0ZXh0IGFzIGFueSBhcyBUO1xufVxuXG4vKipcbiAqIEEgc3ViY2xhc3Mgb2YgYFByb21pc2VgIHByb3ZpZGluZyBhZGRpdGlvbmFsIGhlbHBlciBtZXRob2RzXG4gKiBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgU0RLLlxuICovXG5leHBvcnQgY2xhc3MgQVBJUHJvbWlzZTxUPiBleHRlbmRzIFByb21pc2U8VD4ge1xuICBwcml2YXRlIHBhcnNlZFByb21pc2U6IFByb21pc2U8VD4gfCB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZXNwb25zZVByb21pc2U6IFByb21pc2U8QVBJUmVzcG9uc2VQcm9wcz4sXG4gICAgcHJpdmF0ZSBwYXJzZVJlc3BvbnNlOiAocHJvcHM6IEFQSVJlc3BvbnNlUHJvcHMpID0+IFByb21pc2VPclZhbHVlPFQ+ID0gZGVmYXVsdFBhcnNlUmVzcG9uc2UsXG4gICkge1xuICAgIHN1cGVyKChyZXNvbHZlKSA9PiB7XG4gICAgICAvLyB0aGlzIGlzIG1heWJlIGEgYml0IHdlaXJkIGJ1dCB0aGlzIGhhcyB0byBiZSBhIG5vLW9wIHRvIG5vdCBpbXBsaWNpdGx5XG4gICAgICAvLyBwYXJzZSB0aGUgcmVzcG9uc2UgYm9keTsgaW5zdGVhZCAudGhlbiwgLmNhdGNoLCAuZmluYWxseSBhcmUgb3ZlcnJpZGRlblxuICAgICAgLy8gdG8gcGFyc2UgdGhlIHJlc3BvbnNlXG4gICAgICByZXNvbHZlKG51bGwgYXMgYW55KTtcbiAgICB9KTtcbiAgfVxuXG4gIF90aGVuVW53cmFwPFU+KHRyYW5zZm9ybTogKGRhdGE6IFQpID0+IFUpOiBBUElQcm9taXNlPFU+IHtcbiAgICByZXR1cm4gbmV3IEFQSVByb21pc2UodGhpcy5yZXNwb25zZVByb21pc2UsIGFzeW5jIChwcm9wcykgPT4gdHJhbnNmb3JtKGF3YWl0IHRoaXMucGFyc2VSZXNwb25zZShwcm9wcykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSByYXcgYFJlc3BvbnNlYCBpbnN0YW5jZSBpbnN0ZWFkIG9mIHBhcnNpbmcgdGhlIHJlc3BvbnNlXG4gICAqIGRhdGEuXG4gICAqXG4gICAqIElmIHlvdSB3YW50IHRvIHBhcnNlIHRoZSByZXNwb25zZSBib2R5IGJ1dCBzdGlsbCBnZXQgdGhlIGBSZXNwb25zZWBcbiAgICogaW5zdGFuY2UsIHlvdSBjYW4gdXNlIHtAbGluayB3aXRoUmVzcG9uc2UoKX0uXG4gICAqL1xuICBhc1Jlc3BvbnNlKCk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZVByb21pc2UudGhlbigocCkgPT4gcC5yZXNwb25zZSk7XG4gIH1cbiAgLyoqXG4gICAqIEdldHMgdGhlIHBhcnNlZCByZXNwb25zZSBkYXRhIGFuZCB0aGUgcmF3IGBSZXNwb25zZWAgaW5zdGFuY2UuXG4gICAqXG4gICAqIElmIHlvdSBqdXN0IHdhbnQgdG8gZ2V0IHRoZSByYXcgYFJlc3BvbnNlYCBpbnN0YW5jZSB3aXRob3V0IHBhcnNpbmcgaXQsXG4gICAqIHlvdSBjYW4gdXNlIHtAbGluayBhc1Jlc3BvbnNlKCl9LlxuICAgKi9cbiAgYXN5bmMgd2l0aFJlc3BvbnNlKCk6IFByb21pc2U8eyBkYXRhOiBUOyByZXNwb25zZTogUmVzcG9uc2UgfT4ge1xuICAgIGNvbnN0IFtkYXRhLCByZXNwb25zZV0gPSBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy5wYXJzZSgpLCB0aGlzLmFzUmVzcG9uc2UoKV0pO1xuICAgIHJldHVybiB7IGRhdGEsIHJlc3BvbnNlIH07XG4gIH1cblxuICBwcml2YXRlIHBhcnNlKCk6IFByb21pc2U8VD4ge1xuICAgIGlmICghdGhpcy5wYXJzZWRQcm9taXNlKSB7XG4gICAgICB0aGlzLnBhcnNlZFByb21pc2UgPSB0aGlzLnJlc3BvbnNlUHJvbWlzZS50aGVuKHRoaXMucGFyc2VSZXNwb25zZSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnBhcnNlZFByb21pc2U7XG4gIH1cblxuICBvdmVycmlkZSB0aGVuPFRSZXN1bHQxID0gVCwgVFJlc3VsdDIgPSBuZXZlcj4oXG4gICAgb25mdWxmaWxsZWQ/OiAoKHZhbHVlOiBUKSA9PiBUUmVzdWx0MSB8IFByb21pc2VMaWtlPFRSZXN1bHQxPikgfCB1bmRlZmluZWQgfCBudWxsLFxuICAgIG9ucmVqZWN0ZWQ/OiAoKHJlYXNvbjogYW55KSA9PiBUUmVzdWx0MiB8IFByb21pc2VMaWtlPFRSZXN1bHQyPikgfCB1bmRlZmluZWQgfCBudWxsLFxuICApOiBQcm9taXNlPFRSZXN1bHQxIHwgVFJlc3VsdDI+IHtcbiAgICByZXR1cm4gdGhpcy5wYXJzZSgpLnRoZW4ob25mdWxmaWxsZWQsIG9ucmVqZWN0ZWQpO1xuICB9XG5cbiAgb3ZlcnJpZGUgY2F0Y2g8VFJlc3VsdCA9IG5ldmVyPihcbiAgICBvbnJlamVjdGVkPzogKChyZWFzb246IGFueSkgPT4gVFJlc3VsdCB8IFByb21pc2VMaWtlPFRSZXN1bHQ+KSB8IHVuZGVmaW5lZCB8IG51bGwsXG4gICk6IFByb21pc2U8VCB8IFRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5wYXJzZSgpLmNhdGNoKG9ucmVqZWN0ZWQpO1xuICB9XG5cbiAgb3ZlcnJpZGUgZmluYWxseShvbmZpbmFsbHk/OiAoKCkgPT4gdm9pZCkgfCB1bmRlZmluZWQgfCBudWxsKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIHRoaXMucGFyc2UoKS5maW5hbGx5KG9uZmluYWxseSk7XG4gIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFQSUNsaWVudCB7XG4gIGJhc2VVUkw6IHN0cmluZztcbiAgbWF4UmV0cmllczogbnVtYmVyO1xuICB0aW1lb3V0OiBudW1iZXI7XG4gIGh0dHBBZ2VudDogQWdlbnQgfCB1bmRlZmluZWQ7XG5cbiAgcHJpdmF0ZSBmZXRjaDogRmV0Y2g7XG4gIHByb3RlY3RlZCBpZGVtcG90ZW5jeUhlYWRlcj86IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgYmFzZVVSTCxcbiAgICBtYXhSZXRyaWVzLFxuICAgIHRpbWVvdXQgPSA2MDAwMDAsIC8vIDEwIG1pbnV0ZXNcbiAgICBodHRwQWdlbnQsXG4gICAgZmV0Y2g6IG92ZXJyaWRlbkZldGNoLFxuICB9OiB7XG4gICAgYmFzZVVSTDogc3RyaW5nO1xuICAgIG1heFJldHJpZXM/OiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gICAgdGltZW91dDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICAgIGh0dHBBZ2VudDogQWdlbnQgfCB1bmRlZmluZWQ7XG4gICAgZmV0Y2g6IEZldGNoIHwgdW5kZWZpbmVkO1xuICB9KSB7XG4gICAgdGhpcy5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICB0aGlzLm1heFJldHJpZXMgPSB2YWxpZGF0ZVBvc2l0aXZlSW50ZWdlcignbWF4UmV0cmllcycsIG1heFJldHJpZXMgPz8gTUFYX1JFVFJJRVMpO1xuICAgIHRoaXMudGltZW91dCA9IHZhbGlkYXRlUG9zaXRpdmVJbnRlZ2VyKCd0aW1lb3V0JywgdGltZW91dCk7XG4gICAgdGhpcy5odHRwQWdlbnQgPSBodHRwQWdlbnQ7XG5cbiAgICB0aGlzLmZldGNoID0gb3ZlcnJpZGVuRmV0Y2ggPz8gZmV0Y2g7XG4gIH1cblxuICBwcm90ZWN0ZWQgYXV0aEhlYWRlcnMob3B0czogRmluYWxSZXF1ZXN0T3B0aW9ucyk6IEhlYWRlcnMge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB0aGlzIHRvIGFkZCB5b3VyIG93biBkZWZhdWx0IGhlYWRlcnMsIGZvciBleGFtcGxlOlxuICAgKlxuICAgKiAge1xuICAgKiAgICAuLi5zdXBlci5kZWZhdWx0SGVhZGVycygpLFxuICAgKiAgICBBdXRob3JpemF0aW9uOiAnQmVhcmVyIDEyMycsXG4gICAqICB9XG4gICAqL1xuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMob3B0czogRmluYWxSZXF1ZXN0T3B0aW9ucyk6IEhlYWRlcnMge1xuICAgIHJldHVybiB7XG4gICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAnVXNlci1BZ2VudCc6IHRoaXMuZ2V0VXNlckFnZW50KCksXG4gICAgICAuLi5nZXRQbGF0Zm9ybUhlYWRlcnMoKSxcbiAgICAgIC4uLnRoaXMuYXV0aEhlYWRlcnMob3B0cyksXG4gICAgfTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBkZWZhdWx0UXVlcnkoKTogRGVmYXVsdFF1ZXJ5IHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB0aGlzIHRvIGFkZCB5b3VyIG93biBoZWFkZXJzIHZhbGlkYXRpb246XG4gICAqL1xuICBwcm90ZWN0ZWQgdmFsaWRhdGVIZWFkZXJzKGhlYWRlcnM6IEhlYWRlcnMsIGN1c3RvbUhlYWRlcnM6IEhlYWRlcnMpIHt9XG5cbiAgcHJvdGVjdGVkIGRlZmF1bHRJZGVtcG90ZW5jeUtleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgc3RhaW5sZXNzLW5vZGUtcmV0cnktJHt1dWlkNCgpfWA7XG4gIH1cblxuICBnZXQ8UmVxIGV4dGVuZHMge30sIFJzcD4ocGF0aDogc3RyaW5nLCBvcHRzPzogUHJvbWlzZU9yVmFsdWU8UmVxdWVzdE9wdGlvbnM8UmVxPj4pOiBBUElQcm9taXNlPFJzcD4ge1xuICAgIHJldHVybiB0aGlzLm1ldGhvZFJlcXVlc3QoJ2dldCcsIHBhdGgsIG9wdHMpO1xuICB9XG5cbiAgcG9zdDxSZXEgZXh0ZW5kcyB7fSwgUnNwPihwYXRoOiBzdHJpbmcsIG9wdHM/OiBQcm9taXNlT3JWYWx1ZTxSZXF1ZXN0T3B0aW9uczxSZXE+Pik6IEFQSVByb21pc2U8UnNwPiB7XG4gICAgcmV0dXJuIHRoaXMubWV0aG9kUmVxdWVzdCgncG9zdCcsIHBhdGgsIG9wdHMpO1xuICB9XG5cbiAgcGF0Y2g8UmVxIGV4dGVuZHMge30sIFJzcD4ocGF0aDogc3RyaW5nLCBvcHRzPzogUHJvbWlzZU9yVmFsdWU8UmVxdWVzdE9wdGlvbnM8UmVxPj4pOiBBUElQcm9taXNlPFJzcD4ge1xuICAgIHJldHVybiB0aGlzLm1ldGhvZFJlcXVlc3QoJ3BhdGNoJywgcGF0aCwgb3B0cyk7XG4gIH1cblxuICBwdXQ8UmVxIGV4dGVuZHMge30sIFJzcD4ocGF0aDogc3RyaW5nLCBvcHRzPzogUHJvbWlzZU9yVmFsdWU8UmVxdWVzdE9wdGlvbnM8UmVxPj4pOiBBUElQcm9taXNlPFJzcD4ge1xuICAgIHJldHVybiB0aGlzLm1ldGhvZFJlcXVlc3QoJ3B1dCcsIHBhdGgsIG9wdHMpO1xuICB9XG5cbiAgZGVsZXRlPFJlcSBleHRlbmRzIHt9LCBSc3A+KHBhdGg6IHN0cmluZywgb3B0cz86IFByb21pc2VPclZhbHVlPFJlcXVlc3RPcHRpb25zPFJlcT4+KTogQVBJUHJvbWlzZTxSc3A+IHtcbiAgICByZXR1cm4gdGhpcy5tZXRob2RSZXF1ZXN0KCdkZWxldGUnLCBwYXRoLCBvcHRzKTtcbiAgfVxuXG4gIHByaXZhdGUgbWV0aG9kUmVxdWVzdDxSZXEgZXh0ZW5kcyB7fSwgUnNwPihcbiAgICBtZXRob2Q6IEhUVFBNZXRob2QsXG4gICAgcGF0aDogc3RyaW5nLFxuICAgIG9wdHM/OiBQcm9taXNlT3JWYWx1ZTxSZXF1ZXN0T3B0aW9uczxSZXE+PixcbiAgKTogQVBJUHJvbWlzZTxSc3A+IHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KFByb21pc2UucmVzb2x2ZShvcHRzKS50aGVuKChvcHRzKSA9PiAoeyBtZXRob2QsIHBhdGgsIC4uLm9wdHMgfSkpKTtcbiAgfVxuXG4gIGdldEFQSUxpc3Q8SXRlbSwgUGFnZUNsYXNzIGV4dGVuZHMgQWJzdHJhY3RQYWdlPEl0ZW0+ID0gQWJzdHJhY3RQYWdlPEl0ZW0+PihcbiAgICBwYXRoOiBzdHJpbmcsXG4gICAgUGFnZTogbmV3ICguLi5hcmdzOiBhbnlbXSkgPT4gUGFnZUNsYXNzLFxuICAgIG9wdHM/OiBSZXF1ZXN0T3B0aW9uczxhbnk+LFxuICApOiBQYWdlUHJvbWlzZTxQYWdlQ2xhc3MsIEl0ZW0+IHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0QVBJTGlzdChQYWdlLCB7IG1ldGhvZDogJ2dldCcsIHBhdGgsIC4uLm9wdHMgfSk7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbnRlbnRMZW5ndGgoYm9keTogdW5rbm93bik6IHN0cmluZyB8IG51bGwge1xuICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGlmICh0eXBlb2YgQnVmZmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gQnVmZmVyLmJ5dGVMZW5ndGgoYm9keSwgJ3V0ZjgnKS50b1N0cmluZygpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIFRleHRFbmNvZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIGNvbnN0IGVuY29kZWQgPSBlbmNvZGVyLmVuY29kZShib2R5KTtcbiAgICAgICAgcmV0dXJuIGVuY29kZWQubGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBidWlsZFJlcXVlc3Q8UmVxIGV4dGVuZHMge30+KFxuICAgIG9wdGlvbnM6IEZpbmFsUmVxdWVzdE9wdGlvbnM8UmVxPixcbiAgKTogeyByZXE6IFJlcXVlc3RJbml0OyB1cmw6IHN0cmluZzsgdGltZW91dDogbnVtYmVyIH0ge1xuICAgIGNvbnN0IHsgbWV0aG9kLCBwYXRoLCBxdWVyeSwgaGVhZGVyczogaGVhZGVycyA9IHt9IH0gPSBvcHRpb25zO1xuXG4gICAgY29uc3QgYm9keSA9XG4gICAgICBpc011bHRpcGFydEJvZHkob3B0aW9ucy5ib2R5KSA/IG9wdGlvbnMuYm9keS5ib2R5XG4gICAgICA6IG9wdGlvbnMuYm9keSA/IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYm9keSwgbnVsbCwgMilcbiAgICAgIDogbnVsbDtcbiAgICBjb25zdCBjb250ZW50TGVuZ3RoID0gdGhpcy5jYWxjdWxhdGVDb250ZW50TGVuZ3RoKGJvZHkpO1xuXG4gICAgY29uc3QgdXJsID0gdGhpcy5idWlsZFVSTChwYXRoISwgcXVlcnkpO1xuICAgIGlmICgndGltZW91dCcgaW4gb3B0aW9ucykgdmFsaWRhdGVQb3NpdGl2ZUludGVnZXIoJ3RpbWVvdXQnLCBvcHRpb25zLnRpbWVvdXQpO1xuICAgIGNvbnN0IHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQgPz8gdGhpcy50aW1lb3V0O1xuICAgIGNvbnN0IGh0dHBBZ2VudCA9IG9wdGlvbnMuaHR0cEFnZW50ID8/IHRoaXMuaHR0cEFnZW50ID8/IGdldERlZmF1bHRBZ2VudCh1cmwpO1xuICAgIGNvbnN0IG1pbkFnZW50VGltZW91dCA9IHRpbWVvdXQgKyAxMDAwO1xuICAgIGlmIChcbiAgICAgIHR5cGVvZiAoaHR0cEFnZW50IGFzIGFueSk/Lm9wdGlvbnM/LnRpbWVvdXQgPT09ICdudW1iZXInICYmXG4gICAgICBtaW5BZ2VudFRpbWVvdXQgPiAoKGh0dHBBZ2VudCBhcyBhbnkpLm9wdGlvbnMudGltZW91dCA/PyAwKVxuICAgICkge1xuICAgICAgLy8gQWxsb3cgYW55IGdpdmVuIHJlcXVlc3QgdG8gYnVtcCBvdXIgYWdlbnQgYWN0aXZlIHNvY2tldCB0aW1lb3V0LlxuICAgICAgLy8gVGhpcyBtYXkgc2VlbSBzdHJhbmdlLCBidXQgbGVha2luZyBhY3RpdmUgc29ja2V0cyBzaG91bGQgYmUgcmFyZSBhbmQgbm90IHBhcnRpY3VsYXJseSBwcm9ibGVtYXRpYyxcbiAgICAgIC8vIGFuZCB3aXRob3V0IG11dGF0aW5nIGFnZW50IHdlIHdvdWxkIG5lZWQgdG8gY3JlYXRlIG1vcmUgb2YgdGhlbS5cbiAgICAgIC8vIFRoaXMgdHJhZGVvZmYgb3B0aW1pemVzIGZvciBwZXJmb3JtYW5jZS5cbiAgICAgIChodHRwQWdlbnQgYXMgYW55KS5vcHRpb25zLnRpbWVvdXQgPSBtaW5BZ2VudFRpbWVvdXQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaWRlbXBvdGVuY3lIZWFkZXIgJiYgbWV0aG9kICE9PSAnZ2V0Jykge1xuICAgICAgaWYgKCFvcHRpb25zLmlkZW1wb3RlbmN5S2V5KSBvcHRpb25zLmlkZW1wb3RlbmN5S2V5ID0gdGhpcy5kZWZhdWx0SWRlbXBvdGVuY3lLZXkoKTtcbiAgICAgIGhlYWRlcnNbdGhpcy5pZGVtcG90ZW5jeUhlYWRlcl0gPSBvcHRpb25zLmlkZW1wb3RlbmN5S2V5O1xuICAgIH1cblxuICAgIGNvbnN0IHJlcUhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAuLi4oY29udGVudExlbmd0aCAmJiB7ICdDb250ZW50LUxlbmd0aCc6IGNvbnRlbnRMZW5ndGggfSksXG4gICAgICAuLi50aGlzLmRlZmF1bHRIZWFkZXJzKG9wdGlvbnMpLFxuICAgICAgLi4uaGVhZGVycyxcbiAgICB9O1xuICAgIC8vIGxldCBidWlsdGluIGZldGNoIHNldCB0aGUgQ29udGVudC1UeXBlIGZvciBtdWx0aXBhcnQgYm9kaWVzXG4gICAgaWYgKGlzTXVsdGlwYXJ0Qm9keShvcHRpb25zLmJvZHkpICYmICFmZXRjaElzUG9seWZpbGxlZCkge1xuICAgICAgZGVsZXRlIHJlcUhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddO1xuICAgIH1cblxuICAgIC8vIFN0cmlwIGFueSBoZWFkZXJzIGJlaW5nIGV4cGxpY2l0bHkgb21pdHRlZCB3aXRoIG51bGxcbiAgICBPYmplY3Qua2V5cyhyZXFIZWFkZXJzKS5mb3JFYWNoKChrZXkpID0+IHJlcUhlYWRlcnNba2V5XSA9PT0gbnVsbCAmJiBkZWxldGUgcmVxSGVhZGVyc1trZXldKTtcblxuICAgIGNvbnN0IHJlcTogUmVxdWVzdEluaXQgPSB7XG4gICAgICBtZXRob2QsXG4gICAgICAuLi4oYm9keSAmJiB7IGJvZHk6IGJvZHkgYXMgYW55IH0pLFxuICAgICAgaGVhZGVyczogcmVxSGVhZGVycyxcbiAgICAgIC4uLihodHRwQWdlbnQgJiYgeyBhZ2VudDogaHR0cEFnZW50IH0pLFxuICAgICAgLy8gQHRzLWlnbm9yZSBub2RlLWZldGNoIHVzZXMgYSBjdXN0b20gQWJvcnRTaWduYWwgdHlwZSB0aGF0IGlzXG4gICAgICAvLyBub3QgY29tcGF0aWJsZSB3aXRoIHN0YW5kYXJkIHdlYiB0eXBlc1xuICAgICAgc2lnbmFsOiBvcHRpb25zLnNpZ25hbCA/PyBudWxsLFxuICAgIH07XG5cbiAgICB0aGlzLnZhbGlkYXRlSGVhZGVycyhyZXFIZWFkZXJzLCBoZWFkZXJzKTtcblxuICAgIHJldHVybiB7IHJlcSwgdXJsLCB0aW1lb3V0IH07XG4gIH1cblxuICAvKipcbiAgICogVXNlZCBhcyBhIGNhbGxiYWNrIGZvciBtdXRhdGluZyB0aGUgZ2l2ZW4gYFJlcXVlc3RJbml0YCBvYmplY3QuXG4gICAqXG4gICAqIFRoaXMgaXMgdXNlZnVsIGZvciBjYXNlcyB3aGVyZSB5b3Ugd2FudCB0byBhZGQgY2VydGFpbiBoZWFkZXJzIGJhc2VkIG9mZiBvZlxuICAgKiB0aGUgcmVxdWVzdCBwcm9wZXJ0aWVzLCBlLmcuIGBtZXRob2RgIG9yIGB1cmxgLlxuICAgKi9cbiAgcHJvdGVjdGVkIGFzeW5jIHByZXBhcmVSZXF1ZXN0KFxuICAgIHJlcXVlc3Q6IFJlcXVlc3RJbml0LFxuICAgIHsgdXJsLCBvcHRpb25zIH06IHsgdXJsOiBzdHJpbmc7IG9wdGlvbnM6IEZpbmFsUmVxdWVzdE9wdGlvbnMgfSxcbiAgKTogUHJvbWlzZTx2b2lkPiB7fVxuXG4gIHByb3RlY3RlZCBwYXJzZUhlYWRlcnMoaGVhZGVyczogSGVhZGVyc0luaXQgfCBudWxsIHwgdW5kZWZpbmVkKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgcmV0dXJuIChcbiAgICAgICFoZWFkZXJzID8ge31cbiAgICAgIDogU3ltYm9sLml0ZXJhdG9yIGluIGhlYWRlcnMgP1xuICAgICAgICBPYmplY3QuZnJvbUVudHJpZXMoQXJyYXkuZnJvbShoZWFkZXJzIGFzIEl0ZXJhYmxlPHN0cmluZ1tdPikubWFwKChoZWFkZXIpID0+IFsuLi5oZWFkZXJdKSlcbiAgICAgIDogeyAuLi5oZWFkZXJzIH1cbiAgICApO1xuICB9XG5cbiAgcHJvdGVjdGVkIG1ha2VTdGF0dXNFcnJvcihcbiAgICBzdGF0dXM6IG51bWJlciB8IHVuZGVmaW5lZCxcbiAgICBlcnJvcjogT2JqZWN0IHwgdW5kZWZpbmVkLFxuICAgIG1lc3NhZ2U6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICBoZWFkZXJzOiBIZWFkZXJzIHwgdW5kZWZpbmVkLFxuICApIHtcbiAgICByZXR1cm4gQVBJRXJyb3IuZ2VuZXJhdGUoc3RhdHVzLCBlcnJvciwgbWVzc2FnZSwgaGVhZGVycyk7XG4gIH1cblxuICByZXF1ZXN0PFJlcSBleHRlbmRzIHt9LCBSc3A+KFxuICAgIG9wdGlvbnM6IFByb21pc2VPclZhbHVlPEZpbmFsUmVxdWVzdE9wdGlvbnM8UmVxPj4sXG4gICAgcmVtYWluaW5nUmV0cmllczogbnVtYmVyIHwgbnVsbCA9IG51bGwsXG4gICk6IEFQSVByb21pc2U8UnNwPiB7XG4gICAgcmV0dXJuIG5ldyBBUElQcm9taXNlKHRoaXMubWFrZVJlcXVlc3Qob3B0aW9ucywgcmVtYWluaW5nUmV0cmllcykpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVxdWVzdChcbiAgICBvcHRpb25zSW5wdXQ6IFByb21pc2VPclZhbHVlPEZpbmFsUmVxdWVzdE9wdGlvbnM+LFxuICAgIHJldHJpZXNSZW1haW5pbmc6IG51bWJlciB8IG51bGwsXG4gICk6IFByb21pc2U8QVBJUmVzcG9uc2VQcm9wcz4ge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBhd2FpdCBvcHRpb25zSW5wdXQ7XG4gICAgaWYgKHJldHJpZXNSZW1haW5pbmcgPT0gbnVsbCkge1xuICAgICAgcmV0cmllc1JlbWFpbmluZyA9IG9wdGlvbnMubWF4UmV0cmllcyA/PyB0aGlzLm1heFJldHJpZXM7XG4gICAgfVxuXG4gICAgY29uc3QgeyByZXEsIHVybCwgdGltZW91dCB9ID0gdGhpcy5idWlsZFJlcXVlc3Qob3B0aW9ucyk7XG5cbiAgICBhd2FpdCB0aGlzLnByZXBhcmVSZXF1ZXN0KHJlcSwgeyB1cmwsIG9wdGlvbnMgfSk7XG5cbiAgICBkZWJ1ZygncmVxdWVzdCcsIHVybCwgb3B0aW9ucywgcmVxLmhlYWRlcnMpO1xuXG4gICAgaWYgKG9wdGlvbnMuc2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJVXNlckFib3J0RXJyb3IoKTtcbiAgICB9XG5cbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5mZXRjaFdpdGhUaW1lb3V0KHVybCwgcmVxLCB0aW1lb3V0LCBjb250cm9sbGVyKS5jYXRjaChjYXN0VG9FcnJvcik7XG5cbiAgICBpZiAocmVzcG9uc2UgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgaWYgKG9wdGlvbnMuc2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElVc2VyQWJvcnRFcnJvcigpO1xuICAgICAgfVxuICAgICAgaWYgKHJldHJpZXNSZW1haW5pbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cnlSZXF1ZXN0KG9wdGlvbnMsIHJldHJpZXNSZW1haW5pbmcpO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3BvbnNlLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICB0aHJvdyBuZXcgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvcigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEFQSUNvbm5lY3Rpb25FcnJvcih7IGNhdXNlOiByZXNwb25zZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBjcmVhdGVSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UuaGVhZGVycyk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBpZiAocmV0cmllc1JlbWFpbmluZyAmJiB0aGlzLnNob3VsZFJldHJ5KHJlc3BvbnNlKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXRyeVJlcXVlc3Qob3B0aW9ucywgcmV0cmllc1JlbWFpbmluZywgcmVzcG9uc2VIZWFkZXJzKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZXJyVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiAnVW5rbm93bicpO1xuICAgICAgY29uc3QgZXJySlNPTiA9IHNhZmVKU09OKGVyclRleHQpO1xuICAgICAgY29uc3QgZXJyTWVzc2FnZSA9IGVyckpTT04gPyB1bmRlZmluZWQgOiBlcnJUZXh0O1xuXG4gICAgICBkZWJ1ZygncmVzcG9uc2UnLCByZXNwb25zZS5zdGF0dXMsIHVybCwgcmVzcG9uc2VIZWFkZXJzLCBlcnJNZXNzYWdlKTtcblxuICAgICAgY29uc3QgZXJyID0gdGhpcy5tYWtlU3RhdHVzRXJyb3IocmVzcG9uc2Uuc3RhdHVzLCBlcnJKU09OLCBlcnJNZXNzYWdlLCByZXNwb25zZUhlYWRlcnMpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cblxuICAgIHJldHVybiB7IHJlc3BvbnNlLCBvcHRpb25zLCBjb250cm9sbGVyIH07XG4gIH1cblxuICByZXF1ZXN0QVBJTGlzdDxJdGVtID0gdW5rbm93biwgUGFnZUNsYXNzIGV4dGVuZHMgQWJzdHJhY3RQYWdlPEl0ZW0+ID0gQWJzdHJhY3RQYWdlPEl0ZW0+PihcbiAgICBQYWdlOiBuZXcgKC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgQWJzdHJhY3RQYWdlPikgPT4gUGFnZUNsYXNzLFxuICAgIG9wdGlvbnM6IEZpbmFsUmVxdWVzdE9wdGlvbnMsXG4gICk6IFBhZ2VQcm9taXNlPFBhZ2VDbGFzcywgSXRlbT4ge1xuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLm1ha2VSZXF1ZXN0KG9wdGlvbnMsIG51bGwpO1xuICAgIHJldHVybiBuZXcgUGFnZVByb21pc2U8UGFnZUNsYXNzLCBJdGVtPih0aGlzLCByZXF1ZXN0LCBQYWdlKTtcbiAgfVxuXG4gIGJ1aWxkVVJMPFJlcSBleHRlbmRzIFJlY29yZDxzdHJpbmcsIHVua25vd24+PihwYXRoOiBzdHJpbmcsIHF1ZXJ5OiBSZXEgfCBudWxsIHwgdW5kZWZpbmVkKTogc3RyaW5nIHtcbiAgICBjb25zdCB1cmwgPVxuICAgICAgaXNBYnNvbHV0ZVVSTChwYXRoKSA/XG4gICAgICAgIG5ldyBVUkwocGF0aClcbiAgICAgIDogbmV3IFVSTCh0aGlzLmJhc2VVUkwgKyAodGhpcy5iYXNlVVJMLmVuZHNXaXRoKCcvJykgJiYgcGF0aC5zdGFydHNXaXRoKCcvJykgPyBwYXRoLnNsaWNlKDEpIDogcGF0aCkpO1xuXG4gICAgY29uc3QgZGVmYXVsdFF1ZXJ5ID0gdGhpcy5kZWZhdWx0UXVlcnkoKTtcbiAgICBpZiAoIWlzRW1wdHlPYmooZGVmYXVsdFF1ZXJ5KSkge1xuICAgICAgcXVlcnkgPSB7IC4uLmRlZmF1bHRRdWVyeSwgLi4ucXVlcnkgfSBhcyBSZXE7XG4gICAgfVxuXG4gICAgaWYgKHF1ZXJ5KSB7XG4gICAgICB1cmwuc2VhcmNoID0gdGhpcy5zdHJpbmdpZnlRdWVyeShxdWVyeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVybC50b1N0cmluZygpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHN0cmluZ2lmeVF1ZXJ5KHF1ZXJ5OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHN0cmluZyB7XG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHF1ZXJ5KVxuICAgICAgLmZpbHRlcigoW18sIHZhbHVlXSkgPT4gdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJylcbiAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgcmV0dXJuIGAke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSl9YDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PWA7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIGBDYW5ub3Qgc3RyaW5naWZ5IHR5cGUgJHt0eXBlb2YgdmFsdWV9OyBFeHBlY3RlZCBzdHJpbmcsIG51bWJlciwgYm9vbGVhbiwgb3IgbnVsbC4gSWYgeW91IG5lZWQgdG8gcGFzcyBuZXN0ZWQgcXVlcnkgcGFyYW1ldGVycywgeW91IGNhbiBtYW51YWxseSBlbmNvZGUgdGhlbSwgZS5nLiB7IHF1ZXJ5OiB7ICdmb29ba2V5MV0nOiB2YWx1ZTEsICdmb29ba2V5Ml0nOiB2YWx1ZTIgfSB9LCBhbmQgcGxlYXNlIG9wZW4gYSBHaXRIdWIgaXNzdWUgcmVxdWVzdGluZyBiZXR0ZXIgc3VwcG9ydCBmb3IgeW91ciB1c2UgY2FzZS5gLFxuICAgICAgICApO1xuICAgICAgfSlcbiAgICAgIC5qb2luKCcmJyk7XG4gIH1cblxuICBhc3luYyBmZXRjaFdpdGhUaW1lb3V0KFxuICAgIHVybDogUmVxdWVzdEluZm8sXG4gICAgaW5pdDogUmVxdWVzdEluaXQgfCB1bmRlZmluZWQsXG4gICAgbXM6IG51bWJlcixcbiAgICBjb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXIsXG4gICk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgICBjb25zdCB7IHNpZ25hbCwgLi4ub3B0aW9ucyB9ID0gaW5pdCB8fCB7fTtcbiAgICBpZiAoc2lnbmFsKSBzaWduYWwuYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCAoKSA9PiBjb250cm9sbGVyLmFib3J0KCkpO1xuXG4gICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCBtcyk7XG5cbiAgICByZXR1cm4gdGhpcy5nZXRSZXF1ZXN0Q2xpZW50KClcbiAgICAgIC5mZXRjaCh1cmwsIHsgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCBhcyBhbnksIC4uLm9wdGlvbnMgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0UmVxdWVzdENsaWVudCgpOiBSZXF1ZXN0Q2xpZW50IHtcbiAgICByZXR1cm4geyBmZXRjaDogdGhpcy5mZXRjaCB9O1xuICB9XG5cbiAgcHJpdmF0ZSBzaG91bGRSZXRyeShyZXNwb25zZTogUmVzcG9uc2UpOiBib29sZWFuIHtcbiAgICAvLyBOb3RlIHRoaXMgaXMgbm90IGEgc3RhbmRhcmQgaGVhZGVyLlxuICAgIGNvbnN0IHNob3VsZFJldHJ5SGVhZGVyID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ3gtc2hvdWxkLXJldHJ5Jyk7XG5cbiAgICAvLyBJZiB0aGUgc2VydmVyIGV4cGxpY2l0bHkgc2F5cyB3aGV0aGVyIG9yIG5vdCB0byByZXRyeSwgb2JleS5cbiAgICBpZiAoc2hvdWxkUmV0cnlIZWFkZXIgPT09ICd0cnVlJykgcmV0dXJuIHRydWU7XG4gICAgaWYgKHNob3VsZFJldHJ5SGVhZGVyID09PSAnZmFsc2UnKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBSZXRyeSBvbiBsb2NrIHRpbWVvdXRzLlxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgcmV0dXJuIHRydWU7XG5cbiAgICAvLyBSZXRyeSBvbiByYXRlIGxpbWl0cy5cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHJldHVybiB0cnVlO1xuXG4gICAgLy8gUmV0cnkgaW50ZXJuYWwgZXJyb3JzLlxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPj0gNTAwKSByZXR1cm4gdHJ1ZTtcblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmV0cnlSZXF1ZXN0KFxuICAgIG9wdGlvbnM6IEZpbmFsUmVxdWVzdE9wdGlvbnMsXG4gICAgcmV0cmllc1JlbWFpbmluZzogbnVtYmVyLFxuICAgIHJlc3BvbnNlSGVhZGVycz86IEhlYWRlcnMgfCB1bmRlZmluZWQsXG4gICk6IFByb21pc2U8QVBJUmVzcG9uc2VQcm9wcz4ge1xuICAgIHJldHJpZXNSZW1haW5pbmcgLT0gMTtcblxuICAgIC8vIEFib3V0IHRoZSBSZXRyeS1BZnRlciBoZWFkZXI6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvSGVhZGVycy9SZXRyeS1BZnRlclxuICAgIC8vXG4gICAgLy8gVE9ETzogd2UgbWF5IHdhbnQgdG8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSBoZWFkZXIgaXMgdXNpbmcgdGhlIGh0dHAtZGF0ZSBzeW50YXg6IFwiUmV0cnktQWZ0ZXI6IDxodHRwLWRhdGU+XCIuXG4gICAgLy8gU2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvSGVhZGVycy9SZXRyeS1BZnRlciNzeW50YXggZm9yIGRldGFpbHMuXG4gICAgY29uc3QgcmV0cnlBZnRlciA9IHBhcnNlSW50KHJlc3BvbnNlSGVhZGVycz8uWydyZXRyeS1hZnRlciddIHx8ICcnKTtcblxuICAgIGNvbnN0IG1heFJldHJpZXMgPSBvcHRpb25zLm1heFJldHJpZXMgPz8gdGhpcy5tYXhSZXRyaWVzO1xuICAgIGNvbnN0IHRpbWVvdXQgPSB0aGlzLmNhbGN1bGF0ZVJldHJ5VGltZW91dFNlY29uZHMocmV0cmllc1JlbWFpbmluZywgcmV0cnlBZnRlciwgbWF4UmV0cmllcykgKiAxMDAwO1xuICAgIGF3YWl0IHNsZWVwKHRpbWVvdXQpO1xuXG4gICAgcmV0dXJuIHRoaXMubWFrZVJlcXVlc3Qob3B0aW9ucywgcmV0cmllc1JlbWFpbmluZyk7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVJldHJ5VGltZW91dFNlY29uZHMoXG4gICAgcmV0cmllc1JlbWFpbmluZzogbnVtYmVyLFxuICAgIHJldHJ5QWZ0ZXI6IG51bWJlcixcbiAgICBtYXhSZXRyaWVzOiBudW1iZXIsXG4gICk6IG51bWJlciB7XG4gICAgY29uc3QgaW5pdGlhbFJldHJ5RGVsYXkgPSAwLjU7XG4gICAgY29uc3QgbWF4UmV0cnlEZWxheSA9IDI7XG5cbiAgICAvLyBJZiB0aGUgQVBJIGFza3MgdXMgdG8gd2FpdCBhIGNlcnRhaW4gYW1vdW50IG9mIHRpbWUgKGFuZCBpdCdzIGEgcmVhc29uYWJsZSBhbW91bnQpLFxuICAgIC8vIGp1c3QgZG8gd2hhdCBpdCBzYXlzLlxuICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHJldHJ5QWZ0ZXIpICYmIHJldHJ5QWZ0ZXIgPD0gNjApIHtcbiAgICAgIHJldHVybiByZXRyeUFmdGVyO1xuICAgIH1cblxuICAgIGNvbnN0IG51bVJldHJpZXMgPSBtYXhSZXRyaWVzIC0gcmV0cmllc1JlbWFpbmluZztcblxuICAgIC8vIEFwcGx5IGV4cG9uZW50aWFsIGJhY2tvZmYsIGJ1dCBub3QgbW9yZSB0aGFuIHRoZSBtYXguXG4gICAgY29uc3Qgc2xlZXBTZWNvbmRzID0gTWF0aC5taW4oaW5pdGlhbFJldHJ5RGVsYXkgKiBNYXRoLnBvdyhudW1SZXRyaWVzIC0gMSwgMiksIG1heFJldHJ5RGVsYXkpO1xuXG4gICAgLy8gQXBwbHkgc29tZSBqaXR0ZXIsIHBsdXMtb3ItbWludXMgaGFsZiBhIHNlY29uZC5cbiAgICBjb25zdCBqaXR0ZXIgPSBNYXRoLnJhbmRvbSgpIC0gMC41O1xuXG4gICAgcmV0dXJuIHNsZWVwU2Vjb25kcyArIGppdHRlcjtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VXNlckFnZW50KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke3RoaXMuY29uc3RydWN0b3IubmFtZX0vSlMgJHtWRVJTSU9OfWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFQSVJlc291cmNlIHtcbiAgcHJvdGVjdGVkIGNsaWVudDogQVBJQ2xpZW50O1xuICBjb25zdHJ1Y3RvcihjbGllbnQ6IEFQSUNsaWVudCkge1xuICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuXG4gICAgdGhpcy5nZXQgPSBjbGllbnQuZ2V0LmJpbmQoY2xpZW50KTtcbiAgICB0aGlzLnBvc3QgPSBjbGllbnQucG9zdC5iaW5kKGNsaWVudCk7XG4gICAgdGhpcy5wYXRjaCA9IGNsaWVudC5wYXRjaC5iaW5kKGNsaWVudCk7XG4gICAgdGhpcy5wdXQgPSBjbGllbnQucHV0LmJpbmQoY2xpZW50KTtcbiAgICB0aGlzLmRlbGV0ZSA9IGNsaWVudC5kZWxldGUuYmluZChjbGllbnQpO1xuICAgIHRoaXMuZ2V0QVBJTGlzdCA9IGNsaWVudC5nZXRBUElMaXN0LmJpbmQoY2xpZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXQ6IEFQSUNsaWVudFsnZ2V0J107XG4gIHByb3RlY3RlZCBwb3N0OiBBUElDbGllbnRbJ3Bvc3QnXTtcbiAgcHJvdGVjdGVkIHBhdGNoOiBBUElDbGllbnRbJ3BhdGNoJ107XG4gIHByb3RlY3RlZCBwdXQ6IEFQSUNsaWVudFsncHV0J107XG4gIHByb3RlY3RlZCBkZWxldGU6IEFQSUNsaWVudFsnZGVsZXRlJ107XG4gIHByb3RlY3RlZCBnZXRBUElMaXN0OiBBUElDbGllbnRbJ2dldEFQSUxpc3QnXTtcbn1cblxuZXhwb3J0IHR5cGUgUGFnZUluZm8gPSB7IHVybDogVVJMIH0gfCB7IHBhcmFtczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCBudWxsIH07XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFBhZ2U8SXRlbT4gaW1wbGVtZW50cyBBc3luY0l0ZXJhYmxlPEl0ZW0+IHtcbiAgI2NsaWVudDogQVBJQ2xpZW50O1xuICBwcm90ZWN0ZWQgb3B0aW9uczogRmluYWxSZXF1ZXN0T3B0aW9ucztcblxuICBwcm90ZWN0ZWQgcmVzcG9uc2U6IFJlc3BvbnNlO1xuICBwcm90ZWN0ZWQgYm9keTogdW5rbm93bjtcblxuICBjb25zdHJ1Y3RvcihjbGllbnQ6IEFQSUNsaWVudCwgcmVzcG9uc2U6IFJlc3BvbnNlLCBib2R5OiB1bmtub3duLCBvcHRpb25zOiBGaW5hbFJlcXVlc3RPcHRpb25zKSB7XG4gICAgdGhpcy4jY2xpZW50ID0gY2xpZW50O1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMuYm9keSA9IGJvZHk7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgVXNlIG5leHRQYWdlSW5mbyBpbnN0ZWFkXG4gICAqL1xuICBhYnN0cmFjdCBuZXh0UGFnZVBhcmFtcygpOiBQYXJ0aWFsPFJlY29yZDxzdHJpbmcsIHVua25vd24+PiB8IG51bGw7XG4gIGFic3RyYWN0IG5leHRQYWdlSW5mbygpOiBQYWdlSW5mbyB8IG51bGw7XG5cbiAgYWJzdHJhY3QgZ2V0UGFnaW5hdGVkSXRlbXMoKTogSXRlbVtdO1xuXG4gIGhhc05leHRQYWdlKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5nZXRQYWdpbmF0ZWRJdGVtcygpO1xuICAgIGlmICghaXRlbXMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXMubmV4dFBhZ2VJbmZvKCkgIT0gbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGdldE5leHRQYWdlKCk6IFByb21pc2U8dGhpcz4ge1xuICAgIGNvbnN0IG5leHRJbmZvID0gdGhpcy5uZXh0UGFnZUluZm8oKTtcbiAgICBpZiAoIW5leHRJbmZvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdObyBuZXh0IHBhZ2UgZXhwZWN0ZWQ7IHBsZWFzZSBjaGVjayBgLmhhc05leHRQYWdlKClgIGJlZm9yZSBjYWxsaW5nIGAuZ2V0TmV4dFBhZ2UoKWAuJyxcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IG5leHRPcHRpb25zID0geyAuLi50aGlzLm9wdGlvbnMgfTtcbiAgICBpZiAoJ3BhcmFtcycgaW4gbmV4dEluZm8pIHtcbiAgICAgIG5leHRPcHRpb25zLnF1ZXJ5ID0geyAuLi5uZXh0T3B0aW9ucy5xdWVyeSwgLi4ubmV4dEluZm8ucGFyYW1zIH07XG4gICAgfSBlbHNlIGlmICgndXJsJyBpbiBuZXh0SW5mbykge1xuICAgICAgY29uc3QgcGFyYW1zID0gWy4uLk9iamVjdC5lbnRyaWVzKG5leHRPcHRpb25zLnF1ZXJ5IHx8IHt9KSwgLi4ubmV4dEluZm8udXJsLnNlYXJjaFBhcmFtcy5lbnRyaWVzKCldO1xuICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgcGFyYW1zKSB7XG4gICAgICAgIG5leHRJbmZvLnVybC5zZWFyY2hQYXJhbXMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgbmV4dE9wdGlvbnMucXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgICBuZXh0T3B0aW9ucy5wYXRoID0gbmV4dEluZm8udXJsLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLiNjbGllbnQucmVxdWVzdEFQSUxpc3QodGhpcy5jb25zdHJ1Y3RvciBhcyBhbnksIG5leHRPcHRpb25zKTtcbiAgfVxuXG4gIGFzeW5jICppdGVyUGFnZXMoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgbGV0IHBhZ2U6IEFic3RyYWN0UGFnZTxJdGVtPiA9IHRoaXM7XG4gICAgeWllbGQgcGFnZTtcbiAgICB3aGlsZSAocGFnZS5oYXNOZXh0UGFnZSgpKSB7XG4gICAgICBwYWdlID0gYXdhaXQgcGFnZS5nZXROZXh0UGFnZSgpO1xuICAgICAgeWllbGQgcGFnZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyAqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IHBhZ2Ugb2YgdGhpcy5pdGVyUGFnZXMoKSkge1xuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHBhZ2UuZ2V0UGFnaW5hdGVkSXRlbXMoKSkge1xuICAgICAgICB5aWVsZCBpdGVtO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgc3ViY2xhc3Mgb2YgUHJvbWlzZSB3aWxsIHJlc29sdmUgdG8gYW4gaW5zdGFudGlhdGVkIFBhZ2Ugb25jZSB0aGUgcmVxdWVzdCBjb21wbGV0ZXMuXG4gKlxuICogSXQgYWxzbyBpbXBsZW1lbnRzIEFzeW5jSXRlcmFibGUgdG8gYWxsb3cgYXV0by1wYWdpbmF0aW5nIGl0ZXJhdGlvbiBvbiBhbiB1bmF3YWl0ZWQgbGlzdCBjYWxsLCBlZzpcbiAqXG4gKiAgICBmb3IgYXdhaXQgKGNvbnN0IGl0ZW0gb2YgY2xpZW50Lml0ZW1zLmxpc3QoKSkge1xuICogICAgICBjb25zb2xlLmxvZyhpdGVtKVxuICogICAgfVxuICovXG5leHBvcnQgY2xhc3MgUGFnZVByb21pc2U8XG4gICAgUGFnZUNsYXNzIGV4dGVuZHMgQWJzdHJhY3RQYWdlPEl0ZW0+LFxuICAgIEl0ZW0gPSBSZXR1cm5UeXBlPFBhZ2VDbGFzc1snZ2V0UGFnaW5hdGVkSXRlbXMnXT5bbnVtYmVyXSxcbiAgPlxuICBleHRlbmRzIEFQSVByb21pc2U8UGFnZUNsYXNzPlxuICBpbXBsZW1lbnRzIEFzeW5jSXRlcmFibGU8SXRlbT5cbntcbiAgY29uc3RydWN0b3IoXG4gICAgY2xpZW50OiBBUElDbGllbnQsXG4gICAgcmVxdWVzdDogUHJvbWlzZTxBUElSZXNwb25zZVByb3BzPixcbiAgICBQYWdlOiBuZXcgKC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgQWJzdHJhY3RQYWdlPikgPT4gUGFnZUNsYXNzLFxuICApIHtcbiAgICBzdXBlcihcbiAgICAgIHJlcXVlc3QsXG4gICAgICBhc3luYyAocHJvcHMpID0+IG5ldyBQYWdlKGNsaWVudCwgcHJvcHMucmVzcG9uc2UsIGF3YWl0IGRlZmF1bHRQYXJzZVJlc3BvbnNlKHByb3BzKSwgcHJvcHMub3B0aW9ucyksXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbGxvdyBhdXRvLXBhZ2luYXRpbmcgaXRlcmF0aW9uIG9uIGFuIHVuYXdhaXRlZCBsaXN0IGNhbGwsIGVnOlxuICAgKlxuICAgKiAgICBmb3IgYXdhaXQgKGNvbnN0IGl0ZW0gb2YgY2xpZW50Lml0ZW1zLmxpc3QoKSkge1xuICAgKiAgICAgIGNvbnNvbGUubG9nKGl0ZW0pXG4gICAqICAgIH1cbiAgICovXG4gIGFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIGNvbnN0IHBhZ2UgPSBhd2FpdCB0aGlzO1xuICAgIGZvciBhd2FpdCAoY29uc3QgaXRlbSBvZiBwYWdlKSB7XG4gICAgICB5aWVsZCBpdGVtO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlUmVzcG9uc2VIZWFkZXJzID0gKFxuICBoZWFkZXJzOiBBd2FpdGVkPFJldHVyblR5cGU8RmV0Y2g+PlsnaGVhZGVycyddLFxuKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9PiB7XG4gIHJldHVybiBuZXcgUHJveHkoXG4gICAgT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgaGVhZGVycy5lbnRyaWVzKCksXG4gICAgKSxcbiAgICB7XG4gICAgICBnZXQodGFyZ2V0LCBuYW1lKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IG5hbWUudG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIHRhcmdldFtrZXkudG9Mb3dlckNhc2UoKV0gfHwgdGFyZ2V0W2tleV07XG4gICAgICB9LFxuICAgIH0sXG4gICk7XG59O1xuXG50eXBlIEhUVFBNZXRob2QgPSAnZ2V0JyB8ICdwb3N0JyB8ICdwdXQnIHwgJ3BhdGNoJyB8ICdkZWxldGUnO1xuXG5leHBvcnQgdHlwZSBSZXF1ZXN0Q2xpZW50ID0geyBmZXRjaDogRmV0Y2ggfTtcbmV4cG9ydCB0eXBlIEhlYWRlcnMgPSBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkPjtcbmV4cG9ydCB0eXBlIERlZmF1bHRRdWVyeSA9IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG5leHBvcnQgdHlwZSBLZXlzRW51bTxUPiA9IHsgW1AgaW4ga2V5b2YgUmVxdWlyZWQ8VD5dOiB0cnVlIH07XG5cbmV4cG9ydCB0eXBlIFJlcXVlc3RPcHRpb25zPFJlcSBleHRlbmRzIHt9ID0gUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCBSZWFkYWJsZT4gPSB7XG4gIG1ldGhvZD86IEhUVFBNZXRob2Q7XG4gIHBhdGg/OiBzdHJpbmc7XG4gIHF1ZXJ5PzogUmVxIHwgdW5kZWZpbmVkO1xuICBib2R5PzogUmVxIHwgdW5kZWZpbmVkO1xuICBoZWFkZXJzPzogSGVhZGVycyB8IHVuZGVmaW5lZDtcblxuICBtYXhSZXRyaWVzPzogbnVtYmVyO1xuICBzdHJlYW0/OiBib29sZWFuIHwgdW5kZWZpbmVkO1xuICB0aW1lb3V0PzogbnVtYmVyO1xuICBodHRwQWdlbnQ/OiBBZ2VudDtcbiAgc2lnbmFsPzogQWJvcnRTaWduYWwgfCB1bmRlZmluZWQgfCBudWxsO1xuICBpZGVtcG90ZW5jeUtleT86IHN0cmluZztcbn07XG5cbi8vIFRoaXMgaXMgcmVxdWlyZWQgc28gdGhhdCB3ZSBjYW4gZGV0ZXJtaW5lIGlmIGEgZ2l2ZW4gb2JqZWN0IG1hdGNoZXMgdGhlIFJlcXVlc3RPcHRpb25zXG4vLyB0eXBlIGF0IHJ1bnRpbWUuIFdoaWxlIHRoaXMgcmVxdWlyZXMgZHVwbGljYXRpb24sIGl0IGlzIGVuZm9yY2VkIGJ5IHRoZSBUeXBlU2NyaXB0XG4vLyBjb21waWxlciBzdWNoIHRoYXQgYW55IG1pc3NpbmcgLyBleHRyYW5lb3VzIGtleXMgd2lsbCBjYXVzZSBhbiBlcnJvci5cbmNvbnN0IHJlcXVlc3RPcHRpb25zS2V5czogS2V5c0VudW08UmVxdWVzdE9wdGlvbnM+ID0ge1xuICBtZXRob2Q6IHRydWUsXG4gIHBhdGg6IHRydWUsXG4gIHF1ZXJ5OiB0cnVlLFxuICBib2R5OiB0cnVlLFxuICBoZWFkZXJzOiB0cnVlLFxuXG4gIG1heFJldHJpZXM6IHRydWUsXG4gIHN0cmVhbTogdHJ1ZSxcbiAgdGltZW91dDogdHJ1ZSxcbiAgaHR0cEFnZW50OiB0cnVlLFxuICBzaWduYWw6IHRydWUsXG4gIGlkZW1wb3RlbmN5S2V5OiB0cnVlLFxufTtcblxuZXhwb3J0IGNvbnN0IGlzUmVxdWVzdE9wdGlvbnMgPSAob2JqOiB1bmtub3duKTogb2JqIGlzIFJlcXVlc3RPcHRpb25zID0+IHtcbiAgcmV0dXJuIChcbiAgICB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJlxuICAgIG9iaiAhPT0gbnVsbCAmJlxuICAgICFpc0VtcHR5T2JqKG9iaikgJiZcbiAgICBPYmplY3Qua2V5cyhvYmopLmV2ZXJ5KChrKSA9PiBoYXNPd24ocmVxdWVzdE9wdGlvbnNLZXlzLCBrKSlcbiAgKTtcbn07XG5cbmV4cG9ydCB0eXBlIEZpbmFsUmVxdWVzdE9wdGlvbnM8UmVxIGV4dGVuZHMge30gPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IFJlYWRhYmxlPiA9IFJlcXVlc3RPcHRpb25zPFJlcT4gJiB7XG4gIG1ldGhvZDogSFRUUE1ldGhvZDtcbiAgcGF0aDogc3RyaW5nO1xufTtcblxuZGVjbGFyZSBjb25zdCBEZW5vOiBhbnk7XG5kZWNsYXJlIGNvbnN0IEVkZ2VSdW50aW1lOiBhbnk7XG50eXBlIEFyY2ggPSAneDMyJyB8ICd4NjQnIHwgJ2FybScgfCAnYXJtNjQnIHwgYG90aGVyOiR7c3RyaW5nfWAgfCAndW5rbm93bic7XG50eXBlIFBsYXRmb3JtTmFtZSA9XG4gIHwgJ01hY09TJ1xuICB8ICdMaW51eCdcbiAgfCAnV2luZG93cydcbiAgfCAnRnJlZUJTRCdcbiAgfCAnT3BlbkJTRCdcbiAgfCAnaU9TJ1xuICB8ICdBbmRyb2lkJ1xuICB8IGBPdGhlcjoke3N0cmluZ31gXG4gIHwgJ1Vua25vd24nO1xudHlwZSBCcm93c2VyID0gJ2llJyB8ICdlZGdlJyB8ICdjaHJvbWUnIHwgJ2ZpcmVmb3gnIHwgJ3NhZmFyaSc7XG50eXBlIFBsYXRmb3JtUHJvcGVydGllcyA9IHtcbiAgJ1gtU3RhaW5sZXNzLUxhbmcnOiAnanMnO1xuICAnWC1TdGFpbmxlc3MtUGFja2FnZS1WZXJzaW9uJzogc3RyaW5nO1xuICAnWC1TdGFpbmxlc3MtT1MnOiBQbGF0Zm9ybU5hbWU7XG4gICdYLVN0YWlubGVzcy1BcmNoJzogQXJjaDtcbiAgJ1gtU3RhaW5sZXNzLVJ1bnRpbWUnOiAnbm9kZScgfCAnZGVubycgfCAnZWRnZScgfCBgYnJvd3Nlcjoke0Jyb3dzZXJ9YCB8ICd1bmtub3duJztcbiAgJ1gtU3RhaW5sZXNzLVJ1bnRpbWUtVmVyc2lvbic6IHN0cmluZztcbn07XG5jb25zdCBnZXRQbGF0Zm9ybVByb3BlcnRpZXMgPSAoKTogUGxhdGZvcm1Qcm9wZXJ0aWVzID0+IHtcbiAgaWYgKHR5cGVvZiBEZW5vICE9PSAndW5kZWZpbmVkJyAmJiBEZW5vLmJ1aWxkICE9IG51bGwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ1gtU3RhaW5sZXNzLUxhbmcnOiAnanMnLFxuICAgICAgJ1gtU3RhaW5sZXNzLVBhY2thZ2UtVmVyc2lvbic6IFZFUlNJT04sXG4gICAgICAnWC1TdGFpbmxlc3MtT1MnOiBub3JtYWxpemVQbGF0Zm9ybShEZW5vLmJ1aWxkLm9zKSxcbiAgICAgICdYLVN0YWlubGVzcy1BcmNoJzogbm9ybWFsaXplQXJjaChEZW5vLmJ1aWxkLmFyY2gpLFxuICAgICAgJ1gtU3RhaW5sZXNzLVJ1bnRpbWUnOiAnZGVubycsXG4gICAgICAnWC1TdGFpbmxlc3MtUnVudGltZS1WZXJzaW9uJzogRGVuby52ZXJzaW9uLFxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBFZGdlUnVudGltZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ1gtU3RhaW5sZXNzLUxhbmcnOiAnanMnLFxuICAgICAgJ1gtU3RhaW5sZXNzLVBhY2thZ2UtVmVyc2lvbic6IFZFUlNJT04sXG4gICAgICAnWC1TdGFpbmxlc3MtT1MnOiAnVW5rbm93bicsXG4gICAgICAnWC1TdGFpbmxlc3MtQXJjaCc6IGBvdGhlcjoke0VkZ2VSdW50aW1lfWAsXG4gICAgICAnWC1TdGFpbmxlc3MtUnVudGltZSc6ICdlZGdlJyxcbiAgICAgICdYLVN0YWlubGVzcy1SdW50aW1lLVZlcnNpb24nOiBwcm9jZXNzLnZlcnNpb24sXG4gICAgfTtcbiAgfVxuICAvLyBDaGVjayBpZiBOb2RlLmpzXG4gIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnID8gcHJvY2VzcyA6IDApID09PSAnW29iamVjdCBwcm9jZXNzXScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ1gtU3RhaW5sZXNzLUxhbmcnOiAnanMnLFxuICAgICAgJ1gtU3RhaW5sZXNzLVBhY2thZ2UtVmVyc2lvbic6IFZFUlNJT04sXG4gICAgICAnWC1TdGFpbmxlc3MtT1MnOiBub3JtYWxpemVQbGF0Zm9ybShwcm9jZXNzLnBsYXRmb3JtKSxcbiAgICAgICdYLVN0YWlubGVzcy1BcmNoJzogbm9ybWFsaXplQXJjaChwcm9jZXNzLmFyY2gpLFxuICAgICAgJ1gtU3RhaW5sZXNzLVJ1bnRpbWUnOiAnbm9kZScsXG4gICAgICAnWC1TdGFpbmxlc3MtUnVudGltZS1WZXJzaW9uJzogcHJvY2Vzcy52ZXJzaW9uLFxuICAgIH07XG4gIH1cblxuICBjb25zdCBicm93c2VySW5mbyA9IGdldEJyb3dzZXJJbmZvKCk7XG4gIGlmIChicm93c2VySW5mbykge1xuICAgIHJldHVybiB7XG4gICAgICAnWC1TdGFpbmxlc3MtTGFuZyc6ICdqcycsXG4gICAgICAnWC1TdGFpbmxlc3MtUGFja2FnZS1WZXJzaW9uJzogVkVSU0lPTixcbiAgICAgICdYLVN0YWlubGVzcy1PUyc6ICdVbmtub3duJyxcbiAgICAgICdYLVN0YWlubGVzcy1BcmNoJzogJ3Vua25vd24nLFxuICAgICAgJ1gtU3RhaW5sZXNzLVJ1bnRpbWUnOiBgYnJvd3Nlcjoke2Jyb3dzZXJJbmZvLmJyb3dzZXJ9YCxcbiAgICAgICdYLVN0YWlubGVzcy1SdW50aW1lLVZlcnNpb24nOiBicm93c2VySW5mby52ZXJzaW9uLFxuICAgIH07XG4gIH1cblxuICAvLyBUT0RPIGFkZCBzdXBwb3J0IGZvciBDbG91ZGZsYXJlIHdvcmtlcnMsIGV0Yy5cbiAgcmV0dXJuIHtcbiAgICAnWC1TdGFpbmxlc3MtTGFuZyc6ICdqcycsXG4gICAgJ1gtU3RhaW5sZXNzLVBhY2thZ2UtVmVyc2lvbic6IFZFUlNJT04sXG4gICAgJ1gtU3RhaW5sZXNzLU9TJzogJ1Vua25vd24nLFxuICAgICdYLVN0YWlubGVzcy1BcmNoJzogJ3Vua25vd24nLFxuICAgICdYLVN0YWlubGVzcy1SdW50aW1lJzogJ3Vua25vd24nLFxuICAgICdYLVN0YWlubGVzcy1SdW50aW1lLVZlcnNpb24nOiAndW5rbm93bicsXG4gIH07XG59O1xuXG50eXBlIEJyb3dzZXJJbmZvID0ge1xuICBicm93c2VyOiBCcm93c2VyO1xuICB2ZXJzaW9uOiBzdHJpbmc7XG59O1xuXG5kZWNsYXJlIGNvbnN0IG5hdmlnYXRvcjogeyB1c2VyQWdlbnQ6IHN0cmluZyB9IHwgdW5kZWZpbmVkO1xuXG4vLyBOb3RlOiBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9KUy1EZXZUb29scy9ob3N0LWVudmlyb25tZW50L2Jsb2IvYjFhYjc5ZWNkZTM3ZGI1ZDZlMTYzYzA1MGU1NGZlN2QyODdkN2M5Mi9zcmMvaXNvbW9ycGhpYy5icm93c2VyLnRzXG5mdW5jdGlvbiBnZXRCcm93c2VySW5mbygpOiBCcm93c2VySW5mbyB8IG51bGwge1xuICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIW5hdmlnYXRvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gTk9URTogVGhlIG9yZGVyIG1hdHRlcnMgaGVyZSFcbiAgY29uc3QgYnJvd3NlclBhdHRlcm5zID0gW1xuICAgIHsga2V5OiAnZWRnZScgYXMgY29uc3QsIHBhdHRlcm46IC9FZGdlKD86XFxXKyhcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/KT8vIH0sXG4gICAgeyBrZXk6ICdpZScgYXMgY29uc3QsIHBhdHRlcm46IC9NU0lFKD86XFxXKyhcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/KT8vIH0sXG4gICAgeyBrZXk6ICdpZScgYXMgY29uc3QsIHBhdHRlcm46IC9UcmlkZW50KD86LipydlxcOihcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/KT8vIH0sXG4gICAgeyBrZXk6ICdjaHJvbWUnIGFzIGNvbnN0LCBwYXR0ZXJuOiAvQ2hyb21lKD86XFxXKyhcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/KT8vIH0sXG4gICAgeyBrZXk6ICdmaXJlZm94JyBhcyBjb25zdCwgcGF0dGVybjogL0ZpcmVmb3goPzpcXFcrKFxcZCspXFwuKFxcZCspKD86XFwuKFxcZCspKT8pPy8gfSxcbiAgICB7IGtleTogJ3NhZmFyaScgYXMgY29uc3QsIHBhdHRlcm46IC8oPzpWZXJzaW9uXFxXKyhcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/KT8oPzpcXFcrTW9iaWxlXFxTKik/XFxXK1NhZmFyaS8gfSxcbiAgXTtcblxuICAvLyBGaW5kIHRoZSBGSVJTVCBtYXRjaGluZyBicm93c2VyXG4gIGZvciAoY29uc3QgeyBrZXksIHBhdHRlcm4gfSBvZiBicm93c2VyUGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IHBhdHRlcm4uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIGNvbnN0IG1ham9yID0gbWF0Y2hbMV0gfHwgMDtcbiAgICAgIGNvbnN0IG1pbm9yID0gbWF0Y2hbMl0gfHwgMDtcbiAgICAgIGNvbnN0IHBhdGNoID0gbWF0Y2hbM10gfHwgMDtcblxuICAgICAgcmV0dXJuIHsgYnJvd3Nlcjoga2V5LCB2ZXJzaW9uOiBgJHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH1gIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbmNvbnN0IG5vcm1hbGl6ZUFyY2ggPSAoYXJjaDogc3RyaW5nKTogQXJjaCA9PiB7XG4gIC8vIE5vZGUgZG9jczpcbiAgLy8gLSBodHRwczovL25vZGVqcy5vcmcvYXBpL3Byb2Nlc3MuaHRtbCNwcm9jZXNzYXJjaFxuICAvLyBEZW5vIGRvY3M6XG4gIC8vIC0gaHR0cHM6Ly9kb2MuZGVuby5sYW5kL2Rlbm8vc3RhYmxlL34vRGVuby5idWlsZFxuICBpZiAoYXJjaCA9PT0gJ3gzMicpIHJldHVybiAneDMyJztcbiAgaWYgKGFyY2ggPT09ICd4ODZfNjQnIHx8IGFyY2ggPT09ICd4NjQnKSByZXR1cm4gJ3g2NCc7XG4gIGlmIChhcmNoID09PSAnYXJtJykgcmV0dXJuICdhcm0nO1xuICBpZiAoYXJjaCA9PT0gJ2FhcmNoNjQnIHx8IGFyY2ggPT09ICdhcm02NCcpIHJldHVybiAnYXJtNjQnO1xuICBpZiAoYXJjaCkgcmV0dXJuIGBvdGhlcjoke2FyY2h9YDtcbiAgcmV0dXJuICd1bmtub3duJztcbn07XG5cbmNvbnN0IG5vcm1hbGl6ZVBsYXRmb3JtID0gKHBsYXRmb3JtOiBzdHJpbmcpOiBQbGF0Zm9ybU5hbWUgPT4ge1xuICAvLyBOb2RlIHBsYXRmb3JtczpcbiAgLy8gLSBodHRwczovL25vZGVqcy5vcmcvYXBpL3Byb2Nlc3MuaHRtbCNwcm9jZXNzcGxhdGZvcm1cbiAgLy8gRGVubyBwbGF0Zm9ybXM6XG4gIC8vIC0gaHR0cHM6Ly9kb2MuZGVuby5sYW5kL2Rlbm8vc3RhYmxlL34vRGVuby5idWlsZFxuICAvLyAtIGh0dHBzOi8vZ2l0aHViLmNvbS9kZW5vbGFuZC9kZW5vL2lzc3Vlcy8xNDc5OVxuXG4gIHBsYXRmb3JtID0gcGxhdGZvcm0udG9Mb3dlckNhc2UoKTtcblxuICAvLyBOT1RFOiB0aGlzIGlPUyBjaGVjayBpcyB1bnRlc3RlZCBhbmQgbWF5IG5vdCB3b3JrXG4gIC8vIE5vZGUgZG9lcyBub3Qgd29yayBuYXRpdmVseSBvbiBJT1MsIHRoZXJlIGlzIGEgZm9yayBhdFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzLW1vYmlsZS9ub2RlanMtbW9iaWxlXG4gIC8vIGhvd2V2ZXIgaXQgaXMgdW5rbm93biBhdCB0aGUgdGltZSBvZiB3cml0aW5nIGhvdyB0byBkZXRlY3QgaWYgaXQgaXMgcnVubmluZ1xuICBpZiAocGxhdGZvcm0uaW5jbHVkZXMoJ2lvcycpKSByZXR1cm4gJ2lPUyc7XG4gIGlmIChwbGF0Zm9ybSA9PT0gJ2FuZHJvaWQnKSByZXR1cm4gJ0FuZHJvaWQnO1xuICBpZiAocGxhdGZvcm0gPT09ICdkYXJ3aW4nKSByZXR1cm4gJ01hY09TJztcbiAgaWYgKHBsYXRmb3JtID09PSAnd2luMzInKSByZXR1cm4gJ1dpbmRvd3MnO1xuICBpZiAocGxhdGZvcm0gPT09ICdmcmVlYnNkJykgcmV0dXJuICdGcmVlQlNEJztcbiAgaWYgKHBsYXRmb3JtID09PSAnb3BlbmJzZCcpIHJldHVybiAnT3BlbkJTRCc7XG4gIGlmIChwbGF0Zm9ybSA9PT0gJ2xpbnV4JykgcmV0dXJuICdMaW51eCc7XG4gIGlmIChwbGF0Zm9ybSkgcmV0dXJuIGBPdGhlcjoke3BsYXRmb3JtfWA7XG4gIHJldHVybiAnVW5rbm93bic7XG59O1xuXG5sZXQgX3BsYXRmb3JtSGVhZGVyczogUGxhdGZvcm1Qcm9wZXJ0aWVzO1xuY29uc3QgZ2V0UGxhdGZvcm1IZWFkZXJzID0gKCkgPT4ge1xuICByZXR1cm4gKF9wbGF0Zm9ybUhlYWRlcnMgPz89IGdldFBsYXRmb3JtUHJvcGVydGllcygpKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzYWZlSlNPTiA9ICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZSh0ZXh0KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufTtcblxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE5NzA5ODQ2XG5jb25zdCBzdGFydHNXaXRoU2NoZW1lUmVnZXhwID0gbmV3IFJlZ0V4cCgnXig/OlthLXpdKzopPy8vJywgJ2knKTtcbmNvbnN0IGlzQWJzb2x1dGVVUkwgPSAodXJsOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgcmV0dXJuIHN0YXJ0c1dpdGhTY2hlbWVSZWdleHAudGVzdCh1cmwpO1xufTtcblxuZXhwb3J0IGNvbnN0IHNsZWVwID0gKG1zOiBudW1iZXIpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG5cbmNvbnN0IHZhbGlkYXRlUG9zaXRpdmVJbnRlZ2VyID0gKG5hbWU6IHN0cmluZywgbjogdW5rbm93bik6IG51bWJlciA9PiB7XG4gIGlmICh0eXBlb2YgbiAhPT0gJ251bWJlcicgfHwgIU51bWJlci5pc0ludGVnZXIobikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7bmFtZX0gbXVzdCBiZSBhbiBpbnRlZ2VyYCk7XG4gIH1cbiAgaWYgKG4gPCAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyYCk7XG4gIH1cbiAgcmV0dXJuIG47XG59O1xuXG5leHBvcnQgY29uc3QgY2FzdFRvRXJyb3IgPSAoZXJyOiBhbnkpOiBFcnJvciA9PiB7XG4gIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikgcmV0dXJuIGVycjtcbiAgcmV0dXJuIG5ldyBFcnJvcihlcnIpO1xufTtcblxuZXhwb3J0IGNvbnN0IGVuc3VyZVByZXNlbnQgPSA8VD4odmFsdWU6IFQgfCBudWxsIHwgdW5kZWZpbmVkKTogVCA9PiB7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGEgdmFsdWUgdG8gYmUgZ2l2ZW4gYnV0IHJlY2VpdmVkICR7dmFsdWV9IGluc3RlYWQuYCk7XG4gIHJldHVybiB2YWx1ZTtcbn07XG5cbi8qKlxuICogUmVhZCBhbiBlbnZpcm9ubWVudCB2YXJpYWJsZS5cbiAqXG4gKiBXaWxsIHJldHVybiB1bmRlZmluZWQgaWYgdGhlIGVudmlyb25tZW50IHZhcmlhYmxlIGRvZXNuJ3QgZXhpc3Qgb3IgY2Fubm90IGJlIGFjY2Vzc2VkLlxuICovXG5leHBvcnQgY29uc3QgcmVhZEVudiA9IChlbnY6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnY/LltlbnZdID8/IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAodHlwZW9mIERlbm8gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIERlbm8uZW52Py5nZXQ/LihlbnYpO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgY29uc3QgY29lcmNlSW50ZWdlciA9ICh2YWx1ZTogdW5rbm93bik6IG51bWJlciA9PiB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSk7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSByZXR1cm4gcGFyc2VJbnQodmFsdWUsIDEwKTtcblxuICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBjb2VyY2UgJHt2YWx1ZX0gKHR5cGU6ICR7dHlwZW9mIHZhbHVlfSkgaW50byBhIG51bWJlcmApO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvZXJjZUZsb2F0ID0gKHZhbHVlOiB1bmtub3duKTogbnVtYmVyID0+IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHJldHVybiB2YWx1ZTtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKTtcblxuICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBjb2VyY2UgJHt2YWx1ZX0gKHR5cGU6ICR7dHlwZW9mIHZhbHVlfSkgaW50byBhIG51bWJlcmApO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvZXJjZUJvb2xlYW4gPSAodmFsdWU6IHVua25vd24pOiBib29sZWFuID0+IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSByZXR1cm4gdmFsdWU7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSByZXR1cm4gdmFsdWUgPT09ICd0cnVlJztcbiAgcmV0dXJuIEJvb2xlYW4odmFsdWUpO1xufTtcblxuZXhwb3J0IGNvbnN0IG1heWJlQ29lcmNlSW50ZWdlciA9ICh2YWx1ZTogdW5rbm93bik6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gY29lcmNlSW50ZWdlcih2YWx1ZSk7XG59O1xuXG5leHBvcnQgY29uc3QgbWF5YmVDb2VyY2VGbG9hdCA9ICh2YWx1ZTogdW5rbm93bik6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gY29lcmNlRmxvYXQodmFsdWUpO1xufTtcblxuZXhwb3J0IGNvbnN0IG1heWJlQ29lcmNlQm9vbGVhbiA9ICh2YWx1ZTogdW5rbm93bik6IGJvb2xlYW4gfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIGNvZXJjZUJvb2xlYW4odmFsdWUpO1xufTtcblxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM0NDkxMjg3XG5leHBvcnQgZnVuY3Rpb24gaXNFbXB0eU9iaihvYmo6IE9iamVjdCB8IG51bGwgfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgaWYgKCFvYmopIHJldHVybiB0cnVlO1xuICBmb3IgKGNvbnN0IF9rIGluIG9iaikgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gaHR0cHM6Ly9lc2xpbnQub3JnL2RvY3MvbGF0ZXN0L3J1bGVzL25vLXByb3RvdHlwZS1idWlsdGluc1xuZXhwb3J0IGZ1bmN0aW9uIGhhc093bihvYmo6IE9iamVjdCwga2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1ZyhhY3Rpb246IHN0cmluZywgLi4uYXJnczogYW55W10pIHtcbiAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudlsnREVCVUcnXSA9PT0gJ3RydWUnKSB7XG4gICAgY29uc29sZS5sb2coYE9wZW5BSTpERUJVRzoke2FjdGlvbn1gLCAuLi5hcmdzKTtcbiAgfVxufVxuXG4vKipcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMTE3NTIzXG4gKi9cbmNvbnN0IHV1aWQ0ID0gKCkgPT4ge1xuICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCAoYykgPT4ge1xuICAgIGNvbnN0IHIgPSAoTWF0aC5yYW5kb20oKSAqIDE2KSB8IDA7XG4gICAgY29uc3QgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MykgfCAweDg7XG4gICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBpc1J1bm5pbmdJbkJyb3dzZXIgPSAoKSA9PiB7XG4gIHJldHVybiAoXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHR5cGVvZiB3aW5kb3cuZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnXG4gICk7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEhlYWRlcnNQcm90b2NvbCB7XG4gIGdldDogKGhlYWRlcjogc3RyaW5nKSA9PiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkO1xufVxuZXhwb3J0IHR5cGUgSGVhZGVyc0xpa2UgPSBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXSB8IHVuZGVmaW5lZD4gfCBIZWFkZXJzUHJvdG9jb2w7XG5cbmV4cG9ydCBjb25zdCBpc0hlYWRlcnNQcm90b2NvbCA9IChoZWFkZXJzOiBhbnkpOiBoZWFkZXJzIGlzIEhlYWRlcnNQcm90b2NvbCA9PiB7XG4gIHJldHVybiB0eXBlb2YgaGVhZGVycz8uZ2V0ID09PSAnZnVuY3Rpb24nO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEhlYWRlciA9IChoZWFkZXJzOiBIZWFkZXJzTGlrZSwga2V5OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgbG93ZXJLZXkgPSBrZXkudG9Mb3dlckNhc2UoKTtcbiAgaWYgKGlzSGVhZGVyc1Byb3RvY29sKGhlYWRlcnMpKSByZXR1cm4gaGVhZGVycy5nZXQoa2V5KSB8fCBoZWFkZXJzLmdldChsb3dlcktleSk7XG4gIGNvbnN0IHZhbHVlID0gaGVhZGVyc1trZXldIHx8IGhlYWRlcnNbbG93ZXJLZXldO1xuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBpZiAodmFsdWUubGVuZ3RoIDw9IDEpIHJldHVybiB2YWx1ZVswXTtcbiAgICBjb25zb2xlLndhcm4oYFJlY2VpdmVkICR7dmFsdWUubGVuZ3RofSBlbnRyaWVzIGZvciB0aGUgJHtrZXl9IGhlYWRlciwgdXNpbmcgdGhlIGZpcnN0IGVudHJ5LmApO1xuICAgIHJldHVybiB2YWx1ZVswXTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xuXG4vKipcbiAqIEVuY29kZXMgYSBzdHJpbmcgdG8gQmFzZTY0IGZvcm1hdC5cbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmFzZTY0ID0gKHN0cjogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyA9PiB7XG4gIGlmICghc3RyKSByZXR1cm4gJyc7XG4gIGlmICh0eXBlb2YgQnVmZmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBCdWZmZXIuZnJvbShzdHIpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gYnRvYShzdHIpO1xuICB9XG5cbiAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZ2VuZXJhdGUgYjY0IHN0cmluZzsgRXhwZWN0ZWQgYEJ1ZmZlcmAgb3IgYGJ0b2FgIHRvIGJlIGRlZmluZWQnKTtcbn07XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0IHsgQWJzdHJhY3RQYWdlLCBSZXNwb25zZSwgQVBJQ2xpZW50LCBGaW5hbFJlcXVlc3RPcHRpb25zLCBQYWdlSW5mbyB9IGZyb20gJy4vY29yZS5qcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFnZVJlc3BvbnNlPEl0ZW0+IHtcbiAgZGF0YTogQXJyYXk8SXRlbT47XG5cbiAgb2JqZWN0OiBzdHJpbmc7XG59XG5cbi8qKlxuICogTm90ZTogbm8gcGFnaW5hdGlvbiBhY3R1YWxseSBvY2N1cnMgeWV0LCB0aGlzIGlzIGZvciBmb3J3YXJkcy1jb21wYXRpYmlsaXR5LlxuICovXG5leHBvcnQgY2xhc3MgUGFnZTxJdGVtPiBleHRlbmRzIEFic3RyYWN0UGFnZTxJdGVtPiBpbXBsZW1lbnRzIFBhZ2VSZXNwb25zZTxJdGVtPiB7XG4gIG9iamVjdDogc3RyaW5nO1xuXG4gIGRhdGE6IEFycmF5PEl0ZW0+O1xuXG4gIGNvbnN0cnVjdG9yKGNsaWVudDogQVBJQ2xpZW50LCByZXNwb25zZTogUmVzcG9uc2UsIGJvZHk6IFBhZ2VSZXNwb25zZTxJdGVtPiwgb3B0aW9uczogRmluYWxSZXF1ZXN0T3B0aW9ucykge1xuICAgIHN1cGVyKGNsaWVudCwgcmVzcG9uc2UsIGJvZHksIG9wdGlvbnMpO1xuXG4gICAgdGhpcy5vYmplY3QgPSBib2R5Lm9iamVjdDtcbiAgICB0aGlzLmRhdGEgPSBib2R5LmRhdGE7XG4gIH1cblxuICBnZXRQYWdpbmF0ZWRJdGVtcygpOiBJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLmRhdGE7XG4gIH1cblxuICAvLyBAZGVwcmVjYXRlZCBQbGVhc2UgdXNlIGBuZXh0UGFnZUluZm8oKWAgaW5zdGVhZFxuICAvKipcbiAgICogVGhpcyBwYWdlIHJlcHJlc2VudHMgYSByZXNwb25zZSB0aGF0IGlzbid0IGFjdHVhbGx5IHBhZ2luYXRlZCBhdCB0aGUgQVBJIGxldmVsXG4gICAqIHNvIHRoZXJlIHdpbGwgbmV2ZXIgYmUgYW55IG5leHQgcGFnZSBwYXJhbXMuXG4gICAqL1xuICBuZXh0UGFnZVBhcmFtcygpOiBudWxsIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIG5leHRQYWdlSW5mbygpOiBudWxsIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnNvclBhZ2VSZXNwb25zZTxJdGVtPiB7XG4gIGRhdGE6IEFycmF5PEl0ZW0+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnNvclBhZ2VQYXJhbXMge1xuICAvKipcbiAgICogSWRlbnRpZmllciBmb3IgdGhlIGxhc3Qgam9iIGZyb20gdGhlIHByZXZpb3VzIHBhZ2luYXRpb24gcmVxdWVzdC5cbiAgICovXG4gIGFmdGVyPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgZmluZS10dW5pbmcgam9icyB0byByZXRyaWV2ZS5cbiAgICovXG4gIGxpbWl0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgQ3Vyc29yUGFnZTxJdGVtIGV4dGVuZHMgeyBpZDogc3RyaW5nIH0+XG4gIGV4dGVuZHMgQWJzdHJhY3RQYWdlPEl0ZW0+XG4gIGltcGxlbWVudHMgQ3Vyc29yUGFnZVJlc3BvbnNlPEl0ZW0+XG57XG4gIGRhdGE6IEFycmF5PEl0ZW0+O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGNsaWVudDogQVBJQ2xpZW50LFxuICAgIHJlc3BvbnNlOiBSZXNwb25zZSxcbiAgICBib2R5OiBDdXJzb3JQYWdlUmVzcG9uc2U8SXRlbT4sXG4gICAgb3B0aW9uczogRmluYWxSZXF1ZXN0T3B0aW9ucyxcbiAgKSB7XG4gICAgc3VwZXIoY2xpZW50LCByZXNwb25zZSwgYm9keSwgb3B0aW9ucyk7XG5cbiAgICB0aGlzLmRhdGEgPSBib2R5LmRhdGE7XG4gIH1cblxuICBnZXRQYWdpbmF0ZWRJdGVtcygpOiBJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLmRhdGE7XG4gIH1cblxuICAvLyBAZGVwcmVjYXRlZCBQbGVhc2UgdXNlIGBuZXh0UGFnZUluZm8oKWAgaW5zdGVhZFxuICBuZXh0UGFnZVBhcmFtcygpOiBQYXJ0aWFsPEN1cnNvclBhZ2VQYXJhbXM+IHwgbnVsbCB7XG4gICAgY29uc3QgaW5mbyA9IHRoaXMubmV4dFBhZ2VJbmZvKCk7XG4gICAgaWYgKCFpbmZvKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoJ3BhcmFtcycgaW4gaW5mbykgcmV0dXJuIGluZm8ucGFyYW1zO1xuICAgIGNvbnN0IHBhcmFtcyA9IE9iamVjdC5mcm9tRW50cmllcyhpbmZvLnVybC5zZWFyY2hQYXJhbXMpO1xuICAgIGlmICghT2JqZWN0LmtleXMocGFyYW1zKS5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICBuZXh0UGFnZUluZm8oKTogUGFnZUluZm8gfCBudWxsIHtcbiAgICBpZiAoIXRoaXMuZGF0YT8ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBuZXh0ID0gdGhpcy5kYXRhW3RoaXMuZGF0YS5sZW5ndGggLSAxXT8uaWQ7XG4gICAgaWYgKCFuZXh0KSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4geyBwYXJhbXM6IHsgYWZ0ZXI6IG5leHQgfSB9O1xuICB9XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0IHR5cGUgeyBPcGVuQUkgfSBmcm9tICcuL2luZGV4LmpzJztcblxuZXhwb3J0IGNsYXNzIEFQSVJlc291cmNlIHtcbiAgcHJvdGVjdGVkIGNsaWVudDogT3BlbkFJO1xuICBjb25zdHJ1Y3RvcihjbGllbnQ6IE9wZW5BSSkge1xuICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuXG4gICAgdGhpcy5nZXQgPSBjbGllbnQuZ2V0LmJpbmQoY2xpZW50KTtcbiAgICB0aGlzLnBvc3QgPSBjbGllbnQucG9zdC5iaW5kKGNsaWVudCk7XG4gICAgdGhpcy5wYXRjaCA9IGNsaWVudC5wYXRjaC5iaW5kKGNsaWVudCk7XG4gICAgdGhpcy5wdXQgPSBjbGllbnQucHV0LmJpbmQoY2xpZW50KTtcbiAgICB0aGlzLmRlbGV0ZSA9IGNsaWVudC5kZWxldGUuYmluZChjbGllbnQpO1xuICAgIHRoaXMuZ2V0QVBJTGlzdCA9IGNsaWVudC5nZXRBUElMaXN0LmJpbmQoY2xpZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXQ6IE9wZW5BSVsnZ2V0J107XG4gIHByb3RlY3RlZCBwb3N0OiBPcGVuQUlbJ3Bvc3QnXTtcbiAgcHJvdGVjdGVkIHBhdGNoOiBPcGVuQUlbJ3BhdGNoJ107XG4gIHByb3RlY3RlZCBwdXQ6IE9wZW5BSVsncHV0J107XG4gIHByb3RlY3RlZCBkZWxldGU6IE9wZW5BSVsnZGVsZXRlJ107XG4gIHByb3RlY3RlZCBnZXRBUElMaXN0OiBPcGVuQUlbJ2dldEFQSUxpc3QnXTtcbn1cbiIsICIvLyBGaWxlIGdlbmVyYXRlZCBmcm9tIG91ciBPcGVuQVBJIHNwZWMgYnkgU3RhaW5sZXNzLlxuXG5pbXBvcnQgKiBhcyBDb3JlIGZyb20gJy4uLy4uL2NvcmUuanMnO1xuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi8uLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgKiBhcyBBUEkgZnJvbSAnLi9pbmRleC5qcyc7XG5pbXBvcnQgeyB0eXBlIFVwbG9hZGFibGUsIG11bHRpcGFydEZvcm1SZXF1ZXN0T3B0aW9ucyB9IGZyb20gJy4uLy4uL2NvcmUuanMnO1xuXG5leHBvcnQgY2xhc3MgVHJhbnNjcmlwdGlvbnMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBUcmFuc2NyaWJlcyBhdWRpbyBpbnRvIHRoZSBpbnB1dCBsYW5ndWFnZS5cbiAgICovXG4gIGNyZWF0ZShib2R5OiBUcmFuc2NyaXB0aW9uQ3JlYXRlUGFyYW1zLCBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyk6IENvcmUuQVBJUHJvbWlzZTxUcmFuc2NyaXB0aW9uPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdCgnL2F1ZGlvL3RyYW5zY3JpcHRpb25zJywgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zKHsgYm9keSwgLi4ub3B0aW9ucyB9KSk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2NyaXB0aW9uIHtcbiAgdGV4dDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zY3JpcHRpb25DcmVhdGVQYXJhbXMge1xuICAvKipcbiAgICogVGhlIGF1ZGlvIGZpbGUgb2JqZWN0IChub3QgZmlsZSBuYW1lKSB0byB0cmFuc2NyaWJlLCBpbiBvbmUgb2YgdGhlc2UgZm9ybWF0czpcbiAgICogZmxhYywgbXAzLCBtcDQsIG1wZWcsIG1wZ2EsIG00YSwgb2dnLCB3YXYsIG9yIHdlYm0uXG4gICAqL1xuICBmaWxlOiBVcGxvYWRhYmxlO1xuXG4gIC8qKlxuICAgKiBJRCBvZiB0aGUgbW9kZWwgdG8gdXNlLiBPbmx5IGB3aGlzcGVyLTFgIGlzIGN1cnJlbnRseSBhdmFpbGFibGUuXG4gICAqL1xuICBtb2RlbDogKHN0cmluZyAmIHt9KSB8ICd3aGlzcGVyLTEnO1xuXG4gIC8qKlxuICAgKiBUaGUgbGFuZ3VhZ2Ugb2YgdGhlIGlucHV0IGF1ZGlvLiBTdXBwbHlpbmcgdGhlIGlucHV0IGxhbmd1YWdlIGluXG4gICAqIFtJU08tNjM5LTFdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfSVNPXzYzOS0xX2NvZGVzKSBmb3JtYXQgd2lsbFxuICAgKiBpbXByb3ZlIGFjY3VyYWN5IGFuZCBsYXRlbmN5LlxuICAgKi9cbiAgbGFuZ3VhZ2U/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEFuIG9wdGlvbmFsIHRleHQgdG8gZ3VpZGUgdGhlIG1vZGVsJ3Mgc3R5bGUgb3IgY29udGludWUgYSBwcmV2aW91cyBhdWRpb1xuICAgKiBzZWdtZW50LiBUaGUgW3Byb21wdF0oL2RvY3MvZ3VpZGVzL3NwZWVjaC10by10ZXh0L3Byb21wdGluZykgc2hvdWxkIG1hdGNoIHRoZVxuICAgKiBhdWRpbyBsYW5ndWFnZS5cbiAgICovXG4gIHByb21wdD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGZvcm1hdCBvZiB0aGUgdHJhbnNjcmlwdCBvdXRwdXQsIGluIG9uZSBvZiB0aGVzZSBvcHRpb25zOiBqc29uLCB0ZXh0LCBzcnQsXG4gICAqIHZlcmJvc2VfanNvbiwgb3IgdnR0LlxuICAgKi9cbiAgcmVzcG9uc2VfZm9ybWF0PzogJ2pzb24nIHwgJ3RleHQnIHwgJ3NydCcgfCAndmVyYm9zZV9qc29uJyB8ICd2dHQnO1xuXG4gIC8qKlxuICAgKiBUaGUgc2FtcGxpbmcgdGVtcGVyYXR1cmUsIGJldHdlZW4gMCBhbmQgMS4gSGlnaGVyIHZhbHVlcyBsaWtlIDAuOCB3aWxsIG1ha2UgdGhlXG4gICAqIG91dHB1dCBtb3JlIHJhbmRvbSwgd2hpbGUgbG93ZXIgdmFsdWVzIGxpa2UgMC4yIHdpbGwgbWFrZSBpdCBtb3JlIGZvY3VzZWQgYW5kXG4gICAqIGRldGVybWluaXN0aWMuIElmIHNldCB0byAwLCB0aGUgbW9kZWwgd2lsbCB1c2VcbiAgICogW2xvZyBwcm9iYWJpbGl0eV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9nX3Byb2JhYmlsaXR5KSB0b1xuICAgKiBhdXRvbWF0aWNhbGx5IGluY3JlYXNlIHRoZSB0ZW1wZXJhdHVyZSB1bnRpbCBjZXJ0YWluIHRocmVzaG9sZHMgYXJlIGhpdC5cbiAgICovXG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIFRyYW5zY3JpcHRpb25zIHtcbiAgZXhwb3J0IGltcG9ydCBUcmFuc2NyaXB0aW9uID0gQVBJLlRyYW5zY3JpcHRpb247XG4gIGV4cG9ydCBpbXBvcnQgVHJhbnNjcmlwdGlvbkNyZWF0ZVBhcmFtcyA9IEFQSS5UcmFuc2NyaXB0aW9uQ3JlYXRlUGFyYW1zO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uLy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcbmltcG9ydCB7IHR5cGUgVXBsb2FkYWJsZSwgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vY29yZS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvbnMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBUcmFuc2xhdGVzIGF1ZGlvIGludG8gRW5nbGlzaC5cbiAgICovXG4gIGNyZWF0ZShib2R5OiBUcmFuc2xhdGlvbkNyZWF0ZVBhcmFtcywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkFQSVByb21pc2U8VHJhbnNsYXRpb24+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvYXVkaW8vdHJhbnNsYXRpb25zJywgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zKHsgYm9keSwgLi4ub3B0aW9ucyB9KSk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2xhdGlvbiB7XG4gIHRleHQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2xhdGlvbkNyZWF0ZVBhcmFtcyB7XG4gIC8qKlxuICAgKiBUaGUgYXVkaW8gZmlsZSBvYmplY3QgKG5vdCBmaWxlIG5hbWUpIHRyYW5zbGF0ZSwgaW4gb25lIG9mIHRoZXNlIGZvcm1hdHM6IGZsYWMsXG4gICAqIG1wMywgbXA0LCBtcGVnLCBtcGdhLCBtNGEsIG9nZywgd2F2LCBvciB3ZWJtLlxuICAgKi9cbiAgZmlsZTogVXBsb2FkYWJsZTtcblxuICAvKipcbiAgICogSUQgb2YgdGhlIG1vZGVsIHRvIHVzZS4gT25seSBgd2hpc3Blci0xYCBpcyBjdXJyZW50bHkgYXZhaWxhYmxlLlxuICAgKi9cbiAgbW9kZWw6IChzdHJpbmcgJiB7fSkgfCAnd2hpc3Blci0xJztcblxuICAvKipcbiAgICogQW4gb3B0aW9uYWwgdGV4dCB0byBndWlkZSB0aGUgbW9kZWwncyBzdHlsZSBvciBjb250aW51ZSBhIHByZXZpb3VzIGF1ZGlvXG4gICAqIHNlZ21lbnQuIFRoZSBbcHJvbXB0XSgvZG9jcy9ndWlkZXMvc3BlZWNoLXRvLXRleHQvcHJvbXB0aW5nKSBzaG91bGQgYmUgaW5cbiAgICogRW5nbGlzaC5cbiAgICovXG4gIHByb21wdD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGZvcm1hdCBvZiB0aGUgdHJhbnNjcmlwdCBvdXRwdXQsIGluIG9uZSBvZiB0aGVzZSBvcHRpb25zOiBqc29uLCB0ZXh0LCBzcnQsXG4gICAqIHZlcmJvc2VfanNvbiwgb3IgdnR0LlxuICAgKi9cbiAgcmVzcG9uc2VfZm9ybWF0Pzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgc2FtcGxpbmcgdGVtcGVyYXR1cmUsIGJldHdlZW4gMCBhbmQgMS4gSGlnaGVyIHZhbHVlcyBsaWtlIDAuOCB3aWxsIG1ha2UgdGhlXG4gICAqIG91dHB1dCBtb3JlIHJhbmRvbSwgd2hpbGUgbG93ZXIgdmFsdWVzIGxpa2UgMC4yIHdpbGwgbWFrZSBpdCBtb3JlIGZvY3VzZWQgYW5kXG4gICAqIGRldGVybWluaXN0aWMuIElmIHNldCB0byAwLCB0aGUgbW9kZWwgd2lsbCB1c2VcbiAgICogW2xvZyBwcm9iYWJpbGl0eV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9nX3Byb2JhYmlsaXR5KSB0b1xuICAgKiBhdXRvbWF0aWNhbGx5IGluY3JlYXNlIHRoZSB0ZW1wZXJhdHVyZSB1bnRpbCBjZXJ0YWluIHRocmVzaG9sZHMgYXJlIGhpdC5cbiAgICovXG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIFRyYW5zbGF0aW9ucyB7XG4gIGV4cG9ydCBpbXBvcnQgVHJhbnNsYXRpb24gPSBBUEkuVHJhbnNsYXRpb247XG4gIGV4cG9ydCBpbXBvcnQgVHJhbnNsYXRpb25DcmVhdGVQYXJhbXMgPSBBUEkuVHJhbnNsYXRpb25DcmVhdGVQYXJhbXM7XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi8uLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgeyBUcmFuc2NyaXB0aW9ucyB9IGZyb20gJy4vdHJhbnNjcmlwdGlvbnMuanMnO1xuaW1wb3J0IHsgVHJhbnNsYXRpb25zIH0gZnJvbSAnLi90cmFuc2xhdGlvbnMuanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vaW5kZXguanMnO1xuXG5leHBvcnQgY2xhc3MgQXVkaW8gZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIHRyYW5zY3JpcHRpb25zOiBUcmFuc2NyaXB0aW9ucyA9IG5ldyBUcmFuc2NyaXB0aW9ucyh0aGlzLmNsaWVudCk7XG4gIHRyYW5zbGF0aW9uczogVHJhbnNsYXRpb25zID0gbmV3IFRyYW5zbGF0aW9ucyh0aGlzLmNsaWVudCk7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQXVkaW8ge1xuICBleHBvcnQgaW1wb3J0IFRyYW5zY3JpcHRpb25zID0gQVBJLlRyYW5zY3JpcHRpb25zO1xuICBleHBvcnQgaW1wb3J0IFRyYW5zY3JpcHRpb24gPSBBUEkuVHJhbnNjcmlwdGlvbjtcbiAgZXhwb3J0IGltcG9ydCBUcmFuc2NyaXB0aW9uQ3JlYXRlUGFyYW1zID0gQVBJLlRyYW5zY3JpcHRpb25DcmVhdGVQYXJhbXM7XG5cbiAgZXhwb3J0IGltcG9ydCBUcmFuc2xhdGlvbnMgPSBBUEkuVHJhbnNsYXRpb25zO1xuICBleHBvcnQgaW1wb3J0IFRyYW5zbGF0aW9uID0gQVBJLlRyYW5zbGF0aW9uO1xuICBleHBvcnQgaW1wb3J0IFRyYW5zbGF0aW9uQ3JlYXRlUGFyYW1zID0gQVBJLlRyYW5zbGF0aW9uQ3JlYXRlUGFyYW1zO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElQcm9taXNlIH0gZnJvbSAnLi4vLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uLy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIENvbXBsZXRpb25zXyBmcm9tICcuLi9jb21wbGV0aW9ucy5qcyc7XG5pbXBvcnQgKiBhcyBBUEkgZnJvbSAnLi9pbmRleC5qcyc7XG5pbXBvcnQgeyBTdHJlYW0gfSBmcm9tICcuLi8uLi9zdHJlYW1pbmcuanMnO1xuXG5leHBvcnQgY2xhc3MgQ29tcGxldGlvbnMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbW9kZWwgcmVzcG9uc2UgZm9yIHRoZSBnaXZlbiBjaGF0IGNvbnZlcnNhdGlvbi5cbiAgICovXG4gIGNyZWF0ZShcbiAgICBib2R5OiBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZyxcbiAgICBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyxcbiAgKTogQVBJUHJvbWlzZTxDaGF0Q29tcGxldGlvbj47XG4gIGNyZWF0ZShcbiAgICBib2R5OiBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyxcbiAgICBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyxcbiAgKTogQVBJUHJvbWlzZTxTdHJlYW08Q2hhdENvbXBsZXRpb25DaHVuaz4+O1xuICBjcmVhdGUoXG4gICAgYm9keTogQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNCYXNlLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBBUElQcm9taXNlPFN0cmVhbTxDaGF0Q29tcGxldGlvbkNodW5rPiB8IENoYXRDb21wbGV0aW9uPjtcbiAgY3JlYXRlKFxuICAgIGJvZHk6IENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBBUElQcm9taXNlPENoYXRDb21wbGV0aW9uPiB8IEFQSVByb21pc2U8U3RyZWFtPENoYXRDb21wbGV0aW9uQ2h1bms+PiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdCgnL2NoYXQvY29tcGxldGlvbnMnLCB7IGJvZHksIC4uLm9wdGlvbnMsIHN0cmVhbTogYm9keS5zdHJlYW0gPz8gZmFsc2UgfSkgYXNcbiAgICAgIHwgQVBJUHJvbWlzZTxDaGF0Q29tcGxldGlvbj5cbiAgICAgIHwgQVBJUHJvbWlzZTxTdHJlYW08Q2hhdENvbXBsZXRpb25DaHVuaz4+O1xuICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGNoYXQgY29tcGxldGlvbiByZXNwb25zZSByZXR1cm5lZCBieSBtb2RlbCwgYmFzZWQgb24gdGhlIHByb3ZpZGVkXG4gKiBpbnB1dC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDaGF0Q29tcGxldGlvbiB7XG4gIC8qKlxuICAgKiBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgY2hhdCBjb21wbGV0aW9uLlxuICAgKi9cbiAgaWQ6IHN0cmluZztcblxuICAvKipcbiAgICogQSBsaXN0IG9mIGNoYXQgY29tcGxldGlvbiBjaG9pY2VzLiBDYW4gYmUgbW9yZSB0aGFuIG9uZSBpZiBgbmAgaXMgZ3JlYXRlclxuICAgKiB0aGFuIDEuXG4gICAqL1xuICBjaG9pY2VzOiBBcnJheTxDaGF0Q29tcGxldGlvbi5DaG9pY2U+O1xuXG4gIC8qKlxuICAgKiBUaGUgVW5peCB0aW1lc3RhbXAgKGluIHNlY29uZHMpIG9mIHdoZW4gdGhlIGNoYXQgY29tcGxldGlvbiB3YXMgY3JlYXRlZC5cbiAgICovXG4gIGNyZWF0ZWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIG1vZGVsIHVzZWQgZm9yIHRoZSBjaGF0IGNvbXBsZXRpb24uXG4gICAqL1xuICBtb2RlbDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IHR5cGUsIHdoaWNoIGlzIGFsd2F5cyBgY2hhdC5jb21wbGV0aW9uYC5cbiAgICovXG4gIG9iamVjdDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBVc2FnZSBzdGF0aXN0aWNzIGZvciB0aGUgY29tcGxldGlvbiByZXF1ZXN0LlxuICAgKi9cbiAgdXNhZ2U/OiBDb21wbGV0aW9uc18uQ29tcGxldGlvblVzYWdlO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENoYXRDb21wbGV0aW9uIHtcbiAgZXhwb3J0IGludGVyZmFjZSBDaG9pY2Uge1xuICAgIC8qKlxuICAgICAqIFRoZSByZWFzb24gdGhlIG1vZGVsIHN0b3BwZWQgZ2VuZXJhdGluZyB0b2tlbnMuIFRoaXMgd2lsbCBiZSBgc3RvcGAgaWYgdGhlIG1vZGVsXG4gICAgICogaGl0IGEgbmF0dXJhbCBzdG9wIHBvaW50IG9yIGEgcHJvdmlkZWQgc3RvcCBzZXF1ZW5jZSwgYGxlbmd0aGAgaWYgdGhlIG1heGltdW1cbiAgICAgKiBudW1iZXIgb2YgdG9rZW5zIHNwZWNpZmllZCBpbiB0aGUgcmVxdWVzdCB3YXMgcmVhY2hlZCwgb3IgYGZ1bmN0aW9uX2NhbGxgIGlmIHRoZVxuICAgICAqIG1vZGVsIGNhbGxlZCBhIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZpbmlzaF9yZWFzb246ICdzdG9wJyB8ICdsZW5ndGgnIHwgJ2Z1bmN0aW9uX2NhbGwnO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IG9mIHRoZSBjaG9pY2UgaW4gdGhlIGxpc3Qgb2YgY2hvaWNlcy5cbiAgICAgKi9cbiAgICBpbmRleDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQSBjaGF0IGNvbXBsZXRpb24gbWVzc2FnZSBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsLlxuICAgICAqL1xuICAgIG1lc3NhZ2U6IENoYXRDb21wbGV0aW9uTWVzc2FnZTtcbiAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBzdHJlYW1lZCBjaHVuayBvZiBhIGNoYXQgY29tcGxldGlvbiByZXNwb25zZSByZXR1cm5lZCBieSBtb2RlbCxcbiAqIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBpbnB1dC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDaGF0Q29tcGxldGlvbkNodW5rIHtcbiAgLyoqXG4gICAqIEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBjaGF0IGNvbXBsZXRpb24gY2h1bmsuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBBIGxpc3Qgb2YgY2hhdCBjb21wbGV0aW9uIGNob2ljZXMuIENhbiBiZSBtb3JlIHRoYW4gb25lIGlmIGBuYCBpcyBncmVhdGVyXG4gICAqIHRoYW4gMS5cbiAgICovXG4gIGNob2ljZXM6IEFycmF5PENoYXRDb21wbGV0aW9uQ2h1bmsuQ2hvaWNlPjtcblxuICAvKipcbiAgICogVGhlIFVuaXggdGltZXN0YW1wIChpbiBzZWNvbmRzKSBvZiB3aGVuIHRoZSBjaGF0IGNvbXBsZXRpb24gY2h1bmsgd2FzIGNyZWF0ZWQuXG4gICAqL1xuICBjcmVhdGVkOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBtb2RlbCB0byBnZW5lcmF0ZSB0aGUgY29tcGxldGlvbi5cbiAgICovXG4gIG1vZGVsOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgdHlwZSwgd2hpY2ggaXMgYWx3YXlzIGBjaGF0LmNvbXBsZXRpb24uY2h1bmtgLlxuICAgKi9cbiAgb2JqZWN0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ2hhdENvbXBsZXRpb25DaHVuayB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgQ2hvaWNlIHtcbiAgICAvKipcbiAgICAgKiBBIGNoYXQgY29tcGxldGlvbiBkZWx0YSBnZW5lcmF0ZWQgYnkgc3RyZWFtZWQgbW9kZWwgcmVzcG9uc2VzLlxuICAgICAqL1xuICAgIGRlbHRhOiBDaG9pY2UuRGVsdGE7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSBtb2RlbCBzdG9wcGVkIGdlbmVyYXRpbmcgdG9rZW5zLiBUaGlzIHdpbGwgYmUgYHN0b3BgIGlmIHRoZSBtb2RlbFxuICAgICAqIGhpdCBhIG5hdHVyYWwgc3RvcCBwb2ludCBvciBhIHByb3ZpZGVkIHN0b3Agc2VxdWVuY2UsIGBsZW5ndGhgIGlmIHRoZSBtYXhpbXVtXG4gICAgICogbnVtYmVyIG9mIHRva2VucyBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIHJlYWNoZWQsIG9yIGBmdW5jdGlvbl9jYWxsYCBpZiB0aGVcbiAgICAgKiBtb2RlbCBjYWxsZWQgYSBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmaW5pc2hfcmVhc29uOiAnc3RvcCcgfCAnbGVuZ3RoJyB8ICdmdW5jdGlvbl9jYWxsJyB8IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGNob2ljZSBpbiB0aGUgbGlzdCBvZiBjaG9pY2VzLlxuICAgICAqL1xuICAgIGluZGV4OiBudW1iZXI7XG4gIH1cblxuICBleHBvcnQgbmFtZXNwYWNlIENob2ljZSB7XG4gICAgLyoqXG4gICAgICogQSBjaGF0IGNvbXBsZXRpb24gZGVsdGEgZ2VuZXJhdGVkIGJ5IHN0cmVhbWVkIG1vZGVsIHJlc3BvbnNlcy5cbiAgICAgKi9cbiAgICBleHBvcnQgaW50ZXJmYWNlIERlbHRhIHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGNvbnRlbnRzIG9mIHRoZSBjaHVuayBtZXNzYWdlLlxuICAgICAgICovXG4gICAgICBjb250ZW50Pzogc3RyaW5nIHwgbnVsbDtcblxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbmFtZSBhbmQgYXJndW1lbnRzIG9mIGEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgY2FsbGVkLCBhcyBnZW5lcmF0ZWQgYnkgdGhlXG4gICAgICAgKiBtb2RlbC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb25fY2FsbD86IERlbHRhLkZ1bmN0aW9uQ2FsbDtcblxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgcm9sZSBvZiB0aGUgYXV0aG9yIG9mIHRoaXMgbWVzc2FnZS5cbiAgICAgICAqL1xuICAgICAgcm9sZT86IENoYXRDb21wbGV0aW9uUm9sZTtcbiAgICB9XG5cbiAgICBleHBvcnQgbmFtZXNwYWNlIERlbHRhIHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG5hbWUgYW5kIGFyZ3VtZW50cyBvZiBhIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIGJlIGNhbGxlZCwgYXMgZ2VuZXJhdGVkIGJ5IHRoZVxuICAgICAgICogbW9kZWwuXG4gICAgICAgKi9cbiAgICAgIGV4cG9ydCBpbnRlcmZhY2UgRnVuY3Rpb25DYWxsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhcmd1bWVudHMgdG8gY2FsbCB0aGUgZnVuY3Rpb24gd2l0aCwgYXMgZ2VuZXJhdGVkIGJ5IHRoZSBtb2RlbCBpbiBKU09OXG4gICAgICAgICAqIGZvcm1hdC4gTm90ZSB0aGF0IHRoZSBtb2RlbCBkb2VzIG5vdCBhbHdheXMgZ2VuZXJhdGUgdmFsaWQgSlNPTiwgYW5kIG1heVxuICAgICAgICAgKiBoYWxsdWNpbmF0ZSBwYXJhbWV0ZXJzIG5vdCBkZWZpbmVkIGJ5IHlvdXIgZnVuY3Rpb24gc2NoZW1hLiBWYWxpZGF0ZSB0aGVcbiAgICAgICAgICogYXJndW1lbnRzIGluIHlvdXIgY29kZSBiZWZvcmUgY2FsbGluZyB5b3VyIGZ1bmN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgYXJndW1lbnRzPzogc3RyaW5nO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gY2FsbC5cbiAgICAgICAgICovXG4gICAgICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQSBjaGF0IGNvbXBsZXRpb24gbWVzc2FnZSBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIENoYXRDb21wbGV0aW9uTWVzc2FnZSB7XG4gIC8qKlxuICAgKiBUaGUgY29udGVudHMgb2YgdGhlIG1lc3NhZ2UuXG4gICAqL1xuICBjb250ZW50OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgcm9sZSBvZiB0aGUgYXV0aG9yIG9mIHRoaXMgbWVzc2FnZS5cbiAgICovXG4gIHJvbGU6IENoYXRDb21wbGV0aW9uUm9sZTtcblxuICAvKipcbiAgICogVGhlIG5hbWUgYW5kIGFyZ3VtZW50cyBvZiBhIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIGJlIGNhbGxlZCwgYXMgZ2VuZXJhdGVkIGJ5IHRoZVxuICAgKiBtb2RlbC5cbiAgICovXG4gIGZ1bmN0aW9uX2NhbGw/OiBDaGF0Q29tcGxldGlvbk1lc3NhZ2UuRnVuY3Rpb25DYWxsO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENoYXRDb21wbGV0aW9uTWVzc2FnZSB7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBhbmQgYXJndW1lbnRzIG9mIGEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgY2FsbGVkLCBhcyBnZW5lcmF0ZWQgYnkgdGhlXG4gICAqIG1vZGVsLlxuICAgKi9cbiAgZXhwb3J0IGludGVyZmFjZSBGdW5jdGlvbkNhbGwge1xuICAgIC8qKlxuICAgICAqIFRoZSBhcmd1bWVudHMgdG8gY2FsbCB0aGUgZnVuY3Rpb24gd2l0aCwgYXMgZ2VuZXJhdGVkIGJ5IHRoZSBtb2RlbCBpbiBKU09OXG4gICAgICogZm9ybWF0LiBOb3RlIHRoYXQgdGhlIG1vZGVsIGRvZXMgbm90IGFsd2F5cyBnZW5lcmF0ZSB2YWxpZCBKU09OLCBhbmQgbWF5XG4gICAgICogaGFsbHVjaW5hdGUgcGFyYW1ldGVycyBub3QgZGVmaW5lZCBieSB5b3VyIGZ1bmN0aW9uIHNjaGVtYS4gVmFsaWRhdGUgdGhlXG4gICAgICogYXJndW1lbnRzIGluIHlvdXIgY29kZSBiZWZvcmUgY2FsbGluZyB5b3VyIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGFyZ3VtZW50czogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG5hbWUgb2YgdGhlIGZ1bmN0aW9uIHRvIGNhbGwuXG4gICAgICovXG4gICAgbmFtZTogc3RyaW5nO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW0ge1xuICAvKipcbiAgICogVGhlIGNvbnRlbnRzIG9mIHRoZSBtZXNzYWdlLiBgY29udGVudGAgaXMgcmVxdWlyZWQgZm9yIGFsbCBtZXNzYWdlcywgYW5kIG1heSBiZVxuICAgKiBudWxsIGZvciBhc3Npc3RhbnQgbWVzc2FnZXMgd2l0aCBmdW5jdGlvbiBjYWxscy5cbiAgICovXG4gIGNvbnRlbnQ6IHN0cmluZyB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSByb2xlIG9mIHRoZSBtZXNzYWdlcyBhdXRob3IuIE9uZSBvZiBgc3lzdGVtYCwgYHVzZXJgLCBgYXNzaXN0YW50YCwgb3JcbiAgICogYGZ1bmN0aW9uYC5cbiAgICovXG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnZnVuY3Rpb24nO1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZSBhbmQgYXJndW1lbnRzIG9mIGEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgY2FsbGVkLCBhcyBnZW5lcmF0ZWQgYnkgdGhlXG4gICAqIG1vZGVsLlxuICAgKi9cbiAgZnVuY3Rpb25fY2FsbD86IENoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtLkZ1bmN0aW9uQ2FsbDtcblxuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGF1dGhvciBvZiB0aGlzIG1lc3NhZ2UuIGBuYW1lYCBpcyByZXF1aXJlZCBpZiByb2xlIGlzXG4gICAqIGBmdW5jdGlvbmAsIGFuZCBpdCBzaG91bGQgYmUgdGhlIG5hbWUgb2YgdGhlIGZ1bmN0aW9uIHdob3NlIHJlc3BvbnNlIGlzIGluIHRoZVxuICAgKiBgY29udGVudGAuIE1heSBjb250YWluIGEteiwgQS1aLCAwLTksIGFuZCB1bmRlcnNjb3Jlcywgd2l0aCBhIG1heGltdW0gbGVuZ3RoIG9mXG4gICAqIDY0IGNoYXJhY3RlcnMuXG4gICAqL1xuICBuYW1lPzogc3RyaW5nO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtIHtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIGFuZCBhcmd1bWVudHMgb2YgYSBmdW5jdGlvbiB0aGF0IHNob3VsZCBiZSBjYWxsZWQsIGFzIGdlbmVyYXRlZCBieSB0aGVcbiAgICogbW9kZWwuXG4gICAqL1xuICBleHBvcnQgaW50ZXJmYWNlIEZ1bmN0aW9uQ2FsbCB7XG4gICAgLyoqXG4gICAgICogVGhlIGFyZ3VtZW50cyB0byBjYWxsIHRoZSBmdW5jdGlvbiB3aXRoLCBhcyBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsIGluIEpTT05cbiAgICAgKiBmb3JtYXQuIE5vdGUgdGhhdCB0aGUgbW9kZWwgZG9lcyBub3QgYWx3YXlzIGdlbmVyYXRlIHZhbGlkIEpTT04sIGFuZCBtYXlcbiAgICAgKiBoYWxsdWNpbmF0ZSBwYXJhbWV0ZXJzIG5vdCBkZWZpbmVkIGJ5IHlvdXIgZnVuY3Rpb24gc2NoZW1hLiBWYWxpZGF0ZSB0aGVcbiAgICAgKiBhcmd1bWVudHMgaW4geW91ciBjb2RlIGJlZm9yZSBjYWxsaW5nIHlvdXIgZnVuY3Rpb24uXG4gICAgICovXG4gICAgYXJndW1lbnRzOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gY2FsbC5cbiAgICAgKi9cbiAgICBuYW1lOiBzdHJpbmc7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGUgcm9sZSBvZiB0aGUgYXV0aG9yIG9mIHRoaXMgbWVzc2FnZS5cbiAqL1xuZXhwb3J0IHR5cGUgQ2hhdENvbXBsZXRpb25Sb2xlID0gJ3N5c3RlbScgfCAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdmdW5jdGlvbic7XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgQ2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW0gc2hvdWxkIGJlIHVzZWQgaW5zdGVhZFxuICovXG5leHBvcnQgdHlwZSBDcmVhdGVDaGF0Q29tcGxldGlvblJlcXVlc3RNZXNzYWdlID0gQ2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW07XG5cbmV4cG9ydCB0eXBlIENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zID1cbiAgfCBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZ1xuICB8IENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zQmFzZSB7XG4gIC8qKlxuICAgKiBBIGxpc3Qgb2YgbWVzc2FnZXMgY29tcHJpc2luZyB0aGUgY29udmVyc2F0aW9uIHNvIGZhci5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fZm9ybWF0X2lucHV0c190b19DaGF0R1BUX21vZGVscy5pcHluYikuXG4gICAqL1xuICBtZXNzYWdlczogQXJyYXk8Q2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW0+O1xuXG4gIC8qKlxuICAgKiBJRCBvZiB0aGUgbW9kZWwgdG8gdXNlLiBTZWUgdGhlXG4gICAqIFttb2RlbCBlbmRwb2ludCBjb21wYXRpYmlsaXR5XSgvZG9jcy9tb2RlbHMvbW9kZWwtZW5kcG9pbnQtY29tcGF0aWJpbGl0eSkgdGFibGVcbiAgICogZm9yIGRldGFpbHMgb24gd2hpY2ggbW9kZWxzIHdvcmsgd2l0aCB0aGUgQ2hhdCBBUEkuXG4gICAqL1xuICBtb2RlbDpcbiAgICB8IChzdHJpbmcgJiB7fSlcbiAgICB8ICdncHQtNCdcbiAgICB8ICdncHQtNC0wMzE0J1xuICAgIHwgJ2dwdC00LTA2MTMnXG4gICAgfCAnZ3B0LTQtMzJrJ1xuICAgIHwgJ2dwdC00LTMyay0wMzE0J1xuICAgIHwgJ2dwdC00LTMyay0wNjEzJ1xuICAgIHwgJ2dwdC0zLjUtdHVyYm8nXG4gICAgfCAnZ3B0LTMuNS10dXJiby0xNmsnXG4gICAgfCAnZ3B0LTMuNS10dXJiby0wMzAxJ1xuICAgIHwgJ2dwdC0zLjUtdHVyYm8tMDYxMydcbiAgICB8ICdncHQtMy41LXR1cmJvLTE2ay0wNjEzJztcblxuICAvKipcbiAgICogTnVtYmVyIGJldHdlZW4gLTIuMCBhbmQgMi4wLiBQb3NpdGl2ZSB2YWx1ZXMgcGVuYWxpemUgbmV3IHRva2VucyBiYXNlZCBvbiB0aGVpclxuICAgKiBleGlzdGluZyBmcmVxdWVuY3kgaW4gdGhlIHRleHQgc28gZmFyLCBkZWNyZWFzaW5nIHRoZSBtb2RlbCdzIGxpa2VsaWhvb2QgdG9cbiAgICogcmVwZWF0IHRoZSBzYW1lIGxpbmUgdmVyYmF0aW0uXG4gICAqXG4gICAqIFtTZWUgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBmcmVxdWVuY3kgYW5kIHByZXNlbmNlIHBlbmFsdGllcy5dKC9kb2NzL2d1aWRlcy9ncHQvcGFyYW1ldGVyLWRldGFpbHMpXG4gICAqL1xuICBmcmVxdWVuY3lfcGVuYWx0eT86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIENvbnRyb2xzIGhvdyB0aGUgbW9kZWwgcmVzcG9uZHMgdG8gZnVuY3Rpb24gY2FsbHMuIFwibm9uZVwiIG1lYW5zIHRoZSBtb2RlbCBkb2VzXG4gICAqIG5vdCBjYWxsIGEgZnVuY3Rpb24sIGFuZCByZXNwb25kcyB0byB0aGUgZW5kLXVzZXIuIFwiYXV0b1wiIG1lYW5zIHRoZSBtb2RlbCBjYW5cbiAgICogcGljayBiZXR3ZWVuIGFuIGVuZC11c2VyIG9yIGNhbGxpbmcgYSBmdW5jdGlvbi4gU3BlY2lmeWluZyBhIHBhcnRpY3VsYXIgZnVuY3Rpb25cbiAgICogdmlhIGB7XCJuYW1lXCI6IFwibXlfZnVuY3Rpb25cIn1gIGZvcmNlcyB0aGUgbW9kZWwgdG8gY2FsbCB0aGF0IGZ1bmN0aW9uLiBcIm5vbmVcIiBpc1xuICAgKiB0aGUgZGVmYXVsdCB3aGVuIG5vIGZ1bmN0aW9ucyBhcmUgcHJlc2VudC4gXCJhdXRvXCIgaXMgdGhlIGRlZmF1bHQgaWYgZnVuY3Rpb25zXG4gICAqIGFyZSBwcmVzZW50LlxuICAgKi9cbiAgZnVuY3Rpb25fY2FsbD86ICdub25lJyB8ICdhdXRvJyB8IENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zLkZ1bmN0aW9uQ2FsbE9wdGlvbjtcblxuICAvKipcbiAgICogQSBsaXN0IG9mIGZ1bmN0aW9ucyB0aGUgbW9kZWwgbWF5IGdlbmVyYXRlIEpTT04gaW5wdXRzIGZvci5cbiAgICovXG4gIGZ1bmN0aW9ucz86IEFycmF5PENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zLkZ1bmN0aW9uPjtcblxuICAvKipcbiAgICogTW9kaWZ5IHRoZSBsaWtlbGlob29kIG9mIHNwZWNpZmllZCB0b2tlbnMgYXBwZWFyaW5nIGluIHRoZSBjb21wbGV0aW9uLlxuICAgKlxuICAgKiBBY2NlcHRzIGEganNvbiBvYmplY3QgdGhhdCBtYXBzIHRva2VucyAoc3BlY2lmaWVkIGJ5IHRoZWlyIHRva2VuIElEIGluIHRoZVxuICAgKiB0b2tlbml6ZXIpIHRvIGFuIGFzc29jaWF0ZWQgYmlhcyB2YWx1ZSBmcm9tIC0xMDAgdG8gMTAwLiBNYXRoZW1hdGljYWxseSwgdGhlXG4gICAqIGJpYXMgaXMgYWRkZWQgdG8gdGhlIGxvZ2l0cyBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsIHByaW9yIHRvIHNhbXBsaW5nLiBUaGUgZXhhY3RcbiAgICogZWZmZWN0IHdpbGwgdmFyeSBwZXIgbW9kZWwsIGJ1dCB2YWx1ZXMgYmV0d2VlbiAtMSBhbmQgMSBzaG91bGQgZGVjcmVhc2Ugb3JcbiAgICogaW5jcmVhc2UgbGlrZWxpaG9vZCBvZiBzZWxlY3Rpb247IHZhbHVlcyBsaWtlIC0xMDAgb3IgMTAwIHNob3VsZCByZXN1bHQgaW4gYSBiYW5cbiAgICogb3IgZXhjbHVzaXZlIHNlbGVjdGlvbiBvZiB0aGUgcmVsZXZhbnQgdG9rZW4uXG4gICAqL1xuICBsb2dpdF9iaWFzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBbdG9rZW5zXSgvdG9rZW5pemVyKSB0byBnZW5lcmF0ZSBpbiB0aGUgY2hhdCBjb21wbGV0aW9uLlxuICAgKlxuICAgKiBUaGUgdG90YWwgbGVuZ3RoIG9mIGlucHV0IHRva2VucyBhbmQgZ2VuZXJhdGVkIHRva2VucyBpcyBsaW1pdGVkIGJ5IHRoZSBtb2RlbCdzXG4gICAqIGNvbnRleHQgbGVuZ3RoLlxuICAgKiBbRXhhbXBsZSBQeXRob24gY29kZV0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5haS9vcGVuYWktY29va2Jvb2svYmxvYi9tYWluL2V4YW1wbGVzL0hvd190b19jb3VudF90b2tlbnNfd2l0aF90aWt0b2tlbi5pcHluYilcbiAgICogZm9yIGNvdW50aW5nIHRva2Vucy5cbiAgICovXG4gIG1heF90b2tlbnM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEhvdyBtYW55IGNoYXQgY29tcGxldGlvbiBjaG9pY2VzIHRvIGdlbmVyYXRlIGZvciBlYWNoIGlucHV0IG1lc3NhZ2UuXG4gICAqL1xuICBuPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogTnVtYmVyIGJldHdlZW4gLTIuMCBhbmQgMi4wLiBQb3NpdGl2ZSB2YWx1ZXMgcGVuYWxpemUgbmV3IHRva2VucyBiYXNlZCBvblxuICAgKiB3aGV0aGVyIHRoZXkgYXBwZWFyIGluIHRoZSB0ZXh0IHNvIGZhciwgaW5jcmVhc2luZyB0aGUgbW9kZWwncyBsaWtlbGlob29kIHRvXG4gICAqIHRhbGsgYWJvdXQgbmV3IHRvcGljcy5cbiAgICpcbiAgICogW1NlZSBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGZyZXF1ZW5jeSBhbmQgcHJlc2VuY2UgcGVuYWx0aWVzLl0oL2RvY3MvZ3VpZGVzL2dwdC9wYXJhbWV0ZXItZGV0YWlscylcbiAgICovXG4gIHByZXNlbmNlX3BlbmFsdHk/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBVcCB0byA0IHNlcXVlbmNlcyB3aGVyZSB0aGUgQVBJIHdpbGwgc3RvcCBnZW5lcmF0aW5nIGZ1cnRoZXIgdG9rZW5zLlxuICAgKi9cbiAgc3RvcD86IHN0cmluZyB8IG51bGwgfCBBcnJheTxzdHJpbmc+O1xuXG4gIC8qKlxuICAgKiBJZiBzZXQsIHBhcnRpYWwgbWVzc2FnZSBkZWx0YXMgd2lsbCBiZSBzZW50LCBsaWtlIGluIENoYXRHUFQuIFRva2VucyB3aWxsIGJlXG4gICAqIHNlbnQgYXMgZGF0YS1vbmx5XG4gICAqIFtzZXJ2ZXItc2VudCBldmVudHNdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TZXJ2ZXItc2VudF9ldmVudHMvVXNpbmdfc2VydmVyLXNlbnRfZXZlbnRzI0V2ZW50X3N0cmVhbV9mb3JtYXQpXG4gICAqIGFzIHRoZXkgYmVjb21lIGF2YWlsYWJsZSwgd2l0aCB0aGUgc3RyZWFtIHRlcm1pbmF0ZWQgYnkgYSBgZGF0YTogW0RPTkVdYFxuICAgKiBtZXNzYWdlLlxuICAgKiBbRXhhbXBsZSBQeXRob24gY29kZV0oaHR0cHM6Ly9naXRodWIuY29tL29wZW5haS9vcGVuYWktY29va2Jvb2svYmxvYi9tYWluL2V4YW1wbGVzL0hvd190b19zdHJlYW1fY29tcGxldGlvbnMuaXB5bmIpLlxuICAgKi9cbiAgc3RyZWFtPzogYm9vbGVhbiB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFdoYXQgc2FtcGxpbmcgdGVtcGVyYXR1cmUgdG8gdXNlLCBiZXR3ZWVuIDAgYW5kIDIuIEhpZ2hlciB2YWx1ZXMgbGlrZSAwLjggd2lsbFxuICAgKiBtYWtlIHRoZSBvdXRwdXQgbW9yZSByYW5kb20sIHdoaWxlIGxvd2VyIHZhbHVlcyBsaWtlIDAuMiB3aWxsIG1ha2UgaXQgbW9yZVxuICAgKiBmb2N1c2VkIGFuZCBkZXRlcm1pbmlzdGljLlxuICAgKlxuICAgKiBXZSBnZW5lcmFsbHkgcmVjb21tZW5kIGFsdGVyaW5nIHRoaXMgb3IgYHRvcF9wYCBidXQgbm90IGJvdGguXG4gICAqL1xuICB0ZW1wZXJhdHVyZT86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIEFuIGFsdGVybmF0aXZlIHRvIHNhbXBsaW5nIHdpdGggdGVtcGVyYXR1cmUsIGNhbGxlZCBudWNsZXVzIHNhbXBsaW5nLCB3aGVyZSB0aGVcbiAgICogbW9kZWwgY29uc2lkZXJzIHRoZSByZXN1bHRzIG9mIHRoZSB0b2tlbnMgd2l0aCB0b3BfcCBwcm9iYWJpbGl0eSBtYXNzLiBTbyAwLjFcbiAgICogbWVhbnMgb25seSB0aGUgdG9rZW5zIGNvbXByaXNpbmcgdGhlIHRvcCAxMCUgcHJvYmFiaWxpdHkgbWFzcyBhcmUgY29uc2lkZXJlZC5cbiAgICpcbiAgICogV2UgZ2VuZXJhbGx5IHJlY29tbWVuZCBhbHRlcmluZyB0aGlzIG9yIGB0ZW1wZXJhdHVyZWAgYnV0IG5vdCBib3RoLlxuICAgKi9cbiAgdG9wX3A/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBIHVuaXF1ZSBpZGVudGlmaWVyIHJlcHJlc2VudGluZyB5b3VyIGVuZC11c2VyLCB3aGljaCBjYW4gaGVscCBPcGVuQUkgdG8gbW9uaXRvclxuICAgKiBhbmQgZGV0ZWN0IGFidXNlLiBbTGVhcm4gbW9yZV0oL2RvY3MvZ3VpZGVzL3NhZmV0eS1iZXN0LXByYWN0aWNlcy9lbmQtdXNlci1pZHMpLlxuICAgKi9cbiAgdXNlcj86IHN0cmluZztcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtcyB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgRnVuY3Rpb25DYWxsT3B0aW9uIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gY2FsbC5cbiAgICAgKi9cbiAgICBuYW1lOiBzdHJpbmc7XG4gIH1cblxuICBleHBvcnQgaW50ZXJmYWNlIEZ1bmN0aW9uIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkLiBNdXN0IGJlIGEteiwgQS1aLCAwLTksIG9yIGNvbnRhaW5cbiAgICAgKiB1bmRlcnNjb3JlcyBhbmQgZGFzaGVzLCB3aXRoIGEgbWF4aW11bSBsZW5ndGggb2YgNjQuXG4gICAgICovXG4gICAgbmFtZTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHBhcmFtZXRlcnMgdGhlIGZ1bmN0aW9ucyBhY2NlcHRzLCBkZXNjcmliZWQgYXMgYSBKU09OIFNjaGVtYSBvYmplY3QuIFNlZSB0aGVcbiAgICAgKiBbZ3VpZGVdKC9kb2NzL2d1aWRlcy9ncHQvZnVuY3Rpb24tY2FsbGluZykgZm9yIGV4YW1wbGVzLCBhbmQgdGhlXG4gICAgICogW0pTT04gU2NoZW1hIHJlZmVyZW5jZV0oaHR0cHM6Ly9qc29uLXNjaGVtYS5vcmcvdW5kZXJzdGFuZGluZy1qc29uLXNjaGVtYS8pIGZvclxuICAgICAqIGRvY3VtZW50YXRpb24gYWJvdXQgdGhlIGZvcm1hdC5cbiAgICAgKlxuICAgICAqIFRvIGRlc2NyaWJlIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIG5vIHBhcmFtZXRlcnMsIHByb3ZpZGUgdGhlIHZhbHVlXG4gICAgICogYHtcInR5cGVcIjogXCJvYmplY3RcIiwgXCJwcm9wZXJ0aWVzXCI6IHt9fWAuXG4gICAgICovXG4gICAgcGFyYW1ldGVyczogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cbiAgICAvKipcbiAgICAgKiBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIGZ1bmN0aW9uIGRvZXMsIHVzZWQgYnkgdGhlIG1vZGVsIHRvIGNob29zZSB3aGVuIGFuZFxuICAgICAqIGhvdyB0byBjYWxsIHRoZSBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgfVxuXG4gIGV4cG9ydCB0eXBlIENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nID0gQVBJLkNoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nO1xuICBleHBvcnQgdHlwZSBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyA9IEFQSS5DaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZztcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXMgaW5zdGVhZFxuICovXG5leHBvcnQgdHlwZSBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zID0gQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXM7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmcgZXh0ZW5kcyBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc0Jhc2Uge1xuICAvKipcbiAgICogSWYgc2V0LCBwYXJ0aWFsIG1lc3NhZ2UgZGVsdGFzIHdpbGwgYmUgc2VudCwgbGlrZSBpbiBDaGF0R1BULiBUb2tlbnMgd2lsbCBiZVxuICAgKiBzZW50IGFzIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUsIHdpdGggdGhlIHN0cmVhbSB0ZXJtaW5hdGVkIGJ5IGEgYGRhdGE6IFtET05FXWBcbiAgICogbWVzc2FnZS5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fc3RyZWFtX2NvbXBsZXRpb25zLmlweW5iKS5cbiAgICovXG4gIHN0cmVhbT86IGZhbHNlIHwgbnVsbDtcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmcgaW5zdGVhZFxuICovXG5leHBvcnQgdHlwZSBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nID0gQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmcgZXh0ZW5kcyBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc0Jhc2Uge1xuICAvKipcbiAgICogSWYgc2V0LCBwYXJ0aWFsIG1lc3NhZ2UgZGVsdGFzIHdpbGwgYmUgc2VudCwgbGlrZSBpbiBDaGF0R1BULiBUb2tlbnMgd2lsbCBiZVxuICAgKiBzZW50IGFzIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUsIHdpdGggdGhlIHN0cmVhbSB0ZXJtaW5hdGVkIGJ5IGEgYGRhdGE6IFtET05FXWBcbiAgICogbWVzc2FnZS5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fc3RyZWFtX2NvbXBsZXRpb25zLmlweW5iKS5cbiAgICovXG4gIHN0cmVhbTogdHJ1ZTtcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmcgaW5zdGVhZFxuICovXG5leHBvcnQgdHlwZSBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nID0gQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmc7XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ29tcGxldGlvbnMge1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uID0gQVBJLkNoYXRDb21wbGV0aW9uO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uQ2h1bmsgPSBBUEkuQ2hhdENvbXBsZXRpb25DaHVuaztcbiAgZXhwb3J0IGltcG9ydCBDaGF0Q29tcGxldGlvbk1lc3NhZ2UgPSBBUEkuQ2hhdENvbXBsZXRpb25NZXNzYWdlO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtID0gQVBJLkNoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uUm9sZSA9IEFQSS5DaGF0Q29tcGxldGlvblJvbGU7XG4gIGV4cG9ydCBpbXBvcnQgQ3JlYXRlQ2hhdENvbXBsZXRpb25SZXF1ZXN0TWVzc2FnZSA9IEFQSS5DcmVhdGVDaGF0Q29tcGxldGlvblJlcXVlc3RNZXNzYWdlO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zID0gQVBJLkNoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25DcmVhdGVQYXJhbXMgPSBBUEkuQ29tcGxldGlvbkNyZWF0ZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZyA9IEFQSS5DaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZztcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nID0gQVBJLkNvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmc7XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmcgPSBBUEkuQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmc7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyA9IEFQSS5Db21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCB7IEFQSVJlc291cmNlIH0gZnJvbSAnLi4vLi4vcmVzb3VyY2UuanMnO1xuaW1wb3J0IHsgQ29tcGxldGlvbnMgfSBmcm9tICcuL2NvbXBsZXRpb25zLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcblxuZXhwb3J0IGNsYXNzIENoYXQgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIGNvbXBsZXRpb25zOiBDb21wbGV0aW9ucyA9IG5ldyBDb21wbGV0aW9ucyh0aGlzLmNsaWVudCk7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ2hhdCB7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbnMgPSBBUEkuQ29tcGxldGlvbnM7XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb24gPSBBUEkuQ2hhdENvbXBsZXRpb247XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb25DaHVuayA9IEFQSS5DaGF0Q29tcGxldGlvbkNodW5rO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uTWVzc2FnZSA9IEFQSS5DaGF0Q29tcGxldGlvbk1lc3NhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW0gPSBBUEkuQ2hhdENvbXBsZXRpb25NZXNzYWdlUGFyYW07XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb25Sb2xlID0gQVBJLkNoYXRDb21wbGV0aW9uUm9sZTtcbiAgZXhwb3J0IGltcG9ydCBDcmVhdGVDaGF0Q29tcGxldGlvblJlcXVlc3RNZXNzYWdlID0gQVBJLkNyZWF0ZUNoYXRDb21wbGV0aW9uUmVxdWVzdE1lc3NhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXMgPSBBUEkuQ2hhdENvbXBsZXRpb25DcmVhdGVQYXJhbXM7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbkNyZWF0ZVBhcmFtcyA9IEFQSS5Db21wbGV0aW9uQ3JlYXRlUGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IENoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nID0gQVBJLkNoYXRDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmcgPSBBUEkuQ29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZztcbiAgZXhwb3J0IGltcG9ydCBDaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyA9IEFQSS5DaGF0Q29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZztcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nID0gQVBJLkNvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmc7XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0ICogYXMgQ29yZSBmcm9tICcuLi9jb3JlLmpzJztcbmltcG9ydCB7IEFQSVByb21pc2UgfSBmcm9tICcuLi9jb3JlLmpzJztcbmltcG9ydCB7IEFQSVJlc291cmNlIH0gZnJvbSAnLi4vcmVzb3VyY2UuanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vaW5kZXguanMnO1xuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSAnLi4vc3RyZWFtaW5nLmpzJztcblxuZXhwb3J0IGNsYXNzIENvbXBsZXRpb25zIGV4dGVuZHMgQVBJUmVzb3VyY2Uge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIGNvbXBsZXRpb24gZm9yIHRoZSBwcm92aWRlZCBwcm9tcHQgYW5kIHBhcmFtZXRlcnMuXG4gICAqL1xuICBjcmVhdGUoYm9keTogQ29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBBUElQcm9taXNlPENvbXBsZXRpb24+O1xuICBjcmVhdGUoXG4gICAgYm9keTogQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyxcbiAgICBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyxcbiAgKTogQVBJUHJvbWlzZTxTdHJlYW08Q29tcGxldGlvbj4+O1xuICBjcmVhdGUoXG4gICAgYm9keTogQ29tcGxldGlvbkNyZWF0ZVBhcmFtc0Jhc2UsXG4gICAgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMsXG4gICk6IEFQSVByb21pc2U8U3RyZWFtPENvbXBsZXRpb24+IHwgQ29tcGxldGlvbj47XG4gIGNyZWF0ZShcbiAgICBib2R5OiBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBBUElQcm9taXNlPENvbXBsZXRpb24+IHwgQVBJUHJvbWlzZTxTdHJlYW08Q29tcGxldGlvbj4+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvY29tcGxldGlvbnMnLCB7IGJvZHksIC4uLm9wdGlvbnMsIHN0cmVhbTogYm9keS5zdHJlYW0gPz8gZmFsc2UgfSkgYXNcbiAgICAgIHwgQVBJUHJvbWlzZTxDb21wbGV0aW9uPlxuICAgICAgfCBBUElQcm9taXNlPFN0cmVhbTxDb21wbGV0aW9uPj47XG4gIH1cbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgY29tcGxldGlvbiByZXNwb25zZSBmcm9tIHRoZSBBUEkuIE5vdGU6IGJvdGggdGhlIHN0cmVhbWVkIGFuZFxuICogbm9uLXN0cmVhbWVkIHJlc3BvbnNlIG9iamVjdHMgc2hhcmUgdGhlIHNhbWUgc2hhcGUgKHVubGlrZSB0aGUgY2hhdCBlbmRwb2ludCkuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGxldGlvbiB7XG4gIC8qKlxuICAgKiBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgY29tcGxldGlvbi5cbiAgICovXG4gIGlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIGNvbXBsZXRpb24gY2hvaWNlcyB0aGUgbW9kZWwgZ2VuZXJhdGVkIGZvciB0aGUgaW5wdXQgcHJvbXB0LlxuICAgKi9cbiAgY2hvaWNlczogQXJyYXk8Q29tcGxldGlvbkNob2ljZT47XG5cbiAgLyoqXG4gICAqIFRoZSBVbml4IHRpbWVzdGFtcCAoaW4gc2Vjb25kcykgb2Ygd2hlbiB0aGUgY29tcGxldGlvbiB3YXMgY3JlYXRlZC5cbiAgICovXG4gIGNyZWF0ZWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIG1vZGVsIHVzZWQgZm9yIGNvbXBsZXRpb24uXG4gICAqL1xuICBtb2RlbDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IHR5cGUsIHdoaWNoIGlzIGFsd2F5cyBcInRleHRfY29tcGxldGlvblwiXG4gICAqL1xuICBvYmplY3Q6IHN0cmluZztcblxuICAvKipcbiAgICogVXNhZ2Ugc3RhdGlzdGljcyBmb3IgdGhlIGNvbXBsZXRpb24gcmVxdWVzdC5cbiAgICovXG4gIHVzYWdlPzogQ29tcGxldGlvblVzYWdlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBsZXRpb25DaG9pY2Uge1xuICAvKipcbiAgICogVGhlIHJlYXNvbiB0aGUgbW9kZWwgc3RvcHBlZCBnZW5lcmF0aW5nIHRva2Vucy4gVGhpcyB3aWxsIGJlIGBzdG9wYCBpZiB0aGUgbW9kZWxcbiAgICogaGl0IGEgbmF0dXJhbCBzdG9wIHBvaW50IG9yIGEgcHJvdmlkZWQgc3RvcCBzZXF1ZW5jZSwgb3IgYGxlbmd0aGAgaWYgdGhlIG1heGltdW1cbiAgICogbnVtYmVyIG9mIHRva2VucyBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIHJlYWNoZWQuXG4gICAqL1xuICBmaW5pc2hfcmVhc29uOiAnc3RvcCcgfCAnbGVuZ3RoJztcblxuICBpbmRleDogbnVtYmVyO1xuXG4gIGxvZ3Byb2JzOiBDb21wbGV0aW9uQ2hvaWNlLkxvZ3Byb2JzIHwgbnVsbDtcblxuICB0ZXh0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ29tcGxldGlvbkNob2ljZSB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgTG9ncHJvYnMge1xuICAgIHRleHRfb2Zmc2V0PzogQXJyYXk8bnVtYmVyPjtcblxuICAgIHRva2VuX2xvZ3Byb2JzPzogQXJyYXk8bnVtYmVyPjtcblxuICAgIHRva2Vucz86IEFycmF5PHN0cmluZz47XG5cbiAgICB0b3BfbG9ncHJvYnM/OiBBcnJheTxSZWNvcmQ8c3RyaW5nLCBudW1iZXI+PjtcbiAgfVxufVxuXG4vKipcbiAqIFVzYWdlIHN0YXRpc3RpY3MgZm9yIHRoZSBjb21wbGV0aW9uIHJlcXVlc3QuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGxldGlvblVzYWdlIHtcbiAgLyoqXG4gICAqIE51bWJlciBvZiB0b2tlbnMgaW4gdGhlIGdlbmVyYXRlZCBjb21wbGV0aW9uLlxuICAgKi9cbiAgY29tcGxldGlvbl90b2tlbnM6IG51bWJlcjtcblxuICAvKipcbiAgICogTnVtYmVyIG9mIHRva2VucyBpbiB0aGUgcHJvbXB0LlxuICAgKi9cbiAgcHJvbXB0X3Rva2VuczogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUb3RhbCBudW1iZXIgb2YgdG9rZW5zIHVzZWQgaW4gdGhlIHJlcXVlc3QgKHByb21wdCArIGNvbXBsZXRpb24pLlxuICAgKi9cbiAgdG90YWxfdG9rZW5zOiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIENvbXBsZXRpb25DcmVhdGVQYXJhbXMgPSBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nIHwgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZztcblxuZXhwb3J0IGludGVyZmFjZSBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zQmFzZSB7XG4gIC8qKlxuICAgKiBJRCBvZiB0aGUgbW9kZWwgdG8gdXNlLiBZb3UgY2FuIHVzZSB0aGVcbiAgICogW0xpc3QgbW9kZWxzXSgvZG9jcy9hcGktcmVmZXJlbmNlL21vZGVscy9saXN0KSBBUEkgdG8gc2VlIGFsbCBvZiB5b3VyIGF2YWlsYWJsZVxuICAgKiBtb2RlbHMsIG9yIHNlZSBvdXIgW01vZGVsIG92ZXJ2aWV3XSgvZG9jcy9tb2RlbHMvb3ZlcnZpZXcpIGZvciBkZXNjcmlwdGlvbnMgb2ZcbiAgICogdGhlbS5cbiAgICovXG4gIG1vZGVsOlxuICAgIHwgKHN0cmluZyAmIHt9KVxuICAgIHwgJ2JhYmJhZ2UtMDAyJ1xuICAgIHwgJ2RhdmluY2ktMDAyJ1xuICAgIHwgJ3RleHQtZGF2aW5jaS0wMDMnXG4gICAgfCAndGV4dC1kYXZpbmNpLTAwMidcbiAgICB8ICd0ZXh0LWRhdmluY2ktMDAxJ1xuICAgIHwgJ2NvZGUtZGF2aW5jaS0wMDInXG4gICAgfCAndGV4dC1jdXJpZS0wMDEnXG4gICAgfCAndGV4dC1iYWJiYWdlLTAwMSdcbiAgICB8ICd0ZXh0LWFkYS0wMDEnO1xuXG4gIC8qKlxuICAgKiBUaGUgcHJvbXB0KHMpIHRvIGdlbmVyYXRlIGNvbXBsZXRpb25zIGZvciwgZW5jb2RlZCBhcyBhIHN0cmluZywgYXJyYXkgb2ZcbiAgICogc3RyaW5ncywgYXJyYXkgb2YgdG9rZW5zLCBvciBhcnJheSBvZiB0b2tlbiBhcnJheXMuXG4gICAqXG4gICAqIE5vdGUgdGhhdCA8fGVuZG9mdGV4dHw+IGlzIHRoZSBkb2N1bWVudCBzZXBhcmF0b3IgdGhhdCB0aGUgbW9kZWwgc2VlcyBkdXJpbmdcbiAgICogdHJhaW5pbmcsIHNvIGlmIGEgcHJvbXB0IGlzIG5vdCBzcGVjaWZpZWQgdGhlIG1vZGVsIHdpbGwgZ2VuZXJhdGUgYXMgaWYgZnJvbSB0aGVcbiAgICogYmVnaW5uaW5nIG9mIGEgbmV3IGRvY3VtZW50LlxuICAgKi9cbiAgcHJvbXB0OiBzdHJpbmcgfCBBcnJheTxzdHJpbmc+IHwgQXJyYXk8bnVtYmVyPiB8IEFycmF5PEFycmF5PG51bWJlcj4+IHwgbnVsbDtcblxuICAvKipcbiAgICogR2VuZXJhdGVzIGBiZXN0X29mYCBjb21wbGV0aW9ucyBzZXJ2ZXItc2lkZSBhbmQgcmV0dXJucyB0aGUgXCJiZXN0XCIgKHRoZSBvbmUgd2l0aFxuICAgKiB0aGUgaGlnaGVzdCBsb2cgcHJvYmFiaWxpdHkgcGVyIHRva2VuKS4gUmVzdWx0cyBjYW5ub3QgYmUgc3RyZWFtZWQuXG4gICAqXG4gICAqIFdoZW4gdXNlZCB3aXRoIGBuYCwgYGJlc3Rfb2ZgIGNvbnRyb2xzIHRoZSBudW1iZXIgb2YgY2FuZGlkYXRlIGNvbXBsZXRpb25zIGFuZFxuICAgKiBgbmAgc3BlY2lmaWVzIGhvdyBtYW55IHRvIHJldHVybiBcdTIwMTMgYGJlc3Rfb2ZgIG11c3QgYmUgZ3JlYXRlciB0aGFuIGBuYC5cbiAgICpcbiAgICogKipOb3RlOioqIEJlY2F1c2UgdGhpcyBwYXJhbWV0ZXIgZ2VuZXJhdGVzIG1hbnkgY29tcGxldGlvbnMsIGl0IGNhbiBxdWlja2x5XG4gICAqIGNvbnN1bWUgeW91ciB0b2tlbiBxdW90YS4gVXNlIGNhcmVmdWxseSBhbmQgZW5zdXJlIHRoYXQgeW91IGhhdmUgcmVhc29uYWJsZVxuICAgKiBzZXR0aW5ncyBmb3IgYG1heF90b2tlbnNgIGFuZCBgc3RvcGAuXG4gICAqL1xuICBiZXN0X29mPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogRWNobyBiYWNrIHRoZSBwcm9tcHQgaW4gYWRkaXRpb24gdG8gdGhlIGNvbXBsZXRpb25cbiAgICovXG4gIGVjaG8/OiBib29sZWFuIHwgbnVsbDtcblxuICAvKipcbiAgICogTnVtYmVyIGJldHdlZW4gLTIuMCBhbmQgMi4wLiBQb3NpdGl2ZSB2YWx1ZXMgcGVuYWxpemUgbmV3IHRva2VucyBiYXNlZCBvbiB0aGVpclxuICAgKiBleGlzdGluZyBmcmVxdWVuY3kgaW4gdGhlIHRleHQgc28gZmFyLCBkZWNyZWFzaW5nIHRoZSBtb2RlbCdzIGxpa2VsaWhvb2QgdG9cbiAgICogcmVwZWF0IHRoZSBzYW1lIGxpbmUgdmVyYmF0aW0uXG4gICAqXG4gICAqIFtTZWUgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBmcmVxdWVuY3kgYW5kIHByZXNlbmNlIHBlbmFsdGllcy5dKC9kb2NzL2d1aWRlcy9ncHQvcGFyYW1ldGVyLWRldGFpbHMpXG4gICAqL1xuICBmcmVxdWVuY3lfcGVuYWx0eT86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIE1vZGlmeSB0aGUgbGlrZWxpaG9vZCBvZiBzcGVjaWZpZWQgdG9rZW5zIGFwcGVhcmluZyBpbiB0aGUgY29tcGxldGlvbi5cbiAgICpcbiAgICogQWNjZXB0cyBhIGpzb24gb2JqZWN0IHRoYXQgbWFwcyB0b2tlbnMgKHNwZWNpZmllZCBieSB0aGVpciB0b2tlbiBJRCBpbiB0aGUgR1BUXG4gICAqIHRva2VuaXplcikgdG8gYW4gYXNzb2NpYXRlZCBiaWFzIHZhbHVlIGZyb20gLTEwMCB0byAxMDAuIFlvdSBjYW4gdXNlIHRoaXNcbiAgICogW3Rva2VuaXplciB0b29sXSgvdG9rZW5pemVyP3ZpZXc9YnBlKSAod2hpY2ggd29ya3MgZm9yIGJvdGggR1BULTIgYW5kIEdQVC0zKSB0b1xuICAgKiBjb252ZXJ0IHRleHQgdG8gdG9rZW4gSURzLiBNYXRoZW1hdGljYWxseSwgdGhlIGJpYXMgaXMgYWRkZWQgdG8gdGhlIGxvZ2l0c1xuICAgKiBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsIHByaW9yIHRvIHNhbXBsaW5nLiBUaGUgZXhhY3QgZWZmZWN0IHdpbGwgdmFyeSBwZXIgbW9kZWwsXG4gICAqIGJ1dCB2YWx1ZXMgYmV0d2VlbiAtMSBhbmQgMSBzaG91bGQgZGVjcmVhc2Ugb3IgaW5jcmVhc2UgbGlrZWxpaG9vZCBvZiBzZWxlY3Rpb247XG4gICAqIHZhbHVlcyBsaWtlIC0xMDAgb3IgMTAwIHNob3VsZCByZXN1bHQgaW4gYSBiYW4gb3IgZXhjbHVzaXZlIHNlbGVjdGlvbiBvZiB0aGVcbiAgICogcmVsZXZhbnQgdG9rZW4uXG4gICAqXG4gICAqIEFzIGFuIGV4YW1wbGUsIHlvdSBjYW4gcGFzcyBge1wiNTAyNTZcIjogLTEwMH1gIHRvIHByZXZlbnQgdGhlIDx8ZW5kb2Z0ZXh0fD4gdG9rZW5cbiAgICogZnJvbSBiZWluZyBnZW5lcmF0ZWQuXG4gICAqL1xuICBsb2dpdF9iaWFzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB8IG51bGw7XG5cbiAgLyoqXG4gICAqIEluY2x1ZGUgdGhlIGxvZyBwcm9iYWJpbGl0aWVzIG9uIHRoZSBgbG9ncHJvYnNgIG1vc3QgbGlrZWx5IHRva2VucywgYXMgd2VsbCB0aGVcbiAgICogY2hvc2VuIHRva2Vucy4gRm9yIGV4YW1wbGUsIGlmIGBsb2dwcm9ic2AgaXMgNSwgdGhlIEFQSSB3aWxsIHJldHVybiBhIGxpc3Qgb2ZcbiAgICogdGhlIDUgbW9zdCBsaWtlbHkgdG9rZW5zLiBUaGUgQVBJIHdpbGwgYWx3YXlzIHJldHVybiB0aGUgYGxvZ3Byb2JgIG9mIHRoZVxuICAgKiBzYW1wbGVkIHRva2VuLCBzbyB0aGVyZSBtYXkgYmUgdXAgdG8gYGxvZ3Byb2JzKzFgIGVsZW1lbnRzIGluIHRoZSByZXNwb25zZS5cbiAgICpcbiAgICogVGhlIG1heGltdW0gdmFsdWUgZm9yIGBsb2dwcm9ic2AgaXMgNS5cbiAgICovXG4gIGxvZ3Byb2JzPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIG1heGltdW0gbnVtYmVyIG9mIFt0b2tlbnNdKC90b2tlbml6ZXIpIHRvIGdlbmVyYXRlIGluIHRoZSBjb21wbGV0aW9uLlxuICAgKlxuICAgKiBUaGUgdG9rZW4gY291bnQgb2YgeW91ciBwcm9tcHQgcGx1cyBgbWF4X3Rva2Vuc2AgY2Fubm90IGV4Y2VlZCB0aGUgbW9kZWwnc1xuICAgKiBjb250ZXh0IGxlbmd0aC5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fY291bnRfdG9rZW5zX3dpdGhfdGlrdG9rZW4uaXB5bmIpXG4gICAqIGZvciBjb3VudGluZyB0b2tlbnMuXG4gICAqL1xuICBtYXhfdG9rZW5zPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogSG93IG1hbnkgY29tcGxldGlvbnMgdG8gZ2VuZXJhdGUgZm9yIGVhY2ggcHJvbXB0LlxuICAgKlxuICAgKiAqKk5vdGU6KiogQmVjYXVzZSB0aGlzIHBhcmFtZXRlciBnZW5lcmF0ZXMgbWFueSBjb21wbGV0aW9ucywgaXQgY2FuIHF1aWNrbHlcbiAgICogY29uc3VtZSB5b3VyIHRva2VuIHF1b3RhLiBVc2UgY2FyZWZ1bGx5IGFuZCBlbnN1cmUgdGhhdCB5b3UgaGF2ZSByZWFzb25hYmxlXG4gICAqIHNldHRpbmdzIGZvciBgbWF4X3Rva2Vuc2AgYW5kIGBzdG9wYC5cbiAgICovXG4gIG4/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBOdW1iZXIgYmV0d2VlbiAtMi4wIGFuZCAyLjAuIFBvc2l0aXZlIHZhbHVlcyBwZW5hbGl6ZSBuZXcgdG9rZW5zIGJhc2VkIG9uXG4gICAqIHdoZXRoZXIgdGhleSBhcHBlYXIgaW4gdGhlIHRleHQgc28gZmFyLCBpbmNyZWFzaW5nIHRoZSBtb2RlbCdzIGxpa2VsaWhvb2QgdG9cbiAgICogdGFsayBhYm91dCBuZXcgdG9waWNzLlxuICAgKlxuICAgKiBbU2VlIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgZnJlcXVlbmN5IGFuZCBwcmVzZW5jZSBwZW5hbHRpZXMuXSgvZG9jcy9ndWlkZXMvZ3B0L3BhcmFtZXRlci1kZXRhaWxzKVxuICAgKi9cbiAgcHJlc2VuY2VfcGVuYWx0eT86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFVwIHRvIDQgc2VxdWVuY2VzIHdoZXJlIHRoZSBBUEkgd2lsbCBzdG9wIGdlbmVyYXRpbmcgZnVydGhlciB0b2tlbnMuIFRoZVxuICAgKiByZXR1cm5lZCB0ZXh0IHdpbGwgbm90IGNvbnRhaW4gdGhlIHN0b3Agc2VxdWVuY2UuXG4gICAqL1xuICBzdG9wPzogc3RyaW5nIHwgbnVsbCB8IEFycmF5PHN0cmluZz47XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc3RyZWFtIGJhY2sgcGFydGlhbCBwcm9ncmVzcy4gSWYgc2V0LCB0b2tlbnMgd2lsbCBiZSBzZW50IGFzXG4gICAqIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUsIHdpdGggdGhlIHN0cmVhbSB0ZXJtaW5hdGVkIGJ5IGEgYGRhdGE6IFtET05FXWBcbiAgICogbWVzc2FnZS5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fc3RyZWFtX2NvbXBsZXRpb25zLmlweW5iKS5cbiAgICovXG4gIHN0cmVhbT86IGJvb2xlYW4gfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgc3VmZml4IHRoYXQgY29tZXMgYWZ0ZXIgYSBjb21wbGV0aW9uIG9mIGluc2VydGVkIHRleHQuXG4gICAqL1xuICBzdWZmaXg/OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBXaGF0IHNhbXBsaW5nIHRlbXBlcmF0dXJlIHRvIHVzZSwgYmV0d2VlbiAwIGFuZCAyLiBIaWdoZXIgdmFsdWVzIGxpa2UgMC44IHdpbGxcbiAgICogbWFrZSB0aGUgb3V0cHV0IG1vcmUgcmFuZG9tLCB3aGlsZSBsb3dlciB2YWx1ZXMgbGlrZSAwLjIgd2lsbCBtYWtlIGl0IG1vcmVcbiAgICogZm9jdXNlZCBhbmQgZGV0ZXJtaW5pc3RpYy5cbiAgICpcbiAgICogV2UgZ2VuZXJhbGx5IHJlY29tbWVuZCBhbHRlcmluZyB0aGlzIG9yIGB0b3BfcGAgYnV0IG5vdCBib3RoLlxuICAgKi9cbiAgdGVtcGVyYXR1cmU/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBbiBhbHRlcm5hdGl2ZSB0byBzYW1wbGluZyB3aXRoIHRlbXBlcmF0dXJlLCBjYWxsZWQgbnVjbGV1cyBzYW1wbGluZywgd2hlcmUgdGhlXG4gICAqIG1vZGVsIGNvbnNpZGVycyB0aGUgcmVzdWx0cyBvZiB0aGUgdG9rZW5zIHdpdGggdG9wX3AgcHJvYmFiaWxpdHkgbWFzcy4gU28gMC4xXG4gICAqIG1lYW5zIG9ubHkgdGhlIHRva2VucyBjb21wcmlzaW5nIHRoZSB0b3AgMTAlIHByb2JhYmlsaXR5IG1hc3MgYXJlIGNvbnNpZGVyZWQuXG4gICAqXG4gICAqIFdlIGdlbmVyYWxseSByZWNvbW1lbmQgYWx0ZXJpbmcgdGhpcyBvciBgdGVtcGVyYXR1cmVgIGJ1dCBub3QgYm90aC5cbiAgICovXG4gIHRvcF9wPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogQSB1bmlxdWUgaWRlbnRpZmllciByZXByZXNlbnRpbmcgeW91ciBlbmQtdXNlciwgd2hpY2ggY2FuIGhlbHAgT3BlbkFJIHRvIG1vbml0b3JcbiAgICogYW5kIGRldGVjdCBhYnVzZS4gW0xlYXJuIG1vcmVdKC9kb2NzL2d1aWRlcy9zYWZldHktYmVzdC1wcmFjdGljZXMvZW5kLXVzZXItaWRzKS5cbiAgICovXG4gIHVzZXI/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ29tcGxldGlvbkNyZWF0ZVBhcmFtcyB7XG4gIGV4cG9ydCB0eXBlIENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmcgPSBBUEkuQ29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZztcbiAgZXhwb3J0IHR5cGUgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyA9IEFQSS5Db21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmcgZXh0ZW5kcyBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zQmFzZSB7XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIHN0cmVhbSBiYWNrIHBhcnRpYWwgcHJvZ3Jlc3MuIElmIHNldCwgdG9rZW5zIHdpbGwgYmUgc2VudCBhc1xuICAgKiBkYXRhLW9ubHlcbiAgICogW3NlcnZlci1zZW50IGV2ZW50c10oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NlcnZlci1zZW50X2V2ZW50cy9Vc2luZ19zZXJ2ZXItc2VudF9ldmVudHMjRXZlbnRfc3RyZWFtX2Zvcm1hdClcbiAgICogYXMgdGhleSBiZWNvbWUgYXZhaWxhYmxlLCB3aXRoIHRoZSBzdHJlYW0gdGVybWluYXRlZCBieSBhIGBkYXRhOiBbRE9ORV1gXG4gICAqIG1lc3NhZ2UuXG4gICAqIFtFeGFtcGxlIFB5dGhvbiBjb2RlXShodHRwczovL2dpdGh1Yi5jb20vb3BlbmFpL29wZW5haS1jb29rYm9vay9ibG9iL21haW4vZXhhbXBsZXMvSG93X3RvX3N0cmVhbV9jb21wbGV0aW9ucy5pcHluYikuXG4gICAqL1xuICBzdHJlYW0/OiBmYWxzZSB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyBleHRlbmRzIENvbXBsZXRpb25DcmVhdGVQYXJhbXNCYXNlIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc3RyZWFtIGJhY2sgcGFydGlhbCBwcm9ncmVzcy4gSWYgc2V0LCB0b2tlbnMgd2lsbCBiZSBzZW50IGFzXG4gICAqIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUsIHdpdGggdGhlIHN0cmVhbSB0ZXJtaW5hdGVkIGJ5IGEgYGRhdGE6IFtET05FXWBcbiAgICogbWVzc2FnZS5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fc3RyZWFtX2NvbXBsZXRpb25zLmlweW5iKS5cbiAgICovXG4gIHN0cmVhbTogdHJ1ZTtcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBDb21wbGV0aW9ucyB7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbiA9IEFQSS5Db21wbGV0aW9uO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25DaG9pY2UgPSBBUEkuQ29tcGxldGlvbkNob2ljZTtcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uVXNhZ2UgPSBBUEkuQ29tcGxldGlvblVzYWdlO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25DcmVhdGVQYXJhbXMgPSBBUEkuQ29tcGxldGlvbkNyZWF0ZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nID0gQVBJLkNvbXBsZXRpb25DcmVhdGVQYXJhbXNOb25TdHJlYW1pbmc7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZyA9IEFQSS5Db21wbGV0aW9uQ3JlYXRlUGFyYW1zU3RyZWFtaW5nO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcblxuZXhwb3J0IGNsYXNzIEVtYmVkZGluZ3MgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGVtYmVkZGluZyB2ZWN0b3IgcmVwcmVzZW50aW5nIHRoZSBpbnB1dCB0ZXh0LlxuICAgKi9cbiAgY3JlYXRlKFxuICAgIGJvZHk6IEVtYmVkZGluZ0NyZWF0ZVBhcmFtcyxcbiAgICBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyxcbiAgKTogQ29yZS5BUElQcm9taXNlPENyZWF0ZUVtYmVkZGluZ1Jlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdCgnL2VtYmVkZGluZ3MnLCB7IGJvZHksIC4uLm9wdGlvbnMgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVFbWJlZGRpbmdSZXNwb25zZSB7XG4gIC8qKlxuICAgKiBUaGUgbGlzdCBvZiBlbWJlZGRpbmdzIGdlbmVyYXRlZCBieSB0aGUgbW9kZWwuXG4gICAqL1xuICBkYXRhOiBBcnJheTxFbWJlZGRpbmc+O1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgbW9kZWwgdXNlZCB0byBnZW5lcmF0ZSB0aGUgZW1iZWRkaW5nLlxuICAgKi9cbiAgbW9kZWw6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9iamVjdCB0eXBlLCB3aGljaCBpcyBhbHdheXMgXCJlbWJlZGRpbmdcIi5cbiAgICovXG4gIG9iamVjdDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgdXNhZ2UgaW5mb3JtYXRpb24gZm9yIHRoZSByZXF1ZXN0LlxuICAgKi9cbiAgdXNhZ2U6IENyZWF0ZUVtYmVkZGluZ1Jlc3BvbnNlLlVzYWdlO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENyZWF0ZUVtYmVkZGluZ1Jlc3BvbnNlIHtcbiAgLyoqXG4gICAqIFRoZSB1c2FnZSBpbmZvcm1hdGlvbiBmb3IgdGhlIHJlcXVlc3QuXG4gICAqL1xuICBleHBvcnQgaW50ZXJmYWNlIFVzYWdlIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIHRva2VucyB1c2VkIGJ5IHRoZSBwcm9tcHQuXG4gICAgICovXG4gICAgcHJvbXB0X3Rva2VuczogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHRvdGFsIG51bWJlciBvZiB0b2tlbnMgdXNlZCBieSB0aGUgcmVxdWVzdC5cbiAgICAgKi9cbiAgICB0b3RhbF90b2tlbnM6IG51bWJlcjtcbiAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYW4gZW1iZWRkaW5nIHZlY3RvciByZXR1cm5lZCBieSBlbWJlZGRpbmcgZW5kcG9pbnQuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRW1iZWRkaW5nIHtcbiAgLyoqXG4gICAqIFRoZSBlbWJlZGRpbmcgdmVjdG9yLCB3aGljaCBpcyBhIGxpc3Qgb2YgZmxvYXRzLiBUaGUgbGVuZ3RoIG9mIHZlY3RvciBkZXBlbmRzIG9uXG4gICAqIHRoZSBtb2RlbCBhcyBsaXN0ZWQgaW4gdGhlIFtlbWJlZGRpbmcgZ3VpZGVdKC9kb2NzL2d1aWRlcy9lbWJlZGRpbmdzKS5cbiAgICovXG4gIGVtYmVkZGluZzogQXJyYXk8bnVtYmVyPjtcblxuICAvKipcbiAgICogVGhlIGluZGV4IG9mIHRoZSBlbWJlZGRpbmcgaW4gdGhlIGxpc3Qgb2YgZW1iZWRkaW5ncy5cbiAgICovXG4gIGluZGV4OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgdHlwZSwgd2hpY2ggaXMgYWx3YXlzIFwiZW1iZWRkaW5nXCIuXG4gICAqL1xuICBvYmplY3Q6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbWJlZGRpbmdDcmVhdGVQYXJhbXMge1xuICAvKipcbiAgICogSW5wdXQgdGV4dCB0byBlbWJlZCwgZW5jb2RlZCBhcyBhIHN0cmluZyBvciBhcnJheSBvZiB0b2tlbnMuIFRvIGVtYmVkIG11bHRpcGxlXG4gICAqIGlucHV0cyBpbiBhIHNpbmdsZSByZXF1ZXN0LCBwYXNzIGFuIGFycmF5IG9mIHN0cmluZ3Mgb3IgYXJyYXkgb2YgdG9rZW4gYXJyYXlzLlxuICAgKiBFYWNoIGlucHV0IG11c3Qgbm90IGV4Y2VlZCB0aGUgbWF4IGlucHV0IHRva2VucyBmb3IgdGhlIG1vZGVsICg4MTkxIHRva2VucyBmb3JcbiAgICogYHRleHQtZW1iZWRkaW5nLWFkYS0wMDJgKS5cbiAgICogW0V4YW1wbGUgUHl0aG9uIGNvZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuYWkvb3BlbmFpLWNvb2tib29rL2Jsb2IvbWFpbi9leGFtcGxlcy9Ib3dfdG9fY291bnRfdG9rZW5zX3dpdGhfdGlrdG9rZW4uaXB5bmIpXG4gICAqIGZvciBjb3VudGluZyB0b2tlbnMuXG4gICAqL1xuICBpbnB1dDogc3RyaW5nIHwgQXJyYXk8c3RyaW5nPiB8IEFycmF5PG51bWJlcj4gfCBBcnJheTxBcnJheTxudW1iZXI+PjtcblxuICAvKipcbiAgICogSUQgb2YgdGhlIG1vZGVsIHRvIHVzZS4gWW91IGNhbiB1c2UgdGhlXG4gICAqIFtMaXN0IG1vZGVsc10oL2RvY3MvYXBpLXJlZmVyZW5jZS9tb2RlbHMvbGlzdCkgQVBJIHRvIHNlZSBhbGwgb2YgeW91ciBhdmFpbGFibGVcbiAgICogbW9kZWxzLCBvciBzZWUgb3VyIFtNb2RlbCBvdmVydmlld10oL2RvY3MvbW9kZWxzL292ZXJ2aWV3KSBmb3IgZGVzY3JpcHRpb25zIG9mXG4gICAqIHRoZW0uXG4gICAqL1xuICBtb2RlbDogKHN0cmluZyAmIHt9KSB8ICd0ZXh0LWVtYmVkZGluZy1hZGEtMDAyJztcblxuICAvKipcbiAgICogQSB1bmlxdWUgaWRlbnRpZmllciByZXByZXNlbnRpbmcgeW91ciBlbmQtdXNlciwgd2hpY2ggY2FuIGhlbHAgT3BlbkFJIHRvIG1vbml0b3JcbiAgICogYW5kIGRldGVjdCBhYnVzZS4gW0xlYXJuIG1vcmVdKC9kb2NzL2d1aWRlcy9zYWZldHktYmVzdC1wcmFjdGljZXMvZW5kLXVzZXItaWRzKS5cbiAgICovXG4gIHVzZXI/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRW1iZWRkaW5ncyB7XG4gIGV4cG9ydCBpbXBvcnQgQ3JlYXRlRW1iZWRkaW5nUmVzcG9uc2UgPSBBUEkuQ3JlYXRlRW1iZWRkaW5nUmVzcG9uc2U7XG4gIGV4cG9ydCBpbXBvcnQgRW1iZWRkaW5nID0gQVBJLkVtYmVkZGluZztcbiAgZXhwb3J0IGltcG9ydCBFbWJlZGRpbmdDcmVhdGVQYXJhbXMgPSBBUEkuRW1iZWRkaW5nQ3JlYXRlUGFyYW1zO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIENvbXBsZXRpb25zIGZyb20gJy4vY29tcGxldGlvbnMuanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vaW5kZXguanMnO1xuXG5leHBvcnQgY2xhc3MgRWRpdHMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IGVkaXQgZm9yIHRoZSBwcm92aWRlZCBpbnB1dCwgaW5zdHJ1Y3Rpb24sIGFuZCBwYXJhbWV0ZXJzLlxuICAgKlxuICAgKiBAZGVwcmVjYXRlZCBUaGUgRWRpdHMgQVBJIGlzIGRlcHJlY2F0ZWQ7IHBsZWFzZSB1c2UgQ2hhdCBDb21wbGV0aW9ucyBpbnN0ZWFkLlxuICAgKlxuICAgKiBodHRwczovL29wZW5haS5jb20vYmxvZy9ncHQtNC1hcGktZ2VuZXJhbC1hdmFpbGFiaWxpdHkjZGVwcmVjYXRpb24tb2YtdGhlLWVkaXRzLWFwaVxuICAgKi9cbiAgY3JlYXRlKGJvZHk6IEVkaXRDcmVhdGVQYXJhbXMsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPEVkaXQ+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvZWRpdHMnLCB7IGJvZHksIC4uLm9wdGlvbnMgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBFZGl0IHtcbiAgLyoqXG4gICAqIEEgbGlzdCBvZiBlZGl0IGNob2ljZXMuIENhbiBiZSBtb3JlIHRoYW4gb25lIGlmIGBuYCBpcyBncmVhdGVyIHRoYW4gMS5cbiAgICovXG4gIGNob2ljZXM6IEFycmF5PEVkaXQuQ2hvaWNlPjtcblxuICAvKipcbiAgICogVGhlIFVuaXggdGltZXN0YW1wIChpbiBzZWNvbmRzKSBvZiB3aGVuIHRoZSBlZGl0IHdhcyBjcmVhdGVkLlxuICAgKi9cbiAgY3JlYXRlZDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IHR5cGUsIHdoaWNoIGlzIGFsd2F5cyBgZWRpdGAuXG4gICAqL1xuICBvYmplY3Q6IHN0cmluZztcblxuICAvKipcbiAgICogVXNhZ2Ugc3RhdGlzdGljcyBmb3IgdGhlIGNvbXBsZXRpb24gcmVxdWVzdC5cbiAgICovXG4gIHVzYWdlOiBDb21wbGV0aW9ucy5Db21wbGV0aW9uVXNhZ2U7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRWRpdCB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgQ2hvaWNlIHtcbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSBtb2RlbCBzdG9wcGVkIGdlbmVyYXRpbmcgdG9rZW5zLiBUaGlzIHdpbGwgYmUgYHN0b3BgIGlmIHRoZSBtb2RlbFxuICAgICAqIGhpdCBhIG5hdHVyYWwgc3RvcCBwb2ludCBvciBhIHByb3ZpZGVkIHN0b3Agc2VxdWVuY2UsIG9yIGBsZW5ndGhgIGlmIHRoZSBtYXhpbXVtXG4gICAgICogbnVtYmVyIG9mIHRva2VucyBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIHJlYWNoZWQuXG4gICAgICovXG4gICAgZmluaXNoX3JlYXNvbjogJ3N0b3AnIHwgJ2xlbmd0aCc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGNob2ljZSBpbiB0aGUgbGlzdCBvZiBjaG9pY2VzLlxuICAgICAqL1xuICAgIGluZGV4OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZWRpdGVkIHJlc3VsdC5cbiAgICAgKi9cbiAgICB0ZXh0OiBzdHJpbmc7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBFZGl0Q3JlYXRlUGFyYW1zIHtcbiAgLyoqXG4gICAqIFRoZSBpbnN0cnVjdGlvbiB0aGF0IHRlbGxzIHRoZSBtb2RlbCBob3cgdG8gZWRpdCB0aGUgcHJvbXB0LlxuICAgKi9cbiAgaW5zdHJ1Y3Rpb246IHN0cmluZztcblxuICAvKipcbiAgICogSUQgb2YgdGhlIG1vZGVsIHRvIHVzZS4gWW91IGNhbiB1c2UgdGhlIGB0ZXh0LWRhdmluY2ktZWRpdC0wMDFgIG9yXG4gICAqIGBjb2RlLWRhdmluY2ktZWRpdC0wMDFgIG1vZGVsIHdpdGggdGhpcyBlbmRwb2ludC5cbiAgICovXG4gIG1vZGVsOiAoc3RyaW5nICYge30pIHwgJ3RleHQtZGF2aW5jaS1lZGl0LTAwMScgfCAnY29kZS1kYXZpbmNpLWVkaXQtMDAxJztcblxuICAvKipcbiAgICogVGhlIGlucHV0IHRleHQgdG8gdXNlIGFzIGEgc3RhcnRpbmcgcG9pbnQgZm9yIHRoZSBlZGl0LlxuICAgKi9cbiAgaW5wdXQ/OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBIb3cgbWFueSBlZGl0cyB0byBnZW5lcmF0ZSBmb3IgdGhlIGlucHV0IGFuZCBpbnN0cnVjdGlvbi5cbiAgICovXG4gIG4/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBXaGF0IHNhbXBsaW5nIHRlbXBlcmF0dXJlIHRvIHVzZSwgYmV0d2VlbiAwIGFuZCAyLiBIaWdoZXIgdmFsdWVzIGxpa2UgMC44IHdpbGxcbiAgICogbWFrZSB0aGUgb3V0cHV0IG1vcmUgcmFuZG9tLCB3aGlsZSBsb3dlciB2YWx1ZXMgbGlrZSAwLjIgd2lsbCBtYWtlIGl0IG1vcmVcbiAgICogZm9jdXNlZCBhbmQgZGV0ZXJtaW5pc3RpYy5cbiAgICpcbiAgICogV2UgZ2VuZXJhbGx5IHJlY29tbWVuZCBhbHRlcmluZyB0aGlzIG9yIGB0b3BfcGAgYnV0IG5vdCBib3RoLlxuICAgKi9cbiAgdGVtcGVyYXR1cmU/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBbiBhbHRlcm5hdGl2ZSB0byBzYW1wbGluZyB3aXRoIHRlbXBlcmF0dXJlLCBjYWxsZWQgbnVjbGV1cyBzYW1wbGluZywgd2hlcmUgdGhlXG4gICAqIG1vZGVsIGNvbnNpZGVycyB0aGUgcmVzdWx0cyBvZiB0aGUgdG9rZW5zIHdpdGggdG9wX3AgcHJvYmFiaWxpdHkgbWFzcy4gU28gMC4xXG4gICAqIG1lYW5zIG9ubHkgdGhlIHRva2VucyBjb21wcmlzaW5nIHRoZSB0b3AgMTAlIHByb2JhYmlsaXR5IG1hc3MgYXJlIGNvbnNpZGVyZWQuXG4gICAqXG4gICAqIFdlIGdlbmVyYWxseSByZWNvbW1lbmQgYWx0ZXJpbmcgdGhpcyBvciBgdGVtcGVyYXR1cmVgIGJ1dCBub3QgYm90aC5cbiAgICovXG4gIHRvcF9wPzogbnVtYmVyIHwgbnVsbDtcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBFZGl0cyB7XG4gIGV4cG9ydCBpbXBvcnQgRWRpdCA9IEFQSS5FZGl0O1xuICBleHBvcnQgaW1wb3J0IEVkaXRDcmVhdGVQYXJhbXMgPSBBUEkuRWRpdENyZWF0ZVBhcmFtcztcbn1cbiIsICIvLyBGaWxlIGdlbmVyYXRlZCBmcm9tIG91ciBPcGVuQVBJIHNwZWMgYnkgU3RhaW5sZXNzLlxuXG5pbXBvcnQgKiBhcyBDb3JlIGZyb20gJy4uL2NvcmUuanMnO1xuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgeyBzbGVlcCB9IGZyb20gJy4uL2NvcmUuanMnO1xuaW1wb3J0IHsgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvciB9IGZyb20gJy4uL2Vycm9yLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcbmltcG9ydCB7IHR5cGUgVXBsb2FkYWJsZSwgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBQYWdlIH0gZnJvbSAnLi4vcGFnaW5hdGlvbi5qcyc7XG5cbmV4cG9ydCBjbGFzcyBGaWxlcyBleHRlbmRzIEFQSVJlc291cmNlIHtcbiAgLyoqXG4gICAqIFVwbG9hZCBhIGZpbGUgdGhhdCBjb250YWlucyBkb2N1bWVudChzKSB0byBiZSB1c2VkIGFjcm9zcyB2YXJpb3VzXG4gICAqIGVuZHBvaW50cy9mZWF0dXJlcy4gQ3VycmVudGx5LCB0aGUgc2l6ZSBvZiBhbGwgdGhlIGZpbGVzIHVwbG9hZGVkIGJ5IG9uZVxuICAgKiBvcmdhbml6YXRpb24gY2FuIGJlIHVwIHRvIDEgR0IuIFBsZWFzZSBjb250YWN0IHVzIGlmIHlvdSBuZWVkIHRvIGluY3JlYXNlIHRoZVxuICAgKiBzdG9yYWdlIGxpbWl0LlxuICAgKi9cbiAgY3JlYXRlKGJvZHk6IEZpbGVDcmVhdGVQYXJhbXMsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPEZpbGVPYmplY3Q+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvZmlsZXMnLCBtdWx0aXBhcnRGb3JtUmVxdWVzdE9wdGlvbnMoeyBib2R5LCAuLi5vcHRpb25zIH0pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGluZm9ybWF0aW9uIGFib3V0IGEgc3BlY2lmaWMgZmlsZS5cbiAgICovXG4gIHJldHJpZXZlKGZpbGVJZDogc3RyaW5nLCBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyk6IENvcmUuQVBJUHJvbWlzZTxGaWxlT2JqZWN0PiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGAvZmlsZXMvJHtmaWxlSWR9YCwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIGxpc3Qgb2YgZmlsZXMgdGhhdCBiZWxvbmcgdG8gdGhlIHVzZXIncyBvcmdhbml6YXRpb24uXG4gICAqL1xuICBsaXN0KG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5QYWdlUHJvbWlzZTxGaWxlT2JqZWN0c1BhZ2UsIEZpbGVPYmplY3Q+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRBUElMaXN0KCcvZmlsZXMnLCBGaWxlT2JqZWN0c1BhZ2UsIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGV0ZSBhIGZpbGUuXG4gICAqL1xuICBkZWwoZmlsZUlkOiBzdHJpbmcsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPEZpbGVEZWxldGVkPiB7XG4gICAgcmV0dXJuIHRoaXMuZGVsZXRlKGAvZmlsZXMvJHtmaWxlSWR9YCwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgY29udGVudHMgb2YgdGhlIHNwZWNpZmllZCBmaWxlXG4gICAqL1xuICByZXRyaWV2ZUNvbnRlbnQoZmlsZUlkOiBzdHJpbmcsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiB0aGlzLmdldChgL2ZpbGVzLyR7ZmlsZUlkfS9jb250ZW50YCwge1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIGhlYWRlcnM6IHsgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsIC4uLm9wdGlvbnM/LmhlYWRlcnMgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXYWl0cyBmb3IgdGhlIGdpdmVuIGZpbGUgdG8gYmUgcHJvY2Vzc2VkLCBkZWZhdWx0IHRpbWVvdXQgaXMgMzAgbWlucy5cbiAgICovXG4gIGFzeW5jIHdhaXRGb3JQcm9jZXNzaW5nKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgeyBwb2xsSW50ZXJ2YWwgPSA1MDAwLCBtYXhXYWl0ID0gMzAgKiA2MCAqIDEwMDAgfTogeyBwb2xsSW50ZXJ2YWw/OiBudW1iZXI7IG1heFdhaXQ/OiBudW1iZXIgfSA9IHt9LFxuICApOiBQcm9taXNlPEZpbGVPYmplY3Q+IHtcbiAgICBjb25zdCBURVJNSU5BTF9TVEFURVMgPSBuZXcgU2V0KFsncHJvY2Vzc2VkJywgJ2Vycm9yJywgJ2RlbGV0ZWQnXSk7XG5cbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgbGV0IGZpbGUgPSBhd2FpdCB0aGlzLnJldHJpZXZlKGlkKTtcblxuICAgIHdoaWxlICghZmlsZS5zdGF0dXMgfHwgIVRFUk1JTkFMX1NUQVRFUy5oYXMoZmlsZS5zdGF0dXMpKSB7XG4gICAgICBhd2FpdCBzbGVlcChwb2xsSW50ZXJ2YWwpO1xuXG4gICAgICBmaWxlID0gYXdhaXQgdGhpcy5yZXRyaWV2ZShpZCk7XG4gICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gbWF4V2FpdCkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogYEdpdmluZyB1cCBvbiB3YWl0aW5nIGZvciBmaWxlICR7aWR9IHRvIGZpbmlzaCBwcm9jZXNzaW5nIGFmdGVyICR7bWF4V2FpdH0gbWlsbGlzZWNvbmRzLmAsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmaWxlO1xuICB9XG59XG5cbi8qKlxuICogTm90ZTogbm8gcGFnaW5hdGlvbiBhY3R1YWxseSBvY2N1cnMgeWV0LCB0aGlzIGlzIGZvciBmb3J3YXJkcy1jb21wYXRpYmlsaXR5LlxuICovXG5leHBvcnQgY2xhc3MgRmlsZU9iamVjdHNQYWdlIGV4dGVuZHMgUGFnZTxGaWxlT2JqZWN0PiB7fVxuLy8gYWxpYXMgc28gd2UgY2FuIGV4cG9ydCBpdCBpbiB0aGUgbmFtZXNwYWNlXG50eXBlIF9GaWxlT2JqZWN0c1BhZ2UgPSBGaWxlT2JqZWN0c1BhZ2U7XG5cbmV4cG9ydCB0eXBlIEZpbGVDb250ZW50ID0gc3RyaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVEZWxldGVkIHtcbiAgaWQ6IHN0cmluZztcblxuICBkZWxldGVkOiBib29sZWFuO1xuXG4gIG9iamVjdDogc3RyaW5nO1xufVxuXG4vKipcbiAqIFRoZSBgRmlsZWAgb2JqZWN0IHJlcHJlc2VudHMgYSBkb2N1bWVudCB0aGF0IGhhcyBiZWVuIHVwbG9hZGVkIHRvIE9wZW5BSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGaWxlT2JqZWN0IHtcbiAgLyoqXG4gICAqIFRoZSBmaWxlIGlkZW50aWZpZXIsIHdoaWNoIGNhbiBiZSByZWZlcmVuY2VkIGluIHRoZSBBUEkgZW5kcG9pbnRzLlxuICAgKi9cbiAgaWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHNpemUgb2YgdGhlIGZpbGUgaW4gYnl0ZXMuXG4gICAqL1xuICBieXRlczogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgVW5peCB0aW1lc3RhbXAgKGluIHNlY29uZHMpIGZvciB3aGVuIHRoZSBmaWxlIHdhcyBjcmVhdGVkLlxuICAgKi9cbiAgY3JlYXRlZF9hdDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgZmlsZS5cbiAgICovXG4gIGZpbGVuYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgdHlwZSwgd2hpY2ggaXMgYWx3YXlzIFwiZmlsZVwiLlxuICAgKi9cbiAgb2JqZWN0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBpbnRlbmRlZCBwdXJwb3NlIG9mIHRoZSBmaWxlLiBDdXJyZW50bHksIG9ubHkgXCJmaW5lLXR1bmVcIiBpcyBzdXBwb3J0ZWQuXG4gICAqL1xuICBwdXJwb3NlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IHN0YXR1cyBvZiB0aGUgZmlsZSwgd2hpY2ggY2FuIGJlIGVpdGhlciBgdXBsb2FkZWRgLCBgcHJvY2Vzc2VkYCxcbiAgICogYHBlbmRpbmdgLCBgZXJyb3JgLCBgZGVsZXRpbmdgIG9yIGBkZWxldGVkYC5cbiAgICovXG4gIHN0YXR1cz86IHN0cmluZztcblxuICAvKipcbiAgICogQWRkaXRpb25hbCBkZXRhaWxzIGFib3V0IHRoZSBzdGF0dXMgb2YgdGhlIGZpbGUuIElmIHRoZSBmaWxlIGlzIGluIHRoZSBgZXJyb3JgXG4gICAqIHN0YXRlLCB0aGlzIHdpbGwgaW5jbHVkZSBhIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgZXJyb3IuXG4gICAqL1xuICBzdGF0dXNfZGV0YWlscz86IHN0cmluZyB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmlsZUNyZWF0ZVBhcmFtcyB7XG4gIC8qKlxuICAgKiBOYW1lIG9mIHRoZSBbSlNPTiBMaW5lc10oaHR0cHM6Ly9qc29ubGluZXMucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0LykgZmlsZSB0byBiZVxuICAgKiB1cGxvYWRlZC5cbiAgICpcbiAgICogSWYgdGhlIGBwdXJwb3NlYCBpcyBzZXQgdG8gXCJmaW5lLXR1bmVcIiwgdGhlIGZpbGUgd2lsbCBiZSB1c2VkIGZvciBmaW5lLXR1bmluZy5cbiAgICovXG4gIGZpbGU6IFVwbG9hZGFibGU7XG5cbiAgLyoqXG4gICAqIFRoZSBpbnRlbmRlZCBwdXJwb3NlIG9mIHRoZSB1cGxvYWRlZCBkb2N1bWVudHMuXG4gICAqXG4gICAqIFVzZSBcImZpbmUtdHVuZVwiIGZvciBbZmluZS10dW5pbmddKC9kb2NzL2FwaS1yZWZlcmVuY2UvZmluZS10dW5pbmcpLiBUaGlzIGFsbG93c1xuICAgKiB1cyB0byB2YWxpZGF0ZSB0aGUgZm9ybWF0IG9mIHRoZSB1cGxvYWRlZCBmaWxlLlxuICAgKi9cbiAgcHVycG9zZTogc3RyaW5nO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIEZpbGVzIHtcbiAgZXhwb3J0IGltcG9ydCBGaWxlQ29udGVudCA9IEFQSS5GaWxlQ29udGVudDtcbiAgZXhwb3J0IGltcG9ydCBGaWxlRGVsZXRlZCA9IEFQSS5GaWxlRGVsZXRlZDtcbiAgZXhwb3J0IGltcG9ydCBGaWxlT2JqZWN0ID0gQVBJLkZpbGVPYmplY3Q7XG4gIGV4cG9ydCB0eXBlIEZpbGVPYmplY3RzUGFnZSA9IF9GaWxlT2JqZWN0c1BhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgRmlsZUNyZWF0ZVBhcmFtcyA9IEFQSS5GaWxlQ3JlYXRlUGFyYW1zO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElQcm9taXNlIH0gZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIEZpbGVzIGZyb20gJy4vZmlsZXMuanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vaW5kZXguanMnO1xuaW1wb3J0IHsgUGFnZSB9IGZyb20gJy4uL3BhZ2luYXRpb24uanMnO1xuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSAnLi4vc3RyZWFtaW5nLmpzJztcblxuZXhwb3J0IGNsYXNzIEZpbmVUdW5lcyBleHRlbmRzIEFQSVJlc291cmNlIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBqb2IgdGhhdCBmaW5lLXR1bmVzIGEgc3BlY2lmaWVkIG1vZGVsIGZyb20gYSBnaXZlbiBkYXRhc2V0LlxuICAgKlxuICAgKiBSZXNwb25zZSBpbmNsdWRlcyBkZXRhaWxzIG9mIHRoZSBlbnF1ZXVlZCBqb2IgaW5jbHVkaW5nIGpvYiBzdGF0dXMgYW5kIHRoZSBuYW1lXG4gICAqIG9mIHRoZSBmaW5lLXR1bmVkIG1vZGVscyBvbmNlIGNvbXBsZXRlLlxuICAgKlxuICAgKiBbTGVhcm4gbW9yZSBhYm91dCBmaW5lLXR1bmluZ10oL2RvY3MvZ3VpZGVzL2xlZ2FjeS1maW5lLXR1bmluZylcbiAgICovXG4gIGNyZWF0ZShib2R5OiBGaW5lVHVuZUNyZWF0ZVBhcmFtcywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkFQSVByb21pc2U8RmluZVR1bmU+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvZmluZS10dW5lcycsIHsgYm9keSwgLi4ub3B0aW9ucyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGluZm8gYWJvdXQgdGhlIGZpbmUtdHVuZSBqb2IuXG4gICAqXG4gICAqIFtMZWFybiBtb3JlIGFib3V0IGZpbmUtdHVuaW5nXSgvZG9jcy9ndWlkZXMvbGVnYWN5LWZpbmUtdHVuaW5nKVxuICAgKi9cbiAgcmV0cmlldmUoZmluZVR1bmVJZDogc3RyaW5nLCBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyk6IENvcmUuQVBJUHJvbWlzZTxGaW5lVHVuZT4ge1xuICAgIHJldHVybiB0aGlzLmdldChgL2ZpbmUtdHVuZXMvJHtmaW5lVHVuZUlkfWAsIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIExpc3QgeW91ciBvcmdhbml6YXRpb24ncyBmaW5lLXR1bmluZyBqb2JzXG4gICAqL1xuICBsaXN0KG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5QYWdlUHJvbWlzZTxGaW5lVHVuZXNQYWdlLCBGaW5lVHVuZT4ge1xuICAgIHJldHVybiB0aGlzLmdldEFQSUxpc3QoJy9maW5lLXR1bmVzJywgRmluZVR1bmVzUGFnZSwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogSW1tZWRpYXRlbHkgY2FuY2VsIGEgZmluZS10dW5lIGpvYi5cbiAgICovXG4gIGNhbmNlbChmaW5lVHVuZUlkOiBzdHJpbmcsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPEZpbmVUdW5lPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdChgL2ZpbmUtdHVuZXMvJHtmaW5lVHVuZUlkfS9jYW5jZWxgLCBvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZmluZS1ncmFpbmVkIHN0YXR1cyB1cGRhdGVzIGZvciBhIGZpbmUtdHVuZSBqb2IuXG4gICAqL1xuICBsaXN0RXZlbnRzKFxuICAgIGZpbmVUdW5lSWQ6IHN0cmluZyxcbiAgICBxdWVyeT86IEZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc05vblN0cmVhbWluZyxcbiAgICBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyxcbiAgKTogQVBJUHJvbWlzZTxGaW5lVHVuZUV2ZW50c0xpc3RSZXNwb25zZT47XG4gIGxpc3RFdmVudHMoXG4gICAgZmluZVR1bmVJZDogc3RyaW5nLFxuICAgIHF1ZXJ5OiBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNTdHJlYW1pbmcsXG4gICAgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMsXG4gICk6IEFQSVByb21pc2U8U3RyZWFtPEZpbmVUdW5lRXZlbnQ+PjtcbiAgbGlzdEV2ZW50cyhcbiAgICBmaW5lVHVuZUlkOiBzdHJpbmcsXG4gICAgcXVlcnk/OiBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNCYXNlIHwgdW5kZWZpbmVkLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBBUElQcm9taXNlPFN0cmVhbTxGaW5lVHVuZUV2ZW50PiB8IEZpbmVUdW5lRXZlbnRzTGlzdFJlc3BvbnNlPjtcbiAgbGlzdEV2ZW50cyhcbiAgICBmaW5lVHVuZUlkOiBzdHJpbmcsXG4gICAgcXVlcnk/OiBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXMgfCB1bmRlZmluZWQsXG4gICAgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMsXG4gICk6IEFQSVByb21pc2U8RmluZVR1bmVFdmVudHNMaXN0UmVzcG9uc2U+IHwgQVBJUHJvbWlzZTxTdHJlYW08RmluZVR1bmVFdmVudD4+IHtcbiAgICByZXR1cm4gdGhpcy5nZXQoYC9maW5lLXR1bmVzLyR7ZmluZVR1bmVJZH0vZXZlbnRzYCwge1xuICAgICAgcXVlcnksXG4gICAgICB0aW1lb3V0OiA4NjQwMDAwMCxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBzdHJlYW06IHF1ZXJ5Py5zdHJlYW0gPz8gZmFsc2UsXG4gICAgfSkgYXMgQVBJUHJvbWlzZTxGaW5lVHVuZUV2ZW50c0xpc3RSZXNwb25zZT4gfCBBUElQcm9taXNlPFN0cmVhbTxGaW5lVHVuZUV2ZW50Pj47XG4gIH1cbn1cblxuLyoqXG4gKiBOb3RlOiBubyBwYWdpbmF0aW9uIGFjdHVhbGx5IG9jY3VycyB5ZXQsIHRoaXMgaXMgZm9yIGZvcndhcmRzLWNvbXBhdGliaWxpdHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBGaW5lVHVuZXNQYWdlIGV4dGVuZHMgUGFnZTxGaW5lVHVuZT4ge31cbi8vIGFsaWFzIHNvIHdlIGNhbiBleHBvcnQgaXQgaW4gdGhlIG5hbWVzcGFjZVxudHlwZSBfRmluZVR1bmVzUGFnZSA9IEZpbmVUdW5lc1BhZ2U7XG5cbi8qKlxuICogVGhlIGBGaW5lVHVuZWAgb2JqZWN0IHJlcHJlc2VudHMgYSBsZWdhY3kgZmluZS10dW5lIGpvYiB0aGF0IGhhcyBiZWVuIGNyZWF0ZWRcbiAqIHRocm91Z2ggdGhlIEFQSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGaW5lVHVuZSB7XG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IGlkZW50aWZpZXIsIHdoaWNoIGNhbiBiZSByZWZlcmVuY2VkIGluIHRoZSBBUEkgZW5kcG9pbnRzLlxuICAgKi9cbiAgaWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIFVuaXggdGltZXN0YW1wIChpbiBzZWNvbmRzKSBmb3Igd2hlbiB0aGUgZmluZS10dW5pbmcgam9iIHdhcyBjcmVhdGVkLlxuICAgKi9cbiAgY3JlYXRlZF9hdDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgZmluZS10dW5lZCBtb2RlbCB0aGF0IGlzIGJlaW5nIGNyZWF0ZWQuXG4gICAqL1xuICBmaW5lX3R1bmVkX21vZGVsOiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgaHlwZXJwYXJhbWV0ZXJzIHVzZWQgZm9yIHRoZSBmaW5lLXR1bmluZyBqb2IuIFNlZSB0aGVcbiAgICogW2ZpbmUtdHVuaW5nIGd1aWRlXSgvZG9jcy9ndWlkZXMvbGVnYWN5LWZpbmUtdHVuaW5nL2h5cGVycGFyYW1ldGVycykgZm9yIG1vcmVcbiAgICogZGV0YWlscy5cbiAgICovXG4gIGh5cGVycGFyYW1zOiBGaW5lVHVuZS5IeXBlcnBhcmFtcztcblxuICAvKipcbiAgICogVGhlIGJhc2UgbW9kZWwgdGhhdCBpcyBiZWluZyBmaW5lLXR1bmVkLlxuICAgKi9cbiAgbW9kZWw6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9iamVjdCB0eXBlLCB3aGljaCBpcyBhbHdheXMgXCJmaW5lLXR1bmVcIi5cbiAgICovXG4gIG9iamVjdDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb3JnYW5pemF0aW9uIHRoYXQgb3ducyB0aGUgZmluZS10dW5pbmcgam9iLlxuICAgKi9cbiAgb3JnYW5pemF0aW9uX2lkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBjb21waWxlZCByZXN1bHRzIGZpbGVzIGZvciB0aGUgZmluZS10dW5pbmcgam9iLlxuICAgKi9cbiAgcmVzdWx0X2ZpbGVzOiBBcnJheTxGaWxlcy5GaWxlT2JqZWN0PjtcblxuICAvKipcbiAgICogVGhlIGN1cnJlbnQgc3RhdHVzIG9mIHRoZSBmaW5lLXR1bmluZyBqb2IsIHdoaWNoIGNhbiBiZSBlaXRoZXIgYGNyZWF0ZWRgLFxuICAgKiBgcnVubmluZ2AsIGBzdWNjZWVkZWRgLCBgZmFpbGVkYCwgb3IgYGNhbmNlbGxlZGAuXG4gICAqL1xuICBzdGF0dXM6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGxpc3Qgb2YgZmlsZXMgdXNlZCBmb3IgdHJhaW5pbmcuXG4gICAqL1xuICB0cmFpbmluZ19maWxlczogQXJyYXk8RmlsZXMuRmlsZU9iamVjdD47XG5cbiAgLyoqXG4gICAqIFRoZSBVbml4IHRpbWVzdGFtcCAoaW4gc2Vjb25kcykgZm9yIHdoZW4gdGhlIGZpbmUtdHVuaW5nIGpvYiB3YXMgbGFzdCB1cGRhdGVkLlxuICAgKi9cbiAgdXBkYXRlZF9hdDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgbGlzdCBvZiBmaWxlcyB1c2VkIGZvciB2YWxpZGF0aW9uLlxuICAgKi9cbiAgdmFsaWRhdGlvbl9maWxlczogQXJyYXk8RmlsZXMuRmlsZU9iamVjdD47XG5cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIGV2ZW50cyB0aGF0IGhhdmUgYmVlbiBvYnNlcnZlZCBpbiB0aGUgbGlmZWN5Y2xlIG9mIHRoZSBGaW5lVHVuZSBqb2IuXG4gICAqL1xuICBldmVudHM/OiBBcnJheTxGaW5lVHVuZUV2ZW50Pjtcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBGaW5lVHVuZSB7XG4gIC8qKlxuICAgKiBUaGUgaHlwZXJwYXJhbWV0ZXJzIHVzZWQgZm9yIHRoZSBmaW5lLXR1bmluZyBqb2IuIFNlZSB0aGVcbiAgICogW2ZpbmUtdHVuaW5nIGd1aWRlXSgvZG9jcy9ndWlkZXMvbGVnYWN5LWZpbmUtdHVuaW5nL2h5cGVycGFyYW1ldGVycykgZm9yIG1vcmVcbiAgICogZGV0YWlscy5cbiAgICovXG4gIGV4cG9ydCBpbnRlcmZhY2UgSHlwZXJwYXJhbXMge1xuICAgIC8qKlxuICAgICAqIFRoZSBiYXRjaCBzaXplIHRvIHVzZSBmb3IgdHJhaW5pbmcuIFRoZSBiYXRjaCBzaXplIGlzIHRoZSBudW1iZXIgb2YgdHJhaW5pbmdcbiAgICAgKiBleGFtcGxlcyB1c2VkIHRvIHRyYWluIGEgc2luZ2xlIGZvcndhcmQgYW5kIGJhY2t3YXJkIHBhc3MuXG4gICAgICovXG4gICAgYmF0Y2hfc2l6ZTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGxlYXJuaW5nIHJhdGUgbXVsdGlwbGllciB0byB1c2UgZm9yIHRyYWluaW5nLlxuICAgICAqL1xuICAgIGxlYXJuaW5nX3JhdGVfbXVsdGlwbGllcjogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiBlcG9jaHMgdG8gdHJhaW4gdGhlIG1vZGVsIGZvci4gQW4gZXBvY2ggcmVmZXJzIHRvIG9uZSBmdWxsIGN5Y2xlXG4gICAgICogdGhyb3VnaCB0aGUgdHJhaW5pbmcgZGF0YXNldC5cbiAgICAgKi9cbiAgICBuX2Vwb2NoczogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHdlaWdodCB0byB1c2UgZm9yIGxvc3Mgb24gdGhlIHByb21wdCB0b2tlbnMuXG4gICAgICovXG4gICAgcHJvbXB0X2xvc3Nfd2VpZ2h0OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIGNsYXNzZXMgdG8gdXNlIGZvciBjb21wdXRpbmcgY2xhc3NpZmljYXRpb24gbWV0cmljcy5cbiAgICAgKi9cbiAgICBjbGFzc2lmaWNhdGlvbl9uX2NsYXNzZXM/OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcG9zaXRpdmUgY2xhc3MgdG8gdXNlIGZvciBjb21wdXRpbmcgY2xhc3NpZmljYXRpb24gbWV0cmljcy5cbiAgICAgKi9cbiAgICBjbGFzc2lmaWNhdGlvbl9wb3NpdGl2ZV9jbGFzcz86IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzc2lmaWNhdGlvbiBtZXRyaWNzIHRvIGNvbXB1dGUgdXNpbmcgdGhlIHZhbGlkYXRpb24gZGF0YXNldCBhdCB0aGUgZW5kIG9mXG4gICAgICogZXZlcnkgZXBvY2guXG4gICAgICovXG4gICAgY29tcHV0ZV9jbGFzc2lmaWNhdGlvbl9tZXRyaWNzPzogYm9vbGVhbjtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpbmVUdW5lRXZlbnQge1xuICBjcmVhdGVkX2F0OiBudW1iZXI7XG5cbiAgbGV2ZWw6IHN0cmluZztcblxuICBtZXNzYWdlOiBzdHJpbmc7XG5cbiAgb2JqZWN0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmluZVR1bmVFdmVudHNMaXN0UmVzcG9uc2Uge1xuICBkYXRhOiBBcnJheTxGaW5lVHVuZUV2ZW50PjtcblxuICBvYmplY3Q6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5lVHVuZUNyZWF0ZVBhcmFtcyB7XG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgYW4gdXBsb2FkZWQgZmlsZSB0aGF0IGNvbnRhaW5zIHRyYWluaW5nIGRhdGEuXG4gICAqXG4gICAqIFNlZSBbdXBsb2FkIGZpbGVdKC9kb2NzL2FwaS1yZWZlcmVuY2UvZmlsZXMvdXBsb2FkKSBmb3IgaG93IHRvIHVwbG9hZCBhIGZpbGUuXG4gICAqXG4gICAqIFlvdXIgZGF0YXNldCBtdXN0IGJlIGZvcm1hdHRlZCBhcyBhIEpTT05MIGZpbGUsIHdoZXJlIGVhY2ggdHJhaW5pbmcgZXhhbXBsZSBpcyBhXG4gICAqIEpTT04gb2JqZWN0IHdpdGggdGhlIGtleXMgXCJwcm9tcHRcIiBhbmQgXCJjb21wbGV0aW9uXCIuIEFkZGl0aW9uYWxseSwgeW91IG11c3RcbiAgICogdXBsb2FkIHlvdXIgZmlsZSB3aXRoIHRoZSBwdXJwb3NlIGBmaW5lLXR1bmVgLlxuICAgKlxuICAgKiBTZWUgdGhlXG4gICAqIFtmaW5lLXR1bmluZyBndWlkZV0oL2RvY3MvZ3VpZGVzL2xlZ2FjeS1maW5lLXR1bmluZy9jcmVhdGluZy10cmFpbmluZy1kYXRhKSBmb3JcbiAgICogbW9yZSBkZXRhaWxzLlxuICAgKi9cbiAgdHJhaW5pbmdfZmlsZTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgYmF0Y2ggc2l6ZSB0byB1c2UgZm9yIHRyYWluaW5nLiBUaGUgYmF0Y2ggc2l6ZSBpcyB0aGUgbnVtYmVyIG9mIHRyYWluaW5nXG4gICAqIGV4YW1wbGVzIHVzZWQgdG8gdHJhaW4gYSBzaW5nbGUgZm9yd2FyZCBhbmQgYmFja3dhcmQgcGFzcy5cbiAgICpcbiAgICogQnkgZGVmYXVsdCwgdGhlIGJhdGNoIHNpemUgd2lsbCBiZSBkeW5hbWljYWxseSBjb25maWd1cmVkIHRvIGJlIH4wLjIlIG9mIHRoZVxuICAgKiBudW1iZXIgb2YgZXhhbXBsZXMgaW4gdGhlIHRyYWluaW5nIHNldCwgY2FwcGVkIGF0IDI1NiAtIGluIGdlbmVyYWwsIHdlJ3ZlIGZvdW5kXG4gICAqIHRoYXQgbGFyZ2VyIGJhdGNoIHNpemVzIHRlbmQgdG8gd29yayBiZXR0ZXIgZm9yIGxhcmdlciBkYXRhc2V0cy5cbiAgICovXG4gIGJhdGNoX3NpemU/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBJZiB0aGlzIGlzIHByb3ZpZGVkLCB3ZSBjYWxjdWxhdGUgRi1iZXRhIHNjb3JlcyBhdCB0aGUgc3BlY2lmaWVkIGJldGEgdmFsdWVzLlxuICAgKiBUaGUgRi1iZXRhIHNjb3JlIGlzIGEgZ2VuZXJhbGl6YXRpb24gb2YgRi0xIHNjb3JlLiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgYmluYXJ5XG4gICAqIGNsYXNzaWZpY2F0aW9uLlxuICAgKlxuICAgKiBXaXRoIGEgYmV0YSBvZiAxIChpLmUuIHRoZSBGLTEgc2NvcmUpLCBwcmVjaXNpb24gYW5kIHJlY2FsbCBhcmUgZ2l2ZW4gdGhlIHNhbWVcbiAgICogd2VpZ2h0LiBBIGxhcmdlciBiZXRhIHNjb3JlIHB1dHMgbW9yZSB3ZWlnaHQgb24gcmVjYWxsIGFuZCBsZXNzIG9uIHByZWNpc2lvbi4gQVxuICAgKiBzbWFsbGVyIGJldGEgc2NvcmUgcHV0cyBtb3JlIHdlaWdodCBvbiBwcmVjaXNpb24gYW5kIGxlc3Mgb24gcmVjYWxsLlxuICAgKi9cbiAgY2xhc3NpZmljYXRpb25fYmV0YXM/OiBBcnJheTxudW1iZXI+IHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBjbGFzc2VzIGluIGEgY2xhc3NpZmljYXRpb24gdGFzay5cbiAgICpcbiAgICogVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQgZm9yIG11bHRpY2xhc3MgY2xhc3NpZmljYXRpb24uXG4gICAqL1xuICBjbGFzc2lmaWNhdGlvbl9uX2NsYXNzZXM/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgcG9zaXRpdmUgY2xhc3MgaW4gYmluYXJ5IGNsYXNzaWZpY2F0aW9uLlxuICAgKlxuICAgKiBUaGlzIHBhcmFtZXRlciBpcyBuZWVkZWQgdG8gZ2VuZXJhdGUgcHJlY2lzaW9uLCByZWNhbGwsIGFuZCBGMSBtZXRyaWNzIHdoZW5cbiAgICogZG9pbmcgYmluYXJ5IGNsYXNzaWZpY2F0aW9uLlxuICAgKi9cbiAgY2xhc3NpZmljYXRpb25fcG9zaXRpdmVfY2xhc3M/OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBJZiBzZXQsIHdlIGNhbGN1bGF0ZSBjbGFzc2lmaWNhdGlvbi1zcGVjaWZpYyBtZXRyaWNzIHN1Y2ggYXMgYWNjdXJhY3kgYW5kIEYtMVxuICAgKiBzY29yZSB1c2luZyB0aGUgdmFsaWRhdGlvbiBzZXQgYXQgdGhlIGVuZCBvZiBldmVyeSBlcG9jaC4gVGhlc2UgbWV0cmljcyBjYW4gYmVcbiAgICogdmlld2VkIGluIHRoZVxuICAgKiBbcmVzdWx0cyBmaWxlXSgvZG9jcy9ndWlkZXMvbGVnYWN5LWZpbmUtdHVuaW5nL2FuYWx5emluZy15b3VyLWZpbmUtdHVuZWQtbW9kZWwpLlxuICAgKlxuICAgKiBJbiBvcmRlciB0byBjb21wdXRlIGNsYXNzaWZpY2F0aW9uIG1ldHJpY3MsIHlvdSBtdXN0IHByb3ZpZGUgYVxuICAgKiBgdmFsaWRhdGlvbl9maWxlYC4gQWRkaXRpb25hbGx5LCB5b3UgbXVzdCBzcGVjaWZ5IGBjbGFzc2lmaWNhdGlvbl9uX2NsYXNzZXNgIGZvclxuICAgKiBtdWx0aWNsYXNzIGNsYXNzaWZpY2F0aW9uIG9yIGBjbGFzc2lmaWNhdGlvbl9wb3NpdGl2ZV9jbGFzc2AgZm9yIGJpbmFyeVxuICAgKiBjbGFzc2lmaWNhdGlvbi5cbiAgICovXG4gIGNvbXB1dGVfY2xhc3NpZmljYXRpb25fbWV0cmljcz86IGJvb2xlYW4gfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgbGVhcm5pbmcgcmF0ZSBtdWx0aXBsaWVyIHRvIHVzZSBmb3IgdHJhaW5pbmcuIFRoZSBmaW5lLXR1bmluZyBsZWFybmluZyByYXRlXG4gICAqIGlzIHRoZSBvcmlnaW5hbCBsZWFybmluZyByYXRlIHVzZWQgZm9yIHByZXRyYWluaW5nIG11bHRpcGxpZWQgYnkgdGhpcyB2YWx1ZS5cbiAgICpcbiAgICogQnkgZGVmYXVsdCwgdGhlIGxlYXJuaW5nIHJhdGUgbXVsdGlwbGllciBpcyB0aGUgMC4wNSwgMC4xLCBvciAwLjIgZGVwZW5kaW5nIG9uXG4gICAqIGZpbmFsIGBiYXRjaF9zaXplYCAobGFyZ2VyIGxlYXJuaW5nIHJhdGVzIHRlbmQgdG8gcGVyZm9ybSBiZXR0ZXIgd2l0aCBsYXJnZXJcbiAgICogYmF0Y2ggc2l6ZXMpLiBXZSByZWNvbW1lbmQgZXhwZXJpbWVudGluZyB3aXRoIHZhbHVlcyBpbiB0aGUgcmFuZ2UgMC4wMiB0byAwLjIgdG9cbiAgICogc2VlIHdoYXQgcHJvZHVjZXMgdGhlIGJlc3QgcmVzdWx0cy5cbiAgICovXG4gIGxlYXJuaW5nX3JhdGVfbXVsdGlwbGllcj86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBiYXNlIG1vZGVsIHRvIGZpbmUtdHVuZS4gWW91IGNhbiBzZWxlY3Qgb25lIG9mIFwiYWRhXCIsIFwiYmFiYmFnZVwiLFxuICAgKiBcImN1cmllXCIsIFwiZGF2aW5jaVwiLCBvciBhIGZpbmUtdHVuZWQgbW9kZWwgY3JlYXRlZCBhZnRlciAyMDIyLTA0LTIxIGFuZCBiZWZvcmVcbiAgICogMjAyMy0wOC0yMi4gVG8gbGVhcm4gbW9yZSBhYm91dCB0aGVzZSBtb2RlbHMsIHNlZSB0aGUgW01vZGVsc10oL2RvY3MvbW9kZWxzKVxuICAgKiBkb2N1bWVudGF0aW9uLlxuICAgKi9cbiAgbW9kZWw/OiAoc3RyaW5nICYge30pIHwgJ2FkYScgfCAnYmFiYmFnZScgfCAnY3VyaWUnIHwgJ2RhdmluY2knIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBlcG9jaHMgdG8gdHJhaW4gdGhlIG1vZGVsIGZvci4gQW4gZXBvY2ggcmVmZXJzIHRvIG9uZSBmdWxsIGN5Y2xlXG4gICAqIHRocm91Z2ggdGhlIHRyYWluaW5nIGRhdGFzZXQuXG4gICAqL1xuICBuX2Vwb2Nocz86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSB3ZWlnaHQgdG8gdXNlIGZvciBsb3NzIG9uIHRoZSBwcm9tcHQgdG9rZW5zLiBUaGlzIGNvbnRyb2xzIGhvdyBtdWNoIHRoZVxuICAgKiBtb2RlbCB0cmllcyB0byBsZWFybiB0byBnZW5lcmF0ZSB0aGUgcHJvbXB0IChhcyBjb21wYXJlZCB0byB0aGUgY29tcGxldGlvbiB3aGljaFxuICAgKiBhbHdheXMgaGFzIGEgd2VpZ2h0IG9mIDEuMCksIGFuZCBjYW4gYWRkIGEgc3RhYmlsaXppbmcgZWZmZWN0IHRvIHRyYWluaW5nIHdoZW5cbiAgICogY29tcGxldGlvbnMgYXJlIHNob3J0LlxuICAgKlxuICAgKiBJZiBwcm9tcHRzIGFyZSBleHRyZW1lbHkgbG9uZyAocmVsYXRpdmUgdG8gY29tcGxldGlvbnMpLCBpdCBtYXkgbWFrZSBzZW5zZSB0b1xuICAgKiByZWR1Y2UgdGhpcyB3ZWlnaHQgc28gYXMgdG8gYXZvaWQgb3Zlci1wcmlvcml0aXppbmcgbGVhcm5pbmcgdGhlIHByb21wdC5cbiAgICovXG4gIHByb21wdF9sb3NzX3dlaWdodD86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIEEgc3RyaW5nIG9mIHVwIHRvIDQwIGNoYXJhY3RlcnMgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHlvdXIgZmluZS10dW5lZCBtb2RlbFxuICAgKiBuYW1lLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgYSBgc3VmZml4YCBvZiBcImN1c3RvbS1tb2RlbC1uYW1lXCIgd291bGQgcHJvZHVjZSBhIG1vZGVsIG5hbWUgbGlrZVxuICAgKiBgYWRhOmZ0LXlvdXItb3JnOmN1c3RvbS1tb2RlbC1uYW1lLTIwMjItMDItMTUtMDQtMjEtMDRgLlxuICAgKi9cbiAgc3VmZml4Pzogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIElEIG9mIGFuIHVwbG9hZGVkIGZpbGUgdGhhdCBjb250YWlucyB2YWxpZGF0aW9uIGRhdGEuXG4gICAqXG4gICAqIElmIHlvdSBwcm92aWRlIHRoaXMgZmlsZSwgdGhlIGRhdGEgaXMgdXNlZCB0byBnZW5lcmF0ZSB2YWxpZGF0aW9uIG1ldHJpY3NcbiAgICogcGVyaW9kaWNhbGx5IGR1cmluZyBmaW5lLXR1bmluZy4gVGhlc2UgbWV0cmljcyBjYW4gYmUgdmlld2VkIGluIHRoZVxuICAgKiBbZmluZS10dW5pbmcgcmVzdWx0cyBmaWxlXSgvZG9jcy9ndWlkZXMvbGVnYWN5LWZpbmUtdHVuaW5nL2FuYWx5emluZy15b3VyLWZpbmUtdHVuZWQtbW9kZWwpLlxuICAgKiBZb3VyIHRyYWluIGFuZCB2YWxpZGF0aW9uIGRhdGEgc2hvdWxkIGJlIG11dHVhbGx5IGV4Y2x1c2l2ZS5cbiAgICpcbiAgICogWW91ciBkYXRhc2V0IG11c3QgYmUgZm9ybWF0dGVkIGFzIGEgSlNPTkwgZmlsZSwgd2hlcmUgZWFjaCB2YWxpZGF0aW9uIGV4YW1wbGUgaXNcbiAgICogYSBKU09OIG9iamVjdCB3aXRoIHRoZSBrZXlzIFwicHJvbXB0XCIgYW5kIFwiY29tcGxldGlvblwiLiBBZGRpdGlvbmFsbHksIHlvdSBtdXN0XG4gICAqIHVwbG9hZCB5b3VyIGZpbGUgd2l0aCB0aGUgcHVycG9zZSBgZmluZS10dW5lYC5cbiAgICpcbiAgICogU2VlIHRoZVxuICAgKiBbZmluZS10dW5pbmcgZ3VpZGVdKC9kb2NzL2d1aWRlcy9sZWdhY3ktZmluZS10dW5pbmcvY3JlYXRpbmctdHJhaW5pbmctZGF0YSkgZm9yXG4gICAqIG1vcmUgZGV0YWlscy5cbiAgICovXG4gIHZhbGlkYXRpb25fZmlsZT86IHN0cmluZyB8IG51bGw7XG59XG5cbmV4cG9ydCB0eXBlIEZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtcyA9XG4gIHwgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zTm9uU3RyZWFtaW5nXG4gIHwgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zU3RyZWFtaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc0Jhc2Uge1xuICAvKipcbiAgICogV2hldGhlciB0byBzdHJlYW0gZXZlbnRzIGZvciB0aGUgZmluZS10dW5lIGpvYi4gSWYgc2V0IHRvIHRydWUsIGV2ZW50cyB3aWxsIGJlXG4gICAqIHNlbnQgYXMgZGF0YS1vbmx5XG4gICAqIFtzZXJ2ZXItc2VudCBldmVudHNdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TZXJ2ZXItc2VudF9ldmVudHMvVXNpbmdfc2VydmVyLXNlbnRfZXZlbnRzI0V2ZW50X3N0cmVhbV9mb3JtYXQpXG4gICAqIGFzIHRoZXkgYmVjb21lIGF2YWlsYWJsZS4gVGhlIHN0cmVhbSB3aWxsIHRlcm1pbmF0ZSB3aXRoIGEgYGRhdGE6IFtET05FXWBcbiAgICogbWVzc2FnZSB3aGVuIHRoZSBqb2IgaXMgZmluaXNoZWQgKHN1Y2NlZWRlZCwgY2FuY2VsbGVkLCBvciBmYWlsZWQpLlxuICAgKlxuICAgKiBJZiBzZXQgdG8gZmFsc2UsIG9ubHkgZXZlbnRzIGdlbmVyYXRlZCBzbyBmYXIgd2lsbCBiZSByZXR1cm5lZC5cbiAgICovXG4gIHN0cmVhbT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zIHtcbiAgZXhwb3J0IHR5cGUgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zTm9uU3RyZWFtaW5nID0gQVBJLkZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc05vblN0cmVhbWluZztcbiAgZXhwb3J0IHR5cGUgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zU3RyZWFtaW5nID0gQVBJLkZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc1N0cmVhbWluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNOb25TdHJlYW1pbmcgZXh0ZW5kcyBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNCYXNlIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc3RyZWFtIGV2ZW50cyBmb3IgdGhlIGZpbmUtdHVuZSBqb2IuIElmIHNldCB0byB0cnVlLCBldmVudHMgd2lsbCBiZVxuICAgKiBzZW50IGFzIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUuIFRoZSBzdHJlYW0gd2lsbCB0ZXJtaW5hdGUgd2l0aCBhIGBkYXRhOiBbRE9ORV1gXG4gICAqIG1lc3NhZ2Ugd2hlbiB0aGUgam9iIGlzIGZpbmlzaGVkIChzdWNjZWVkZWQsIGNhbmNlbGxlZCwgb3IgZmFpbGVkKS5cbiAgICpcbiAgICogSWYgc2V0IHRvIGZhbHNlLCBvbmx5IGV2ZW50cyBnZW5lcmF0ZWQgc28gZmFyIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAqL1xuICBzdHJlYW0/OiBmYWxzZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNTdHJlYW1pbmcgZXh0ZW5kcyBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNCYXNlIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc3RyZWFtIGV2ZW50cyBmb3IgdGhlIGZpbmUtdHVuZSBqb2IuIElmIHNldCB0byB0cnVlLCBldmVudHMgd2lsbCBiZVxuICAgKiBzZW50IGFzIGRhdGEtb25seVxuICAgKiBbc2VydmVyLXNlbnQgZXZlbnRzXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50cyNFdmVudF9zdHJlYW1fZm9ybWF0KVxuICAgKiBhcyB0aGV5IGJlY29tZSBhdmFpbGFibGUuIFRoZSBzdHJlYW0gd2lsbCB0ZXJtaW5hdGUgd2l0aCBhIGBkYXRhOiBbRE9ORV1gXG4gICAqIG1lc3NhZ2Ugd2hlbiB0aGUgam9iIGlzIGZpbmlzaGVkIChzdWNjZWVkZWQsIGNhbmNlbGxlZCwgb3IgZmFpbGVkKS5cbiAgICpcbiAgICogSWYgc2V0IHRvIGZhbHNlLCBvbmx5IGV2ZW50cyBnZW5lcmF0ZWQgc28gZmFyIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAqL1xuICBzdHJlYW06IHRydWU7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRmluZVR1bmVzIHtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZSA9IEFQSS5GaW5lVHVuZTtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZUV2ZW50ID0gQVBJLkZpbmVUdW5lRXZlbnQ7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmVFdmVudHNMaXN0UmVzcG9uc2UgPSBBUEkuRmluZVR1bmVFdmVudHNMaXN0UmVzcG9uc2U7XG4gIGV4cG9ydCB0eXBlIEZpbmVUdW5lc1BhZ2UgPSBfRmluZVR1bmVzUGFnZTtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZUNyZWF0ZVBhcmFtcyA9IEFQSS5GaW5lVHVuZUNyZWF0ZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXMgPSBBUEkuRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc05vblN0cmVhbWluZyA9IEFQSS5GaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNOb25TdHJlYW1pbmc7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zU3RyZWFtaW5nID0gQVBJLkZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc1N0cmVhbWluZztcbn1cbiIsICIvLyBGaWxlIGdlbmVyYXRlZCBmcm9tIG91ciBPcGVuQVBJIHNwZWMgYnkgU3RhaW5sZXNzLlxuXG5pbXBvcnQgKiBhcyBDb3JlIGZyb20gJy4uLy4uL2NvcmUuanMnO1xuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi8uLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgeyBpc1JlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi4vLi4vY29yZS5qcyc7XG5pbXBvcnQgKiBhcyBGaWxlcyBmcm9tICcuLi9maWxlcy5qcyc7XG5pbXBvcnQgKiBhcyBBUEkgZnJvbSAnLi9pbmRleC5qcyc7XG5pbXBvcnQgeyBDdXJzb3JQYWdlLCBDdXJzb3JQYWdlUGFyYW1zIH0gZnJvbSAnLi4vLi4vcGFnaW5hdGlvbi5qcyc7XG5cbmV4cG9ydCBjbGFzcyBKb2JzIGV4dGVuZHMgQVBJUmVzb3VyY2Uge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIGpvYiB0aGF0IGZpbmUtdHVuZXMgYSBzcGVjaWZpZWQgbW9kZWwgZnJvbSBhIGdpdmVuIGRhdGFzZXQuXG4gICAqXG4gICAqIFJlc3BvbnNlIGluY2x1ZGVzIGRldGFpbHMgb2YgdGhlIGVucXVldWVkIGpvYiBpbmNsdWRpbmcgam9iIHN0YXR1cyBhbmQgdGhlIG5hbWVcbiAgICogb2YgdGhlIGZpbmUtdHVuZWQgbW9kZWxzIG9uY2UgY29tcGxldGUuXG4gICAqXG4gICAqIFtMZWFybiBtb3JlIGFib3V0IGZpbmUtdHVuaW5nXSgvZG9jcy9ndWlkZXMvZmluZS10dW5pbmcpXG4gICAqL1xuICBjcmVhdGUoYm9keTogSm9iQ3JlYXRlUGFyYW1zLCBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyk6IENvcmUuQVBJUHJvbWlzZTxGaW5lVHVuaW5nSm9iPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdCgnL2ZpbmVfdHVuaW5nL2pvYnMnLCB7IGJvZHksIC4uLm9wdGlvbnMgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGluZm8gYWJvdXQgYSBmaW5lLXR1bmluZyBqb2IuXG4gICAqXG4gICAqIFtMZWFybiBtb3JlIGFib3V0IGZpbmUtdHVuaW5nXSgvZG9jcy9ndWlkZXMvZmluZS10dW5pbmcpXG4gICAqL1xuICByZXRyaWV2ZShmaW5lVHVuaW5nSm9iSWQ6IHN0cmluZywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkFQSVByb21pc2U8RmluZVR1bmluZ0pvYj4ge1xuICAgIHJldHVybiB0aGlzLmdldChgL2ZpbmVfdHVuaW5nL2pvYnMvJHtmaW5lVHVuaW5nSm9iSWR9YCwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogTGlzdCB5b3VyIG9yZ2FuaXphdGlvbidzIGZpbmUtdHVuaW5nIGpvYnNcbiAgICovXG4gIGxpc3QoXG4gICAgcXVlcnk/OiBKb2JMaXN0UGFyYW1zLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBDb3JlLlBhZ2VQcm9taXNlPEZpbmVUdW5pbmdKb2JzUGFnZSwgRmluZVR1bmluZ0pvYj47XG4gIGxpc3Qob3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLlBhZ2VQcm9taXNlPEZpbmVUdW5pbmdKb2JzUGFnZSwgRmluZVR1bmluZ0pvYj47XG4gIGxpc3QoXG4gICAgcXVlcnk6IEpvYkxpc3RQYXJhbXMgfCBDb3JlLlJlcXVlc3RPcHRpb25zID0ge30sXG4gICAgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMsXG4gICk6IENvcmUuUGFnZVByb21pc2U8RmluZVR1bmluZ0pvYnNQYWdlLCBGaW5lVHVuaW5nSm9iPiB7XG4gICAgaWYgKGlzUmVxdWVzdE9wdGlvbnMocXVlcnkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5saXN0KHt9LCBxdWVyeSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmdldEFQSUxpc3QoJy9maW5lX3R1bmluZy9qb2JzJywgRmluZVR1bmluZ0pvYnNQYWdlLCB7IHF1ZXJ5LCAuLi5vcHRpb25zIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEltbWVkaWF0ZWx5IGNhbmNlbCBhIGZpbmUtdHVuZSBqb2IuXG4gICAqL1xuICBjYW5jZWwoZmluZVR1bmluZ0pvYklkOiBzdHJpbmcsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPEZpbmVUdW5pbmdKb2I+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KGAvZmluZV90dW5pbmcvam9icy8ke2ZpbmVUdW5pbmdKb2JJZH0vY2FuY2VsYCwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHN0YXR1cyB1cGRhdGVzIGZvciBhIGZpbmUtdHVuaW5nIGpvYi5cbiAgICovXG4gIGxpc3RFdmVudHMoXG4gICAgZmluZVR1bmluZ0pvYklkOiBzdHJpbmcsXG4gICAgcXVlcnk/OiBKb2JMaXN0RXZlbnRzUGFyYW1zLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBDb3JlLlBhZ2VQcm9taXNlPEZpbmVUdW5pbmdKb2JFdmVudHNQYWdlLCBGaW5lVHVuaW5nSm9iRXZlbnQ+O1xuICBsaXN0RXZlbnRzKFxuICAgIGZpbmVUdW5pbmdKb2JJZDogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBDb3JlLlBhZ2VQcm9taXNlPEZpbmVUdW5pbmdKb2JFdmVudHNQYWdlLCBGaW5lVHVuaW5nSm9iRXZlbnQ+O1xuICBsaXN0RXZlbnRzKFxuICAgIGZpbmVUdW5pbmdKb2JJZDogc3RyaW5nLFxuICAgIHF1ZXJ5OiBKb2JMaXN0RXZlbnRzUGFyYW1zIHwgQ29yZS5SZXF1ZXN0T3B0aW9ucyA9IHt9LFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBDb3JlLlBhZ2VQcm9taXNlPEZpbmVUdW5pbmdKb2JFdmVudHNQYWdlLCBGaW5lVHVuaW5nSm9iRXZlbnQ+IHtcbiAgICBpZiAoaXNSZXF1ZXN0T3B0aW9ucyhxdWVyeSkpIHtcbiAgICAgIHJldHVybiB0aGlzLmxpc3RFdmVudHMoZmluZVR1bmluZ0pvYklkLCB7fSwgcXVlcnkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nZXRBUElMaXN0KGAvZmluZV90dW5pbmcvam9icy8ke2ZpbmVUdW5pbmdKb2JJZH0vZXZlbnRzYCwgRmluZVR1bmluZ0pvYkV2ZW50c1BhZ2UsIHtcbiAgICAgIHF1ZXJ5LFxuICAgICAgLi4ub3B0aW9ucyxcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRmluZVR1bmluZ0pvYnNQYWdlIGV4dGVuZHMgQ3Vyc29yUGFnZTxGaW5lVHVuaW5nSm9iPiB7fVxuLy8gYWxpYXMgc28gd2UgY2FuIGV4cG9ydCBpdCBpbiB0aGUgbmFtZXNwYWNlXG50eXBlIF9GaW5lVHVuaW5nSm9ic1BhZ2UgPSBGaW5lVHVuaW5nSm9ic1BhZ2U7XG5cbmV4cG9ydCBjbGFzcyBGaW5lVHVuaW5nSm9iRXZlbnRzUGFnZSBleHRlbmRzIEN1cnNvclBhZ2U8RmluZVR1bmluZ0pvYkV2ZW50PiB7fVxuLy8gYWxpYXMgc28gd2UgY2FuIGV4cG9ydCBpdCBpbiB0aGUgbmFtZXNwYWNlXG50eXBlIF9GaW5lVHVuaW5nSm9iRXZlbnRzUGFnZSA9IEZpbmVUdW5pbmdKb2JFdmVudHNQYWdlO1xuXG4vKipcbiAqIFRoZSBgZmluZV90dW5pbmcuam9iYCBvYmplY3QgcmVwcmVzZW50cyBhIGZpbmUtdHVuaW5nIGpvYiB0aGF0IGhhcyBiZWVuIGNyZWF0ZWRcbiAqIHRocm91Z2ggdGhlIEFQSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGaW5lVHVuaW5nSm9iIHtcbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgaWRlbnRpZmllciwgd2hpY2ggY2FuIGJlIHJlZmVyZW5jZWQgaW4gdGhlIEFQSSBlbmRwb2ludHMuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgVW5peCB0aW1lc3RhbXAgKGluIHNlY29uZHMpIGZvciB3aGVuIHRoZSBmaW5lLXR1bmluZyBqb2Igd2FzIGNyZWF0ZWQuXG4gICAqL1xuICBjcmVhdGVkX2F0OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBmaW5lLXR1bmVkIG1vZGVsIHRoYXQgaXMgYmVpbmcgY3JlYXRlZC5cbiAgICovXG4gIGZpbmVfdHVuZWRfbW9kZWw6IHN0cmluZyB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBoeXBlcnBhcmFtZXRlcnMgdXNlZCBmb3IgdGhlIGZpbmUtdHVuaW5nIGpvYi4gU2VlIHRoZVxuICAgKiBbZmluZS10dW5pbmcgZ3VpZGVdKC9kb2NzL2d1aWRlcy9maW5lLXR1bmluZykgZm9yIG1vcmUgZGV0YWlscy5cbiAgICovXG4gIGh5cGVycGFyYW1ldGVyczogRmluZVR1bmluZ0pvYi5IeXBlcnBhcmFtZXRlcnM7XG5cbiAgLyoqXG4gICAqIFRoZSBiYXNlIG1vZGVsIHRoYXQgaXMgYmVpbmcgZmluZS10dW5lZC5cbiAgICovXG4gIG1vZGVsOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvYmplY3QgdHlwZSwgd2hpY2ggaXMgYWx3YXlzIFwiZmluZV90dW5pbmcuam9iXCIuXG4gICAqL1xuICBvYmplY3Q6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9yZ2FuaXphdGlvbiB0aGF0IG93bnMgdGhlIGZpbmUtdHVuaW5nIGpvYi5cbiAgICovXG4gIG9yZ2FuaXphdGlvbl9pZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgY29tcGlsZWQgcmVzdWx0cyBmaWxlcyBmb3IgdGhlIGZpbmUtdHVuaW5nIGpvYi5cbiAgICovXG4gIHJlc3VsdF9maWxlczogQXJyYXk8RmlsZXMuRmlsZU9iamVjdD47XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IHN0YXR1cyBvZiB0aGUgZmluZS10dW5pbmcgam9iLCB3aGljaCBjYW4gYmUgZWl0aGVyIGBjcmVhdGVkYCxcbiAgICogYHBlbmRpbmdgLCBgcnVubmluZ2AsIGBzdWNjZWVkZWRgLCBgZmFpbGVkYCwgb3IgYGNhbmNlbGxlZGAuXG4gICAqL1xuICBzdGF0dXM6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHRvdGFsIG51bWJlciBvZiBiaWxsYWJsZSB0b2tlbnMgcHJvY2Vzc2VkIGJ5IHRoaXMgZmluZSB0dW5pbmcgam9iLlxuICAgKi9cbiAgdHJhaW5lZF90b2tlbnM6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGZpbGUgSUQgdXNlZCBmb3IgdHJhaW5pbmcuXG4gICAqL1xuICB0cmFpbmluZ19maWxlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBmaWxlIElEIHVzZWQgZm9yIHZhbGlkYXRpb24uXG4gICAqL1xuICB2YWxpZGF0aW9uX2ZpbGU6IHN0cmluZyB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBVbml4IHRpbWVzdGFtcCAoaW4gc2Vjb25kcykgZm9yIHdoZW4gdGhlIGZpbmUtdHVuaW5nIGpvYiB3YXMgZmluaXNoZWQuXG4gICAqL1xuICBmaW5pc2hlZF9hdD86IG51bWJlcjtcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBGaW5lVHVuaW5nSm9iIHtcbiAgLyoqXG4gICAqIFRoZSBoeXBlcnBhcmFtZXRlcnMgdXNlZCBmb3IgdGhlIGZpbmUtdHVuaW5nIGpvYi4gU2VlIHRoZVxuICAgKiBbZmluZS10dW5pbmcgZ3VpZGVdKC9kb2NzL2d1aWRlcy9maW5lLXR1bmluZykgZm9yIG1vcmUgZGV0YWlscy5cbiAgICovXG4gIGV4cG9ydCBpbnRlcmZhY2UgSHlwZXJwYXJhbWV0ZXJzIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIGVwb2NocyB0byB0cmFpbiB0aGUgbW9kZWwgZm9yLiBBbiBlcG9jaCByZWZlcnMgdG8gb25lIGZ1bGwgY3ljbGVcbiAgICAgKiB0aHJvdWdoIHRoZSB0cmFpbmluZyBkYXRhc2V0LiBcIkF1dG9cIiBkZWNpZGVzIHRoZSBvcHRpbWFsIG51bWJlciBvZiBlcG9jaHMgYmFzZWRcbiAgICAgKiBvbiB0aGUgc2l6ZSBvZiB0aGUgZGF0YXNldC4gSWYgc2V0dGluZyB0aGUgbnVtYmVyIG1hbnVhbGx5LCB3ZSBzdXBwb3J0IGFueVxuICAgICAqIG51bWJlciBiZXR3ZWVuIDEgYW5kIDUwIGVwb2Nocy5cbiAgICAgKi9cbiAgICBuX2Vwb2Nocz86ICdhdXRvJyB8IG51bWJlcjtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpbmVUdW5pbmdKb2JFdmVudCB7XG4gIGlkOiBzdHJpbmc7XG5cbiAgY3JlYXRlZF9hdDogbnVtYmVyO1xuXG4gIGxldmVsOiAnaW5mbycgfCAnd2FybicgfCAnZXJyb3InO1xuXG4gIG1lc3NhZ2U6IHN0cmluZztcblxuICBvYmplY3Q6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKb2JDcmVhdGVQYXJhbXMge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIG1vZGVsIHRvIGZpbmUtdHVuZS4gWW91IGNhbiBzZWxlY3Qgb25lIG9mIHRoZVxuICAgKiBbc3VwcG9ydGVkIG1vZGVsc10oL2RvY3MvZ3VpZGVzL2ZpbmUtdHVuaW5nL3doYXQtbW9kZWxzLWNhbi1iZS1maW5lLXR1bmVkKS5cbiAgICovXG4gIG1vZGVsOiAoc3RyaW5nICYge30pIHwgJ2JhYmJhZ2UtMDAyJyB8ICdkYXZpbmNpLTAwMicgfCAnZ3B0LTMuNS10dXJibyc7XG5cbiAgLyoqXG4gICAqIFRoZSBJRCBvZiBhbiB1cGxvYWRlZCBmaWxlIHRoYXQgY29udGFpbnMgdHJhaW5pbmcgZGF0YS5cbiAgICpcbiAgICogU2VlIFt1cGxvYWQgZmlsZV0oL2RvY3MvYXBpLXJlZmVyZW5jZS9maWxlcy91cGxvYWQpIGZvciBob3cgdG8gdXBsb2FkIGEgZmlsZS5cbiAgICpcbiAgICogWW91ciBkYXRhc2V0IG11c3QgYmUgZm9ybWF0dGVkIGFzIGEgSlNPTkwgZmlsZS4gQWRkaXRpb25hbGx5LCB5b3UgbXVzdCB1cGxvYWRcbiAgICogeW91ciBmaWxlIHdpdGggdGhlIHB1cnBvc2UgYGZpbmUtdHVuZWAuXG4gICAqXG4gICAqIFNlZSB0aGUgW2ZpbmUtdHVuaW5nIGd1aWRlXSgvZG9jcy9ndWlkZXMvZmluZS10dW5pbmcpIGZvciBtb3JlIGRldGFpbHMuXG4gICAqL1xuICB0cmFpbmluZ19maWxlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBoeXBlcnBhcmFtZXRlcnMgdXNlZCBmb3IgdGhlIGZpbmUtdHVuaW5nIGpvYi5cbiAgICovXG4gIGh5cGVycGFyYW1ldGVycz86IEpvYkNyZWF0ZVBhcmFtcy5IeXBlcnBhcmFtZXRlcnM7XG5cbiAgLyoqXG4gICAqIEEgc3RyaW5nIG9mIHVwIHRvIDQwIGNoYXJhY3RlcnMgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHlvdXIgZmluZS10dW5lZCBtb2RlbFxuICAgKiBuYW1lLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgYSBgc3VmZml4YCBvZiBcImN1c3RvbS1tb2RlbC1uYW1lXCIgd291bGQgcHJvZHVjZSBhIG1vZGVsIG5hbWUgbGlrZVxuICAgKiBgZnQ6Z3B0LTMuNS10dXJibzpvcGVuYWk6Y3VzdG9tLW1vZGVsLW5hbWU6N3A0bFVSZWxgLlxuICAgKi9cbiAgc3VmZml4Pzogc3RyaW5nIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIElEIG9mIGFuIHVwbG9hZGVkIGZpbGUgdGhhdCBjb250YWlucyB2YWxpZGF0aW9uIGRhdGEuXG4gICAqXG4gICAqIElmIHlvdSBwcm92aWRlIHRoaXMgZmlsZSwgdGhlIGRhdGEgaXMgdXNlZCB0byBnZW5lcmF0ZSB2YWxpZGF0aW9uIG1ldHJpY3NcbiAgICogcGVyaW9kaWNhbGx5IGR1cmluZyBmaW5lLXR1bmluZy4gVGhlc2UgbWV0cmljcyBjYW4gYmUgdmlld2VkIGluIHRoZSBmaW5lLXR1bmluZ1xuICAgKiByZXN1bHRzIGZpbGUuIFRoZSBzYW1lIGRhdGEgc2hvdWxkIG5vdCBiZSBwcmVzZW50IGluIGJvdGggdHJhaW4gYW5kIHZhbGlkYXRpb25cbiAgICogZmlsZXMuXG4gICAqXG4gICAqIFlvdXIgZGF0YXNldCBtdXN0IGJlIGZvcm1hdHRlZCBhcyBhIEpTT05MIGZpbGUuIFlvdSBtdXN0IHVwbG9hZCB5b3VyIGZpbGUgd2l0aFxuICAgKiB0aGUgcHVycG9zZSBgZmluZS10dW5lYC5cbiAgICpcbiAgICogU2VlIHRoZSBbZmluZS10dW5pbmcgZ3VpZGVdKC9kb2NzL2d1aWRlcy9maW5lLXR1bmluZykgZm9yIG1vcmUgZGV0YWlscy5cbiAgICovXG4gIHZhbGlkYXRpb25fZmlsZT86IHN0cmluZyB8IG51bGw7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgSm9iQ3JlYXRlUGFyYW1zIHtcbiAgLyoqXG4gICAqIFRoZSBoeXBlcnBhcmFtZXRlcnMgdXNlZCBmb3IgdGhlIGZpbmUtdHVuaW5nIGpvYi5cbiAgICovXG4gIGV4cG9ydCBpbnRlcmZhY2UgSHlwZXJwYXJhbWV0ZXJzIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIGVwb2NocyB0byB0cmFpbiB0aGUgbW9kZWwgZm9yLiBBbiBlcG9jaCByZWZlcnMgdG8gb25lIGZ1bGwgY3ljbGVcbiAgICAgKiB0aHJvdWdoIHRoZSB0cmFpbmluZyBkYXRhc2V0LlxuICAgICAqL1xuICAgIG5fZXBvY2hzPzogJ2F1dG8nIHwgbnVtYmVyO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSm9iTGlzdFBhcmFtcyBleHRlbmRzIEN1cnNvclBhZ2VQYXJhbXMge31cblxuZXhwb3J0IGludGVyZmFjZSBKb2JMaXN0RXZlbnRzUGFyYW1zIGV4dGVuZHMgQ3Vyc29yUGFnZVBhcmFtcyB7fVxuXG5leHBvcnQgbmFtZXNwYWNlIEpvYnMge1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5pbmdKb2IgPSBBUEkuRmluZVR1bmluZ0pvYjtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuaW5nSm9iRXZlbnQgPSBBUEkuRmluZVR1bmluZ0pvYkV2ZW50O1xuICBleHBvcnQgdHlwZSBGaW5lVHVuaW5nSm9ic1BhZ2UgPSBfRmluZVR1bmluZ0pvYnNQYWdlO1xuICBleHBvcnQgdHlwZSBGaW5lVHVuaW5nSm9iRXZlbnRzUGFnZSA9IF9GaW5lVHVuaW5nSm9iRXZlbnRzUGFnZTtcbiAgZXhwb3J0IGltcG9ydCBKb2JDcmVhdGVQYXJhbXMgPSBBUEkuSm9iQ3JlYXRlUGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IEpvYkxpc3RQYXJhbXMgPSBBUEkuSm9iTGlzdFBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBKb2JMaXN0RXZlbnRzUGFyYW1zID0gQVBJLkpvYkxpc3RFdmVudHNQYXJhbXM7XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi8uLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgeyBKb2JzIH0gZnJvbSAnLi9qb2JzLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcblxuZXhwb3J0IGNsYXNzIEZpbmVUdW5pbmcgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIGpvYnM6IEpvYnMgPSBuZXcgSm9icyh0aGlzLmNsaWVudCk7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRmluZVR1bmluZyB7XG4gIGV4cG9ydCBpbXBvcnQgSm9icyA9IEFQSS5Kb2JzO1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5pbmdKb2IgPSBBUEkuRmluZVR1bmluZ0pvYjtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuaW5nSm9iRXZlbnQgPSBBUEkuRmluZVR1bmluZ0pvYkV2ZW50O1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5pbmdKb2JzUGFnZSA9IEFQSS5GaW5lVHVuaW5nSm9ic1BhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmluZ0pvYkV2ZW50c1BhZ2UgPSBBUEkuRmluZVR1bmluZ0pvYkV2ZW50c1BhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgSm9iQ3JlYXRlUGFyYW1zID0gQVBJLkpvYkNyZWF0ZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBKb2JMaXN0UGFyYW1zID0gQVBJLkpvYkxpc3RQYXJhbXM7XG4gIGV4cG9ydCBpbXBvcnQgSm9iTGlzdEV2ZW50c1BhcmFtcyA9IEFQSS5Kb2JMaXN0RXZlbnRzUGFyYW1zO1xufVxuIiwgIi8vIEZpbGUgZ2VuZXJhdGVkIGZyb20gb3VyIE9wZW5BUEkgc3BlYyBieSBTdGFpbmxlc3MuXG5cbmltcG9ydCAqIGFzIENvcmUgZnJvbSAnLi4vY29yZS5qcyc7XG5pbXBvcnQgeyBBUElSZXNvdXJjZSB9IGZyb20gJy4uL3Jlc291cmNlLmpzJztcbmltcG9ydCAqIGFzIEFQSSBmcm9tICcuL2luZGV4LmpzJztcbmltcG9ydCB7IHR5cGUgVXBsb2FkYWJsZSwgbXVsdGlwYXJ0Rm9ybVJlcXVlc3RPcHRpb25zIH0gZnJvbSAnLi4vY29yZS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZXMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgdmFyaWF0aW9uIG9mIGEgZ2l2ZW4gaW1hZ2UuXG4gICAqL1xuICBjcmVhdGVWYXJpYXRpb24oXG4gICAgYm9keTogSW1hZ2VDcmVhdGVWYXJpYXRpb25QYXJhbXMsXG4gICAgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMsXG4gICk6IENvcmUuQVBJUHJvbWlzZTxJbWFnZXNSZXNwb25zZT4ge1xuICAgIHJldHVybiB0aGlzLnBvc3QoJy9pbWFnZXMvdmFyaWF0aW9ucycsIG11bHRpcGFydEZvcm1SZXF1ZXN0T3B0aW9ucyh7IGJvZHksIC4uLm9wdGlvbnMgfSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZWRpdGVkIG9yIGV4dGVuZGVkIGltYWdlIGdpdmVuIGFuIG9yaWdpbmFsIGltYWdlIGFuZCBhIHByb21wdC5cbiAgICovXG4gIGVkaXQoYm9keTogSW1hZ2VFZGl0UGFyYW1zLCBvcHRpb25zPzogQ29yZS5SZXF1ZXN0T3B0aW9ucyk6IENvcmUuQVBJUHJvbWlzZTxJbWFnZXNSZXNwb25zZT4ge1xuICAgIHJldHVybiB0aGlzLnBvc3QoJy9pbWFnZXMvZWRpdHMnLCBtdWx0aXBhcnRGb3JtUmVxdWVzdE9wdGlvbnMoeyBib2R5LCAuLi5vcHRpb25zIH0pKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGltYWdlIGdpdmVuIGEgcHJvbXB0LlxuICAgKi9cbiAgZ2VuZXJhdGUoYm9keTogSW1hZ2VHZW5lcmF0ZVBhcmFtcywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkFQSVByb21pc2U8SW1hZ2VzUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5wb3N0KCcvaW1hZ2VzL2dlbmVyYXRpb25zJywgeyBib2R5LCAuLi5vcHRpb25zIH0pO1xuICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgdXJsIG9yIHRoZSBjb250ZW50IG9mIGFuIGltYWdlIGdlbmVyYXRlZCBieSB0aGUgT3BlbkFJIEFQSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJbWFnZSB7XG4gIC8qKlxuICAgKiBUaGUgYmFzZTY0LWVuY29kZWQgSlNPTiBvZiB0aGUgZ2VuZXJhdGVkIGltYWdlLCBpZiBgcmVzcG9uc2VfZm9ybWF0YCBpc1xuICAgKiBgYjY0X2pzb25gLlxuICAgKi9cbiAgYjY0X2pzb24/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBVUkwgb2YgdGhlIGdlbmVyYXRlZCBpbWFnZSwgaWYgYHJlc3BvbnNlX2Zvcm1hdGAgaXMgYHVybGAgKGRlZmF1bHQpLlxuICAgKi9cbiAgdXJsPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEltYWdlc1Jlc3BvbnNlIHtcbiAgY3JlYXRlZDogbnVtYmVyO1xuXG4gIGRhdGE6IEFycmF5PEltYWdlPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbWFnZUNyZWF0ZVZhcmlhdGlvblBhcmFtcyB7XG4gIC8qKlxuICAgKiBUaGUgaW1hZ2UgdG8gdXNlIGFzIHRoZSBiYXNpcyBmb3IgdGhlIHZhcmlhdGlvbihzKS4gTXVzdCBiZSBhIHZhbGlkIFBORyBmaWxlLFxuICAgKiBsZXNzIHRoYW4gNE1CLCBhbmQgc3F1YXJlLlxuICAgKi9cbiAgaW1hZ2U6IFVwbG9hZGFibGU7XG5cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgaW1hZ2VzIHRvIGdlbmVyYXRlLiBNdXN0IGJlIGJldHdlZW4gMSBhbmQgMTAuXG4gICAqL1xuICBuPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIGZvcm1hdCBpbiB3aGljaCB0aGUgZ2VuZXJhdGVkIGltYWdlcyBhcmUgcmV0dXJuZWQuIE11c3QgYmUgb25lIG9mIGB1cmxgIG9yXG4gICAqIGBiNjRfanNvbmAuXG4gICAqL1xuICByZXNwb25zZV9mb3JtYXQ/OiAndXJsJyB8ICdiNjRfanNvbicgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgc2l6ZSBvZiB0aGUgZ2VuZXJhdGVkIGltYWdlcy4gTXVzdCBiZSBvbmUgb2YgYDI1NngyNTZgLCBgNTEyeDUxMmAsIG9yXG4gICAqIGAxMDI0eDEwMjRgLlxuICAgKi9cbiAgc2l6ZT86ICcyNTZ4MjU2JyB8ICc1MTJ4NTEyJyB8ICcxMDI0eDEwMjQnIHwgbnVsbDtcblxuICAvKipcbiAgICogQSB1bmlxdWUgaWRlbnRpZmllciByZXByZXNlbnRpbmcgeW91ciBlbmQtdXNlciwgd2hpY2ggY2FuIGhlbHAgT3BlbkFJIHRvIG1vbml0b3JcbiAgICogYW5kIGRldGVjdCBhYnVzZS4gW0xlYXJuIG1vcmVdKC9kb2NzL2d1aWRlcy9zYWZldHktYmVzdC1wcmFjdGljZXMvZW5kLXVzZXItaWRzKS5cbiAgICovXG4gIHVzZXI/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2VFZGl0UGFyYW1zIHtcbiAgLyoqXG4gICAqIFRoZSBpbWFnZSB0byBlZGl0LiBNdXN0IGJlIGEgdmFsaWQgUE5HIGZpbGUsIGxlc3MgdGhhbiA0TUIsIGFuZCBzcXVhcmUuIElmIG1hc2tcbiAgICogaXMgbm90IHByb3ZpZGVkLCBpbWFnZSBtdXN0IGhhdmUgdHJhbnNwYXJlbmN5LCB3aGljaCB3aWxsIGJlIHVzZWQgYXMgdGhlIG1hc2suXG4gICAqL1xuICBpbWFnZTogVXBsb2FkYWJsZTtcblxuICAvKipcbiAgICogQSB0ZXh0IGRlc2NyaXB0aW9uIG9mIHRoZSBkZXNpcmVkIGltYWdlKHMpLiBUaGUgbWF4aW11bSBsZW5ndGggaXMgMTAwMFxuICAgKiBjaGFyYWN0ZXJzLlxuICAgKi9cbiAgcHJvbXB0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEFuIGFkZGl0aW9uYWwgaW1hZ2Ugd2hvc2UgZnVsbHkgdHJhbnNwYXJlbnQgYXJlYXMgKGUuZy4gd2hlcmUgYWxwaGEgaXMgemVybylcbiAgICogaW5kaWNhdGUgd2hlcmUgYGltYWdlYCBzaG91bGQgYmUgZWRpdGVkLiBNdXN0IGJlIGEgdmFsaWQgUE5HIGZpbGUsIGxlc3MgdGhhblxuICAgKiA0TUIsIGFuZCBoYXZlIHRoZSBzYW1lIGRpbWVuc2lvbnMgYXMgYGltYWdlYC5cbiAgICovXG4gIG1hc2s/OiBVcGxvYWRhYmxlO1xuXG4gIC8qKlxuICAgKiBUaGUgbnVtYmVyIG9mIGltYWdlcyB0byBnZW5lcmF0ZS4gTXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEwLlxuICAgKi9cbiAgbj86IG51bWJlciB8IG51bGw7XG5cbiAgLyoqXG4gICAqIFRoZSBmb3JtYXQgaW4gd2hpY2ggdGhlIGdlbmVyYXRlZCBpbWFnZXMgYXJlIHJldHVybmVkLiBNdXN0IGJlIG9uZSBvZiBgdXJsYCBvclxuICAgKiBgYjY0X2pzb25gLlxuICAgKi9cbiAgcmVzcG9uc2VfZm9ybWF0PzogJ3VybCcgfCAnYjY0X2pzb24nIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIHNpemUgb2YgdGhlIGdlbmVyYXRlZCBpbWFnZXMuIE11c3QgYmUgb25lIG9mIGAyNTZ4MjU2YCwgYDUxMng1MTJgLCBvclxuICAgKiBgMTAyNHgxMDI0YC5cbiAgICovXG4gIHNpemU/OiAnMjU2eDI1NicgfCAnNTEyeDUxMicgfCAnMTAyNHgxMDI0JyB8IG51bGw7XG5cbiAgLyoqXG4gICAqIEEgdW5pcXVlIGlkZW50aWZpZXIgcmVwcmVzZW50aW5nIHlvdXIgZW5kLXVzZXIsIHdoaWNoIGNhbiBoZWxwIE9wZW5BSSB0byBtb25pdG9yXG4gICAqIGFuZCBkZXRlY3QgYWJ1c2UuIFtMZWFybiBtb3JlXSgvZG9jcy9ndWlkZXMvc2FmZXR5LWJlc3QtcHJhY3RpY2VzL2VuZC11c2VyLWlkcykuXG4gICAqL1xuICB1c2VyPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEltYWdlR2VuZXJhdGVQYXJhbXMge1xuICAvKipcbiAgICogQSB0ZXh0IGRlc2NyaXB0aW9uIG9mIHRoZSBkZXNpcmVkIGltYWdlKHMpLiBUaGUgbWF4aW11bSBsZW5ndGggaXMgMTAwMFxuICAgKiBjaGFyYWN0ZXJzLlxuICAgKi9cbiAgcHJvbXB0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgaW1hZ2VzIHRvIGdlbmVyYXRlLiBNdXN0IGJlIGJldHdlZW4gMSBhbmQgMTAuXG4gICAqL1xuICBuPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogVGhlIGZvcm1hdCBpbiB3aGljaCB0aGUgZ2VuZXJhdGVkIGltYWdlcyBhcmUgcmV0dXJuZWQuIE11c3QgYmUgb25lIG9mIGB1cmxgIG9yXG4gICAqIGBiNjRfanNvbmAuXG4gICAqL1xuICByZXNwb25zZV9mb3JtYXQ/OiAndXJsJyB8ICdiNjRfanNvbicgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgc2l6ZSBvZiB0aGUgZ2VuZXJhdGVkIGltYWdlcy4gTXVzdCBiZSBvbmUgb2YgYDI1NngyNTZgLCBgNTEyeDUxMmAsIG9yXG4gICAqIGAxMDI0eDEwMjRgLlxuICAgKi9cbiAgc2l6ZT86ICcyNTZ4MjU2JyB8ICc1MTJ4NTEyJyB8ICcxMDI0eDEwMjQnIHwgbnVsbDtcblxuICAvKipcbiAgICogQSB1bmlxdWUgaWRlbnRpZmllciByZXByZXNlbnRpbmcgeW91ciBlbmQtdXNlciwgd2hpY2ggY2FuIGhlbHAgT3BlbkFJIHRvIG1vbml0b3JcbiAgICogYW5kIGRldGVjdCBhYnVzZS4gW0xlYXJuIG1vcmVdKC9kb2NzL2d1aWRlcy9zYWZldHktYmVzdC1wcmFjdGljZXMvZW5kLXVzZXItaWRzKS5cbiAgICovXG4gIHVzZXI/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgSW1hZ2VzIHtcbiAgZXhwb3J0IGltcG9ydCBJbWFnZSA9IEFQSS5JbWFnZTtcbiAgZXhwb3J0IGltcG9ydCBJbWFnZXNSZXNwb25zZSA9IEFQSS5JbWFnZXNSZXNwb25zZTtcbiAgZXhwb3J0IGltcG9ydCBJbWFnZUNyZWF0ZVZhcmlhdGlvblBhcmFtcyA9IEFQSS5JbWFnZUNyZWF0ZVZhcmlhdGlvblBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBJbWFnZUVkaXRQYXJhbXMgPSBBUEkuSW1hZ2VFZGl0UGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IEltYWdlR2VuZXJhdGVQYXJhbXMgPSBBUEkuSW1hZ2VHZW5lcmF0ZVBhcmFtcztcbn1cbiIsICIvLyBGaWxlIGdlbmVyYXRlZCBmcm9tIG91ciBPcGVuQVBJIHNwZWMgYnkgU3RhaW5sZXNzLlxuXG5pbXBvcnQgKiBhcyBDb3JlIGZyb20gJy4uL2NvcmUuanMnO1xuaW1wb3J0IHsgQVBJUmVzb3VyY2UgfSBmcm9tICcuLi9yZXNvdXJjZS5qcyc7XG5pbXBvcnQgKiBhcyBBUEkgZnJvbSAnLi9pbmRleC5qcyc7XG5pbXBvcnQgeyBQYWdlIH0gZnJvbSAnLi4vcGFnaW5hdGlvbi5qcyc7XG5cbmV4cG9ydCBjbGFzcyBNb2RlbHMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgYSBtb2RlbCBpbnN0YW5jZSwgcHJvdmlkaW5nIGJhc2ljIGluZm9ybWF0aW9uIGFib3V0IHRoZSBtb2RlbCBzdWNoIGFzXG4gICAqIHRoZSBvd25lciBhbmQgcGVybWlzc2lvbmluZy5cbiAgICovXG4gIHJldHJpZXZlKG1vZGVsOiBzdHJpbmcsIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zKTogQ29yZS5BUElQcm9taXNlPE1vZGVsPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGAvbW9kZWxzLyR7bW9kZWx9YCwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogTGlzdHMgdGhlIGN1cnJlbnRseSBhdmFpbGFibGUgbW9kZWxzLCBhbmQgcHJvdmlkZXMgYmFzaWMgaW5mb3JtYXRpb24gYWJvdXQgZWFjaFxuICAgKiBvbmUgc3VjaCBhcyB0aGUgb3duZXIgYW5kIGF2YWlsYWJpbGl0eS5cbiAgICovXG4gIGxpc3Qob3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLlBhZ2VQcm9taXNlPE1vZGVsc1BhZ2UsIE1vZGVsPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QVBJTGlzdCgnL21vZGVscycsIE1vZGVsc1BhZ2UsIG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGV0ZSBhIGZpbmUtdHVuZWQgbW9kZWwuIFlvdSBtdXN0IGhhdmUgdGhlIE93bmVyIHJvbGUgaW4geW91ciBvcmdhbml6YXRpb24gdG9cbiAgICogZGVsZXRlIGEgbW9kZWwuXG4gICAqL1xuICBkZWwobW9kZWw6IHN0cmluZywgb3B0aW9ucz86IENvcmUuUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkFQSVByb21pc2U8TW9kZWxEZWxldGVkPiB7XG4gICAgcmV0dXJuIHRoaXMuZGVsZXRlKGAvbW9kZWxzLyR7bW9kZWx9YCwgb3B0aW9ucyk7XG4gIH1cbn1cblxuLyoqXG4gKiBOb3RlOiBubyBwYWdpbmF0aW9uIGFjdHVhbGx5IG9jY3VycyB5ZXQsIHRoaXMgaXMgZm9yIGZvcndhcmRzLWNvbXBhdGliaWxpdHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBNb2RlbHNQYWdlIGV4dGVuZHMgUGFnZTxNb2RlbD4ge31cbi8vIGFsaWFzIHNvIHdlIGNhbiBleHBvcnQgaXQgaW4gdGhlIG5hbWVzcGFjZVxudHlwZSBfTW9kZWxzUGFnZSA9IE1vZGVsc1BhZ2U7XG5cbi8qKlxuICogRGVzY3JpYmVzIGFuIE9wZW5BSSBtb2RlbCBvZmZlcmluZyB0aGF0IGNhbiBiZSB1c2VkIHdpdGggdGhlIEFQSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBNb2RlbCB7XG4gIC8qKlxuICAgKiBUaGUgbW9kZWwgaWRlbnRpZmllciwgd2hpY2ggY2FuIGJlIHJlZmVyZW5jZWQgaW4gdGhlIEFQSSBlbmRwb2ludHMuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgVW5peCB0aW1lc3RhbXAgKGluIHNlY29uZHMpIHdoZW4gdGhlIG1vZGVsIHdhcyBjcmVhdGVkLlxuICAgKi9cbiAgY3JlYXRlZDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgb2JqZWN0IHR5cGUsIHdoaWNoIGlzIGFsd2F5cyBcIm1vZGVsXCIuXG4gICAqL1xuICBvYmplY3Q6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9yZ2FuaXphdGlvbiB0aGF0IG93bnMgdGhlIG1vZGVsLlxuICAgKi9cbiAgb3duZWRfYnk6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb2RlbERlbGV0ZWQge1xuICBpZDogc3RyaW5nO1xuXG4gIGRlbGV0ZWQ6IGJvb2xlYW47XG5cbiAgb2JqZWN0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgTW9kZWxzIHtcbiAgZXhwb3J0IGltcG9ydCBNb2RlbCA9IEFQSS5Nb2RlbDtcbiAgZXhwb3J0IGltcG9ydCBNb2RlbERlbGV0ZWQgPSBBUEkuTW9kZWxEZWxldGVkO1xuICBleHBvcnQgdHlwZSBNb2RlbHNQYWdlID0gX01vZGVsc1BhZ2U7XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0ICogYXMgQ29yZSBmcm9tICcuLi9jb3JlLmpzJztcbmltcG9ydCB7IEFQSVJlc291cmNlIH0gZnJvbSAnLi4vcmVzb3VyY2UuanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vaW5kZXguanMnO1xuXG5leHBvcnQgY2xhc3MgTW9kZXJhdGlvbnMgZXh0ZW5kcyBBUElSZXNvdXJjZSB7XG4gIC8qKlxuICAgKiBDbGFzc2lmaWVzIGlmIHRleHQgdmlvbGF0ZXMgT3BlbkFJJ3MgQ29udGVudCBQb2xpY3lcbiAgICovXG4gIGNyZWF0ZShcbiAgICBib2R5OiBNb2RlcmF0aW9uQ3JlYXRlUGFyYW1zLFxuICAgIG9wdGlvbnM/OiBDb3JlLlJlcXVlc3RPcHRpb25zLFxuICApOiBDb3JlLkFQSVByb21pc2U8TW9kZXJhdGlvbkNyZWF0ZVJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdCgnL21vZGVyYXRpb25zJywgeyBib2R5LCAuLi5vcHRpb25zIH0pO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZXJhdGlvbiB7XG4gIC8qKlxuICAgKiBBIGxpc3Qgb2YgdGhlIGNhdGVnb3JpZXMsIGFuZCB3aGV0aGVyIHRoZXkgYXJlIGZsYWdnZWQgb3Igbm90LlxuICAgKi9cbiAgY2F0ZWdvcmllczogTW9kZXJhdGlvbi5DYXRlZ29yaWVzO1xuXG4gIC8qKlxuICAgKiBBIGxpc3Qgb2YgdGhlIGNhdGVnb3JpZXMgYWxvbmcgd2l0aCB0aGVpciBzY29yZXMgYXMgcHJlZGljdGVkIGJ5IG1vZGVsLlxuICAgKi9cbiAgY2F0ZWdvcnlfc2NvcmVzOiBNb2RlcmF0aW9uLkNhdGVnb3J5U2NvcmVzO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBjb250ZW50IHZpb2xhdGVzXG4gICAqIFtPcGVuQUkncyB1c2FnZSBwb2xpY2llc10oL3BvbGljaWVzL3VzYWdlLXBvbGljaWVzKS5cbiAgICovXG4gIGZsYWdnZWQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgTW9kZXJhdGlvbiB7XG4gIC8qKlxuICAgKiBBIGxpc3Qgb2YgdGhlIGNhdGVnb3JpZXMsIGFuZCB3aGV0aGVyIHRoZXkgYXJlIGZsYWdnZWQgb3Igbm90LlxuICAgKi9cbiAgZXhwb3J0IGludGVyZmFjZSBDYXRlZ29yaWVzIHtcbiAgICAvKipcbiAgICAgKiBDb250ZW50IHRoYXQgZXhwcmVzc2VzLCBpbmNpdGVzLCBvciBwcm9tb3RlcyBoYXJhc3NpbmcgbGFuZ3VhZ2UgdG93YXJkcyBhbnlcbiAgICAgKiB0YXJnZXQuXG4gICAgICovXG4gICAgaGFyYXNzbWVudDogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEhhcmFzc21lbnQgY29udGVudCB0aGF0IGFsc28gaW5jbHVkZXMgdmlvbGVuY2Ugb3Igc2VyaW91cyBoYXJtIHRvd2FyZHMgYW55XG4gICAgICogdGFyZ2V0LlxuICAgICAqL1xuICAgICdoYXJhc3NtZW50L3RocmVhdGVuaW5nJzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIENvbnRlbnQgdGhhdCBleHByZXNzZXMsIGluY2l0ZXMsIG9yIHByb21vdGVzIGhhdGUgYmFzZWQgb24gcmFjZSwgZ2VuZGVyLFxuICAgICAqIGV0aG5pY2l0eSwgcmVsaWdpb24sIG5hdGlvbmFsaXR5LCBzZXh1YWwgb3JpZW50YXRpb24sIGRpc2FiaWxpdHkgc3RhdHVzLCBvclxuICAgICAqIGNhc3RlLiBIYXRlZnVsIGNvbnRlbnQgYWltZWQgYXQgbm9uLXByb3RlY3RlZCBncm91cHMgKGUuZy4sIGNoZXNzIHBsYXllcnMpIGlzXG4gICAgICogaGFycmFzc21lbnQuXG4gICAgICovXG4gICAgaGF0ZTogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEhhdGVmdWwgY29udGVudCB0aGF0IGFsc28gaW5jbHVkZXMgdmlvbGVuY2Ugb3Igc2VyaW91cyBoYXJtIHRvd2FyZHMgdGhlIHRhcmdldGVkXG4gICAgICogZ3JvdXAgYmFzZWQgb24gcmFjZSwgZ2VuZGVyLCBldGhuaWNpdHksIHJlbGlnaW9uLCBuYXRpb25hbGl0eSwgc2V4dWFsXG4gICAgICogb3JpZW50YXRpb24sIGRpc2FiaWxpdHkgc3RhdHVzLCBvciBjYXN0ZS5cbiAgICAgKi9cbiAgICAnaGF0ZS90aHJlYXRlbmluZyc6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBDb250ZW50IHRoYXQgcHJvbW90ZXMsIGVuY291cmFnZXMsIG9yIGRlcGljdHMgYWN0cyBvZiBzZWxmLWhhcm0sIHN1Y2ggYXNcbiAgICAgKiBzdWljaWRlLCBjdXR0aW5nLCBhbmQgZWF0aW5nIGRpc29yZGVycy5cbiAgICAgKi9cbiAgICAnc2VsZi1oYXJtJzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIENvbnRlbnQgdGhhdCBlbmNvdXJhZ2VzIHBlcmZvcm1pbmcgYWN0cyBvZiBzZWxmLWhhcm0sIHN1Y2ggYXMgc3VpY2lkZSwgY3V0dGluZyxcbiAgICAgKiBhbmQgZWF0aW5nIGRpc29yZGVycywgb3IgdGhhdCBnaXZlcyBpbnN0cnVjdGlvbnMgb3IgYWR2aWNlIG9uIGhvdyB0byBjb21taXQgc3VjaFxuICAgICAqIGFjdHMuXG4gICAgICovXG4gICAgJ3NlbGYtaGFybS9pbnN0cnVjdGlvbnMnOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQ29udGVudCB3aGVyZSB0aGUgc3BlYWtlciBleHByZXNzZXMgdGhhdCB0aGV5IGFyZSBlbmdhZ2luZyBvciBpbnRlbmQgdG8gZW5nYWdlXG4gICAgICogaW4gYWN0cyBvZiBzZWxmLWhhcm0sIHN1Y2ggYXMgc3VpY2lkZSwgY3V0dGluZywgYW5kIGVhdGluZyBkaXNvcmRlcnMuXG4gICAgICovXG4gICAgJ3NlbGYtaGFybS9pbnRlbnQnOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQ29udGVudCBtZWFudCB0byBhcm91c2Ugc2V4dWFsIGV4Y2l0ZW1lbnQsIHN1Y2ggYXMgdGhlIGRlc2NyaXB0aW9uIG9mIHNleHVhbFxuICAgICAqIGFjdGl2aXR5LCBvciB0aGF0IHByb21vdGVzIHNleHVhbCBzZXJ2aWNlcyAoZXhjbHVkaW5nIHNleCBlZHVjYXRpb24gYW5kXG4gICAgICogd2VsbG5lc3MpLlxuICAgICAqL1xuICAgIHNleHVhbDogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIFNleHVhbCBjb250ZW50IHRoYXQgaW5jbHVkZXMgYW4gaW5kaXZpZHVhbCB3aG8gaXMgdW5kZXIgMTggeWVhcnMgb2xkLlxuICAgICAqL1xuICAgICdzZXh1YWwvbWlub3JzJzogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIENvbnRlbnQgdGhhdCBkZXBpY3RzIGRlYXRoLCB2aW9sZW5jZSwgb3IgcGh5c2ljYWwgaW5qdXJ5LlxuICAgICAqL1xuICAgIHZpb2xlbmNlOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQ29udGVudCB0aGF0IGRlcGljdHMgZGVhdGgsIHZpb2xlbmNlLCBvciBwaHlzaWNhbCBpbmp1cnkgaW4gZ3JhcGhpYyBkZXRhaWwuXG4gICAgICovXG4gICAgJ3Zpb2xlbmNlL2dyYXBoaWMnOiBib29sZWFuO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgbGlzdCBvZiB0aGUgY2F0ZWdvcmllcyBhbG9uZyB3aXRoIHRoZWlyIHNjb3JlcyBhcyBwcmVkaWN0ZWQgYnkgbW9kZWwuXG4gICAqL1xuICBleHBvcnQgaW50ZXJmYWNlIENhdGVnb3J5U2NvcmVzIHtcbiAgICAvKipcbiAgICAgKiBUaGUgc2NvcmUgZm9yIHRoZSBjYXRlZ29yeSAnaGFyYXNzbWVudCcuXG4gICAgICovXG4gICAgaGFyYXNzbWVudDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHNjb3JlIGZvciB0aGUgY2F0ZWdvcnkgJ2hhcmFzc21lbnQvdGhyZWF0ZW5pbmcnLlxuICAgICAqL1xuICAgICdoYXJhc3NtZW50L3RocmVhdGVuaW5nJzogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHNjb3JlIGZvciB0aGUgY2F0ZWdvcnkgJ2hhdGUnLlxuICAgICAqL1xuICAgIGhhdGU6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBmb3IgdGhlIGNhdGVnb3J5ICdoYXRlL3RocmVhdGVuaW5nJy5cbiAgICAgKi9cbiAgICAnaGF0ZS90aHJlYXRlbmluZyc6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBmb3IgdGhlIGNhdGVnb3J5ICdzZWxmLWhhcm0nLlxuICAgICAqL1xuICAgICdzZWxmLWhhcm0nOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2NvcmUgZm9yIHRoZSBjYXRlZ29yeSAnc2VsZi1oYXJtL2luc3RydWN0aW9ucycuXG4gICAgICovXG4gICAgJ3NlbGYtaGFybS9pbnN0cnVjdGlvbnMnOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2NvcmUgZm9yIHRoZSBjYXRlZ29yeSAnc2VsZi1oYXJtL2ludGVudCcuXG4gICAgICovXG4gICAgJ3NlbGYtaGFybS9pbnRlbnQnOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2NvcmUgZm9yIHRoZSBjYXRlZ29yeSAnc2V4dWFsJy5cbiAgICAgKi9cbiAgICBzZXh1YWw6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBmb3IgdGhlIGNhdGVnb3J5ICdzZXh1YWwvbWlub3JzJy5cbiAgICAgKi9cbiAgICAnc2V4dWFsL21pbm9ycyc6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBmb3IgdGhlIGNhdGVnb3J5ICd2aW9sZW5jZScuXG4gICAgICovXG4gICAgdmlvbGVuY2U6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBmb3IgdGhlIGNhdGVnb3J5ICd2aW9sZW5jZS9ncmFwaGljJy5cbiAgICAgKi9cbiAgICAndmlvbGVuY2UvZ3JhcGhpYyc6IG51bWJlcjtcbiAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgcG9saWN5IGNvbXBsaWFuY2UgcmVwb3J0IGJ5IE9wZW5BSSdzIGNvbnRlbnQgbW9kZXJhdGlvbiBtb2RlbCBhZ2FpbnN0XG4gKiBhIGdpdmVuIGlucHV0LlxuICovXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVyYXRpb25DcmVhdGVSZXNwb25zZSB7XG4gIC8qKlxuICAgKiBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBtb2RlcmF0aW9uIHJlcXVlc3QuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgbW9kZWwgdXNlZCB0byBnZW5lcmF0ZSB0aGUgbW9kZXJhdGlvbiByZXN1bHRzLlxuICAgKi9cbiAgbW9kZWw6IHN0cmluZztcblxuICAvKipcbiAgICogQSBsaXN0IG9mIG1vZGVyYXRpb24gb2JqZWN0cy5cbiAgICovXG4gIHJlc3VsdHM6IEFycmF5PE1vZGVyYXRpb24+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVyYXRpb25DcmVhdGVQYXJhbXMge1xuICAvKipcbiAgICogVGhlIGlucHV0IHRleHQgdG8gY2xhc3NpZnlcbiAgICovXG4gIGlucHV0OiBzdHJpbmcgfCBBcnJheTxzdHJpbmc+O1xuXG4gIC8qKlxuICAgKiBUd28gY29udGVudCBtb2RlcmF0aW9ucyBtb2RlbHMgYXJlIGF2YWlsYWJsZTogYHRleHQtbW9kZXJhdGlvbi1zdGFibGVgIGFuZFxuICAgKiBgdGV4dC1tb2RlcmF0aW9uLWxhdGVzdGAuXG4gICAqXG4gICAqIFRoZSBkZWZhdWx0IGlzIGB0ZXh0LW1vZGVyYXRpb24tbGF0ZXN0YCB3aGljaCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgdXBncmFkZWRcbiAgICogb3ZlciB0aW1lLiBUaGlzIGVuc3VyZXMgeW91IGFyZSBhbHdheXMgdXNpbmcgb3VyIG1vc3QgYWNjdXJhdGUgbW9kZWwuIElmIHlvdSB1c2VcbiAgICogYHRleHQtbW9kZXJhdGlvbi1zdGFibGVgLCB3ZSB3aWxsIHByb3ZpZGUgYWR2YW5jZWQgbm90aWNlIGJlZm9yZSB1cGRhdGluZyB0aGVcbiAgICogbW9kZWwuIEFjY3VyYWN5IG9mIGB0ZXh0LW1vZGVyYXRpb24tc3RhYmxlYCBtYXkgYmUgc2xpZ2h0bHkgbG93ZXIgdGhhbiBmb3JcbiAgICogYHRleHQtbW9kZXJhdGlvbi1sYXRlc3RgLlxuICAgKi9cbiAgbW9kZWw/OiAoc3RyaW5nICYge30pIHwgJ3RleHQtbW9kZXJhdGlvbi1sYXRlc3QnIHwgJ3RleHQtbW9kZXJhdGlvbi1zdGFibGUnO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIE1vZGVyYXRpb25zIHtcbiAgZXhwb3J0IGltcG9ydCBNb2RlcmF0aW9uID0gQVBJLk1vZGVyYXRpb247XG4gIGV4cG9ydCBpbXBvcnQgTW9kZXJhdGlvbkNyZWF0ZVJlc3BvbnNlID0gQVBJLk1vZGVyYXRpb25DcmVhdGVSZXNwb25zZTtcbiAgZXhwb3J0IGltcG9ydCBNb2RlcmF0aW9uQ3JlYXRlUGFyYW1zID0gQVBJLk1vZGVyYXRpb25DcmVhdGVQYXJhbXM7XG59XG4iLCAiLy8gRmlsZSBnZW5lcmF0ZWQgZnJvbSBvdXIgT3BlbkFQSSBzcGVjIGJ5IFN0YWlubGVzcy5cblxuaW1wb3J0ICogYXMgQ29yZSBmcm9tICcuL2NvcmUuanMnO1xuaW1wb3J0ICogYXMgUGFnaW5hdGlvbiBmcm9tICcuL3BhZ2luYXRpb24uanMnO1xuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vcmVzb3VyY2VzL2luZGV4LmpzJztcbmltcG9ydCAqIGFzIEVycm9ycyBmcm9tICcuL2Vycm9yLmpzJztcbmltcG9ydCB0eXBlIHsgQWdlbnQgfSBmcm9tICcuL19zaGltcy9hZ2VudC5qcyc7XG5pbXBvcnQgKiBhcyBVcGxvYWRzIGZyb20gJy4vdXBsb2Fkcy5qcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xpZW50T3B0aW9ucyB7XG4gIC8qKlxuICAgKiBEZWZhdWx0cyB0byBwcm9jZXNzLmVudltcIk9QRU5BSV9BUElfS0VZXCJdLlxuICAgKi9cbiAgYXBpS2V5Pzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB0aGUgZGVmYXVsdCBiYXNlIFVSTCBmb3IgdGhlIEFQSSwgZS5nLiwgXCJodHRwczovL2FwaS5leGFtcGxlLmNvbS92Mi9cIlxuICAgKi9cbiAgYmFzZVVSTD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG1heGltdW0gYW1vdW50IG9mIHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdGhhdCB0aGUgY2xpZW50IHNob3VsZCB3YWl0IGZvciBhIHJlc3BvbnNlXG4gICAqIGZyb20gdGhlIHNlcnZlciBiZWZvcmUgdGltaW5nIG91dCBhIHNpbmdsZSByZXF1ZXN0LlxuICAgKlxuICAgKiBOb3RlIHRoYXQgcmVxdWVzdCB0aW1lb3V0cyBhcmUgcmV0cmllZCBieSBkZWZhdWx0LCBzbyBpbiBhIHdvcnN0LWNhc2Ugc2NlbmFyaW8geW91IG1heSB3YWl0XG4gICAqIG11Y2ggbG9uZ2VyIHRoYW4gdGhpcyB0aW1lb3V0IGJlZm9yZSB0aGUgcHJvbWlzZSBzdWNjZWVkcyBvciBmYWlscy5cbiAgICovXG4gIHRpbWVvdXQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEFuIEhUVFAgYWdlbnQgdXNlZCB0byBtYW5hZ2UgSFRUUChTKSBjb25uZWN0aW9ucy5cbiAgICpcbiAgICogSWYgbm90IHByb3ZpZGVkLCBhbiBhZ2VudCB3aWxsIGJlIGNvbnN0cnVjdGVkIGJ5IGRlZmF1bHQgaW4gdGhlIE5vZGUuanMgZW52aXJvbm1lbnQsXG4gICAqIG90aGVyd2lzZSBubyBhZ2VudCBpcyB1c2VkLlxuICAgKi9cbiAgaHR0cEFnZW50PzogQWdlbnQ7XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgYSBjdXN0b20gYGZldGNoYCBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICpcbiAgICogSWYgbm90IHByb3ZpZGVkLCB3ZSB1c2UgYG5vZGUtZmV0Y2hgIG9uIE5vZGUuanMgYW5kIG90aGVyd2lzZSBleHBlY3QgdGhhdCBgZmV0Y2hgIGlzXG4gICAqIGRlZmluZWQgZ2xvYmFsbHkuXG4gICAqL1xuICBmZXRjaD86IENvcmUuRmV0Y2ggfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiB0aW1lcyB0aGF0IHRoZSBjbGllbnQgd2lsbCByZXRyeSBhIHJlcXVlc3QgaW4gY2FzZSBvZiBhXG4gICAqIHRlbXBvcmFyeSBmYWlsdXJlLCBsaWtlIGEgbmV0d29yayBlcnJvciBvciBhIDVYWCBlcnJvciBmcm9tIHRoZSBzZXJ2ZXIuXG4gICAqXG4gICAqIEBkZWZhdWx0IDJcbiAgICovXG4gIG1heFJldHJpZXM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgaGVhZGVycyB0byBpbmNsdWRlIHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJLlxuICAgKlxuICAgKiBUaGVzZSBjYW4gYmUgcmVtb3ZlZCBpbiBpbmRpdmlkdWFsIHJlcXVlc3RzIGJ5IGV4cGxpY2l0bHkgc2V0dGluZyB0aGVcbiAgICogaGVhZGVyIHRvIGB1bmRlZmluZWRgIG9yIGBudWxsYCBpbiByZXF1ZXN0IG9wdGlvbnMuXG4gICAqL1xuICBkZWZhdWx0SGVhZGVycz86IENvcmUuSGVhZGVycztcblxuICAvKipcbiAgICogRGVmYXVsdCBxdWVyeSBwYXJhbWV0ZXJzIHRvIGluY2x1ZGUgd2l0aCBldmVyeSByZXF1ZXN0IHRvIHRoZSBBUEkuXG4gICAqXG4gICAqIFRoZXNlIGNhbiBiZSByZW1vdmVkIGluIGluZGl2aWR1YWwgcmVxdWVzdHMgYnkgZXhwbGljaXRseSBzZXR0aW5nIHRoZVxuICAgKiBwYXJhbSB0byBgdW5kZWZpbmVkYCBpbiByZXF1ZXN0IG9wdGlvbnMuXG4gICAqL1xuICBkZWZhdWx0UXVlcnk/OiBDb3JlLkRlZmF1bHRRdWVyeTtcblxuICAvKipcbiAgICogQnkgZGVmYXVsdCwgY2xpZW50LXNpZGUgdXNlIG9mIHRoaXMgbGlicmFyeSBpcyBub3QgYWxsb3dlZCwgYXMgaXQgcmlza3MgZXhwb3NpbmcgeW91ciBzZWNyZXQgQVBJIGNyZWRlbnRpYWxzIHRvIGF0dGFja2Vycy5cbiAgICogT25seSBzZXQgdGhpcyBvcHRpb24gdG8gYHRydWVgIGlmIHlvdSB1bmRlcnN0YW5kIHRoZSByaXNrcyBhbmQgaGF2ZSBhcHByb3ByaWF0ZSBtaXRpZ2F0aW9ucyBpbiBwbGFjZS5cbiAgICovXG4gIGRhbmdlcm91c2x5QWxsb3dCcm93c2VyPzogYm9vbGVhbjtcblxuICBvcmdhbml6YXRpb24/OiBzdHJpbmcgfCBudWxsO1xufVxuXG4vKiogQVBJIENsaWVudCBmb3IgaW50ZXJmYWNpbmcgd2l0aCB0aGUgT3BlbkFJIEFQSS4gKi9cbmV4cG9ydCBjbGFzcyBPcGVuQUkgZXh0ZW5kcyBDb3JlLkFQSUNsaWVudCB7XG4gIGFwaUtleTogc3RyaW5nO1xuICBvcmdhbml6YXRpb24/OiBzdHJpbmcgfCBudWxsO1xuXG4gIHByaXZhdGUgX29wdGlvbnM6IENsaWVudE9wdGlvbnM7XG5cbiAgLyoqXG4gICAqIEFQSSBDbGllbnQgZm9yIGludGVyZmFjaW5nIHdpdGggdGhlIE9wZW5BSSBBUEkuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0cy5hcGlLZXk9cHJvY2Vzcy5lbnZbJ09QRU5BSV9BUElfS0VZJ11dIC0gVGhlIEFQSSBLZXkgdG8gc2VuZCB0byB0aGUgQVBJLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdHMuYmFzZVVSTF0gLSBPdmVycmlkZSB0aGUgZGVmYXVsdCBiYXNlIFVSTCBmb3IgdGhlIEFQSS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRzLnRpbWVvdXQ9MTAgbWludXRlc10gLSBUaGUgbWF4aW11bSBhbW91bnQgb2YgdGltZSAoaW4gbWlsbGlzZWNvbmRzKSB0aGUgY2xpZW50IHdpbGwgd2FpdCBmb3IgYSByZXNwb25zZSBiZWZvcmUgdGltaW5nIG91dC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRzLmh0dHBBZ2VudF0gLSBBbiBIVFRQIGFnZW50IHVzZWQgdG8gbWFuYWdlIEhUVFAocykgY29ubmVjdGlvbnMuXG4gICAqIEBwYXJhbSB7Q29yZS5GZXRjaH0gW29wdHMuZmV0Y2hdIC0gU3BlY2lmeSBhIGN1c3RvbSBgZmV0Y2hgIGZ1bmN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW29wdHMubWF4UmV0cmllcz0yXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiB0aW1lcyB0aGUgY2xpZW50IHdpbGwgcmV0cnkgYSByZXF1ZXN0LlxuICAgKiBAcGFyYW0ge0NvcmUuSGVhZGVyc30gb3B0cy5kZWZhdWx0SGVhZGVycyAtIERlZmF1bHQgaGVhZGVycyB0byBpbmNsdWRlIHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJLlxuICAgKiBAcGFyYW0ge0NvcmUuRGVmYXVsdFF1ZXJ5fSBvcHRzLmRlZmF1bHRRdWVyeSAtIERlZmF1bHQgcXVlcnkgcGFyYW1ldGVycyB0byBpbmNsdWRlIHdpdGggZXZlcnkgcmVxdWVzdCB0byB0aGUgQVBJLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRzLmRhbmdlcm91c2x5QWxsb3dCcm93c2VyPWZhbHNlXSAtIEJ5IGRlZmF1bHQsIGNsaWVudC1zaWRlIHVzZSBvZiB0aGlzIGxpYnJhcnkgaXMgbm90IGFsbG93ZWQsIGFzIGl0IHJpc2tzIGV4cG9zaW5nIHlvdXIgc2VjcmV0IEFQSSBjcmVkZW50aWFscyB0byBhdHRhY2tlcnMuXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVsbH0gW29wdHMub3JnYW5pemF0aW9uXVxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIGFwaUtleSA9IENvcmUucmVhZEVudignT1BFTkFJX0FQSV9LRVknKSxcbiAgICBvcmdhbml6YXRpb24gPSBDb3JlLnJlYWRFbnYoJ09QRU5BSV9PUkdfSUQnKSA/PyBudWxsLFxuICAgIC4uLm9wdHNcbiAgfTogQ2xpZW50T3B0aW9ucyA9IHt9KSB7XG4gICAgaWYgKGFwaUtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiVGhlIE9QRU5BSV9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG1pc3Npbmcgb3IgZW1wdHk7IGVpdGhlciBwcm92aWRlIGl0LCBvciBpbnN0YW50aWF0ZSB0aGUgT3BlbkFJIGNsaWVudCB3aXRoIGFuIGFwaUtleSBvcHRpb24sIGxpa2UgbmV3IE9wZW5BSSh7IGFwaUtleTogJ215IGFwaUtleScgfSkuXCIsXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IG9wdGlvbnM6IENsaWVudE9wdGlvbnMgPSB7XG4gICAgICBhcGlLZXksXG4gICAgICBvcmdhbml6YXRpb24sXG4gICAgICAuLi5vcHRzLFxuICAgICAgYmFzZVVSTDogb3B0cy5iYXNlVVJMID8/IGBodHRwczovL2FwaS5vcGVuYWkuY29tL3YxYCxcbiAgICB9O1xuXG4gICAgaWYgKCFvcHRpb25zLmRhbmdlcm91c2x5QWxsb3dCcm93c2VyICYmIENvcmUuaXNSdW5uaW5nSW5Ccm93c2VyKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJJdCBsb29rcyBsaWtlIHlvdSdyZSBydW5uaW5nIGluIGEgYnJvd3Nlci1saWtlIGVudmlyb25tZW50LlxcblxcblRoaXMgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdCwgYXMgaXQgcmlza3MgZXhwb3NpbmcgeW91ciBzZWNyZXQgQVBJIGNyZWRlbnRpYWxzIHRvIGF0dGFja2Vycy5cXG5JZiB5b3UgdW5kZXJzdGFuZCB0aGUgcmlza3MgYW5kIGhhdmUgYXBwcm9wcmlhdGUgbWl0aWdhdGlvbnMgaW4gcGxhY2UsXFxueW91IGNhbiBzZXQgdGhlIGBkYW5nZXJvdXNseUFsbG93QnJvd3NlcmAgb3B0aW9uIHRvIGB0cnVlYCwgZS5nLixcXG5cXG5uZXcgT3BlbkFJKHsgYXBpS2V5LCBkYW5nZXJvdXNseUFsbG93QnJvd3NlcjogdHJ1ZSB9KTtcXG5cXG5odHRwczovL2hlbHAub3BlbmFpLmNvbS9lbi9hcnRpY2xlcy81MTEyNTk1LWJlc3QtcHJhY3RpY2VzLWZvci1hcGkta2V5LXNhZmV0eVxcblwiLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBzdXBlcih7XG4gICAgICBiYXNlVVJMOiBvcHRpb25zLmJhc2VVUkwhLFxuICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0ID8/IDYwMDAwMCAvKiAxMCBtaW51dGVzICovLFxuICAgICAgaHR0cEFnZW50OiBvcHRpb25zLmh0dHBBZ2VudCxcbiAgICAgIG1heFJldHJpZXM6IG9wdGlvbnMubWF4UmV0cmllcyxcbiAgICAgIGZldGNoOiBvcHRpb25zLmZldGNoLFxuICAgIH0pO1xuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuXG4gICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG4gICAgdGhpcy5vcmdhbml6YXRpb24gPSBvcmdhbml6YXRpb247XG4gIH1cblxuICBjb21wbGV0aW9uczogQVBJLkNvbXBsZXRpb25zID0gbmV3IEFQSS5Db21wbGV0aW9ucyh0aGlzKTtcbiAgY2hhdDogQVBJLkNoYXQgPSBuZXcgQVBJLkNoYXQodGhpcyk7XG4gIGVkaXRzOiBBUEkuRWRpdHMgPSBuZXcgQVBJLkVkaXRzKHRoaXMpO1xuICBlbWJlZGRpbmdzOiBBUEkuRW1iZWRkaW5ncyA9IG5ldyBBUEkuRW1iZWRkaW5ncyh0aGlzKTtcbiAgZmlsZXM6IEFQSS5GaWxlcyA9IG5ldyBBUEkuRmlsZXModGhpcyk7XG4gIGltYWdlczogQVBJLkltYWdlcyA9IG5ldyBBUEkuSW1hZ2VzKHRoaXMpO1xuICBhdWRpbzogQVBJLkF1ZGlvID0gbmV3IEFQSS5BdWRpbyh0aGlzKTtcbiAgbW9kZXJhdGlvbnM6IEFQSS5Nb2RlcmF0aW9ucyA9IG5ldyBBUEkuTW9kZXJhdGlvbnModGhpcyk7XG4gIG1vZGVsczogQVBJLk1vZGVscyA9IG5ldyBBUEkuTW9kZWxzKHRoaXMpO1xuICBmaW5lVHVuaW5nOiBBUEkuRmluZVR1bmluZyA9IG5ldyBBUEkuRmluZVR1bmluZyh0aGlzKTtcbiAgZmluZVR1bmVzOiBBUEkuRmluZVR1bmVzID0gbmV3IEFQSS5GaW5lVHVuZXModGhpcyk7XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIGRlZmF1bHRRdWVyeSgpOiBDb3JlLkRlZmF1bHRRdWVyeSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX29wdGlvbnMuZGVmYXVsdFF1ZXJ5O1xuICB9XG5cbiAgcHJvdGVjdGVkIG92ZXJyaWRlIGRlZmF1bHRIZWFkZXJzKG9wdHM6IENvcmUuRmluYWxSZXF1ZXN0T3B0aW9ucyk6IENvcmUuSGVhZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnN1cGVyLmRlZmF1bHRIZWFkZXJzKG9wdHMpLFxuICAgICAgJ09wZW5BSS1Pcmdhbml6YXRpb24nOiB0aGlzLm9yZ2FuaXphdGlvbixcbiAgICAgIC4uLnRoaXMuX29wdGlvbnMuZGVmYXVsdEhlYWRlcnMsXG4gICAgfTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvdmVycmlkZSBhdXRoSGVhZGVycyhvcHRzOiBDb3JlLkZpbmFsUmVxdWVzdE9wdGlvbnMpOiBDb3JlLkhlYWRlcnMge1xuICAgIHJldHVybiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gIH07XG4gIH1cblxuICBzdGF0aWMgT3BlbkFJID0gdGhpcztcblxuICBzdGF0aWMgQVBJRXJyb3IgPSBFcnJvcnMuQVBJRXJyb3I7XG4gIHN0YXRpYyBBUElDb25uZWN0aW9uRXJyb3IgPSBFcnJvcnMuQVBJQ29ubmVjdGlvbkVycm9yO1xuICBzdGF0aWMgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvciA9IEVycm9ycy5BUElDb25uZWN0aW9uVGltZW91dEVycm9yO1xuICBzdGF0aWMgQVBJVXNlckFib3J0RXJyb3IgPSBFcnJvcnMuQVBJVXNlckFib3J0RXJyb3I7XG4gIHN0YXRpYyBOb3RGb3VuZEVycm9yID0gRXJyb3JzLk5vdEZvdW5kRXJyb3I7XG4gIHN0YXRpYyBDb25mbGljdEVycm9yID0gRXJyb3JzLkNvbmZsaWN0RXJyb3I7XG4gIHN0YXRpYyBSYXRlTGltaXRFcnJvciA9IEVycm9ycy5SYXRlTGltaXRFcnJvcjtcbiAgc3RhdGljIEJhZFJlcXVlc3RFcnJvciA9IEVycm9ycy5CYWRSZXF1ZXN0RXJyb3I7XG4gIHN0YXRpYyBBdXRoZW50aWNhdGlvbkVycm9yID0gRXJyb3JzLkF1dGhlbnRpY2F0aW9uRXJyb3I7XG4gIHN0YXRpYyBJbnRlcm5hbFNlcnZlckVycm9yID0gRXJyb3JzLkludGVybmFsU2VydmVyRXJyb3I7XG4gIHN0YXRpYyBQZXJtaXNzaW9uRGVuaWVkRXJyb3IgPSBFcnJvcnMuUGVybWlzc2lvbkRlbmllZEVycm9yO1xuICBzdGF0aWMgVW5wcm9jZXNzYWJsZUVudGl0eUVycm9yID0gRXJyb3JzLlVucHJvY2Vzc2FibGVFbnRpdHlFcnJvcjtcbn1cblxuZXhwb3J0IGNvbnN0IHtcbiAgQVBJRXJyb3IsXG4gIEFQSUNvbm5lY3Rpb25FcnJvcixcbiAgQVBJQ29ubmVjdGlvblRpbWVvdXRFcnJvcixcbiAgQVBJVXNlckFib3J0RXJyb3IsXG4gIE5vdEZvdW5kRXJyb3IsXG4gIENvbmZsaWN0RXJyb3IsXG4gIFJhdGVMaW1pdEVycm9yLFxuICBCYWRSZXF1ZXN0RXJyb3IsXG4gIEF1dGhlbnRpY2F0aW9uRXJyb3IsXG4gIEludGVybmFsU2VydmVyRXJyb3IsXG4gIFBlcm1pc3Npb25EZW5pZWRFcnJvcixcbiAgVW5wcm9jZXNzYWJsZUVudGl0eUVycm9yLFxufSA9IEVycm9ycztcblxuZXhwb3J0IGltcG9ydCB0b0ZpbGUgPSBVcGxvYWRzLnRvRmlsZTtcbmV4cG9ydCBpbXBvcnQgZmlsZUZyb21QYXRoID0gVXBsb2Fkcy5maWxlRnJvbVBhdGg7XG5cbmV4cG9ydCBuYW1lc3BhY2UgT3BlbkFJIHtcbiAgLy8gSGVscGVyIGZ1bmN0aW9uc1xuICBleHBvcnQgaW1wb3J0IHRvRmlsZSA9IFVwbG9hZHMudG9GaWxlO1xuICBleHBvcnQgaW1wb3J0IGZpbGVGcm9tUGF0aCA9IFVwbG9hZHMuZmlsZUZyb21QYXRoO1xuXG4gIGV4cG9ydCBpbXBvcnQgUmVxdWVzdE9wdGlvbnMgPSBDb3JlLlJlcXVlc3RPcHRpb25zO1xuXG4gIGV4cG9ydCBpbXBvcnQgUGFnZSA9IFBhZ2luYXRpb24uUGFnZTtcbiAgZXhwb3J0IGltcG9ydCBQYWdlUmVzcG9uc2UgPSBQYWdpbmF0aW9uLlBhZ2VSZXNwb25zZTtcblxuICBleHBvcnQgaW1wb3J0IEN1cnNvclBhZ2UgPSBQYWdpbmF0aW9uLkN1cnNvclBhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgQ3Vyc29yUGFnZVBhcmFtcyA9IFBhZ2luYXRpb24uQ3Vyc29yUGFnZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBDdXJzb3JQYWdlUmVzcG9uc2UgPSBQYWdpbmF0aW9uLkN1cnNvclBhZ2VSZXNwb25zZTtcblxuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25zID0gQVBJLkNvbXBsZXRpb25zO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb24gPSBBUEkuQ29tcGxldGlvbjtcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uQ2hvaWNlID0gQVBJLkNvbXBsZXRpb25DaG9pY2U7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvblVzYWdlID0gQVBJLkNvbXBsZXRpb25Vc2FnZTtcbiAgZXhwb3J0IGltcG9ydCBDb21wbGV0aW9uQ3JlYXRlUGFyYW1zID0gQVBJLkNvbXBsZXRpb25DcmVhdGVQYXJhbXM7XG4gIGV4cG9ydCBpbXBvcnQgQ29tcGxldGlvbkNyZWF0ZVBhcmFtc05vblN0cmVhbWluZyA9IEFQSS5Db21wbGV0aW9uQ3JlYXRlUGFyYW1zTm9uU3RyZWFtaW5nO1xuICBleHBvcnQgaW1wb3J0IENvbXBsZXRpb25DcmVhdGVQYXJhbXNTdHJlYW1pbmcgPSBBUEkuQ29tcGxldGlvbkNyZWF0ZVBhcmFtc1N0cmVhbWluZztcblxuICBleHBvcnQgaW1wb3J0IENoYXQgPSBBUEkuQ2hhdDtcblxuICBleHBvcnQgaW1wb3J0IEVkaXRzID0gQVBJLkVkaXRzO1xuICBleHBvcnQgaW1wb3J0IEVkaXQgPSBBUEkuRWRpdDtcbiAgZXhwb3J0IGltcG9ydCBFZGl0Q3JlYXRlUGFyYW1zID0gQVBJLkVkaXRDcmVhdGVQYXJhbXM7XG5cbiAgZXhwb3J0IGltcG9ydCBFbWJlZGRpbmdzID0gQVBJLkVtYmVkZGluZ3M7XG4gIGV4cG9ydCBpbXBvcnQgQ3JlYXRlRW1iZWRkaW5nUmVzcG9uc2UgPSBBUEkuQ3JlYXRlRW1iZWRkaW5nUmVzcG9uc2U7XG4gIGV4cG9ydCBpbXBvcnQgRW1iZWRkaW5nID0gQVBJLkVtYmVkZGluZztcbiAgZXhwb3J0IGltcG9ydCBFbWJlZGRpbmdDcmVhdGVQYXJhbXMgPSBBUEkuRW1iZWRkaW5nQ3JlYXRlUGFyYW1zO1xuXG4gIGV4cG9ydCBpbXBvcnQgRmlsZXMgPSBBUEkuRmlsZXM7XG4gIGV4cG9ydCBpbXBvcnQgRmlsZUNvbnRlbnQgPSBBUEkuRmlsZUNvbnRlbnQ7XG4gIGV4cG9ydCBpbXBvcnQgRmlsZURlbGV0ZWQgPSBBUEkuRmlsZURlbGV0ZWQ7XG4gIGV4cG9ydCBpbXBvcnQgRmlsZU9iamVjdCA9IEFQSS5GaWxlT2JqZWN0O1xuICBleHBvcnQgaW1wb3J0IEZpbGVPYmplY3RzUGFnZSA9IEFQSS5GaWxlT2JqZWN0c1BhZ2U7XG4gIGV4cG9ydCBpbXBvcnQgRmlsZUNyZWF0ZVBhcmFtcyA9IEFQSS5GaWxlQ3JlYXRlUGFyYW1zO1xuXG4gIGV4cG9ydCBpbXBvcnQgSW1hZ2VzID0gQVBJLkltYWdlcztcbiAgZXhwb3J0IGltcG9ydCBJbWFnZSA9IEFQSS5JbWFnZTtcbiAgZXhwb3J0IGltcG9ydCBJbWFnZXNSZXNwb25zZSA9IEFQSS5JbWFnZXNSZXNwb25zZTtcbiAgZXhwb3J0IGltcG9ydCBJbWFnZUNyZWF0ZVZhcmlhdGlvblBhcmFtcyA9IEFQSS5JbWFnZUNyZWF0ZVZhcmlhdGlvblBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBJbWFnZUVkaXRQYXJhbXMgPSBBUEkuSW1hZ2VFZGl0UGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IEltYWdlR2VuZXJhdGVQYXJhbXMgPSBBUEkuSW1hZ2VHZW5lcmF0ZVBhcmFtcztcblxuICBleHBvcnQgaW1wb3J0IEF1ZGlvID0gQVBJLkF1ZGlvO1xuXG4gIGV4cG9ydCBpbXBvcnQgTW9kZXJhdGlvbnMgPSBBUEkuTW9kZXJhdGlvbnM7XG4gIGV4cG9ydCBpbXBvcnQgTW9kZXJhdGlvbiA9IEFQSS5Nb2RlcmF0aW9uO1xuICBleHBvcnQgaW1wb3J0IE1vZGVyYXRpb25DcmVhdGVSZXNwb25zZSA9IEFQSS5Nb2RlcmF0aW9uQ3JlYXRlUmVzcG9uc2U7XG4gIGV4cG9ydCBpbXBvcnQgTW9kZXJhdGlvbkNyZWF0ZVBhcmFtcyA9IEFQSS5Nb2RlcmF0aW9uQ3JlYXRlUGFyYW1zO1xuXG4gIGV4cG9ydCBpbXBvcnQgTW9kZWxzID0gQVBJLk1vZGVscztcbiAgZXhwb3J0IGltcG9ydCBNb2RlbCA9IEFQSS5Nb2RlbDtcbiAgZXhwb3J0IGltcG9ydCBNb2RlbERlbGV0ZWQgPSBBUEkuTW9kZWxEZWxldGVkO1xuICBleHBvcnQgaW1wb3J0IE1vZGVsc1BhZ2UgPSBBUEkuTW9kZWxzUGFnZTtcblxuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5pbmcgPSBBUEkuRmluZVR1bmluZztcblxuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5lcyA9IEFQSS5GaW5lVHVuZXM7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmUgPSBBUEkuRmluZVR1bmU7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmVFdmVudCA9IEFQSS5GaW5lVHVuZUV2ZW50O1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5lRXZlbnRzTGlzdFJlc3BvbnNlID0gQVBJLkZpbmVUdW5lRXZlbnRzTGlzdFJlc3BvbnNlO1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5lc1BhZ2UgPSBBUEkuRmluZVR1bmVzUGFnZTtcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZUNyZWF0ZVBhcmFtcyA9IEFQSS5GaW5lVHVuZUNyZWF0ZVBhcmFtcztcbiAgZXhwb3J0IGltcG9ydCBGaW5lVHVuZUxpc3RFdmVudHNQYXJhbXMgPSBBUEkuRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zO1xuICBleHBvcnQgaW1wb3J0IEZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc05vblN0cmVhbWluZyA9IEFQSS5GaW5lVHVuZUxpc3RFdmVudHNQYXJhbXNOb25TdHJlYW1pbmc7XG4gIGV4cG9ydCBpbXBvcnQgRmluZVR1bmVMaXN0RXZlbnRzUGFyYW1zU3RyZWFtaW5nID0gQVBJLkZpbmVUdW5lTGlzdEV2ZW50c1BhcmFtc1N0cmVhbWluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgT3BlbkFJO1xuIiwgImltcG9ydCBCTU9HUFQsIHsgQk1PU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICdzcmMvbWFpbic7XG5pbXBvcnQgeyBjb2xvclRvSGV4IH0gZnJvbSAnc3JjL3V0aWxzL0NvbG9yQ29udmVydGVyJztcbmltcG9ydCB7IGRpc3BsYXlVc2VyRWRpdEJ1dHRvbiwgZGlzcGxheVRyYXNoQnV0dG9uLCBkaXNwbGF5VXNlckNvcHlCdXR0b24sIHJlZ2VuZXJhdGVVc2VyQnV0dG9uIH0gZnJvbSAnLi9CdXR0b25zJztcblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BsYXlVc2VyTWVzc2FnZShwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzLCBtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBsZXQgdHJpbW1lZE1lc3NhZ2UgPSBtZXNzYWdlLnRyaW0oKTtcblxuICAgIGNvbnN0IHVzZXJNZXNzYWdlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdXNlck1lc3NhZ2VEaXYuY2xhc3NOYW1lID0gJ3VzZXJNZXNzYWdlJztcbiAgICB1c2VyTWVzc2FnZURpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclRvSGV4KHNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IgfHwgXG4gICAgICAgIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKSk7XG5cbiAgICB1c2VyTWVzc2FnZURpdi5zdHlsZS5jb2xvciA9IHNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3IgfHwgREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yO1xuXG4gICAgY29uc3QgdXNlck1lc3NhZ2VUb29sQmFyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdXNlck1lc3NhZ2VUb29sQmFyRGl2LmNsYXNzTmFtZSA9ICd1c2VyTWVzc2FnZVRvb2xCYXInO1xuXG4gICAgY29uc3QgYnV0dG9uQ29udGFpbmVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYnV0dG9uQ29udGFpbmVyRGl2LmNsYXNzTmFtZSA9ICdidXR0b24tY29udGFpbmVyJztcblxuICAgIGNvbnN0IHVzZXJOYW1lU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICB1c2VyTmFtZVNwYW4uY2xhc3NOYW1lID0gJ3VzZXJOYW1lJztcbiAgICB1c2VyTmFtZVNwYW4udGV4dENvbnRlbnQgPSBzZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJOYW1lIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS51c2VyTmFtZTtcblxuICAgIHVzZXJNZXNzYWdlVG9vbEJhckRpdi5hcHBlbmRDaGlsZCh1c2VyTmFtZVNwYW4pO1xuICAgIHVzZXJNZXNzYWdlVG9vbEJhckRpdi5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXJEaXYpO1xuXG4gICAgY29uc3QgdXNlclByZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ByZScpO1xuICAgIGNvbnN0IHByZVVzZXJNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIHByZVVzZXJNZXNzYWdlLmNsYXNzTmFtZSA9ICdwcmVVc2VyTWVzc2FnZSc7XG4gICAgdXNlclByZS5hcHBlbmRDaGlsZChwcmVVc2VyTWVzc2FnZSk7XG5cbiAgICAvLyBSZW1vdmUgcmVuZGVyZWQgbm90ZVxuICAgIGNvbnN0IHJlZ2V4UmVuZGVyZWROb3RlID0gLzxub3RlLXJlbmRlcmVkPltcXHNcXFNdKj88XFwvbm90ZS1yZW5kZXJlZD4vZztcbiAgICB0cmltbWVkTWVzc2FnZSA9IHRyaW1tZWRNZXNzYWdlLnJlcGxhY2UocmVnZXhSZW5kZXJlZE5vdGUsICcnKS50cmltKCk7XG5cbiAgICBwcmVVc2VyTWVzc2FnZS5pbm5lckhUTUwgPSB0cmltbWVkTWVzc2FnZTtcblxuICAgIGNvbnN0IHJlZ2VuZXJhdGVCdXR0b24gPSByZWdlbmVyYXRlVXNlckJ1dHRvbihwbHVnaW4sIHNldHRpbmdzKTtcbiAgICBjb25zdCBlZGl0QnV0dG9uID0gZGlzcGxheVVzZXJFZGl0QnV0dG9uKHBsdWdpbiwgc2V0dGluZ3MsIHVzZXJQcmUpO1xuICAgIGNvbnN0IGNvcHlVc2VyQnV0dG9uID0gZGlzcGxheVVzZXJDb3B5QnV0dG9uKHVzZXJQcmUpO1xuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gZGlzcGxheVRyYXNoQnV0dG9uKHBsdWdpbik7XG5cblxuICAgIGlmICghbWVzc2FnZS5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKHJlZ2VuZXJhdGVCdXR0b24pO1xuICAgICAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgfVxuXG4gICAgYnV0dG9uQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKGNvcHlVc2VyQnV0dG9uKTtcbiAgICBidXR0b25Db250YWluZXJEaXYuYXBwZW5kQ2hpbGQodHJhc2hCdXR0b24pO1xuICAgIHVzZXJNZXNzYWdlRGl2LmFwcGVuZENoaWxkKHVzZXJNZXNzYWdlVG9vbEJhckRpdik7XG4gICAgdXNlck1lc3NhZ2VEaXYuYXBwZW5kQ2hpbGQodXNlclByZSk7XG5cbiAgICByZXR1cm4gdXNlck1lc3NhZ2VEaXY7XG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQk1PR1BULCB7IERFRkFVTFRfU0VUVElOR1MsIHVwZGF0ZVNldHRpbmdzRnJvbUZyb250TWF0dGVyIH0gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IGFkZEdlbmVyYWxTZXR0aW5ncyB9IGZyb20gJy4vY29tcG9uZW50cy9zZXR0aW5ncy9HZW5lcmFsU2V0dGluZ3MnO1xuaW1wb3J0IHsgYWRkQXBwZWFyYW5jZVNldHRpbmdzIH0gZnJvbSAnLi9jb21wb25lbnRzL3NldHRpbmdzL0FwcGVhcmFuY2VTZXR0aW5ncyc7XG5pbXBvcnQgeyBhZGRDaGF0SGlzdG9yeVNldHRpbmdzIH0gZnJvbSAnLi9jb21wb25lbnRzL3NldHRpbmdzL0NoYXRIaXN0b3J5U2V0dGluZ3MnO1xuaW1wb3J0IHsgYWRkT2xsYW1hU2V0dGluZ3MgfSBmcm9tICcuL2NvbXBvbmVudHMvc2V0dGluZ3MvT2xsYW1hU2V0dGluZ3MnO1xuaW1wb3J0IHsgYWRkQVBJQ29ubmVjdGlvblNldHRpbmdzIH0gZnJvbSAnLi9jb21wb25lbnRzL3NldHRpbmdzL0Nvbm5lY3Rpb25TZXR0aW5ncyc7XG5pbXBvcnQgeyBhZGRQcm9maWxlU2V0dGluZ3MgfSBmcm9tICcuL2NvbXBvbmVudHMvc2V0dGluZ3MvUHJvZmlsZVNldHRpbmdzJztcbmltcG9ydCB7IGFkZFJFU1RBUElVUkxTZXR0aW5ncyB9IGZyb20gJy4vY29tcG9uZW50cy9zZXR0aW5ncy9SRVNUQVBJVVJMU2V0dGluZ3MnO1xuaW1wb3J0IHsgYWRkRWRpdG9yU2V0dGluZ3MgfSBmcm9tICcuL2NvbXBvbmVudHMvc2V0dGluZ3MvRWRpdG9yU2V0dGluZ3MnO1xuaW1wb3J0IHsgYWRkUHJvbXB0U2V0dGluZ3MgfSBmcm9tICcuL2NvbXBvbmVudHMvc2V0dGluZ3MvUHJvbXB0U2V0dGluZ3MnO1xuXG5leHBvcnQgY2xhc3MgQk1PU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEJNT0dQVDtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBCTU9HUFQpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRhc3luYyBkaXNwbGF5KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIERpc3BsYXkgc2V0dGluZ3MgaW5mb3JtYXRpb25cblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDEnLCB7IHRleHQ6ICdCTU8gQ2hhdGJvdCBTZXR0aW5ncycgfSk7XG5cblx0XHQvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIHRoZSBsaW5rc1xuXHRcdGNvbnN0IGxpbmtDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jyk7XG5cblx0XHQvLyBEZWZpbmUgbGluayBkYXRhXG5cdFx0Y29uc3QgbGlua3MgPSBbXG5cdFx0XHR7IHRleHQ6ICdDaGFuZ2Vsb2cnLCBocmVmOiAnaHR0cHM6Ly9naXRodWIuY29tL2xvbmd5Mmsvb2JzaWRpYW4tYm1vLWNoYXRib3QvcmVsZWFzZXMnIH0sXG5cdFx0XHR7IHRleHQ6ICdXaWtpJywgaHJlZjogJ2h0dHBzOi8vZ2l0aHViLmNvbS9sb25neTJrL29ic2lkaWFuLWJtby1jaGF0Ym90L3dpa2knIH0sXG5cdFx0XHR7IHRleHQ6ICdSZXBvcnQgYSBCdWcnLCBocmVmOiAnaHR0cHM6Ly9naXRodWIuY29tL2xvbmd5Mmsvb2JzaWRpYW4tYm1vLWNoYXRib3QvaXNzdWVzJyB9LFxuXHRcdFx0eyB0ZXh0OiAnU3VwcG9ydCBNZScsIGhyZWY6ICdodHRwczovL2tvLWZpLmNvbS9sb25neTJrJyB9XG5cdFx0XTtcblxuXHRcdC8vIENyZWF0ZSBsaW5rcyBhbmQgc2VwYXJhdG9yc1xuXHRcdGxpbmtzLmZvckVhY2goKGxpbmssIGluZGV4KSA9PiB7XG5cdFx0XHRpZiAoaW5kZXggPiAwKSB7XG5cdFx0XHRcdGxpbmtDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XG5cdFx0XHRcdFx0dGV4dDogJyB8ICcsXG5cdFx0XHRcdFx0YXR0cjogeyBzdHlsZTogJ2ZvbnQtc2l6ZTogMC44cmVtOyBtYXJnaW4tcmlnaHQ6IDVweDsnIH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGxpbmtFbCA9IGxpbmtDb250YWluZXIuY3JlYXRlRWwoJ2EnLCB7XG5cdFx0XHRcdHRleHQ6IGxpbmsudGV4dCxcblx0XHRcdFx0aHJlZjogbGluay5ocmVmLFxuXHRcdFx0XHRhdHRyOiB7IHN0eWxlOiAnZm9udC1zaXplOiAwLjhyZW07JyB9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKGluZGV4IDwgbGlua3MubGVuZ3RoIC0gMSkge1xuXHRcdFx0XHRsaW5rRWwuc3R5bGUubWFyZ2luUmlnaHQgPSAnNXB4Jztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiAnVHlwZSBgL2hlbHBgIGluIGNoYXQgZm9yIGNvbW1hbmRzLicgfSk7XG5cblxuXHRcdC8vIEFkZCBob3Jpem9udGFsIHJ1bGVcblx0XHRhZGRIb3Jpem9udGFsUnVsZSh0aGlzLmNvbnRhaW5lckVsKTtcblxuXHRcdC8vIERpc3BsYXkgc2V0dGluZ3Ncblx0XHRhZGRQcm9maWxlU2V0dGluZ3ModGhpcy5jb250YWluZXJFbCwgdGhpcy5wbHVnaW4sIHRoaXMpO1xuXHRcdGFkZEdlbmVyYWxTZXR0aW5ncyh0aGlzLmNvbnRhaW5lckVsLCB0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0YWRkUHJvbXB0U2V0dGluZ3ModGhpcy5jb250YWluZXJFbCwgdGhpcy5wbHVnaW4sIHRoaXMpO1xuXHRcdGFkZEFwcGVhcmFuY2VTZXR0aW5ncyh0aGlzLmNvbnRhaW5lckVsLCB0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0YWRkQ2hhdEhpc3RvcnlTZXR0aW5ncyh0aGlzLmNvbnRhaW5lckVsLCB0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0YWRkRWRpdG9yU2V0dGluZ3ModGhpcy5jb250YWluZXJFbCwgdGhpcy5wbHVnaW4sIHRoaXMpO1x0XHRcblxuXHRcdC8vIEFkZCBob3Jpem9udGFsIHJ1bGVcblx0XHRhZGRIb3Jpem9udGFsUnVsZSh0aGlzLmNvbnRhaW5lckVsKTtcblxuXHRcdC8vIERpc3BsYXkgc2V0dGluZ3Ncblx0XHRhZGRPbGxhbWFTZXR0aW5ncyh0aGlzLmNvbnRhaW5lckVsLCB0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0YWRkUkVTVEFQSVVSTFNldHRpbmdzKHRoaXMuY29udGFpbmVyRWwsIHRoaXMucGx1Z2luLCB0aGlzKTtcblx0XHRhZGRBUElDb25uZWN0aW9uU2V0dGluZ3ModGhpcy5jb250YWluZXJFbCwgdGhpcy5wbHVnaW4sIHRoaXMpO1xuXG5cdFx0Ly8gQWRkIGhvcml6b250YWwgcnVsZVxuXHRcdGFkZEhvcml6b250YWxSdWxlKHRoaXMuY29udGFpbmVyRWwpO1xuXG5cblx0XHQvLyBBZGQgcmVzZXQgYnV0dG9uXG5cdFx0Y29uc3QgcmVzZXRCdXR0b24gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnYScsIHtcblx0XHRcdHRleHQ6ICdSZXNldCBTZXR0aW5ncycsXG5cdFx0XHRocmVmOiAnIycsXG5cdFx0XHRhdHRyOiB7XG5cdFx0XHRcdHN0eWxlOiAnZGlzcGxheTogYmxvY2s7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAxcmVtIDA7IGZvbnQtc2l6ZTogMC43cmVtOyBjb2xvcjogI2ZmNjY2NjsnXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXNldEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChldmVudCkgPT4ge1xuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGNvbnN0IGNvbmZpcm1SZXNldCA9IGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZXNldCBhbGwgc2V0dGluZ3MgdG8gZGVmYXVsdD8nKTtcblx0XHRcdGlmIChjb25maXJtUmVzZXQpIHtcblx0XHRcdFx0Y29uc3QgcHJvZmlsZVBhdGhGaWxlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGggKyAnLycgKyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlO1xuXHRcdFx0XHRjb25zdCBwcm9maWxlUGF0aCA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJvZmlsZVBhdGhGaWxlKSBhcyBURmlsZTtcblxuXHRcdFx0XHRjb25zdCBkZWZhdWx0UHJvZmlsZVBhdGhGaWxlID0gREVGQVVMVF9TRVRUSU5HUy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCArICcvJyArIERFRkFVTFRfU0VUVElOR1MucHJvZmlsZXMucHJvZmlsZTtcblx0XHRcdFx0Y29uc3QgZGVmYXVsdFByb2ZpbGVQYXRoID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkZWZhdWx0UHJvZmlsZVBhdGhGaWxlKSBhcyBURmlsZTtcblxuXHRcdFx0XHRpZiAocHJvZmlsZVBhdGgpIHtcblx0XHRcdFx0XHRpZiAocHJvZmlsZVBhdGgucGF0aCA9PT0gZGVmYXVsdFByb2ZpbGVQYXRoLnBhdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzID0gREVGQVVMVF9TRVRUSU5HUztcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0XHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5kaXNhYmxlUGx1Z2luKHRoaXMucGx1Z2luLm1hbmlmZXN0LmlkKTtcblx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLmVuYWJsZVBsdWdpbih0aGlzLnBsdWdpbi5tYW5pZmVzdC5pZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZW5hbWVNZXNzYWdlSGlzdG9yeSA9ICcuLy5vYnNpZGlhbi9wbHVnaW5zL2Jtby1jaGF0Ym90L2RhdGEvJyArICdtZXNzYWdlSGlzdG9yeV8nICsgZGVmYXVsdFByb2ZpbGVQYXRoLm5hbWUucmVwbGFjZSgnLm1kJywgJy5qc29uJyk7XG5cdFx0XHRcdFx0XHR0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnJlbW92ZShmaWxlbmFtZU1lc3NhZ2VIaXN0b3J5KTtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmFwcC52YXVsdC5kZWxldGUocHJvZmlsZVBhdGgpO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZSA9IERFRkFVTFRfU0VUVElOR1MucHJvZmlsZXMucHJvZmlsZTtcblx0XHRcdFx0XHRcdGF3YWl0IHVwZGF0ZVNldHRpbmdzRnJvbUZyb250TWF0dGVyKHRoaXMucGx1Z2luLCBkZWZhdWx0UHJvZmlsZVBhdGgpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcblx0XHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdFx0Y29uc3QgcmVmcmVzaFRhYiA9IHRoaXMucGx1Z2luLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKCdibW8tY2hhdGJvdCcpO1xuXHRcdFx0XHRcdGlmIChyZWZyZXNoVGFiKSB7XG5cdFx0XHRcdFx0XHRyZWZyZXNoVGFiLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bmV3IEJNT1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMucGx1Z2luKS5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIGNvbnN0IHJlc2V0Tm90aWNlID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ3AnLCB7XG5cdFx0Ly8gXHR0ZXh0OiAnUGxlYXNlIHJlc2V0IHlvdXIgc2V0dGluZ3MgaWYgeW91IGhhdmUgcmVjZW50bHkgdXBkYXRlZCBmcm9tIHZlcnNpb24gPDIuMC4wLicsXG5cdFx0Ly8gXHRhdHRyOiB7XG5cdFx0Ly8gXHRcdHN0eWxlOiAnZm9udC1zaXplOiAwLjdyZW07IHRleHQtYWxpZ246IGNlbnRlcjsnXG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyBjb250YWluZXJFbC5hcHBlbmRDaGlsZChyZXNldE5vdGljZSk7XG5cdH1cbn1cblxuZnVuY3Rpb24gYWRkSG9yaXpvbnRhbFJ1bGUoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSB7XG5cdGNvbnN0IHNlcGFyYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hyJyk7XG5cdHNlcGFyYXRvci5zdHlsZS5tYXJnaW4gPSAnMXJlbSAwJztcblx0Y29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTtcbn0iLCAiaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQsIE5vdGljZSwgU2V0dGluZywgU2V0dGluZ1RhYiwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBCTU9HUFQsIHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IGZldGNoR29vZ2xlR2VtaW5pTW9kZWxzLCBmZXRjaE1pc3RyYWxNb2RlbHMsIGZldGNoT2xsYW1hTW9kZWxzLCBmZXRjaE9wZW5BSUJhc2VNb2RlbHMsIGZldGNoT3BlblJvdXRlck1vZGVscywgZmV0Y2hSRVNUQVBJVVJMTW9kZWxzIH0gZnJvbSAnLi4vRmV0Y2hNb2RlbExpc3QnO1xuaW1wb3J0IHsgQU5USFJPUElDX01PREVMUyB9IGZyb20gJ3NyYy92aWV3JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEdlbmVyYWxTZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHBsdWdpbjogQk1PR1BULCBTZXR0aW5nVGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdHZW5lcmFsJ30pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUdlbmVyYWxTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUdlbmVyYWxTZXR0aW5ncyA9IGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1kb3duJyk7IC8vIE9wZW4gc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUdlbmVyYWxTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgY3JlYXRlTW9kZWxEcm9wZG93biA9IChkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpID0+IHtcbiAgICAgICAgY29uc3QgbW9kZWxHcm91cHMgPSBbXG4gICAgICAgICAgICB7IG5hbWU6ICdPbGxhbWEgTW9kZWxzJywgbW9kZWxzOiBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ1JFU1QgQVBJIE1vZGVscycsIG1vZGVsczogcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ0FudGhyb3BpYyBNb2RlbHMnLCBtb2RlbHM6IHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5hbnRocm9waWMuYW50aHJvcGljTW9kZWxzIH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdHb29nbGUgR2VtaW5pIE1vZGVscycsIG1vZGVsczogcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5nZW1pbmlNb2RlbHMgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ01pc3RyYWwgTW9kZWxzJywgbW9kZWxzOiBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzIH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdPcGVuQUktQmFzZWQgTW9kZWxzJywgbW9kZWxzOiBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ09wZW5Sb3V0ZXIgTW9kZWxzJywgbW9kZWxzOiBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5vcGVuUm91dGVyTW9kZWxzIH1cbiAgICAgICAgXTtcbiAgICBcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBkcm9wZG93bi5zZWxlY3RFbDtcbiAgICAgICAgc2VsZWN0RWwuaW5uZXJIVE1MID0gJyc7IC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblxuICAgICAgICAvLyBBZGQgdGhlIGRlZmF1bHQgbW9kZWwgb3B0aW9uXG4gICAgICAgIGNvbnN0IGRlZmF1bHRPcHRpb24gPSBzZWxlY3RFbC5jcmVhdGVFbCgnb3B0aW9uJywge1xuICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICAgICAgdGV4dDogJ05vIE1vZGVsJ1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID09PSAnTm8gTW9kZWwnKSB7XG4gICAgICAgICAgICBkZWZhdWx0T3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICBtb2RlbEdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHtcbiAgICAgICAgICAgIGlmIChncm91cC5tb2RlbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGdyb3VwID0gc2VsZWN0RWwuY3JlYXRlRWwoJ29wdGdyb3VwJyk7XG4gICAgICAgICAgICAgICAgb3B0Z3JvdXAubGFiZWwgPSBncm91cC5uYW1lO1xuICAgICAgICAgICAgICAgIGdyb3VwLm1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gb3B0Z3JvdXAuY3JlYXRlRWwoJ29wdGlvbicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1vZGVsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwgPT09IHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIFxuICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1vZGVsID0gdmFsdWU7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgXG4gICAgbGV0IG1vZGVsRHJvcGRvd246IERyb3Bkb3duQ29tcG9uZW50O1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnTW9kZWwnKVxuICAgICAgICAuc2V0RGVzYygnQ2hvb3NlIGEgbW9kZWwuJylcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgICAgIC5zZXRJY29uKCdyb3RhdGUtY3cnKVxuICAgICAgICAgICAgLnNldENsYXNzKCdjbGlja2FibGUtaWNvbicpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdSZWxvYWRpbmcuLi4nKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggbW9kZWxzIHdoZW4gc2V0dGluZ3MgdGFiIG9wZW5zXG4gICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkwgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IGZldGNoT2xsYW1hTW9kZWxzKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscyA9IG1vZGVscyB8fCBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaFJFU1RBUElVUkxNb2RlbHMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMgPSBtb2RlbHMgfHwgW107XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gQU5USFJPUElDX01PREVMUztcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5hbnRocm9waWNNb2RlbHMgPSBtb2RlbHMgfHwgW107XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLkFQSUtleSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gYXdhaXQgZmV0Y2hHb29nbGVHZW1pbmlNb2RlbHMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5nZW1pbmlNb2RlbHMgPSBtb2RlbHMgfHwgW107XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5BUElLZXkgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IGZldGNoTWlzdHJhbE1vZGVscyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzID0gbW9kZWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5BUElLZXkgIT09ICcnIHx8IHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZVVybCAhPSBERUZBVUxUX1NFVFRJTkdTLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IGZldGNoT3BlbkFJQmFzZU1vZGVscyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMgPSBtb2RlbHMgfHwgW107XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXkgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IGZldGNoT3BlblJvdXRlck1vZGVscyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5vcGVuUm91dGVyTW9kZWxzID0gbW9kZWxzIHx8IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICAvLyBBZnRlciBmZXRjaGluZyBhbGwgbW9kZWxzLCByZWNyZWF0ZSB0aGUgZHJvcGRvd25cbiAgICAgICAgICAgICAgICBpZiAobW9kZWxEcm9wZG93bikge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVNb2RlbERyb3Bkb3duKG1vZGVsRHJvcGRvd24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdNb2RlbHMgcmVsb2FkZWQuJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG4gICAgICAgICAgICBtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG4gICAgICAgICAgICBjcmVhdGVNb2RlbERyb3Bkb3duKGRyb3Bkb3duKTtcbiAgICAgICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldE5hbWUoJ01heCBUb2tlbnMnKVxuICAgICAgICAuc2V0RGVzYygnVGhlIG1heGltdW0gbnVtYmVyIG9mIHRva2Vucywgb3Igd29yZHMsIHRoYXQgdGhlIG1vZGVsIGlzIGFsbG93ZWQgdG8gZ2VuZXJhdGUgaW4gaXRzIG91dHB1dC4gU29tZSBtb2RlbHMgcmVxdWlyZSBhIG1pbmltdW0gbnVtYmVyIG9mIHRva2VucyB0byBiZSBzZXQuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGVtcHR5LicpXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCc0MDk2JylcbiAgICAgICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdUZW1wZXJhdHVyZScpXG4gICAgICAgIC5zZXREZXNjKCdUZW1wZXJhdHVyZSBjb250cm9scyBob3cgcmFuZG9tIHRoZSBnZW5lcmF0ZWQgb3V0cHV0IGlzLiBMb3dlciB2YWx1ZXMgbWFrZSB0aGUgdGV4dCBtb3JlIHByZWRpY3RhYmxlLCB3aGlsZSBoaWdoZXIgdmFsdWVzIG1ha2UgaXQgbW9yZSBjcmVhdGl2ZSBhbmQgdW5wcmVkaWN0YWJsZS4nKVxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMS4wMCcpXG4gICAgICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmxvYXRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpOyAvLyAxMCBpcyB0aGUgcmFkaXggcGFyYW1ldGVyIHRvIGVuc3VyZSBwYXJzaW5nIGlzIGRvbmUgaW4gYmFzZSAxMFxuXG4gICAgICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBmbG9hdCB2YWx1ZSBpcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihmbG9hdFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGZsb2F0VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmxvYXRWYWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9ICcwLjAwJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmxvYXRWYWx1ZSA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9ICcyLjAwJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUgPSBmbG9hdFZhbHVlLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9IERFRkFVTFRfU0VUVElOR1MuZ2VuZXJhbC50ZW1wZXJhdHVyZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IHZhbHVlIGlmIGlucHV0IGlzIG5vdCBhIHZhbGlkIG51bWJlclxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSA9IERFRkFVTFRfU0VUVElOR1MuZ2VuZXJhbC50ZW1wZXJhdHVyZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIFJlZmVyZW5jZSBDdXJyZW50IE5vdGUnKVxuICAgICAgICAuc2V0RGVzYygnRW5hYmxlIGNoYXRib3QgdG8gcmVmZXJlbmNlIGN1cnJlbnQgYWN0aXZlIG5vdGUgZHVyaW5nIGNvbnZlcnNhdGlvbi4nKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZW5hYmxlUmVmZXJlbmNlQ3VycmVudE5vdGUpLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmVuYWJsZVJlZmVyZW5jZUN1cnJlbnROb3RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVmZXJlbmNlQ3VycmVudE5vdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZmVyZW5jZUN1cnJlbnROb3RlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbn0iLCAiaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE9sbGFtYSB9IGZyb20gJ29sbGFtYSdcbmltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCBCTU9HUFQgZnJvbSAnc3JjL21haW4nO1xuaW1wb3J0IHsgT1BFTkFJX01PREVMUyB9IGZyb20gJ3NyYy92aWV3JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoT2xsYW1hTW9kZWxzKHBsdWdpbjogQk1PR1BUKSB7XG4gICAgICAgIGNvbnN0IG9sbGFtYVJFU1RBUElVUkwgPSBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5SRVNUQVBJVVJMO1xuXG4gICAgICAgIC8vIExvZyB0aGUgbGlzdCBvZiBtb2RlbHMgdXNpbmcgb2xsYW1hLmxpc3QoKVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgb2xsYW1hID0gbmV3IE9sbGFtYSh7aG9zdDogb2xsYW1hUkVTVEFQSVVSTH0pO1xuICAgICAgICAgICAgY29uc3QgbW9kZWxzTGlzdCA9IGF3YWl0IG9sbGFtYS5saXN0KCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnT2xsYW1hIE1vZGVsczonLCBtb2RlbHNMaXN0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRXh0cmFjdGluZyBtb2RlbCBuYW1lcyBhbmQgdXBkYXRpbmcgdGhlIHBsdWdpbiBzZXR0aW5nc1xuICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gbW9kZWxzTGlzdC5tb2RlbHMubWFwKChtb2RlbDogeyBuYW1lOiBzdHJpbmcgfSkgPT4gbW9kZWwubmFtZSk7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMgPSBtb2RlbHM7XG4gICAgXG4gICAgICAgICAgICByZXR1cm4gbW9kZWxzO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgbW9kZWxzIGZyb20gT2xsYW1hOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hSRVNUQVBJVVJMTW9kZWxzKHBsdWdpbjogQk1PR1BUKSB7XG4gICAgY29uc3QgUkVTVEFQSVVSTCA9IHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMO1xuXG4gICAgLy8gVVJMIFZhbGlkYXRpb25cbiAgICB0cnkge1xuICAgICAgICBuZXcgVVJMKFJFU1RBUElVUkwpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgUkVTVCBBUEkgVVJMOicsIFJFU1RBUElVUkwpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogUkVTVEFQSVVSTCArICcvbW9kZWxzJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwbHVnaW4uc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uQVBJS2V5fWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSByZXNwb25zZSBpcyB2YWxpZFxuICAgICAgICBpZiAocmVzcG9uc2UuanNvbiAmJiAocmVzcG9uc2UuanNvbi5kYXRhIHx8IEFycmF5LmlzQXJyYXkocmVzcG9uc2UuanNvbikpKSB7XG4gICAgICAgICAgICBsZXQgbW9kZWxzO1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UuanNvbikpIHtcbiAgICAgICAgICAgICAgICBtb2RlbHMgPSByZXNwb25zZS5qc29uLm1hcCgobW9kZWw6IHsgaWQ6IG51bWJlcjsgfSkgPT4gbW9kZWwuaWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtb2RlbHMgPSByZXNwb25zZS5qc29uLmRhdGEubWFwKChtb2RlbDogeyBpZDogbnVtYmVyOyB9KSA9PiBtb2RlbC5pZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMTW9kZWxzID0gbW9kZWxzO1xuICAgICAgICAgICAgcmV0dXJuIG1vZGVscztcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1ha2luZyBBUEkgcmVxdWVzdDonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBcbn1cblxuLy8gQW50aHJvcGljIEFQSSBtb2RlbHMgYXJlIHN0YXRpYy4gTm8gbmVlZCB0byBmZXRjaCB0aGVtLlxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hHb29nbGVHZW1pbmlNb2RlbHMocGx1Z2luOiBCTU9HUFQpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBBUElfS0VZID0gcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5BUElLZXk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHM/a2V5PSR7QVBJX0tFWX1gLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJlc3BvbnNlIGlzIHZhbGlkIGFuZCBoYXMgZGF0YVxuICAgICAgICBpZiAocmVzcG9uc2UuanNvbiAmJiByZXNwb25zZS5qc29uLm1vZGVscykge1xuICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gcmVzcG9uc2UuanNvbi5tb2RlbHMubWFwKChtb2RlbDogeyBuYW1lOiBzdHJpbmc7IH0pID0+IG1vZGVsLm5hbWUpLmZpbHRlcigobW9kZWw6IHN0cmluZykgPT4gbW9kZWwuc3RhcnRzV2l0aCgnbW9kZWxzL2dlbWluaScpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG1vZGVscyBpbiB5b3VyIHBsdWdpbidzIHNldHRpbmdzIG9yIGhhbmRsZSB0aGVtIGFzIG5lZWRlZFxuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5nZW1pbmlNb2RlbHMgPSBtb2RlbHM7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWxzO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hNaXN0cmFsTW9kZWxzKHBsdWdpbjogQk1PR1BUKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vYXBpLm1pc3RyYWwuYWkvdjEvbW9kZWxzJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5BUElLZXl9YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJlc3BvbnNlIGlzIHZhbGlkXG4gICAgICAgIGlmIChyZXNwb25zZS5qc29uICYmIHJlc3BvbnNlLmpzb24uZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gcmVzcG9uc2UuanNvbi5kYXRhLm1hcCgobW9kZWw6IHsgaWQ6IG51bWJlcjsgfSkgPT4gbW9kZWwuaWQpO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwubWlzdHJhbE1vZGVscyA9IG1vZGVscztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1vZGVscyk7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWxzO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIFxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoT3BlbkFJQmFzZU1vZGVscyhwbHVnaW46IEJNT0dQVCkge1xuICAgIGNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoe1xuICAgICAgICBhcGlLZXk6IHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuQVBJS2V5LFxuICAgICAgICBiYXNlVVJMOiBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VVcmwsXG4gICAgICAgIGRhbmdlcm91c2x5QWxsb3dCcm93c2VyOiB0cnVlLCAvLyBhcGlLZXkgaXMgc3RvcmVkIHdpdGhpbiBkYXRhLmpzb25cbiAgICB9KTtcblxuXHRjb25zdCBsaXN0ID0gYXdhaXQgb3BlbmFpLm1vZGVscy5saXN0KCk7XG5cbiAgICBpZiAob3BlbmFpLmJhc2VVUkwgPT0gJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnKSB7XG4gICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZU1vZGVscyA9IE9QRU5BSV9NT0RFTFM7XG4gICAgICAgIHJldHVybiBPUEVOQUlfTU9ERUxTO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgbW9kZWxzID0gbGlzdC5kYXRhLm1hcCgobW9kZWwpID0+IG1vZGVsLmlkKTtcbiAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzID0gbW9kZWxzO1xuICAgICAgICByZXR1cm4gbW9kZWxzO1xuICAgIH1cblxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hPcGVuUm91dGVyTW9kZWxzKHBsdWdpbjogQk1PR1BUKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvbW9kZWxzJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXl9YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJlc3BvbnNlIGlzIHZhbGlkXG4gICAgICAgIGlmIChyZXNwb25zZS5qc29uICYmIChyZXNwb25zZS5qc29uLmRhdGEgfHwgQXJyYXkuaXNBcnJheShyZXNwb25zZS5qc29uKSkpIHtcbiAgICAgICAgICAgIGxldCBtb2RlbHM7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZS5qc29uKSkge1xuICAgICAgICAgICAgICAgIG1vZGVscyA9IHJlc3BvbnNlLmpzb24ubWFwKChtb2RlbDogeyBpZDogbnVtYmVyOyB9KSA9PiBtb2RlbC5pZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vZGVscyA9IHJlc3BvbnNlLmpzb24uZGF0YS5tYXAoKG1vZGVsOiB7IGlkOiBudW1iZXI7IH0pID0+IG1vZGVsLmlkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIub3BlblJvdXRlck1vZGVscyA9IG1vZGVscztcbiAgICAgICAgICAgIHJldHVybiBtb2RlbHM7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYWtpbmcgQVBJIHJlcXVlc3Q6JywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgXG59IiwgImltcG9ydCB7IENvbG9yQ29tcG9uZW50LCBTZXR0aW5nLCBTZXR0aW5nVGFiLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEJNT0dQVCwgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc3JjL21haW4nO1xuaW1wb3J0IHsgY29sb3JUb0hleCB9IGZyb20gJ3NyYy91dGlscy9Db2xvckNvbnZlcnRlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRBcHBlYXJhbmNlU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnQXBwZWFyYW5jZSd9KTtcblxuICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBcHBlYXJhbmNlU2V0dGluZ3M7XG4gICAgY29uc3QgY2hldnJvbkljb24gPSB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdjaGV2cm9uLWljb24nIH0pO1xuICAgIHNldEljb24oY2hldnJvbkljb24sIGluaXRpYWxTdGF0ZSA/ICdjaGV2cm9uLWRvd24nIDogJ2NoZXZyb24tcmlnaHQnKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgc2V0dGluZ3MgY29udGFpbmVyIHRvIGJlIHRvZ2dsZWRcbiAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzQ29udGFpbmVyJyB9KTtcbiAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaW5pdGlhbFN0YXRlID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIFRvZ2dsZSB2aXNpYmlsaXR5XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXNPcGVuID0gc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1yaWdodCcpOyAvLyBDbG9zZSBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBcHBlYXJhbmNlU2V0dGluZ3MgPSBmYWxzZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tZG93bicpOyAvLyBPcGVuIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBcHBlYXJhbmNlU2V0dGluZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKCdoNicsIHt0ZXh0OiAnQ2hhdCBWaWV3J30pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ0VuYWJsZSBIZWFkZXInKVxuICAgIC5zZXREZXNjKCdEaXNwbGF5IGNoYXRib3QgbmFtZSBhbmQgbW9kZWwgbmFtZSBpbiBoZWFkZXIuJylcbiAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5lbmFibGVIZWFkZXIpLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuZW5hYmxlSGVhZGVyID0gdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2VDdXJyZW50Tm90ZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmVmZXJlbmNlQ3VycmVudE5vdGUnKSBhcyBIVE1MRWxlbWVudDtcblxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hlYWRlcicpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5tYXJnaW4gPSAnLTAuNXJlbSAwIDAuNXJlbSAwJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoZWFkZXInKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLm1heEhlaWdodCA9ICdjYWxjKDEwMCUgLSA2MHB4KSc7XG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUN1cnJlbnROb3RlRWxlbWVudC5zdHlsZS5tYXJnaW4gPSAnMC41cmVtIDAgMC41cmVtIDAnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICApO1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnVXNlciBOYW1lJylcbiAgICAgICAgLnNldERlc2MoJ0NyZWF0ZSBhIHVzZXJuYW1lLicpXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB1c2VyIG5hbWUnKVxuICAgICAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJOYW1lIHx8IERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS51c2VyTmFtZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTmFtZSA9IHZhbHVlID8gdmFsdWUgOiBERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UudXNlck5hbWU7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLm1heExlbmd0aCA9IDMwO1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyTmFtZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudXNlck5hbWUnKSBhcyBOb2RlTGlzdE9mPEhUTUxIZWFkaW5nRWxlbWVudD47XG4gICAgICAgICAgICAgICAgdXNlck5hbWVzLmZvckVhY2godXNlck5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZS50ZXh0Q29udGVudCA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJOYW1lO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIGxldCBjb2xvclBpY2tlcjE6IENvbG9yQ29tcG9uZW50O1xuICAgIGNvbnN0IGRlZmF1bHRDaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5jaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yKS50cmltKCk7XG5cbiAgICBsZXQgY29sb3JQaWNrZXIyOiBDb2xvckNvbXBvbmVudDtcbiAgICBjb25zdCBkZWZhdWx0TWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvcikudHJpbSgpO1xuXG4gICAgbGV0IGNvbG9yUGlja2VyMzogQ29sb3JDb21wb25lbnQ7XG4gICAgY29uc3QgZGVmYXVsdFVzZXJNZXNzYWdlRm9udENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUZvbnRDb2xvcikudHJpbSgpO1xuXG4gICAgbGV0IGNvbG9yUGlja2VyNDogQ29sb3JDb21wb25lbnQ7XG4gICAgY29uc3QgZGVmYXVsdFVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcikudHJpbSgpO1xuXG4gICAgbGV0IGNvbG9yUGlja2VyNTogQ29sb3JDb21wb25lbnQ7XG4gICAgY29uc3QgZGVmYXVsdEJvdE1lc3NhZ2VGb250Q29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VGb250Q29sb3IpLnRyaW0oKTtcblxuICAgIGxldCBjb2xvclBpY2tlcjY6IENvbG9yQ29tcG9uZW50O1xuICAgIGNvbnN0IGRlZmF1bHRCb3RNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKERFRkFVTFRfU0VUVElOR1MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yKS50cmltKCk7XG5cbiAgICBsZXQgY29sb3JQaWNrZXI3OiBDb2xvckNvbXBvbmVudDtcbiAgICBjb25zdCBkZWZhdWx0Q2hhdEJveEZvbnRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcikudHJpbSgpO1xuXG4gICAgbGV0IGNvbG9yUGlja2VyODogQ29sb3JDb21wb25lbnQ7XG4gICAgY29uc3QgZGVmYXVsdENoYXRCb3hCYWNrZ3JvdW5kQ29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnQ2hhdGJvdCBDb250YWluZXIgQmFja2dyb3VuZCBDb2xvcicpXG4gICAgICAgIC5zZXREZXNjKCdNb2RpZnkgdGhlIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIGNoYXRib3QgY29udGFpbmVyLicpXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1Jlc3RvcmUgRGVmYXVsdCcpXG4gICAgICAgICAgICAuc2V0SWNvbigncm90YXRlLWN3JylcbiAgICAgICAgICAgIC5zZXRDbGFzcygnY2xpY2thYmxlLWljb24nKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IGNvbG9yVG9IZXgoZGVmYXVsdENoYXRib3RDb250YWluZXJCYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgICAgIGNvbG9yUGlja2VyMS5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhdGJvdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90Q29udGFpbmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKGNoYXRib3RDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTW9kaWZ5IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBjaGF0Ym90IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBjaGF0Ym90Q29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvclBpY2tlcjIuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICAgLmFkZENvbG9yUGlja2VyKChjb2xvcikgPT4ge1xuICAgICAgICAgICAgY29sb3JQaWNrZXIxID0gY29sb3I7XG5cbiAgICAgICAgICAgIGxldCBkZWZhdWx0VmFsdWUgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5jaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yO1xuXG4gICAgICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvciA9PSAnLS1iYWNrZ3JvdW5kLXNlY29uZGFyeScpIHtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRDaGF0Ym90Q29udGFpbmVyQmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29sb3Iuc2V0VmFsdWUoZGVmYXVsdFZhbHVlKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhleFZhbHVlID0gY29sb3JUb0hleCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdGJvdENvbnRhaW5lckJhY2tncm91bmRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRib3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdENvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChjaGF0Ym90Q29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXRib3RDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JQaWNrZXIyLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdNZXNzYWdlIENvbnRhaW5lciBCYWNrZ3JvdW5kIENvbG9yJylcbiAgICAuc2V0RGVzYygnTW9kaWZ5IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBtZXNzYWdlIGNvbnRhaW5lci4nKVxuICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgLnNldEljb24oJ3JvdGF0ZS1jdycpXG4gICAgICAgIC5zZXRDbGFzcygnY2xpY2thYmxlLWljb24nKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRNZXNzYWdlQ29udGFpbmVyQmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIGNvbG9yUGlja2VyMi5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpO1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgLy8gTW9kaWZ5IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBjaGF0Ym90IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICApXG4gICAgLmFkZENvbG9yUGlja2VyKChjb2xvcikgPT4ge1xuICAgICAgICBjb2xvclBpY2tlcjIgPSBjb2xvcjtcblxuICAgICAgICBsZXQgZGVmYXVsdFZhbHVlID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvcjtcblxuICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvciA9PSAnLS1iYWNrZ3JvdW5kLXNlY29uZGFyeScpIHtcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZSA9IGNvbG9yVG9IZXgoZGVmYXVsdE1lc3NhZ2VDb250YWluZXJCYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29sb3Iuc2V0VmFsdWUoZGVmYXVsdFZhbHVlKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZXhWYWx1ZSA9IGNvbG9yVG9IZXgodmFsdWUpO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UubWVzc2FnZUNvbnRhaW5lckJhY2tncm91bmRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdVc2VyIE1lc3NhZ2UgRm9udCBDb2xvcicpXG4gICAgICAgIC5zZXREZXNjKCdNb2RpZnkgdGhlIGZvbnQgY29sb3Igb2YgdGhlIHVzZXIgbWVzc2FnZS4nKVxuICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXN0b3JlIERlZmF1bHQnKVxuICAgICAgICAgICAgLnNldEljb24oJ3JvdGF0ZS1jdycpXG4gICAgICAgICAgICAuc2V0Q2xhc3MoJ2NsaWNrYWJsZS1pY29uJylcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRVc2VyTWVzc2FnZUZvbnRDb2xvcik7XG4gICAgICAgICAgICAgICAgY29sb3JQaWNrZXIzLnNldFZhbHVlKGRlZmF1bHRWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy51c2VyTWVzc2FnZScpO1xuICAgICAgICAgICAgICAgICAgICB1c2VyTWVzc2FnZXMuZm9yRWFjaCgodXNlck1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB1c2VyTWVzc2FnZSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuY29sb3IgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICAuYWRkQ29sb3JQaWNrZXIoKGNvbG9yKSA9PiB7XG4gICAgICAgICAgICBjb2xvclBpY2tlcjMgPSBjb2xvcjtcblxuICAgICAgICAgICAgbGV0IGRlZmF1bHRWYWx1ZSA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlRm9udENvbG9yO1xuXG4gICAgICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UudXNlck1lc3NhZ2VGb250Q29sb3IgPT0gJy0tdGV4dC1ub3JtYWwnKSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0VXNlck1lc3NhZ2VGb250Q29sb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb2xvci5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGV4VmFsdWUgPSBjb2xvclRvSGV4KHZhbHVlKTtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUZvbnRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlcyA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnVzZXJNZXNzYWdlJyk7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJNZXNzYWdlcy5mb3JFYWNoKCh1c2VyTWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHVzZXJNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5jb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldE5hbWUoJ1VzZXIgTWVzc2FnZSBCYWNrZ3JvdW5kIENvbG9yJylcbiAgICAgICAgLnNldERlc2MoJ01vZGlmeSB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgdXNlciBtZXNzYWdlLicpXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1Jlc3RvcmUgRGVmYXVsdCcpXG4gICAgICAgICAgICAuc2V0SWNvbigncm90YXRlLWN3JylcbiAgICAgICAgICAgIC5zZXRDbGFzcygnY2xpY2thYmxlLWljb24nKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IGNvbG9yVG9IZXgoZGVmYXVsdFVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgICAgICBjb2xvclBpY2tlcjQuc2V0VmFsdWUoZGVmYXVsdFZhbHVlKTtcbiAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy51c2VyTWVzc2FnZScpO1xuICAgICAgICAgICAgICAgICAgICB1c2VyTWVzc2FnZXMuZm9yRWFjaCgodXNlck1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB1c2VyTWVzc2FnZSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICAgLmFkZENvbG9yUGlja2VyKChjb2xvcikgPT4ge1xuICAgICAgICAgICAgY29sb3JQaWNrZXI0ID0gY29sb3I7XG5cbiAgICAgICAgICAgIGxldCBkZWZhdWx0VmFsdWUgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS51c2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcjtcblxuICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID09ICctLWJhY2tncm91bmQtcHJpbWFyeScpIHtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRVc2VyTWVzc2FnZUJhY2tncm91bmRDb2xvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbG9yLnNldFZhbHVlKGRlZmF1bHRWYWx1ZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoZXhWYWx1ZSA9IGNvbG9yVG9IZXgodmFsdWUpO1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLnVzZXJNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlck1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudXNlck1lc3NhZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgdXNlck1lc3NhZ2VzLmZvckVhY2goKHVzZXJNZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdXNlck1lc3NhZ2UgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnQm90IE1lc3NhZ2UgRm9udCBDb2xvcicpXG4gICAgLnNldERlc2MoJ01vZGlmeSB0aGUgZm9udCBjb2xvciBvZiB0aGUgYm90IG1lc3NhZ2UuJylcbiAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoJ1Jlc3RvcmUgRGVmYXVsdCcpXG4gICAgICAgIC5zZXRJY29uKCdyb3RhdGUtY3cnKVxuICAgICAgICAuc2V0Q2xhc3MoJ2NsaWNrYWJsZS1pY29uJylcbiAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0Qm90TWVzc2FnZUZvbnRDb2xvcik7XG4gICAgICAgICAgICBjb2xvclBpY2tlcjUuc2V0VmFsdWUoZGVmYXVsdFZhbHVlKTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJvdE1lc3NhZ2VzID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuYm90TWVzc2FnZScpO1xuICAgICAgICAgICAgICAgIGJvdE1lc3NhZ2VzLmZvckVhY2goKGJvdE1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGJvdE1lc3NhZ2UgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuY29sb3IgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIClcbiAgICAuYWRkQ29sb3JQaWNrZXIoKGNvbG9yKSA9PiB7XG4gICAgICAgIGNvbG9yUGlja2VyNSA9IGNvbG9yO1xuXG4gICAgICAgIGxldCBkZWZhdWx0VmFsdWUgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yO1xuXG4gICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yID09ICctLXRleHQtbm9ybWFsJykge1xuICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0Qm90TWVzc2FnZUZvbnRDb2xvcik7XG4gICAgICAgIH1cblxuICAgICAgICBjb2xvci5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhleFZhbHVlID0gY29sb3JUb0hleCh2YWx1ZSk7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlRm9udENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VDb250YWluZXInKTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3RNZXNzYWdlJyk7XG4gICAgICAgICAgICAgICAgYm90TWVzc2FnZXMuZm9yRWFjaCgoYm90TWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gYm90TWVzc2FnZSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5jb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdCb3QgTWVzc2FnZSBCYWNrZ3JvdW5kIENvbG9yJylcbiAgICAgICAgLnNldERlc2MoJ01vZGlmeSB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgYm90IG1lc3NhZ2UuJylcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgICAgIC5zZXRJY29uKCdyb3RhdGUtY3cnKVxuICAgICAgICAgICAgLnNldENsYXNzKCdjbGlja2FibGUtaWNvbicpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0Qm90TWVzc2FnZUJhY2tncm91bmRDb2xvcik7XG4gICAgICAgICAgICAgICAgY29sb3JQaWNrZXI2LnNldFZhbHVlKGRlZmF1bHRWYWx1ZSk7XG4gICAgXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQ29udGFpbmVyJyk7XG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3RNZXNzYWdlJyk7XG4gICAgICAgICAgICAgICAgICAgIGJvdE1lc3NhZ2VzLmZvckVhY2goKGJvdE1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBib3RNZXNzYWdlIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICAuYWRkQ29sb3JQaWNrZXIoKGNvbG9yKSA9PiB7XG4gICAgICAgICAgICBjb2xvclBpY2tlcjYgPSBjb2xvcjtcblxuICAgICAgICAgICAgbGV0IGRlZmF1bHRWYWx1ZSA9IHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3I7XG5cbiAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yID09ICctLWJhY2tncm91bmQtc2Vjb25kYXJ5Jykge1xuICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZSA9IGNvbG9yVG9IZXgoZGVmYXVsdEJvdE1lc3NhZ2VCYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb2xvci5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZXhWYWx1ZSA9IGNvbG9yVG9IZXgodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ib3RNZXNzYWdlQmFja2dyb3VuZENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWVzc2FnZUNvbnRhaW5lcicpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYm90TWVzc2FnZXMgPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3RNZXNzYWdlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3RNZXNzYWdlcy5mb3JFYWNoKChib3RNZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGJvdE1lc3NhZ2UgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoZXhWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnQ2hhdGJveCBGb250IENvbG9yJylcbiAgICAuc2V0RGVzYygnTW9kaWZ5IHRoZSBmb250IGNvbG9yIG9mIHRoZSBjaGF0Ym94LicpXG4gICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXN0b3JlIERlZmF1bHQnKVxuICAgICAgICAuc2V0SWNvbigncm90YXRlLWN3JylcbiAgICAgICAgLnNldENsYXNzKCdjbGlja2FibGUtaWNvbicpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IGNvbG9yVG9IZXgoZGVmYXVsdENoYXRCb3hGb250Q29sb3IpO1xuICAgICAgICAgICAgY29sb3JQaWNrZXI3LnNldFZhbHVlKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggdGV4dGFyZWEnKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0ZXh0YXJlYSkge1xuICAgICAgICAgICAgICAgIHRleHRhcmVhLnN0eWxlLmNvbG9yID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgcGxhY2Vob2xkZXIgY29sb3IgdG8gdGhlIGRlZmF1bHQgdmFsdWVcbiAgICAgICAgICAgICAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgICAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBgXG4gICAgICAgICAgICAgICAgICAgIC5jaGF0Ym94IHRleHRhcmVhOjpwbGFjZWhvbGRlciB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJHtkZWZhdWx0VmFsdWV9ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgIHRleHRhcmVhLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgKVxuICAgIC5hZGRDb2xvclBpY2tlcihhc3luYyAoY29sb3IpID0+IHtcbiAgICAgICAgY29sb3JQaWNrZXI3ID0gY29sb3I7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGVmYXVsdFZhbHVlID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvcjtcbiAgICAgICAgXG4gICAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT0gJy0tdGV4dC1ub3JtYWwnKSB7XG4gICAgICAgICAgICBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRDaGF0Qm94Rm9udENvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29sb3Iuc2V0VmFsdWUoZGVmYXVsdFZhbHVlKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhleFZhbHVlID0gY29sb3JUb0hleCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEZvbnRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3ggdGV4dGFyZWEnKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0ZXh0YXJlYSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5jb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBwbGFjZWhvbGRlciBjb2xvciB0byB0aGUgc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IGBcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jaGF0Ym94IHRleHRhcmVhOjpwbGFjZWhvbGRlciB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICR7aGV4VmFsdWV9ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ0NoYXRib3ggQmFja2dyb3VuZCBDb2xvcicpXG4gICAgLnNldERlc2MoJ01vZGlmeSB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgY2hhdGJveC4nKVxuICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgLnNldEljb24oJ3JvdGF0ZS1jdycpXG4gICAgICAgIC5zZXRDbGFzcygnY2xpY2thYmxlLWljb24nKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRDaGF0Qm94QmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIGNvbG9yUGlja2VyOC5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBjaGF0Ym94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3gnKTtcbiAgICAgICAgICAgIGlmIChjaGF0Ym94KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGNoYXRib3ggYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5ib3JkZXJDb2xvciA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgKVxuICAgIC5hZGRDb2xvclBpY2tlcihhc3luYyAoY29sb3IpID0+IHtcbiAgICAgICAgY29sb3JQaWNrZXI4ID0gY29sb3I7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGVmYXVsdFZhbHVlID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuY2hhdEJveEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgXG4gICAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT0gJy0taW50ZXJhY3RpdmUtYWNjZW50Jykge1xuICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0Q2hhdEJveEJhY2tncm91bmRDb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbG9yLnNldFZhbHVlKGRlZmF1bHRWYWx1ZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoZXhWYWx1ZSA9IGNvbG9yVG9IZXgodmFsdWUpO1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmNoYXRCb3hCYWNrZ3JvdW5kQ29sb3IgPSBoZXhWYWx1ZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBjaGF0Ym94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3gnKTtcbiAgICAgICAgICAgICAgICBpZiAoY2hhdGJveCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY2hhdGJveCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoZXhWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5ib3JkZXJDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym94IHRleHRhcmVhJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRhcmVhKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0ZXh0YXJlYSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBoZXhWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5ib3JkZXJDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym94IC5zdWJtaXQtYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgaWYgKHN1Ym1pdEJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gc3VibWl0QnV0dG9uIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJvcmRlckNvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnRW5hYmxlIFNjcm9sbGJhcicpXG4gICAgLnNldERlc2MoJ0Rpc3BsYXkgc2Nyb2xsYmFyIGluIGNoYXRib3guJylcbiAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5lbmFibGVTY3JvbGxCYXIpLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuZW5hYmxlU2Nyb2xsQmFyID0gdmFsdWU7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJveCB0ZXh0YXJlYScpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChjaGF0Ym94KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXRib3guc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJveCB0ZXh0YXJlYScpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChjaGF0Ym94KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXRib3guc3R5bGUub3ZlcmZsb3dZID0gJ2hpZGRlbic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKCdoNicsIHt0ZXh0OiAnR2VuZXJhdGUgVmlldyd9KTtcblxuICAgIGxldCBjb2xvclBpY2tlcjk6IENvbG9yQ29tcG9uZW50O1xuICAgIC8vIGNvbnN0IGRlZmF1bHRCTU9HZW5lcmF0ZUJhY2tncm91bmRDb2xvciA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVCYWNrZ3JvdW5kQ29sb3IpLnRyaW0oKTtcblxuICAgIGxldCBjb2xvclBpY2tlcjEwOiBDb2xvckNvbXBvbmVudDtcbiAgICBjb25zdCBkZWZhdWx0Qk1PR2VuZXJhdGVGb250Q29sb3IgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlRm9udENvbG9yKS50cmltKCk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnQk1PIEdlbmVyYXRlIEJhY2tncm91bmQgQ29sb3InKVxuICAgIC5zZXREZXNjKCdNb2RpZnkgdGhlIGJhY2tncm91bmQgY29sb3Igb2YgQk1PIEdlbmVyYXRlLicpXG4gICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXN0b3JlIERlZmF1bHQnKVxuICAgICAgICAuc2V0SWNvbigncm90YXRlLWN3JylcbiAgICAgICAgLnNldENsYXNzKCdjbGlja2FibGUtaWNvbicpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbG9yUGlja2VyOS5zZXRWYWx1ZShERUZBVUxUX1NFVFRJTkdTLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVCYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJtb0NvZGVCbG9ja0NvbnRhaW5lcicpO1xuICAgICAgICAgICAgY29udGFpbmVycy5mb3JFYWNoKChjb250YWluZXIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gREVGQVVMVF9TRVRUSU5HUy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgKVxuICAgIC5hZGRDb2xvclBpY2tlcihhc3luYyAoY29sb3IpID0+IHtcbiAgICAgICAgY29sb3JQaWNrZXI5ID0gY29sb3I7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ibW9HZW5lcmF0ZUJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgXG4gICAgICAgIGNvbG9yLnNldFZhbHVlKGRlZmF1bHRWYWx1ZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoZXhWYWx1ZSA9IGNvbG9yVG9IZXgodmFsdWUpO1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlQmFja2dyb3VuZENvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibW9Db2RlQmxvY2tDb250YWluZXInKTtcbiAgICAgICAgICAgICAgICBjb250YWluZXJzLmZvckVhY2goKGNvbnRhaW5lcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ0JNTyBHZW5lcmF0ZSBGb250IENvbG9yJylcbiAgICAuc2V0RGVzYygnTW9kaWZ5IHRoZSBmb250IGNvbG9yIG9mIEJNTyBHZW5lcmF0ZS4nKVxuICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgLnNldEljb24oJ3JvdGF0ZS1jdycpXG4gICAgICAgIC5zZXRDbGFzcygnY2xpY2thYmxlLWljb24nKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBjb2xvclRvSGV4KGRlZmF1bHRCTU9HZW5lcmF0ZUZvbnRDb2xvcik7XG4gICAgICAgICAgICBjb2xvclBpY2tlcjEwLnNldFZhbHVlKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGJtb0NvZGVCbG9ja0NvbnRlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJtb0NvZGVCbG9ja0NvbnRlbnQnKTtcbiAgICAgICAgICAgIGJtb0NvZGVCbG9ja0NvbnRlbnRzLmZvckVhY2goKGNvbnRlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gY29udGVudCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmNvbG9yID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICApXG4gICAgLmFkZENvbG9yUGlja2VyKGFzeW5jIChjb2xvcikgPT4ge1xuICAgICAgICBjb2xvclBpY2tlcjEwID0gY29sb3I7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGVmYXVsdFZhbHVlID0gcGx1Z2luLnNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVGb250Q29sb3I7XG4gICAgICAgIFxuICAgICAgICBpZiAoZGVmYXVsdFZhbHVlID09ICctLXRleHQtbm9ybWFsJykge1xuICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gY29sb3JUb0hleChkZWZhdWx0Qk1PR2VuZXJhdGVGb250Q29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb2xvci5zZXRWYWx1ZShkZWZhdWx0VmFsdWUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGV4VmFsdWUgPSBjb2xvclRvSGV4KHZhbHVlKTtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuYXBwZWFyYW5jZS5ibW9HZW5lcmF0ZUZvbnRDb2xvciA9IGhleFZhbHVlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGJtb0NvZGVCbG9ja0NvbnRlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJtb0NvZGVCbG9ja0NvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICBibW9Db2RlQmxvY2tDb250ZW50cy5mb3JFYWNoKChjb250ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBjb250ZW50IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmNvbG9yID0gaGV4VmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBTZXQgdGhlIGluaXRpYWwgZm9udCBjb2xvciBvZiAuYm1vQ29kZUJsb2NrQ29udGVudCBlbGVtZW50c1xuICAgICAgICBjb25zdCBibW9Db2RlQmxvY2tDb250ZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibW9Db2RlQmxvY2tDb250ZW50Jyk7XG4gICAgICAgIGJtb0NvZGVCbG9ja0NvbnRlbnRzLmZvckVhY2goKGNvbnRlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBjb250ZW50IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5jb2xvciA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG4iLCAiaW1wb3J0IHsgU2V0dGluZywgU2V0dGluZ1RhYiwgVEZvbGRlciwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBCTU9HUFQsIHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NyYy9tYWluJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZENoYXRIaXN0b3J5U2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnQ2hhdCBIaXN0b3J5J30pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUNoYXRIaXN0b3J5U2V0dGluZ3M7XG4gICAgY29uc3QgY2hldnJvbkljb24gPSB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdjaGV2cm9uLWljb24nIH0pO1xuICAgIHNldEljb24oY2hldnJvbkljb24sIGluaXRpYWxTdGF0ZSA/ICdjaGV2cm9uLWRvd24nIDogJ2NoZXZyb24tcmlnaHQnKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgc2V0dGluZ3MgY29udGFpbmVyIHRvIGJlIHRvZ2dsZWRcbiAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzQ29udGFpbmVyJyB9KTtcbiAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaW5pdGlhbFN0YXRlID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIFRvZ2dsZSB2aXNpYmlsaXR5XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXNPcGVuID0gc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1yaWdodCcpOyAvLyBDbG9zZSBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVDaGF0SGlzdG9yeVNldHRpbmdzID0gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlQ2hhdEhpc3RvcnlTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdDaGF0IEhpc3RvcnkgRm9sZGVyIFBhdGgnKVxuICAgICAgICAuc2V0RGVzYygnU2F2ZSB5b3VyIGNoYXQgaGlzdG9yeSBpbiBhIHNwZWNpZmllZCBmb2xkZXIuJylcbiAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0JNTy9IaXN0b3J5JylcbiAgICAgICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuY2hhdEhpc3RvcnkuY2hhdEhpc3RvcnlQYXRoIHx8IERFRkFVTFRfU0VUVElOR1MuY2hhdEhpc3RvcnkuY2hhdEhpc3RvcnlQYXRoKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5jaGF0SGlzdG9yeS5jaGF0SGlzdG9yeVBhdGggPSB2YWx1ZSA/IHZhbHVlIDogREVGQVVMVF9TRVRUSU5HUy5jaGF0SGlzdG9yeS5jaGF0SGlzdG9yeVBhdGg7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBmb2xkZXJQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNoYXRIaXN0b3J5LmNoYXRIaXN0b3J5UGF0aC50cmltKCkgfHwgREVGQVVMVF9TRVRUSU5HUy5jaGF0SGlzdG9yeS5jaGF0SGlzdG9yeVBhdGg7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdHJhaWxpbmcgJy8nIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZm9sZGVyUGF0aC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2xkZXJQYXRoID0gZm9sZGVyUGF0aC5zdWJzdHJpbmcoMCwgZm9sZGVyUGF0aC5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5jaGF0SGlzdG9yeS5jaGF0SGlzdG9yeVBhdGggPSBmb2xkZXJQYXRoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXIgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb2xkZXIgJiYgZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLmJvcmRlckNvbG9yID0gJyc7IFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLmJvcmRlckNvbG9yID0gJ3JlZCc7IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldE5hbWUoJ1RlbXBsYXRlIEZpbGUgUGF0aCcpXG4gICAgICAgIC5zZXREZXNjKCdJbnNlcnQgeW91ciB0ZW1wbGF0ZSBmaWxlIHBhdGguJylcbiAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3RlbXBsYXRlcy9ibW8ubWQnKVxuICAgICAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5jaGF0SGlzdG9yeS50ZW1wbGF0ZUZpbGVQYXRoIHx8IERFRkFVTFRfU0VUVElOR1MuY2hhdEhpc3RvcnkudGVtcGxhdGVGaWxlUGF0aClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuY2hhdEhpc3RvcnkudGVtcGxhdGVGaWxlUGF0aCA9IHZhbHVlID8gdmFsdWUgOiBERUZBVUxUX1NFVFRJTkdTLmNoYXRIaXN0b3J5LnRlbXBsYXRlRmlsZVBhdGg7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwcm92aWRlZCBmaWxlIHBhdGggZW5kcyB3aXRoICcubWQnLCBpZiBub3QsIGFwcGVuZCBpdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbi5zZXR0aW5ncy5jaGF0SGlzdG9yeS50ZW1wbGF0ZUZpbGVQYXRoLmVuZHNXaXRoKCcubWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmNoYXRIaXN0b3J5LnRlbXBsYXRlRmlsZVBhdGggKz0gJy5tZCc7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxsRmlsZXMgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVzKCk7IC8vIFJldHJpZXZlIGFsbCBmaWxlcyBmcm9tIHRoZSB2YXVsdFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBzcGVjaWZpZWQgZmlsZSBwYXRoIChpbmNsdWRpbmcgZGlyZWN0b3JpZXMpIGV4aXN0cyBpbiB0aGUgYXJyYXkgb2YgZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUV4aXN0cyA9IGFsbEZpbGVzLnNvbWUoZmlsZSA9PiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpID09PSBwbHVnaW4uc2V0dGluZ3MuY2hhdEhpc3RvcnkudGVtcGxhdGVGaWxlUGF0aC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJGaWxlIGV4aXN0cyBpbiB2YXVsdCFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiRmlsZSBkb2VzIG5vdCBleGlzdCBpbiB2YXVsdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBpbnB1dCBpcyBlbXB0eSwgcmVzZXQgdGhlIGJvcmRlciBjb2xvclxuICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmNoYXRIaXN0b3J5LnRlbXBsYXRlRmlsZVBhdGggPSBERUZBVUxUX1NFVFRJTkdTLmNoYXRIaXN0b3J5LnRlbXBsYXRlRmlsZVBhdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIFJlbmFtZSBOb3RlIFRpdGxlJylcbiAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBtb2RlbCB0byByZW5hbWUgdGhlIG5vdGUgdGl0bGUgd2hlbiBzYXZpbmcgY2hhdCBoaXN0b3J5LicpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuY2hhdEhpc3RvcnkuYWxsb3dSZW5hbWVOb3RlVGl0bGUpLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5jaGF0SGlzdG9yeS5hbGxvd1JlbmFtZU5vdGVUaXRsZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG59IiwgImltcG9ydCB7IFNldHRpbmcsIFNldHRpbmdUYWIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQk1PR1BULCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICdzcmMvbWFpbic7XG5pbXBvcnQgeyBmZXRjaE9sbGFtYU1vZGVscyB9IGZyb20gJy4uL0ZldGNoTW9kZWxMaXN0JztcbmltcG9ydCB7IGFkZERlc2NyaXB0aW9uTGluayB9IGZyb20gJ3NyYy91dGlscy9EZXNjcmlwdGlvbkxpbmsnO1xuXG4vLyBPbGxhbWEgU2V0dGluZ3NcbmV4cG9ydCBmdW5jdGlvbiBhZGRPbGxhbWFTZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHBsdWdpbjogQk1PR1BULCBTZXR0aW5nVGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdPbGxhbWEgQ29ubmVjdGlvbid9KTtcblxuICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy50b2dnbGVPbGxhbWFTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZU9sbGFtYVNldHRpbmdzID0gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlT2xsYW1hU2V0dGluZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnT0xMQU1BIFJFU1QgQVBJIFVSTCcpXG4gICAgICAgIC5zZXREZXNjKGFkZERlc2NyaXB0aW9uTGluaygnRW50ZXIgeW91ciBSRVNUIEFQSSBVUkwuIFVwZGF0ZSAnLCAnaHR0cHM6Ly9vbGxhbWEuY29tLycsICd0byB2ZXJzaW9uID49MC4xLjQyIHRvIGF2b2lkIENPUlMgcmVzdHJpY3Rpb24uJywgJ09sbGFtYScpKVxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcpXG4gICAgICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24uUkVTVEFQSVVSTCB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24uUkVTVEFQSVVSTClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkwgPSB2YWx1ZSA/IHZhbHVlIDogREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5SRVNUQVBJVVJMID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzID0gW107XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaE9sbGFtYU1vZGVscyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxzPy5mb3JFYWNoKChtb2RlbDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5wdXNoKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBTdHJlYW0nKVxuICAgICAgICAuc2V0RGVzYygnRW5hYmxlIE9sbGFtYSBtb2RlbHMgdG8gc3RyZWFtIHJlc3BvbnNlLicpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLmVuYWJsZVN0cmVhbSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHRvZ2dsZSBjb250YWluZXIgZm9yIEFkdmFuY2VkIFNldHRpbmdzIHdpdGhpbiB0aGUgbWFpbiBzZXR0aW5nc0NvbnRhaW5lclxuICAgIGNvbnN0IGFkdmFuY2VkVG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIGFkdmFuY2VkVG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdBZHZhbmNlZCBTZXR0aW5ncycgfSk7XG5cbiAgICAvLyBEZXRlcm1pbmUgdGhlIGluaXRpYWwgc3RhdGUgZm9yIEFkdmFuY2VkIFNldHRpbmdzIGZyb20gdGhlIHBsdWdpbidzIHNldHRpbmdzXG4gICAgY29uc3QgYWR2YW5jZWRJbml0aWFsU3RhdGUgPSBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlQWR2YW5jZWRTZXR0aW5ncztcbiAgICBjb25zdCBhZHZhbmNlZENoZXZyb25JY29uID0gYWR2YW5jZWRUb2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdjaGV2cm9uLWljb24nIH0pO1xuICAgIHNldEljb24oYWR2YW5jZWRDaGV2cm9uSWNvbiwgYWR2YW5jZWRJbml0aWFsU3RhdGUgPyAnY2hldnJvbi1kb3duJyA6ICdjaGV2cm9uLXJpZ2h0Jyk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIGNvbnRhaW5lciBmb3IgQWR2YW5jZWQgU2V0dGluZ3MgdGhhdCB3aWxsIGJlIHRvZ2dsZWRcbiAgICBjb25zdCBhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGFkdmFuY2VkSW5pdGlhbFN0YXRlID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIFRvZ2dsZSB2aXNpYmlsaXR5IGZvciBBZHZhbmNlZCBTZXR0aW5nc1xuICAgIGFkdmFuY2VkVG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXNPcGVuID0gYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oYWR2YW5jZWRDaGV2cm9uSWNvbiwgJ2NoZXZyb24tcmlnaHQnKTsgLy8gQ2xvc2Ugc3RhdGVcbiAgICAgICAgICAgIGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBZHZhbmNlZFNldHRpbmdzID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGFkdmFuY2VkQ2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBZHZhbmNlZFNldHRpbmdzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSk7XG5cblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdtaXJvc3RhdCcpXG4gICAgICAgIC5zZXREZXNjKCdFbmFibGUgTWlyb3N0YXQgc2FtcGxpbmcgZm9yIGNvbnRyb2xsaW5nIHBlcnBsZXhpdHkuIChkZWZhdWx0OiAwLCAwID0gZGlzYWJsZWQsIDEgPSBNaXJvc3RhdCwgMiA9IE1pcm9zdGF0IDIuMCknKVxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMCcpXG4gICAgICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdCB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSB0aGUgaW5wdXQgdmFsdWUgYXMgYW4gaW50ZWdlclxuICAgICAgICAgICAgICAgIGNvbnN0IGludFZhbHVlID0gcGFyc2VJbnQodmFsdWUsIDEwKTsgLy8gMTAgaXMgdGhlIHJhZGl4IHBhcmFtZXRlciB0byBlbnN1cmUgcGFyc2luZyBpcyBkb25lIGluIGJhc2UgMTBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGFyc2VkIHZhbHVlIGlzIGEgdmFsaWQgaW50ZWdlciwgaWYgbm90LCBmYWxsYmFjayB0byB0aGUgZGVmYXVsdCBVUkxcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4oaW50VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXQgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0ID0gaW50VmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ21pcm9zdGF0X2V0YScpXG4gICAgLnNldERlc2MoJ0luZmx1ZW5jZXMgaG93IHF1aWNrbHkgdGhlIGFsZ29yaXRobSByZXNwb25kcyB0byBmZWVkYmFjayBmcm9tIHRoZSBnZW5lcmF0ZWQgdGV4dC4gQSBsb3dlciBsZWFybmluZyByYXRlIHdpbGwgcmVzdWx0IGluIHNsb3dlciBhZGp1c3RtZW50cywgd2hpbGUgYSBoaWdoZXIgbGVhcm5pbmcgcmF0ZSB3aWxsIG1ha2UgdGhlIGFsZ29yaXRobSBtb3JlIHJlc3BvbnNpdmUuIChEZWZhdWx0OiAwLjEpJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcwLjEnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF9ldGEgfHwgREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfZXRhKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgaW5wdXQgdmFsdWUgYXMgYW4gaW50ZWdlclxuICAgICAgICAgICAgY29uc3QgZmxvYXRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpOyAvLyAxMCBpcyB0aGUgcmFkaXggcGFyYW1ldGVyIHRvIGVuc3VyZSBwYXJzaW5nIGlzIGRvbmUgaW4gYmFzZSAxMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgdGhlIGZsb2F0IHZhbHVlIGlzIGFuIGludGVnZXIgKHdob2xlIG51bWJlcilcbiAgICAgICAgICAgIGlmICghaXNOYU4oZmxvYXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X2V0YSA9IGZsb2F0VmFsdWUudG9GaXhlZCgyKS50b1N0cmluZygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayB0byB0aGUgZGVmYXVsdCB2YWx1ZSBpZiBpbnB1dCBpcyBub3QgYSB2YWxpZCBudW1iZXJcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X2V0YSA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X2V0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdtaXJvc3RhdF90YXUnKVxuICAgIC5zZXREZXNjKCdDb250cm9scyB0aGUgYmFsYW5jZSBiZXR3ZWVuIGNvaGVyZW5jZSBhbmQgZGl2ZXJzaXR5IG9mIHRoZSBvdXRwdXQuIEEgbG93ZXIgdmFsdWUgd2lsbCByZXN1bHQgaW4gbW9yZSBmb2N1c2VkIGFuZCBjb2hlcmVudCB0ZXh0LiAoRGVmYXVsdDogNS4wKScpXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignNS4wMCcpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pcm9zdGF0X3RhdSB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taXJvc3RhdF90YXUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBpbnB1dCB2YWx1ZSBhcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICBjb25zdCBmbG9hdFZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiB0aGUgZmxvYXQgdmFsdWUgaXMgYW4gaW50ZWdlciAod2hvbGUgbnVtYmVyKVxuICAgICAgICAgICAgaWYgKCFpc05hTihmbG9hdFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1ID0gZmxvYXRWYWx1ZS50b0ZpeGVkKDIpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IHZhbHVlIGlmIGlucHV0IGlzIG5vdCBhIHZhbGlkIG51bWJlclxuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1ID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWlyb3N0YXRfdGF1O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ251bV9jdHgnKVxuICAgIC5zZXREZXNjKCdTZXRzIHRoZSBzaXplIG9mIHRoZSBjb250ZXh0IHdpbmRvdyB1c2VkIHRvIGdlbmVyYXRlIHRoZSBuZXh0IHRva2VuLiAoRGVmYXVsdDogMjA0OCknKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzIwNDgnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fY3R4IHx8IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9jdHgpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBpbnB1dCB2YWx1ZSBhcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICBjb25zdCBpbnRWYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYXJzZWQgdmFsdWUgaXMgYSB2YWxpZCBpbnRlZ2VyLCBpZiBub3QsIGZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IFVSTFxuICAgICAgICAgICAgaWYgKGlzTmFOKGludFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2N0eCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9jdHg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2N0eCA9IGludFZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnbnVtX2dxYScpXG4gICAgLnNldERlc2MoJ1RoZSBudW1iZXIgb2YgR1FBIGdyb3VwcyBpbiB0aGUgdHJhbnNmb3JtZXIgbGF5ZXIuIFJlcXVpcmVkIGZvciBzb21lIG1vZGVscywgZm9yIGV4YW1wbGUgaXQgaXMgOCBmb3IgbGxhbWEyOjcwYi4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzAnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fZ3FhIHx8IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9ncWEpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBpbnB1dCB2YWx1ZSBhcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICBjb25zdCBpbnRWYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYXJzZWQgdmFsdWUgaXMgYSB2YWxpZCBpbnRlZ2VyLCBpZiBub3QsIGZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IFVSTFxuICAgICAgICAgICAgaWYgKGlzTmFOKGludFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2dxYSA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV9ncWE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX2dxYSA9IGludFZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnbnVtX3RocmVhZCcpXG4gICAgLnNldERlc2MoJ1NldHMgdGhlIG51bWJlciBvZiB0aHJlYWRzIHRvIHVzZSBkdXJpbmcgY29tcHV0YXRpb24uIEJ5IGRlZmF1bHQsIE9sbGFtYSB3aWxsIGRldGVjdCB0aGlzIGZvciBvcHRpbWFsIHBlcmZvcm1hbmNlLiBJdCBpcyByZWNvbW1lbmRlZCB0byBzZXQgdGhpcyB2YWx1ZSB0byB0aGUgbnVtYmVyIG9mIHBoeXNpY2FsIENQVSBjb3JlcyB5b3VyIHN5c3RlbSBoYXMgKGFzIG9wcG9zZWQgdG8gdGhlIGxvZ2ljYWwgbnVtYmVyIG9mIGNvcmVzKS4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzAnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5udW1fdGhyZWFkIHx8IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBpbnB1dCB2YWx1ZSBhcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICBjb25zdCBpbnRWYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYXJzZWQgdmFsdWUgaXMgYSB2YWxpZCBpbnRlZ2VyLCBpZiBub3QsIGZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IFVSTFxuICAgICAgICAgICAgaWYgKGlzTmFOKGludFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX3RocmVhZCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm51bV90aHJlYWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubnVtX3RocmVhZCA9IGludFZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgncmVwZWF0X2xhc3RfbicpXG4gICAgLnNldERlc2MoJ1NldHMgaG93IGZhciBiYWNrIGZvciB0aGUgbW9kZWwgdG8gbG9vayBiYWNrIHRvIHByZXZlbnQgcmVwZXRpdGlvbi4gKERlZmF1bHQ6IDY0LCAwID0gZGlzYWJsZWQsIC0xID0gbnVtX2N0eCknKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzY0JylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X2xhc3RfbiB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfbGFzdF9uKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgaW5wdXQgdmFsdWUgYXMgYW4gaW50ZWdlclxuICAgICAgICAgICAgY29uc3QgaW50VmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApOyAvLyAxMCBpcyB0aGUgcmFkaXggcGFyYW1ldGVyIHRvIGVuc3VyZSBwYXJzaW5nIGlzIGRvbmUgaW4gYmFzZSAxMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGFyc2VkIHZhbHVlIGlzIGEgdmFsaWQgaW50ZWdlciwgaWYgbm90LCBmYWxsYmFjayB0byB0aGUgZGVmYXVsdCBVUkxcbiAgICAgICAgICAgIGlmIChpc05hTihpbnRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9sYXN0X24gPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfbGFzdF9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9sYXN0X24gPSBpbnRWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ3JlcGVhdF9wZW5hbHR5JylcbiAgICAuc2V0RGVzYygnU2V0cyBob3cgc3Ryb25nbHkgdG8gcGVuYWxpemUgcmVwZXRpdGlvbnMuIEEgaGlnaGVyIHZhbHVlIChlLmcuLCAxLjUpIHdpbGwgcGVuYWxpemUgcmVwZXRpdGlvbnMgbW9yZSBzdHJvbmdseSwgd2hpbGUgYSBsb3dlciB2YWx1ZSAoZS5nLiwgMC45KSB3aWxsIGJlIG1vcmUgbGVuaWVudC4gKERlZmF1bHQ6IDEuMSknKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzEuMScpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9wZW5hbHR5IHx8IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnJlcGVhdF9wZW5hbHR5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgaW5wdXQgdmFsdWUgYXMgYW4gaW50ZWdlclxuICAgICAgICAgICAgY29uc3QgZmxvYXRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpOyAvLyAxMCBpcyB0aGUgcmFkaXggcGFyYW1ldGVyIHRvIGVuc3VyZSBwYXJzaW5nIGlzIGRvbmUgaW4gYmFzZSAxMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgdGhlIGZsb2F0IHZhbHVlIGlzIGFuIGludGVnZXIgKHdob2xlIG51bWJlcilcbiAgICAgICAgICAgIGlmIChpc05hTihmbG9hdFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMucmVwZWF0X3BlbmFsdHkgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfcGVuYWx0eTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gdGhlIGRlZmF1bHQgdmFsdWUgaWYgaW5wdXQgaXMgbm90IGEgdmFsaWQgbnVtYmVyXG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5yZXBlYXRfcGVuYWx0eSA9IGZsb2F0VmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdzZWVkJylcbiAgICAuc2V0RGVzYygnU2V0cyB0aGUgcmFuZG9tIG51bWJlciBzZWVkIHRvIHVzZSBmb3IgZ2VuZXJhdGlvbi4gU2V0dGluZyB0aGlzIHRvIGEgc3BlY2lmaWMgbnVtYmVyIHdpbGwgbWFrZSB0aGUgbW9kZWwgZ2VuZXJhdGUgdGhlIHNhbWUgdGV4dCBmb3IgdGhlIHNhbWUgcHJvbXB0LicpXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignMCcpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnNlZWQgfHwgREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc2VlZClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgLy8gUGFyc2UgdGhlIGlucHV0IHZhbHVlIGFzIGFuIGludGVnZXJcbiAgICAgICAgICAgIGNvbnN0IGludFZhbHVlID0gcGFyc2VJbnQodmFsdWUsIDEwKTsgLy8gMTAgaXMgdGhlIHJhZGl4IHBhcmFtZXRlciB0byBlbnN1cmUgcGFyc2luZyBpcyBkb25lIGluIGJhc2UgMTBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBhcnNlZCB2YWx1ZSBpcyBhIHZhbGlkIGludGVnZXIsIGlmIG5vdCwgZmFsbGJhY2sgdG8gdGhlIGRlZmF1bHQgVVJMXG4gICAgICAgICAgICBpZiAoaXNOYU4oaW50VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc2VlZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zZWVkID0gaW50VmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdzdG9wJylcbiAgICAuc2V0RGVzYygnU2V0cyB0aGUgc3RvcCBzZXF1ZW5jZXMgdG8gdXNlLiBXaGVuIHRoaXMgcGF0dGVybiBpcyBlbmNvdW50ZXJlZCwgdGhlIExMTSB3aWxsIHN0b3AgZ2VuZXJhdGluZyB0ZXh0IGFuZCByZXR1cm4uIE11bHRpcGxlIHN0b3AgcGF0dGVybnMgbWF5IGJlIHNldCBieSBzcGVjaWZ5aW5nIHRoZW0gYXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBpbiB0aGUgaW5wdXQgZmllbGQuJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdzdG9wLCBcXFxcbiwgdXNlcjonKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zdG9wICYmIEFycmF5LmlzQXJyYXkocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zdG9wKSBcbiAgICAgICAgICAgICAgICAgICA/IHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc3RvcC5qb2luKCcsICcpIFxuICAgICAgICAgICAgICAgICAgIDogREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMuc3RvcC5qb2luKCcsICcpKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gU3BsaXQgdGhlIGlucHV0IHN0cmluZyBieSBjb21tYXMsIHRyaW0gd2hpdGVzcGFjZSwgYW5kIGVuc3VyZSBpdCdzIGFsd2F5cyBzdG9yZWQgYXMgYW4gYXJyYXlcbiAgICAgICAgICAgICAgICBjb25zdCBzdG9wc0FycmF5ID0gdmFsdWUgPyB2YWx1ZS5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKSA6IFsuLi5ERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5zdG9wXTtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnN0b3AgPSBzdG9wc0FycmF5O1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcbiAgICBcbiAgICBcblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ3Rmc196JylcbiAgICAuc2V0RGVzYygnVGFpbCBmcmVlIHNhbXBsaW5nIGlzIHVzZWQgdG8gcmVkdWNlIHRoZSBpbXBhY3Qgb2YgbGVzcyBwcm9iYWJsZSB0b2tlbnMgZnJvbSB0aGUgb3V0cHV0LiBBIGhpZ2hlciB2YWx1ZSAoZS5nLiwgMi4wKSB3aWxsIHJlZHVjZSB0aGUgaW1wYWN0IG1vcmUsIHdoaWxlIGEgdmFsdWUgb2YgMS4wIGRpc2FibGVzIHRoaXMgc2V0dGluZy4gKGRlZmF1bHQ6IDEpJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcxLjAnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50ZnNfeiB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50ZnNfeilcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgLy8gUGFyc2UgdGhlIGlucHV0IHZhbHVlIGFzIGFuIGludGVnZXJcbiAgICAgICAgICAgIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTsgLy8gMTAgaXMgdGhlIHJhZGl4IHBhcmFtZXRlciB0byBlbnN1cmUgcGFyc2luZyBpcyBkb25lIGluIGJhc2UgMTBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBmbG9hdCB2YWx1ZSBpcyBhbiBpbnRlZ2VyICh3aG9sZSBudW1iZXIpXG4gICAgICAgICAgICBpZiAoaXNOYU4oZmxvYXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRmc196ID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3o7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudGZzX3ogPSBmbG9hdFZhbHVlLnRvRml4ZWQoMikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCd0b3BfaycpXG4gICAgLnNldERlc2MoJ1JlZHVjZXMgdGhlIHByb2JhYmlsaXR5IG9mIGdlbmVyYXRpbmcgbm9uc2Vuc2UuIEEgaGlnaGVyIHZhbHVlIChlLmcuIDEwMCkgd2lsbCBnaXZlIG1vcmUgZGl2ZXJzZSBhbnN3ZXJzLCB3aGlsZSBhIGxvd2VyIHZhbHVlIChlLmcuIDEwKSB3aWxsIGJlIG1vcmUgY29uc2VydmF0aXZlLiAoRGVmYXVsdDogNDApJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCc0MCcpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rIHx8IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgaW5wdXQgdmFsdWUgYXMgYW4gaW50ZWdlclxuICAgICAgICAgICAgY29uc3QgaW50VmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApOyAvLyAxMCBpcyB0aGUgcmFkaXggcGFyYW1ldGVyIHRvIGVuc3VyZSBwYXJzaW5nIGlzIGRvbmUgaW4gYmFzZSAxMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGFyc2VkIHZhbHVlIGlzIGEgdmFsaWQgaW50ZWdlciwgaWYgbm90LCBmYWxsYmFjayB0byB0aGUgZGVmYXVsdCBVUkxcbiAgICAgICAgICAgIGlmIChpc05hTihpbnRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9rID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX2s7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX2sgPSBpbnRWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKGFkdmFuY2VkU2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ3RvcF9wJylcbiAgICAuc2V0RGVzYygnV29ya3MgdG9nZXRoZXIgd2l0aCB0b3Atay4gQSBoaWdoZXIgdmFsdWUgKGUuZy4sIDAuOTUpIHdpbGwgbGVhZCB0byBtb3JlIGRpdmVyc2UgdGV4dCwgd2hpbGUgYSBsb3dlciB2YWx1ZSAoZS5nLiwgMC41KSB3aWxsIGdlbmVyYXRlIG1vcmUgZm9jdXNlZCBhbmQgY29uc2VydmF0aXZlIHRleHQuIChEZWZhdWx0OiAwLjkpJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcxLjAnKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfcCB8fCBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy50b3BfcClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgLy8gUGFyc2UgdGhlIGlucHV0IHZhbHVlIGFzIGFuIGludGVnZXJcbiAgICAgICAgICAgIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTsgLy8gMTAgaXMgdGhlIHJhZGl4IHBhcmFtZXRlciB0byBlbnN1cmUgcGFyc2luZyBpcyBkb25lIGluIGJhc2UgMTBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBmbG9hdCB2YWx1ZSBpcyBhbiBpbnRlZ2VyICh3aG9sZSBudW1iZXIpXG4gICAgICAgICAgICBpZiAoaXNOYU4oZmxvYXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLnRvcF9wID0gREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3A7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMudG9wX3AgPSBmbG9hdFZhbHVlLnRvRml4ZWQoMikudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhhZHZhbmNlZFNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdtaW5fcCcpXG4gICAgLnNldERlc2MoJ0FsdGVybmF0aXZlIHRvIHRoZSB0b3BfcCwgYW5kIGFpbXMgdG8gZW5zdXJlIGEgYmFsYW5jZSBvZiBxdWFsaXR5IGFuZCB2YXJpZXR5LiBUaGUgcGFyYW1ldGVyIHAgcmVwcmVzZW50cyB0aGUgbWluaW11bSBwcm9iYWJpbGl0eSBmb3IgYSB0b2tlbiB0byBiZSBjb25zaWRlcmVkLCByZWxhdGl2ZSB0byB0aGUgcHJvYmFiaWxpdHkgb2YgdGhlIG1vc3QgbGlrZWx5IHRva2VuLiAoRGVmYXVsdDogMC4wKScpXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignMC4wJylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3AgfHwgREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMubWluX3ApXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBpbnB1dCB2YWx1ZSBhcyBhbiBpbnRlZ2VyXG4gICAgICAgICAgICBjb25zdCBmbG9hdFZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7IC8vIDEwIGlzIHRoZSByYWRpeCBwYXJhbWV0ZXIgdG8gZW5zdXJlIHBhcnNpbmcgaXMgZG9uZSBpbiBiYXNlIDEwXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERldGVybWluZSBpZiB0aGUgZmxvYXQgdmFsdWUgaXMgYW4gaW50ZWdlciAod2hvbGUgbnVtYmVyKVxuICAgICAgICAgICAgaWYgKGlzTmFOKGZsb2F0VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5taW5fcCA9IERFRkFVTFRfU0VUVElOR1MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pbl9wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLm1pbl9wID0gZmxvYXRWYWx1ZS50b0ZpeGVkKDIpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoYWR2YW5jZWRTZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgna2VlcF9hbGl2ZScpXG4gICAgLnNldERlc2MoJ0lmIHNldCB0byBhIHBvc2l0aXZlIGR1cmF0aW9uIChlLmcuIDIwbSwgMWhyIG9yIDMwKSwgdGhlIG1vZGVsIHdpbGwgc3RheSBsb2FkZWQgZm9yIHRoZSBwcm92aWRlZCBkdXJhdGlvbiBpbiBzZWNvbmRzLiBJZiBzZXQgdG8gYSBuZWdhdGl2ZSBkdXJhdGlvbiAoZS5nLiAtMSksIHRoZSBtb2RlbCB3aWxsIHN0YXkgbG9hZGVkIGluZGVmaW5pdGVseS4gSWYgc2V0IHRvIDAsIHRoZSBtb2RlbCB3aWxsIGJlIHVubG9hZGVkIGltbWVkaWF0ZWx5IG9uY2UgZmluaXNoZWQuIElmIG5vdCBzZXQsIHRoZSBtb2RlbCB3aWxsIHN0YXkgbG9hZGVkIGZvciA1IG1pbnV0ZXMgYnkgZGVmYXVsdC4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzMwcycpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLmtlZXBfYWxpdmUgfHwgREVGQVVMVF9TRVRUSU5HUy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMua2VlcF9hbGl2ZSlcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgLy8gUmVndWxhciBleHByZXNzaW9uIHRvIHZhbGlkYXRlIHRoZSBpbnB1dCB2YWx1ZSBhbmQgY2FwdHVyZSB0aGUgbnVtYmVyIGFuZCB1bml0XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHZhbHVlLm1hdGNoKC9eKC0/XFxkKykobXxocnxoKT8kLyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KG1hdGNoWzFdKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1bml0ID0gbWF0Y2hbMl07XG5cbiAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IHRvIHNlY29uZHMgYmFzZWQgb24gdGhlIHVuaXRcbiAgICAgICAgICAgICAgICBsZXQgc2Vjb25kcztcbiAgICAgICAgICAgICAgICBpZiAodW5pdCA9PT0gJ20nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBudW0gKiA2MDsgLy8gQ29udmVydCBtaW51dGVzIHRvIHNlY29uZHNcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVuaXQgPT09ICdocicgfHwgdW5pdCA9PT0gJ2gnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBudW0gKiAzNjAwOyAvLyBDb252ZXJ0IGhvdXJzIHRvIHNlY29uZHNcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gbnVtOyAvLyBBc3N1bWUgaXQncyBhbHJlYWR5IGluIHNlY29uZHMgaWYgbm8gdW5pdFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSB2YWx1ZSBpbiBzZWNvbmRzXG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5rZWVwX2FsaXZlID0gc2Vjb25kcy50b1N0cmluZygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgaW5wdXQgaXMgaW52YWxpZCwgcmV2ZXJ0IHRvIHRoZSBkZWZhdWx0IHNldHRpbmdcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuT2xsYW1hQ29ubmVjdGlvbi5vbGxhbWFQYXJhbWV0ZXJzLmtlZXBfYWxpdmUgPSBERUZBVUxUX1NFVFRJTkdTLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hUGFyYW1ldGVycy5rZWVwX2FsaXZlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxufSIsICJleHBvcnQgZnVuY3Rpb24gYWRkRGVzY3JpcHRpb25MaW5rKHRleHQ6IHN0cmluZywgbGluazogc3RyaW5nLCBleHRyYVdvcmRzOiBzdHJpbmcsIGlubmVyVGV4dDogc3RyaW5nKTogRG9jdW1lbnRGcmFnbWVudCB7XG4gICAgY29uc3QgZnJhZyA9IG5ldyBEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29uc3QgZGVzYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBkZXNjLmlubmVyVGV4dCA9IHRleHQgKyAnICc7XG4gICAgZnJhZy5hcHBlbmRDaGlsZChkZXNjKTtcblxuICAgIGNvbnN0IGFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICBhbmNob3IuaHJlZiA9IGxpbms7XG4gICAgYW5jaG9yLnRhcmdldCA9ICdfYmxhbmsnO1xuICAgIGFuY2hvci5yZWwgPSAnbm9vcGVuZXIgbm9yZWZlcnJlcic7XG4gICAgYW5jaG9yLmlubmVyVGV4dCA9IGlubmVyVGV4dDtcbiAgICBmcmFnLmFwcGVuZENoaWxkKGFuY2hvcik7XG5cbiAgICBjb25zdCBleHRyYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBleHRyYS5pbm5lclRleHQgPSAnICcgKyBleHRyYVdvcmRzO1xuICAgIGZyYWcuYXBwZW5kQ2hpbGQoZXh0cmEpO1xuXG4gICAgcmV0dXJuIGZyYWc7XG59IiwgImltcG9ydCB7IFNldHRpbmdUYWIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQk1PR1BUIGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IGFkZE9wZW5BSUNvbm5lY3Rpb25TZXR0aW5ncyB9IGZyb20gJy4vQVBJQ29ubmVjdGlvbnMvT3BlbkFJQ29ubmVjdGlvbnMnO1xuaW1wb3J0IHsgYWRkTWlzdHJhbENvbm5lY3Rpb25TZXR0aW5ncyB9IGZyb20gJy4vQVBJQ29ubmVjdGlvbnMvTWlzdHJhbENvbm5lY3Rpb25zJztcbmltcG9ydCB7IGFkZEdvb2dsZUdlbWluaUNvbm5lY3Rpb25TZXR0aW5ncyB9IGZyb20gJy4vQVBJQ29ubmVjdGlvbnMvR29vZ2xlR2VtaW5pQ29ubmVjdGlvbnMnO1xuaW1wb3J0IHsgYWRkQW50aHJvcGljQ29ubmVjdGlvblNldHRpbmdzIH0gZnJvbSAnLi9BUElDb25uZWN0aW9ucy9BbnRocm9waWNDb25uZWN0aW9ucyc7XG5pbXBvcnQgeyBhZGRPcGVuUm91dGVyQ29ubmVjdGlvblNldHRpbmdzIH0gZnJvbSAnLi9BUElDb25uZWN0aW9ucy9PcGVuUm91dGVyQ29ubmVjdGlvbnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gYWRkQVBJQ29ubmVjdGlvblNldHRpbmdzKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBCTU9HUFQsIFNldHRpbmdUYWI6IFNldHRpbmdUYWIpIHtcbiAgICBjb25zdCB0b2dnbGVTZXR0aW5nQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAndG9nZ2xlU2V0dGluZ0NvbnRhaW5lcicgfSk7XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdBUEkgQ29ubmVjdGlvbnMnIH0pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUFQSUNvbm5lY3Rpb25TZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUFQSUNvbm5lY3Rpb25TZXR0aW5ncyA9IGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1kb3duJyk7IC8vIE9wZW4gc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUFQSUNvbm5lY3Rpb25TZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgYWRkQW50aHJvcGljQ29ubmVjdGlvblNldHRpbmdzKHNldHRpbmdzQ29udGFpbmVyLCBwbHVnaW4sIFNldHRpbmdUYWIpO1xuICAgIGFkZEdvb2dsZUdlbWluaUNvbm5lY3Rpb25TZXR0aW5ncyhzZXR0aW5nc0NvbnRhaW5lciwgcGx1Z2luLCBTZXR0aW5nVGFiKTtcbiAgICBhZGRNaXN0cmFsQ29ubmVjdGlvblNldHRpbmdzKHNldHRpbmdzQ29udGFpbmVyLCBwbHVnaW4sIFNldHRpbmdUYWIpO1xuICAgIGFkZE9wZW5BSUNvbm5lY3Rpb25TZXR0aW5ncyhzZXR0aW5nc0NvbnRhaW5lciwgcGx1Z2luLCBTZXR0aW5nVGFiKTtcbiAgICBhZGRPcGVuUm91dGVyQ29ubmVjdGlvblNldHRpbmdzKHNldHRpbmdzQ29udGFpbmVyLCBwbHVnaW4sIFNldHRpbmdUYWIpO1xufVxuXG4iLCAiaW1wb3J0IHsgU2V0dGluZywgU2V0dGluZ1RhYiwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGZldGNoT3BlbkFJQmFzZU1vZGVscyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0ZldGNoTW9kZWxMaXN0JztcbmltcG9ydCBCTU9HUFQsIHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NyYy9tYWluJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZE9wZW5BSUNvbm5lY3Rpb25TZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHBsdWdpbjogQk1PR1BULCBTZXR0aW5nVGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnT3BlbkFJJyB9KTtcblxuICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy50b2dnbGVPcGVuQUlTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZU9wZW5BSVNldHRpbmdzID0gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlT3BlbkFJU2V0dGluZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdPcGVuQUkgQVBJIEtleScpXG4gICAgLnNldERlc2MoJ0luc2VydCBPcGVuQUkgQVBJIEtleS4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2luc2VydC1hcGkta2V5JylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuQVBJS2V5ID8gYCR7cGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5BUElLZXkuc2xpY2UoMCwgNyl9LS4uLiR7cGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5BUElLZXkuc2xpY2UoLTQpfWAgOiAnJylcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzID0gW107XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLkFQSUtleSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuQVBJS2V5ID09PSAnJykge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZU1vZGVscyA9IFtdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaE9wZW5BSUJhc2VNb2RlbHMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICBtb2RlbHMuZm9yRWFjaCgobW9kZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMucHVzaChtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdPcGVuQUktQmFzZWQgVVJMJylcbiAgICAgICAgLnNldERlc2MoJ0VudGVyIHlvdXIgY3VzdG9tIE9wZW5BSS1CYXNlZCBVUkwuJylcbiAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0JylcbiAgICAgICAgICAgIC5zZXRJY29uKCdyb3RhdGUtY3cnKVxuICAgICAgICAgICAgLnNldENsYXNzKCdjbGlja2FibGUtaWNvbicpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzID0gW107XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsID0gREVGQVVMVF9TRVRUSU5HUy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZVVybDtcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJylcbiAgICAgICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VVcmwgfHwgREVGQVVMVF9TRVRUSU5HUy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZVVybClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsID0gdmFsdWUgPyB2YWx1ZSA6IERFRkFVTFRfU0VUVElOR1MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VVcmw7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdFbmFibGUgU3RyZWFtJylcbiAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBzdHJlYW0gZm9yIE9wZW5BSS1CYXNlZCBtb2RlbHMuJylcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuQUkuZW5hYmxlU3RyZWFtKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLmVuYWJsZVN0cmVhbSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG59IiwgImltcG9ydCB7IFNldHRpbmcsIFNldHRpbmdUYWIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBmZXRjaE1pc3RyYWxNb2RlbHMgfSBmcm9tICdzcmMvY29tcG9uZW50cy9GZXRjaE1vZGVsTGlzdCc7XG5pbXBvcnQgQk1PR1BUIGZyb20gJ3NyYy9tYWluJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZE1pc3RyYWxDb25uZWN0aW9uU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ01pc3RyYWwgQUknIH0pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZU1pc3RyYWxTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZU1pc3RyYWxTZXR0aW5ncyA9IGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1kb3duJyk7IC8vIE9wZW4gc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZU1pc3RyYWxTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ01pc3RyYWwgQVBJIEtleScpXG4gICAgLnNldERlc2MoJ0luc2VydCBNaXN0cmFsIEFQSSBLZXkuJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdpbnNlcnQtYXBpLWtleScpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5BUElLZXkgPyBgJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5BUElLZXkuc2xpY2UoMCwgNil9LS4uLiR7cGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuQVBJS2V5LnNsaWNlKC00KX1gIDogJycpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLm1pc3RyYWxNb2RlbHMgPSBbXTtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLkFQSUtleSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLkFQSUtleSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaE1pc3RyYWxNb2RlbHMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICBtb2RlbHMuZm9yRWFjaCgobW9kZWw6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5taXN0cmFsLm1pc3RyYWxNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLnB1c2gobW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdFbmFibGUgU3RyZWFtJylcbiAgICAuc2V0RGVzYygnRW5hYmxlIHN0cmVhbSBmb3IgTWlzdHJhbCBtb2RlbHMuJylcbiAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5lbmFibGVTdHJlYW0pLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm1pc3RyYWwuZW5hYmxlU3RyZWFtID0gdmFsdWU7XG4gICAgICAgICAgICBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgKTtcbn0iLCAiaW1wb3J0IHsgU2V0dGluZywgU2V0dGluZ1RhYiwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGZldGNoR29vZ2xlR2VtaW5pTW9kZWxzIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvRmV0Y2hNb2RlbExpc3QnO1xuaW1wb3J0IEJNT0dQVCBmcm9tICdzcmMvbWFpbic7XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRHb29nbGVHZW1pbmlDb25uZWN0aW9uU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0dvb2dsZSBHZW1pbmknIH0pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUdvb2dsZUdlbWluaVNldHRpbmdzO1xuICAgIGNvbnN0IGNoZXZyb25JY29uID0gdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAnY2hldnJvbi1pY29uJyB9KTtcbiAgICBzZXRJY29uKGNoZXZyb25JY29uLCBpbml0aWFsU3RhdGUgPyAnY2hldnJvbi1kb3duJyA6ICdjaGV2cm9uLXJpZ2h0Jyk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHNldHRpbmdzIGNvbnRhaW5lciB0byBiZSB0b2dnbGVkXG4gICAgY29uc3Qgc2V0dGluZ3NDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5nc0NvbnRhaW5lcicgfSk7XG4gICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGluaXRpYWxTdGF0ZSA/ICdibG9jaycgOiAnbm9uZSc7XG5cbiAgICAvLyBUb2dnbGUgdmlzaWJpbGl0eVxuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzT3BlbiA9IHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcbiAgICAgICAgaWYgKGlzT3Blbikge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tcmlnaHQnKTsgLy8gQ2xvc2Ugc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlR29vZ2xlR2VtaW5pU2V0dGluZ3MgPSBmYWxzZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tZG93bicpOyAvLyBPcGVuIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVHb29nbGVHZW1pbmlTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ0dvb2dsZSBHZW1pbmkgQVBJIEtleScpXG4gICAgLnNldERlc2MoJ0luc2VydCBHb29nbGUgR2VtaW5pIEFQSSBLZXkuJylcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdpbnNlcnQtYXBpLWtleScpXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLkFQSUtleSA/IGAke3BsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuQVBJS2V5LnNsaWNlKDAsIDYpfS0uLi4ke3BsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuQVBJS2V5LnNsaWNlKC00KX1gIDogJycpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzID0gW107XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLkFQSUtleSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuQVBJS2V5ID09PSAnJykge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaEdvb2dsZUdlbWluaU1vZGVscyhwbHVnaW4pO1xuICAgICAgICAgICAgICAgIG1vZGVscy5mb3JFYWNoKChtb2RlbDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5nZW1pbmlNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmdlbWluaU1vZGVscy5wdXNoKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnRW5hYmxlIFN0cmVhbScpXG4gICAgLnNldERlc2MoJ0VuYWJsZSBHb29nbGUgR2VtaW5pIG1vZGVscyB0byBzdHJlYW0gcmVzcG9uc2UuJylcbiAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmVuYWJsZVN0cmVhbSkub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmVuYWJsZVN0cmVhbSA9IHZhbHVlO1xuICAgICAgICAgICAgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICk7XG59IiwgImltcG9ydCB7IFNldHRpbmcsIFNldHRpbmdUYWIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQk1PR1BUIGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IEFOVEhST1BJQ19NT0RFTFMgfSBmcm9tICdzcmMvdmlldyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRBbnRocm9waWNDb25uZWN0aW9uU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0FudGhyb3BpYycgfSk7XG5cbiAgICBjb25zdCBpbml0aWFsU3RhdGUgPSBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlQW50aHJvcGljU2V0dGluZ3M7XG4gICAgY29uc3QgY2hldnJvbkljb24gPSB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdjaGV2cm9uLWljb24nIH0pO1xuICAgIHNldEljb24oY2hldnJvbkljb24sIGluaXRpYWxTdGF0ZSA/ICdjaGV2cm9uLWRvd24nIDogJ2NoZXZyb24tcmlnaHQnKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgc2V0dGluZ3MgY29udGFpbmVyIHRvIGJlIHRvZ2dsZWRcbiAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzQ29udGFpbmVyJyB9KTtcbiAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaW5pdGlhbFN0YXRlID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIFRvZ2dsZSB2aXNpYmlsaXR5XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXNPcGVuID0gc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1yaWdodCcpOyAvLyBDbG9zZSBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVBbnRocm9waWNTZXR0aW5ncyA9IGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1kb3duJyk7IC8vIE9wZW4gc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUFudGhyb3BpY1NldHRpbmdzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnQW50aHJvcGljIEFQSSBLZXknKVxuICAgIC5zZXREZXNjKCdJbnNlcnQgQW50aHJvcGljIEFQSSBLZXkuIFdhcm5pbmc6IEFudGhyb3BpYyBtb2RlbHMgY2Fubm90IGJlIGFib3J0ZWQuIFBsZWFzZSB1c2Ugd2l0aCBjYXV0aW9uLicpXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignaW5zZXJ0LWFwaS1rZXknKVxuICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5BUElLZXkgPyBgJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleS5zbGljZSgwLCA2KX0tLi4uJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleS5zbGljZSgtNCl9YCA6ICcnKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLmFudGhyb3BpY01vZGVscyA9IFtdO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5BUElLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLmFudGhyb3BpY01vZGVscyA9IFtdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBBTlRIUk9QSUNfTU9ERUxTO1xuICAgICAgICAgICAgICAgIG1vZGVscy5mb3JFYWNoKChtb2RlbDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmFudGhyb3BpYy5hbnRocm9waWNNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLmFudGhyb3BpY01vZGVscy5wdXNoKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG59XG4iLCAiaW1wb3J0IHsgU2V0dGluZywgU2V0dGluZ1RhYiwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGZldGNoT3BlblJvdXRlck1vZGVscyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0ZldGNoTW9kZWxMaXN0JztcbmltcG9ydCBCTU9HUFQgZnJvbSAnc3JjL21haW4nO1xuXG5leHBvcnQgZnVuY3Rpb24gYWRkT3BlblJvdXRlckNvbm5lY3Rpb25TZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHBsdWdpbjogQk1PR1BULCBTZXR0aW5nVGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnT3BlblJvdXRlcicgfSk7XG5cbiAgICBjb25zdCBpbml0aWFsU3RhdGUgPSBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlT3BlblJvdXRlclNldHRpbmdzO1xuICAgIGNvbnN0IGNoZXZyb25JY29uID0gdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAnY2hldnJvbi1pY29uJyB9KTtcbiAgICBzZXRJY29uKGNoZXZyb25JY29uLCBpbml0aWFsU3RhdGUgPyAnY2hldnJvbi1kb3duJyA6ICdjaGV2cm9uLXJpZ2h0Jyk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHNldHRpbmdzIGNvbnRhaW5lciB0byBiZSB0b2dnbGVkXG4gICAgY29uc3Qgc2V0dGluZ3NDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5nc0NvbnRhaW5lcicgfSk7XG4gICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGluaXRpYWxTdGF0ZSA/ICdibG9jaycgOiAnbm9uZSc7XG5cbiAgICAvLyBUb2dnbGUgdmlzaWJpbGl0eVxuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzT3BlbiA9IHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcbiAgICAgICAgaWYgKGlzT3Blbikge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tcmlnaHQnKTsgLy8gQ2xvc2Ugc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlT3BlblJvdXRlclNldHRpbmdzID0gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlT3BlblJvdXRlclNldHRpbmdzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnT3BlblJvdXRlciBBUEkgS2V5JylcbiAgICAuc2V0RGVzYygnSW5zZXJ0IE9wZW5Sb3V0ZXIgQVBJIEtleS4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2luc2VydC1hcGkta2V5JylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLkFQSUtleSA/IGAke3BsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLkFQSUtleS5zbGljZSgwLCA2KX0tLi4uJHtwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXkuc2xpY2UoLTQpfWAgOiAnJylcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzID0gW107XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXkgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIub3BlblJvdXRlck1vZGVscyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gYXdhaXQgZmV0Y2hPcGVuUm91dGVyTW9kZWxzKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgbW9kZWxzLmZvckVhY2goKG1vZGVsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5vcGVuUm91dGVyTW9kZWxzLmluY2x1ZGVzKG1vZGVsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIub3BlblJvdXRlck1vZGVscy5wdXNoKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAuc2V0TmFtZSgnRW5hYmxlIFN0cmVhbScpXG4gICAgLnNldERlc2MoJ0VuYWJsZSBzdHJlYW0gZm9yIE9wZW5Sb3V0ZXIgbW9kZWxzLicpXG4gICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICB0b2dnbGUuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5Sb3V0ZXIuZW5hYmxlU3RyZWFtKS5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLmVuYWJsZVN0cmVhbSA9IHZhbHVlO1xuICAgICAgICAgICAgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICk7XG59IiwgImltcG9ydCB7IFNldHRpbmcsIFNldHRpbmdUYWIsIFRGaWxlLCBURm9sZGVyLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEJNT0dQVCwgeyBERUZBVUxUX1NFVFRJTkdTLCB1cGRhdGVTZXR0aW5nc0Zyb21Gcm9udE1hdHRlciB9IGZyb20gJ3NyYy9tYWluJztcblxuXG4vLyBQcm9maWxlIFNldHRpbmdzXG5leHBvcnQgZnVuY3Rpb24gYWRkUHJvZmlsZVNldHRpbmdzKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBCTU9HUFQsIFNldHRpbmdUYWI6IFNldHRpbmdUYWIpIHtcbiAgICBjb25zdCB0b2dnbGVTZXR0aW5nQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAndG9nZ2xlU2V0dGluZ0NvbnRhaW5lcicgfSk7XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1Byb2ZpbGVzJ30pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZVByb2ZpbGVTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZVByb2ZpbGVTZXR0aW5ncyA9IGZhbHNlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1kb3duJyk7IC8vIE9wZW4gc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZVByb2ZpbGVTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ1Byb2ZpbGUnKVxuICAgIC5zZXREZXNjKCdTZWxlY3QgYSBwcm9maWxlLicpXG4gICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblxuICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLnByb2ZpbGVzLnByb2ZpbGVGb2xkZXJQYXRoICE9PSAnJykge1xuICAgICAgICAgICAgLy8gRmV0Y2hpbmcgZmlsZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGZvbGRlclxuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLnBhdGguc3RhcnRzV2l0aChwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGgpKTtcbiAgICAgICAgXG4gICAgICAgICAgICAvLyBTb3J0aW5nIHRoZSBmaWxlcyBhcnJheSBhbHBoYWJldGljYWxseSBieSBmaWxlIG5hbWVcbiAgICAgICAgICAgIGZpbGVzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xuICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGRhdGFGb2xkZXJQYXRoID0gJy4vLm9ic2lkaWFuL3BsdWdpbnMvYm1vLWNoYXRib3QvZGF0YS8nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRhdGFGb2xkZXJQYXRoKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5ta2RpcihkYXRhRm9sZGVyUGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgZmlsZXMuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWxlTmFtZSA9IGBtZXNzYWdlSGlzdG9yeV8ke2ZpbGVOYW1lfS5qc29uYDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3RmlsZVBhdGggPSBgJHtkYXRhRm9sZGVyUGF0aH0ke25ld0ZpbGVOYW1lfWA7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYXBwLnZhdWx0LmNyZWF0ZShuZXdGaWxlUGF0aCwgJycpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZmlsZSBhbHJlYWR5IGV4aXN0cywgbG9nIGEgbWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVyci5tZXNzYWdlID09PSAnRmlsZSBhbHJlYWR5IGV4aXN0cy4nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEZpbGUgJHtuZXdGaWxlUGF0aH0gYWxyZWFkeSBleGlzdHMuIFNraXBwaW5nIGNyZWF0aW9uLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgYW55IG90aGVyIGVycm9yLCByZXRocm93IGl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGRpbmcgdGhlIGZpbGUgbmFtZSBhcyBhIGRyb3Bkb3duIG9wdGlvblxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oZmlsZS5uYW1lLCBmaWxlTmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGRyb3Bkb3duXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZSB8fCBERUZBVUxUX1NFVFRJTkdTLnByb2ZpbGVzLnByb2ZpbGUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlID0gdmFsdWUgPyB2YWx1ZSA6IERFRkFVTFRfU0VUVElOR1MucHJvZmlsZXMucHJvZmlsZTtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVGaWxlUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCArICcvJyArIHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFByb2ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwcm9maWxlRmlsZVBhdGgpIGFzIFRGaWxlO1xuICAgICAgICAgICAgcGx1Z2luLmFjdGl2YXRlVmlldygpO1xuICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZ3NGcm9tRnJvbnRNYXR0ZXIocGx1Z2luLCBjdXJyZW50UHJvZmlsZSk7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhzZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldE5hbWUoJ1Byb2ZpbGUgRm9sZGVyIFBhdGgnKVxuICAgICAgICAuc2V0RGVzYygnU2VsZWN0IGEgcHJvZmlsZSBmcm9tIGEgc3BlY2lmaWVkIGZvbGRlci4nKVxuICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignQk1PL1Byb2ZpbGVzJylcbiAgICAgICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGggfHwgREVGQVVMVF9TRVRUSU5HUy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGggPSB2YWx1ZSA/IHZhbHVlIDogREVGQVVMVF9TRVRUSU5HUy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aDtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZvbGRlclBhdGggPSBwbHVnaW4uc2V0dGluZ3MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGgudHJpbSgpIHx8IERFRkFVTFRfU0VUVElOR1MucHJvZmlsZXMucHJvZmlsZUZvbGRlclBhdGg7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdHJhaWxpbmcgJy8nIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZm9sZGVyUGF0aC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2xkZXJQYXRoID0gZm9sZGVyUGF0aC5zdWJzdHJpbmcoMCwgZm9sZGVyUGF0aC5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5wcm9maWxlcy5wcm9maWxlRm9sZGVyUGF0aCA9IGZvbGRlclBhdGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvbGRlciA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvbGRlciAmJiBmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAnJzsgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAncmVkJzsgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIFNldHRpbmdUYWIuZGlzcGxheSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbn0iLCAiaW1wb3J0IHsgU2V0dGluZywgU2V0dGluZ1RhYiwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBCTU9HUFQsIHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IGFkZERlc2NyaXB0aW9uTGluayB9IGZyb20gJ3NyYy91dGlscy9EZXNjcmlwdGlvbkxpbmsnO1xuaW1wb3J0IHsgZmV0Y2hSRVNUQVBJVVJMTW9kZWxzIH0gZnJvbSAnLi4vRmV0Y2hNb2RlbExpc3QnO1xuXG4vLyBPcGVuQUktQmFzZWQgUkVTVCBBUEkgVVJMIENvbm5lY3Rpb24gU2V0dGluZ3NcbmV4cG9ydCBmdW5jdGlvbiBhZGRSRVNUQVBJVVJMU2V0dGluZ3MoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwbHVnaW46IEJNT0dQVCwgU2V0dGluZ1RhYjogU2V0dGluZ1RhYikge1xuICAgIGNvbnN0IHRvZ2dsZVNldHRpbmdDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICd0b2dnbGVTZXR0aW5nQ29udGFpbmVyJyB9KTtcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnUkVTVCBBUEkgQ29ubmVjdGlvbid9KTtcblxuICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy50b2dnbGVSRVNUQVBJVVJMU2V0dGluZ3M7XG4gICAgY29uc3QgY2hldnJvbkljb24gPSB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdjaGV2cm9uLWljb24nIH0pO1xuICAgIHNldEljb24oY2hldnJvbkljb24sIGluaXRpYWxTdGF0ZSA/ICdjaGV2cm9uLWRvd24nIDogJ2NoZXZyb24tcmlnaHQnKTtcblxuICAgIC8vIENyZWF0ZSB0aGUgc2V0dGluZ3MgY29udGFpbmVyIHRvIGJlIHRvZ2dsZWRcbiAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NldHRpbmdzQ29udGFpbmVyJyB9KTtcbiAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaW5pdGlhbFN0YXRlID8gJ2Jsb2NrJyA6ICdub25lJztcblxuICAgIC8vIFRvZ2dsZSB2aXNpYmlsaXR5XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXNPcGVuID0gc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBzZXRJY29uKGNoZXZyb25JY29uLCAnY2hldnJvbi1yaWdodCcpOyAvLyBDbG9zZSBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVSRVNUQVBJVVJMU2V0dGluZ3MgPSBmYWxzZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tZG93bicpOyAvLyBPcGVuIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVSRVNUQVBJVVJMU2V0dGluZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdBUEkgS2V5JylcbiAgICAuc2V0RGVzYygnSW5zZXJ0IEFQSSBLZXkgKE9wdGlvbmFsKS4nKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2luc2VydC1hcGkta2V5JylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5BUElLZXkgPyBgJHtwbHVnaW4uc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uQVBJS2V5LnNsaWNlKDAsIDYpfS0uLi4ke3BsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5BUElLZXkuc2xpY2UoLTQpfWAgOiAnJylcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMgPSBbXTtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5BUElLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBTZXR0aW5nVGFiLmRpc3BsYXkoKTtcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ1JFU1QgQVBJIFVSTCcpXG4gICAgLnNldERlc2MoYWRkRGVzY3JpcHRpb25MaW5rKCdFTlRFUiBZT1VSIFJFU1QgQVBJIFVSTC4nLCAnaHR0cHM6Ly9naXRodWIuY29tL2xvbmd5Mmsvb2JzaWRpYW4tYm1vLWNoYXRib3Qvd2lraS9Ib3ctdG8tc2V0dXAtd2l0aC1MTS1TdHVkaW8nLCAnJywgJ1tJbnN0cnVjdGlvbnNdJykpXG4gICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cDovL2xvY2FsaG9zdDoxMjM0L3YxJylcbiAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMIHx8IERFRkFVTFRfU0VUVElOR1MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMTW9kZWxzID0gW107XG4gICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkwgPSB2YWx1ZSA/IHZhbHVlIDogREVGQVVMVF9TRVRUSU5HUy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMO1xuICAgICAgICAgICAgICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTCA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMgPSBbXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBhd2FpdCBmZXRjaFJFU1RBUElVUkxNb2RlbHMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxzLmZvckVhY2goKG1vZGVsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMuaW5jbHVkZXMobW9kZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMucHVzaChtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgIC5zZXROYW1lKCdFbmFibGUgU3RyZWFtJylcbiAgICAuc2V0RGVzYyhhZGREZXNjcmlwdGlvbkxpbmsoJ0VuYWJsZSBSRVNUIEFQSSBtb2RlbHMgdG8gc3RyZWFtIHJlc3BvbnNlLicsICcnLCAnJywgJycpKVxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5lbmFibGVTdHJlYW0pLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLmVuYWJsZVN0cmVhbSA9IHZhbHVlO1xuICAgICAgICAgICAgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KVxuICAgICk7XG59IiwgImltcG9ydCB7IFNldHRpbmcsIFNldHRpbmdUYWIsIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQk1PR1BULCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICdzcmMvbWFpbic7XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEVkaXRvclNldHRpbmdzKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgcGx1Z2luOiBCTU9HUFQsIFNldHRpbmdUYWI6IFNldHRpbmdUYWIpIHtcbiAgICBjb25zdCB0b2dnbGVTZXR0aW5nQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAndG9nZ2xlU2V0dGluZ0NvbnRhaW5lcicgfSk7XG4gICAgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ0VkaXRvcid9KTtcblxuICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy50b2dnbGVFZGl0b3JTZXR0aW5ncztcbiAgICBjb25zdCBjaGV2cm9uSWNvbiA9IHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ2NoZXZyb24taWNvbicgfSk7XG4gICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgaW5pdGlhbFN0YXRlID8gJ2NoZXZyb24tZG93bicgOiAnY2hldnJvbi1yaWdodCcpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBzZXR0aW5ncyBjb250YWluZXIgdG8gYmUgdG9nZ2xlZFxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnc2V0dGluZ3NDb250YWluZXInIH0pO1xuICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpbml0aWFsU3RhdGUgPyAnYmxvY2snIDogJ25vbmUnO1xuXG4gICAgLy8gVG9nZ2xlIHZpc2liaWxpdHlcbiAgICB0b2dnbGVTZXR0aW5nQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc09wZW4gPSBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLXJpZ2h0Jyk7IC8vIENsb3NlIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnRvZ2dsZUVkaXRvclNldHRpbmdzID0gZmFsc2U7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldEljb24oY2hldnJvbkljb24sICdjaGV2cm9uLWRvd24nKTsgLy8gT3BlbiBzdGF0ZVxuICAgICAgICAgICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlRWRpdG9yU2V0dGluZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0TmFtZSgnRWRpdG9yIFN5c3RlbSBSb2xlJylcbiAgICAgICAgLnNldERlc2MoJ1N5c3RlbSByb2xlIGZvciBCTU8gR2VuZXJhdGUgYW5kIFxcJ1Byb21wdCBTZWxlY3QgR2VuZXJhdGVcXCcgY29tbWFuZC4nKVxuICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1lvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudC4nKVxuICAgICAgICAgICAgLnNldFZhbHVlKHBsdWdpbi5zZXR0aW5ncy5lZGl0b3Iuc3lzdGVuX3JvbGUgIT09IHVuZGVmaW5lZCA/IHBsdWdpbi5zZXR0aW5ncy5lZGl0b3Iuc3lzdGVuX3JvbGUgOiBERUZBVUxUX1NFVFRJTkdTLmVkaXRvci5zeXN0ZW5fcm9sZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MuZWRpdG9yLnN5c3Rlbl9yb2xlID0gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogREVGQVVMVF9TRVRUSU5HUy5lZGl0b3Iuc3lzdGVuX3JvbGU7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxufSIsICJpbXBvcnQgeyBTZXR0aW5nLCBTZXR0aW5nVGFiLCBURmlsZSwgVEZvbGRlciwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBCTU9HUFQsIHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NyYy9tYWluJztcblxuXG4vLyBQcm9tcHQgU2V0dGluZ3NcbmV4cG9ydCBmdW5jdGlvbiBhZGRQcm9tcHRTZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHBsdWdpbjogQk1PR1BULCBTZXR0aW5nVGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgY29uc3QgdG9nZ2xlU2V0dGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3RvZ2dsZVNldHRpbmdDb250YWluZXInIH0pO1xuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdQcm9tcHRzJ30pO1xuXG4gICAgY29uc3QgaW5pdGlhbFN0YXRlID0gcGx1Z2luLnNldHRpbmdzLnRvZ2dsZVByb21wdFNldHRpbmdzO1xuICAgIGNvbnN0IGNoZXZyb25JY29uID0gdG9nZ2xlU2V0dGluZ0NvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAnY2hldnJvbi1pY29uJyB9KTtcbiAgICBzZXRJY29uKGNoZXZyb25JY29uLCBpbml0aWFsU3RhdGUgPyAnY2hldnJvbi1kb3duJyA6ICdjaGV2cm9uLXJpZ2h0Jyk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIHNldHRpbmdzIGNvbnRhaW5lciB0byBiZSB0b2dnbGVkXG4gICAgY29uc3Qgc2V0dGluZ3NDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdzZXR0aW5nc0NvbnRhaW5lcicgfSk7XG4gICAgc2V0dGluZ3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGluaXRpYWxTdGF0ZSA/ICdibG9jaycgOiAnbm9uZSc7XG5cbiAgICAvLyBUb2dnbGUgdmlzaWJpbGl0eVxuICAgIHRvZ2dsZVNldHRpbmdDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzT3BlbiA9IHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcbiAgICAgICAgaWYgKGlzT3Blbikge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tcmlnaHQnKTsgLy8gQ2xvc2Ugc3RhdGVcbiAgICAgICAgICAgIHNldHRpbmdzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MudG9nZ2xlUHJvbXB0U2V0dGluZ3MgPSBmYWxzZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0SWNvbihjaGV2cm9uSWNvbiwgJ2NoZXZyb24tZG93bicpOyAvLyBPcGVuIHN0YXRlXG4gICAgICAgICAgICBzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy50b2dnbGVQcm9tcHRTZXR0aW5ncyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgLnNldE5hbWUoJ1Byb21wdCcpXG4gICAgLnNldERlc2MoJ1NlbGVjdCBhIHByb21wdCB0byBwcm92aWRlIGFkZGl0aW9uYWwgY29udGV4dCB0byB0aGUgc3lzdGVtIHJvbGUuJylcbiAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJycsICctLUVNUFRZLS0nKTtcblxuICAgICAgICBpZiAocGx1Z2luLnNldHRpbmdzLnByb21wdHMucHJvbXB0Rm9sZGVyUGF0aCAhPT0gJycpIHtcbiAgICAgICAgICAgIC8vIEZldGNoaW5nIGZpbGVzIGZyb20gdGhlIHNwZWNpZmllZCBmb2xkZXJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gcGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZmlsZSkgPT4gZmlsZS5wYXRoLnN0YXJ0c1dpdGgocGx1Z2luLnNldHRpbmdzLnByb21wdHMucHJvbXB0Rm9sZGVyUGF0aCkpO1xuICAgICAgICBcbiAgICAgICAgICAgIC8vIFNvcnRpbmcgdGhlIGZpbGVzIGFycmF5IGFscGhhYmV0aWNhbGx5IGJ5IGZpbGUgbmFtZVxuICAgICAgICAgICAgZmlsZXMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICAgICBmaWxlcy5mb3JFYWNoKChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkaW5nIHRoZSBmaWxlIG5hbWUgYXMgYSBkcm9wZG93biBvcHRpb25cbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKGZpbGUubmFtZSwgZmlsZU5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgb3B0aW9uIHRvIHRoZSBlbXB0eSBvbmVcbiAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUoJycpO1xuXG4gICAgICAgIGRyb3Bkb3duXG4gICAgICAgIC5zZXRWYWx1ZShwbHVnaW4uc2V0dGluZ3MucHJvbXB0cy5wcm9tcHQgfHwgREVGQVVMVF9TRVRUSU5HUy5wcm9tcHRzLnByb21wdClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnByb21wdHMucHJvbXB0ID0gdmFsdWUgPyB2YWx1ZSA6IERFRkFVTFRfU0VUVElOR1MucHJvbXB0cy5wcm9tcHQ7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIFxuICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoc2V0dGluZ3NDb250YWluZXIpXG4gICAgICAgIC5zZXROYW1lKCdQcm9tcHQgRm9sZGVyIFBhdGgnKVxuICAgICAgICAuc2V0RGVzYygnU2VsZWN0IGEgcHJvbXB0IGZyb20gYSBzcGVjaWZpZWQgZm9sZGVyLicpXG4gICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdCTU8vUHJvbXB0cycpXG4gICAgICAgICAgICAuc2V0VmFsdWUocGx1Z2luLnNldHRpbmdzLnByb21wdHMucHJvbXB0Rm9sZGVyUGF0aCB8fCBERUZBVUxUX1NFVFRJTkdTLnByb21wdHMucHJvbXB0Rm9sZGVyUGF0aClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MucHJvbXB0cy5wcm9tcHRGb2xkZXJQYXRoID0gdmFsdWUgPyB2YWx1ZSA6IERFRkFVTFRfU0VUVElOR1MucHJvbXB0cy5wcm9tcHRGb2xkZXJQYXRoO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZm9sZGVyUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5wcm9tcHRzLnByb21wdEZvbGRlclBhdGgudHJpbSgpIHx8IERFRkFVTFRfU0VUVElOR1MucHJvbXB0cy5wcm9tcHRGb2xkZXJQYXRoO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRyYWlsaW5nICcvJyBpZiBpdCBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGZvbGRlclBhdGguZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9sZGVyUGF0aCA9IGZvbGRlclBhdGguc3Vic3RyaW5nKDAsIGZvbGRlclBhdGgubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3MucHJvbXB0cy5wcm9tcHRGb2xkZXJQYXRoID0gZm9sZGVyUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9sZGVyICYmIGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5ib3JkZXJDb2xvciA9ICcnOyBcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5ib3JkZXJDb2xvciA9ICdyZWQnOyBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgU2V0dGluZ1RhYi5kaXNwbGF5KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xufSIsICJpbXBvcnQgQk1PR1BULCB7IEJNT1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc3JjL21haW4nO1xuaW1wb3J0IHsgZmV0Y2hNb2RlbFJlbmFtZVRpdGxlIH0gZnJvbSAnLi9GZXRjaFJlbmFtZU5vdGVUaXRsZSc7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFOVEhST1BJQ19NT0RFTFMsIE9QRU5BSV9NT0RFTFMgfSBmcm9tICdzcmMvdmlldyc7XG5pbXBvcnQgeyBmZXRjaE9wZW5BSUJhc2VBUElSZXNwb25zZUVkaXRvciwgZmV0Y2hPbGxhbWFSZXNwb25zZUVkaXRvciwgZmV0Y2hSRVNUQVBJVVJMRGF0YUVkaXRvciwgZmV0Y2hBbnRocm9waWNSZXNwb25zZUVkaXRvciwgZmV0Y2hNaXN0cmFsRGF0YUVkaXRvciwgZmV0Y2hHb29nbGVHZW1pbmlEYXRhRWRpdG9yLCBmZXRjaE9wZW5Sb3V0ZXJFZGl0b3IgfSBmcm9tICcuLi9GZXRjaE1vZGVsRWRpdG9yJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmFtZVRpdGxlQ29tbWFuZChwbHVnaW46IEJNT0dQVCwgc2V0dGluZ3M6IEJNT1NldHRpbmdzKSB7XG4gICAgbGV0IHVuaXF1ZU5hbWVGb3VuZCA9IGZhbHNlO1xuICAgIGxldCBtb2RlbFJlbmFtZVRpdGxlO1xuICAgIGxldCBmb2xkZXJOYW1lID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpPy5wYXRoIHx8ICcnKT8ucGFyZW50Py5wYXRoIHx8ICcnO1xuICAgIGNvbnN0IGZpbGVFeHRlbnNpb24gPSAnLm1kJztcbiAgICBjb25zdCBhbGxGaWxlcyA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0RmlsZXMoKTsgLy8gUmV0cmlldmUgYWxsIGZpbGVzIGZyb20gdGhlIHZhdWx0XG4gICAgY29uc3QgYWN0aXZlRmlsZSA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICBsZXQgZmlsZUNvbnRlbnQgPSAnJztcbiAgXG4gICAgdHJ5IHtcbiAgICAgICAgbmV3IE5vdGljZSgnR2VuZXJhdGluZyB0aXRsZS4uLicpO1xuXG4gICAgICAgIGlmIChhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICBmaWxlQ29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICBpZiAoZm9sZGVyTmFtZSAmJiAhZm9sZGVyTmFtZS5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgIGZvbGRlck5hbWUgKz0gJy8nO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgZmlsZSBuYW1lIGFscmVhZHkgZXhpc3RzXG4gICAgICAgIGNvbnN0IGZpbGVOYW1lRXhpc3RzID0gKG5hbWU6IHN0cmluZyB8IG51bGwpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhbGxGaWxlcy5zb21lKChmaWxlKSA9PiBmaWxlLnBhdGggPT09IGZvbGRlck5hbWUgKyBuYW1lICsgZmlsZUV4dGVuc2lvbik7XG4gICAgICAgIH07XG4gICAgXG4gICAgICAgIHdoaWxlICghdW5pcXVlTmFtZUZvdW5kKSB7XG4gICAgICAgICAgICBtb2RlbFJlbmFtZVRpdGxlID0gYXdhaXQgZmV0Y2hNb2RlbFJlbmFtZVRpdGxlKHNldHRpbmdzLCBmaWxlQ29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYgKCFmaWxlTmFtZUV4aXN0cyhtb2RlbFJlbmFtZVRpdGxlKSkge1xuICAgICAgICAgICAgICAgIHVuaXF1ZU5hbWVGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmb2xkZXJOYW1lICsgbW9kZWxSZW5hbWVUaXRsZSArIGZpbGVFeHRlbnNpb247XG4gICAgXG4gICAgICAgIGlmIChhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICBwbHVnaW4uYXBwLnZhdWx0LnJlbmFtZShhY3RpdmVGaWxlLCBmaWxlTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgTm90aWNlKCdSZW5hbWVkIG5vdGUgdGl0bGUuJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfVxufVxuXG4vLyBQcm9tcHQgKyBTZWxlY3QgKyBHZW5lcmF0ZSBjb21tYW5kXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvbXB0U2VsZWN0R2VuZXJhdGVDb21tYW5kKHBsdWdpbjogQk1PR1BULCBzZXR0aW5nczogQk1PU2V0dGluZ3MpIHtcbiAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgIGNvbnN0IHNlbGVjdCA9IHZpZXc/LmVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICBpZiAodmlldyAmJiBzZWxlY3QgJiYgc2VsZWN0LnRyaW0oKSAhPT0gJycpIHtcbiAgICAgICAgY29uc3QgZ2VuZXJhdGluZ05vdGljZSA9IG5ldyBOb3RpY2UoJ0dlbmVyYXRpbmcuLi4nLCAwKTtcbiAgICAgICAgaWYgKHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24uUkVTVEFQSVVSTCAmJiBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoT2xsYW1hUmVzcG9uc2VFZGl0b3Ioc2V0dGluZ3MsIHNlbGVjdCk7IFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHdpdGggdGhlIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yU3RhcnQgPSB2aWV3LmVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHJlc3BvbnNlID8/ICdFUlJPUicpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb24gYmFzZWQgb24gdGhlIGxlbmd0aCBvZiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JFbmQgPSB7IFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3JTdGFydC5saW5lLCBcbiAgICAgICAgICAgICAgICAgICAgY2g6IGN1cnNvclN0YXJ0LmNoICsgKHJlc3BvbnNlID8/ICdFUlJPUicpLmxlbmd0aCBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgbmV3IHRleHQgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRTZWxlY3Rpb24oY3Vyc29yU3RhcnQsIGN1cnNvckVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjb21wbGV0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTCAmJiBzZXR0aW5ncy5SRVNUQVBJVVJMQ29ubmVjdGlvbi5SRVNUQVBJVVJMTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKXtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaFJFU1RBUElVUkxEYXRhRWRpdG9yKHNldHRpbmdzLCBzZWxlY3QpOyBcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB3aXRoIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvclN0YXJ0ID0gdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvbiBiYXNlZCBvbiB0aGUgbGVuZ3RoIG9mIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvckVuZCA9IHsgXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvclN0YXJ0LmxpbmUsIFxuICAgICAgICAgICAgICAgICAgICBjaDogY3Vyc29yU3RhcnQuY2ggKyByZXNwb25zZT8ubGVuZ3RoIFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSBuZXcgdGV4dCBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFNlbGVjdGlvbihjdXJzb3JTdGFydCwgY3Vyc29yRW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGNvbXBsZXRpb246ICcgKyBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChBTlRIUk9QSUNfTU9ERUxTLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hBbnRocm9waWNSZXNwb25zZUVkaXRvcihzZXR0aW5ncywgc2VsZWN0KTsgXG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjb21wbGV0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuZ29vZ2xlR2VtaW5pLmdlbWluaU1vZGVscy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoR29vZ2xlR2VtaW5pRGF0YUVkaXRvcihzZXR0aW5ncywgc2VsZWN0KTsgXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgY3VycmVudCBzZWxlY3Rpb24gd2l0aCB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JTdGFydCA9IHZpZXcuZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24ocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb24gYmFzZWQgb24gdGhlIGxlbmd0aCBvZiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JFbmQgPSB7IFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3JTdGFydC5saW5lLCBcbiAgICAgICAgICAgICAgICAgICAgY2g6IGN1cnNvclN0YXJ0LmNoICsgcmVzcG9uc2U/Lmxlbmd0aCBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgbmV3IHRleHQgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRTZWxlY3Rpb24oY3Vyc29yU3RhcnQsIGN1cnNvckVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjb21wbGV0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLmluY2x1ZGVzKHNldHRpbmdzLmdlbmVyYWwubW9kZWwpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hNaXN0cmFsRGF0YUVkaXRvcihzZXR0aW5ncywgc2VsZWN0KTsgXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgY3VycmVudCBzZWxlY3Rpb24gd2l0aCB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JTdGFydCA9IHZpZXcuZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24ocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb24gYmFzZWQgb24gdGhlIGxlbmd0aCBvZiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JFbmQgPSB7IFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3JTdGFydC5saW5lLCBcbiAgICAgICAgICAgICAgICAgICAgY2g6IGN1cnNvclN0YXJ0LmNoICsgcmVzcG9uc2U/Lmxlbmd0aCBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgbmV3IHRleHQgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRTZWxlY3Rpb24oY3Vyc29yU3RhcnQsIGN1cnNvckVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjb21wbGV0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoT1BFTkFJX01PREVMUy5pbmNsdWRlcyhzZXR0aW5ncy5nZW5lcmFsLm1vZGVsKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoT3BlbkFJQmFzZUFQSVJlc3BvbnNlRWRpdG9yKHNldHRpbmdzLCBzZWxlY3QpOyBcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB3aXRoIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvclN0YXJ0ID0gdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyZXNwb25zZSB8fCAnJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvbiBiYXNlZCBvbiB0aGUgbGVuZ3RoIG9mIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvckVuZCA9IHsgXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvclN0YXJ0LmxpbmUsIFxuICAgICAgICAgICAgICAgICAgICBjaDogY3Vyc29yU3RhcnQuY2ggKyAocmVzcG9uc2U/Lmxlbmd0aCA/PyAwKVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSBuZXcgdGV4dCBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFNlbGVjdGlvbihjdXJzb3JTdGFydCwgY3Vyc29yRW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGNvbXBsZXRpb246ICcgKyBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VVcmwgIT0gREVGQVVMVF9TRVRUSU5HUy5BUElDb25uZWN0aW9ucy5vcGVuQUkub3BlbkFJQmFzZVVybCkgJiYgc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLm9wZW5BSUJhc2VNb2RlbHMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpe1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoT3BlbkFJQmFzZUFQSVJlc3BvbnNlRWRpdG9yKHNldHRpbmdzLCBzZWxlY3QpOyBcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB3aXRoIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvclN0YXJ0ID0gdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyZXNwb25zZSB8fCAnJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvbiBiYXNlZCBvbiB0aGUgbGVuZ3RoIG9mIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvckVuZCA9IHsgXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvclN0YXJ0LmxpbmUsIFxuICAgICAgICAgICAgICAgICAgICBjaDogY3Vyc29yU3RhcnQuY2ggKyAocmVzcG9uc2U/Lmxlbmd0aCA/PyAwKVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSBuZXcgdGV4dCBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFNlbGVjdGlvbihjdXJzb3JTdGFydCwgY3Vyc29yRW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGNvbXBsZXRpb246ICcgKyBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMuaW5jbHVkZXMoc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCkpe1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoT3BlblJvdXRlckVkaXRvcihzZXR0aW5ncywgc2VsZWN0KTsgXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgY3VycmVudCBzZWxlY3Rpb24gd2l0aCB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JTdGFydCA9IHZpZXcuZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24ocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb24gYmFzZWQgb24gdGhlIGxlbmd0aCBvZiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JFbmQgPSB7IFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3JTdGFydC5saW5lLCBcbiAgICAgICAgICAgICAgICAgICAgY2g6IGN1cnNvclN0YXJ0LmNoICsgcmVzcG9uc2U/Lmxlbmd0aCBcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgbmV3IHRleHQgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRTZWxlY3Rpb24oY3Vyc29yU3RhcnQsIGN1cnNvckVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjb21wbGV0aW9uOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZ2VuZXJhdGluZ05vdGljZS5oaWRlKCk7XG4gICAgICAgIG5ldyBOb3RpY2UoJ0dlbmVyYXRpb24gY29tcGxldGUuJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBuZXcgTm90aWNlKCdObyB0ZXh0IHNlbGVjdGVkLicpOyAgICBcbiAgICB9XG59IiwgImltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCTU9TZXR0aW5ncyB9IGZyb20gJ3NyYy9tYWluJztcblxuLy8gUmVxdWVzdCByZXNwb25zZSBmcm9tIE9sbGFtYSBSRVNUIEFQSSBVUkwgKGVkaXRvcilcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE9sbGFtYVJlc3BvbnNlRWRpdG9yKHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCB0ZW1wZXJhdHVyZT86IHN0cmluZywgbWF4VG9rZW5zPzogc3RyaW5nLCBzaWduYWw/OiBBYm9ydFNpZ25hbCkge1xuICAgIGNvbnN0IG9sbGFtYVJFU1RBUElVUkwgPSBzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLlJFU1RBUElVUkw7XG5cbiAgICBpZiAoIW9sbGFtYVJFU1RBUElVUkwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEV4dHJhY3QgaW1hZ2UgbGlua3MgZnJvbSB0aGUgaW5wdXRcbiAgICBjb25zdCBpbWFnZU1hdGNoID0gcHJvbXB0Lm1hdGNoKC8hP1xcW1xcWyguKj8pXFxdXFxdL2cpO1xuICAgIGNvbnN0IGltYWdlTGluayA9IGltYWdlTWF0Y2ggXG4gICAgPyBpbWFnZU1hdGNoXG4gICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnN0YXJ0c1dpdGgoJyEnKSA/IGl0ZW0uc2xpY2UoMywgLTIpIDogaXRlbS5zbGljZSgyLCAtMikpXG4gICAgICAgIC5maWx0ZXIobGluayA9PiAvXFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8d2VicHxibXB8dGlmZnx0aWZ8c3ZnKSQvaS50ZXN0KGxpbmspKVxuICAgIDogW107XG5cbiAgICAvLyAvLyBJbml0aWFsaXplIGFuIGFycmF5IHRvIGhvbGQgdGhlIGFic29sdXRlIFVSTHNcbiAgICBjb25zdCBpbWFnZXNWYXVsdFBhdGg6IFVpbnQ4QXJyYXlbXSB8IHN0cmluZ1tdIHwgbnVsbCA9IFtdO1xuXG4gICAgLy8gTG9vcCB0aHJvdWdoIGVhY2ggaW1hZ2UgbGluayB0byBnZXQgdGhlIGZ1bGwgcGF0aFxuICAgIGlmIChpbWFnZUxpbmsubGVuZ3RoID4gMCkge1xuICAgICAgICBpbWFnZUxpbmsuZm9yRWFjaChsaW5rID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGltYWdlRmlsZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGluaywgJycpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2UgPSBpbWFnZUZpbGUgPyB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmdldEZ1bGxQYXRoKGltYWdlRmlsZS5wYXRoKSA6IG51bGw7XG4gICAgICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICBpbWFnZXNWYXVsdFBhdGgucHVzaChpbWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gob2xsYW1hUkVTVEFQSVVSTCArICcvYXBpL2dlbmVyYXRlJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgc3lzdGVtOiBzZXR0aW5ncy5lZGl0b3Iuc3lzdGVuX3JvbGUsXG4gICAgICAgICAgICAgICAgcHJvbXB0OiBwcm9tcHQsXG4gICAgICAgICAgICAgICAgaW1hZ2VzOiBpbWFnZXNWYXVsdFBhdGgsXG4gICAgICAgICAgICAgICAgc3RyZWFtOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBrZWVwX2FsaXZlOiBwYXJzZUludChzZXR0aW5ncy5PbGxhbWFDb25uZWN0aW9uLm9sbGFtYVBhcmFtZXRlcnMua2VlcF9hbGl2ZSksXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgPyBwYXJzZUZsb2F0KHRlbXBlcmF0dXJlKSA6IHBhcnNlRmxvYXQoc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgICAgICAgICAgIG51bV9wcmVkaWN0OiBtYXhUb2tlbnMgPyBwYXJzZUludChtYXhUb2tlbnMpIDogcGFyc2VJbnQoc2V0dGluZ3MuZ2VuZXJhbC5tYXhfdG9rZW5zKSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzaWduYWw6IHNpZ25hbCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLnJlc3BvbnNlLnRyaW0oKTtcblxuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBhYm9ydGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdPbGxhbWEgcmVxdWVzdDonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gUmVxdWVzdCByZXNwb25zZSBmcm9tIG9wZW5haS1iYXNlZCByZXN0IGFwaSB1cmwgKGVkaXRvcilcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFJFU1RBUElVUkxEYXRhRWRpdG9yKHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCB0ZW1wZXJhdHVyZT86IHN0cmluZywgbWF4VG9rZW5zPzogc3RyaW5nLCBzaWduYWw/OiBBYm9ydFNpZ25hbCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goc2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uUkVTVEFQSVVSTCArICcvY2hhdC9jb21wbGV0aW9ucycsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c2V0dGluZ3MuUkVTVEFQSVVSTENvbm5lY3Rpb24uQVBJS2V5fWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZWRpdG9yLnN5c3Rlbl9yb2xlIHx8ICdZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQuJyB9LFxuICAgICAgICAgICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KG1heFRva2VucyB8fCBzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMgfHwgJy0xJyksXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlRmxvYXQodGVtcGVyYXR1cmUgfHwgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LnRyaW0oKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYWtpbmcgQVBJIHJlcXVlc3Q6JywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59XG5cbi8vIEZldGNoIEFudGhyb3BpYyBBUEkgRWRpdG9yXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbnRocm9waWNSZXNwb25zZUVkaXRvcihzZXR0aW5nczogQk1PU2V0dGluZ3MsIHByb21wdDogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgdGVtcGVyYXR1cmU/OiBzdHJpbmcsIG1heFRva2Vucz86IHN0cmluZywgc2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMScsXG4gICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAneC1hcGkta2V5Jzogc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLkFQSUtleSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgICAgc3lzdGVtOiBzZXR0aW5ncy5lZGl0b3Iuc3lzdGVuX3JvbGUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KG1heFRva2VucyB8fCBzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpIHx8IDQwOTYsXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlRmxvYXQodGVtcGVyYXR1cmUgfHwgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHJlc3BvbnNlLmpzb24uY29udGVudFswXS50ZXh0LnRyaW0oKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG59XG5cbi8vIEZldGNoIEdvb2dsZSBHZW1pbmkgQVBJIEVkaXRvclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoR29vZ2xlR2VtaW5pRGF0YUVkaXRvcihzZXR0aW5nczogQk1PU2V0dGluZ3MsIHByb21wdDogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgdGVtcGVyYXR1cmU/OiBzdHJpbmcsIG1heFRva2Vucz86IHN0cmluZywgc2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzL2dlbWluaS1wcm86Z2VuZXJhdGVDb250ZW50P2tleT0ke3NldHRpbmdzLkFQSUNvbm5lY3Rpb25zLmdvb2dsZUdlbWluaS5BUElLZXl9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgY29udGVudHM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydHM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6IHNldHRpbmdzLmVkaXRvci5zeXN0ZW5fcm9sZSArIHByb21wdCB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbCB8fCBzZXR0aW5ncy5nZW5lcmFsLm1vZGVsLFxuICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlRmxvYXQodGVtcGVyYXR1cmUgfHwgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgICAgICAgICAgIG1heE91dHB1dFRva2VuczogcGFyc2VJbnQobWF4VG9rZW5zIHx8IHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucykgfHwgNDA5NixcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dC50cmltKCk7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cbn1cblxuLy8gRmV0Y2ggTWlzdHJhbCBBUEkgRWRpdG9yXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hNaXN0cmFsRGF0YUVkaXRvcihzZXR0aW5nczogQk1PU2V0dGluZ3MsIHByb21wdDogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgdGVtcGVyYXR1cmU/OiBzdHJpbmcsIG1heFRva2Vucz86IHN0cmluZywgc2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5taXN0cmFsLmFpL3YxL2NoYXQvY29tcGxldGlvbnMnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5BUElLZXl9YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZWRpdG9yLnN5c3Rlbl9yb2xlIH0sXG4gICAgICAgICAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KG1heFRva2VucyB8fCBzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpLFxuICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcGFyc2VGbG9hdCh0ZW1wZXJhdHVyZSB8fCBzZXR0aW5ncy5nZW5lcmFsLnRlbXBlcmF0dXJlKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwsXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQudHJpbSgpO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cbn1cblxuLy8gRmV0Y2ggT3BlbkFJLUJhc2VkIEFQSSBFZGl0b3JcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE9wZW5BSUJhc2VBUElSZXNwb25zZUVkaXRvcihzZXR0aW5nczogQk1PU2V0dGluZ3MsIHByb21wdDogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgdGVtcGVyYXR1cmU/OiBzdHJpbmcsIG1heFRva2Vucz86IHN0cmluZywgc2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3NldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlbkFJLkFQSUtleX1gLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IHNldHRpbmdzLmdlbmVyYWwubW9kZWwsXG4gICAgICAgICAgbWF4X3Rva2VuczogcGFyc2VJbnQobWF4VG9rZW5zIHx8IHNldHRpbmdzLmdlbmVyYWwubWF4X3Rva2VucyksXG4gICAgICAgICAgdGVtcGVyYXR1cmU6IHBhcnNlRmxvYXQodGVtcGVyYXR1cmUgfHwgc2V0dGluZ3MuZ2VuZXJhbC50ZW1wZXJhdHVyZSksXG4gICAgICAgICAgc3RyZWFtOiBmYWxzZSxcbiAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc2V0dGluZ3MuZWRpdG9yLnN5c3Rlbl9yb2xlIH0sXG4gICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0fVxuICAgICAgICBdLFxuICAgICAgICB9KSxcbiAgICAgICAgc2lnbmFsOiBzaWduYWwsXG4gICAgfSk7XG4gICAgICBcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8ICcnO1xuXG4gICAgcmV0dXJuIG1lc3NhZ2U7XG59XG5cbi8vIFJlcXVlc3QgcmVzcG9uc2UgZnJvbSBvcGVuYWktYmFzZWQgcmVzdCBhcGkgdXJsIChlZGl0b3IpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hPcGVuUm91dGVyRWRpdG9yKHNldHRpbmdzOiBCTU9TZXR0aW5ncywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCB0ZW1wZXJhdHVyZT86IHN0cmluZywgbWF4VG9rZW5zPzogc3RyaW5nLCBzaWduYWw/OiBBYm9ydFNpZ25hbCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvY2hhdC9jb21wbGV0aW9ucycsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMub3BlblJvdXRlci5BUElLZXl9YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWwgfHwgc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzZXR0aW5ncy5lZGl0b3Iuc3lzdGVuX3JvbGUgfSxcbiAgICAgICAgICAgICAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHBhcnNlSW50KG1heFRva2VucyB8fCBzZXR0aW5ncy5nZW5lcmFsLm1heF90b2tlbnMpLFxuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwYXJzZUZsb2F0KHRlbXBlcmF0dXJlIHx8IHNldHRpbmdzLmdlbmVyYWwudGVtcGVyYXR1cmUpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBzaWduYWw6IHNpZ25hbCxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudC50cmltKCk7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFraW5nIEFQSSByZXF1ZXN0OicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufSIsICJpbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBNYXJrZG93blJlbmRlcmVyLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCTU9TZXR0aW5ncyB9IGZyb20gJ3NyYy9tYWluJztcbmltcG9ydCB7IGZldGNoQW50aHJvcGljUmVzcG9uc2VFZGl0b3IsIGZldGNoT2xsYW1hUmVzcG9uc2VFZGl0b3IsIGZldGNoUkVTVEFQSVVSTERhdGFFZGl0b3IsIGZldGNoR29vZ2xlR2VtaW5pRGF0YUVkaXRvciwgZmV0Y2hNaXN0cmFsRGF0YUVkaXRvciwgZmV0Y2hPcGVuQUlCYXNlQVBJUmVzcG9uc2VFZGl0b3IsIGZldGNoT3BlblJvdXRlckVkaXRvciB9IGZyb20gJy4uL0ZldGNoTW9kZWxFZGl0b3InO1xuXG5leHBvcnQgZnVuY3Rpb24gYm1vQ29kZUJsb2NrUHJvY2Vzc29yKHBsdWdpbjogUGx1Z2luLCBzZXR0aW5nczogQk1PU2V0dGluZ3MpIHtcbiAgICBsZXQgcHJldmlvdXNQcm9tcHQgPSAnJztcbiAgICBsZXQgYWJvcnRDb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXIgfCBudWxsID0gbnVsbDtcbiAgICBcbiAgICByZXR1cm4gcGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoJ2JtbycsIGFzeW5jIChzb3VyY2U6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50LCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpID0+IHsgICAgICAgICAgICAgICAgXG4gICAgICAgIC8vIEFib3J0IGFueSBleGlzdGluZyBwcm9jZXNzZXNcbiAgICAgICAgaWYgKGFib3J0Q29udHJvbGxlcikge1xuICAgICAgICAgICAgYWJvcnRDb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBhbiBBYm9ydENvbnRyb2xsZXIgYXQgdGhlIGJlZ2lubmluZ1xuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBhY3RpdmUgZmlsZVxuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZmlsZSBleGlzdHMgYW5kIHRoZSBtb2RlbCBpcyBzZXRcbiAgICAgICAgaWYgKGZpbGUgJiYgc2V0dGluZ3MuZ2VuZXJhbC5tb2RlbCAhPT0gJycpIHtcbiAgICAgICAgICAgIC8vIEdldCB0aGUgZmlsZSBjb250ZW50XG4gICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmluZCBhbGwgdGhlIGNvZGUgYmxvY2tzIGluIHRoZSBmaWxlIGNvbnRlbnRcbiAgICAgICAgICAgIGNvbnN0IGNvZGVCbG9ja1JlZ2V4ID0gL2BgYGJtb1xcbihbXFxzXFxTXSo/KWBgYC9nO1xuICAgICAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRGaWxlQ29udGVudCA9IGZpbGVDb250ZW50O1xuXG4gICAgICAgICAgICB3aGlsZSAoKG1hdGNoID0gY29kZUJsb2NrUmVnZXguZXhlYyhmaWxlQ29udGVudCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxDb2RlQmxvY2sgPSBtYXRjaFswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlQmxvY2tDb250ZW50ID0gbWF0Y2hbMV07XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvZGVCbG9ja0NvbnRlbnQuaW5jbHVkZXMoJ01PREVMICcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRTb3VyY2UgPSAnTU9ERUwgJyArIHNldHRpbmdzLmdlbmVyYWwubW9kZWwgKyAnXFxuJyArIGNvZGVCbG9ja0NvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjb2RlIGJsb2NrIGluIHRoZSBmaWxlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEZpbGVDb250ZW50ID0gdXBkYXRlZEZpbGVDb250ZW50LnJlcGxhY2Uob3JpZ2luYWxDb2RlQmxvY2ssICdgYGBibW9cXG4nICsgdXBkYXRlZFNvdXJjZSArICdgYGAnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdyaXRlIHRoZSB1cGRhdGVkIGNvbnRlbnQgYmFjayB0byB0aGUgZmlsZSBpZiB0aGVyZSB3ZXJlIGNoYW5nZXNcbiAgICAgICAgICAgIGlmICh1cGRhdGVkRmlsZUNvbnRlbnQgIT09IGZpbGVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgdXBkYXRlZEZpbGVDb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEV4dHJhY3QgbW9kZWwgbmFtZSBhbmQgY29udGVudCB0byByZW5kZXJcbiAgICAgICAgbGV0IG1vZGVsTmFtZSA9ICdObyBNb2RlbCc7XG4gICAgICAgIGxldCB0ZW1wZXJhdHVyZSA9ICcxLjAnO1xuICAgICAgICBsZXQgbWF4VG9rZW5zID0gJyc7XG4gICAgICAgIGxldCBjb250ZW50VG9SZW5kZXIgPSAnJztcblxuICAgICAgICAvLyBFeHRyYWN0IG1vZGVsIG5hbWVcbiAgICAgICAgY29uc3QgbW9kZWxNYXRjaCA9IHNvdXJjZS5tYXRjaCgvTU9ERUxcXHMrKC4rKS8pO1xuICAgICAgICBpZiAobW9kZWxNYXRjaCkge1xuICAgICAgICAgICAgbW9kZWxOYW1lID0gbW9kZWxNYXRjaFsxXS50cmltKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFeHRyYWN0IHRlbXBlcmF0dXJlXG4gICAgICAgIGNvbnN0IHRlbXBlcmF0dXJlTWF0Y2ggPSBzb3VyY2UubWF0Y2goL1RFTVBFUkFUVVJFXFxzKyguKykvKTtcbiAgICAgICAgaWYgKHRlbXBlcmF0dXJlTWF0Y2gpIHtcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlID0gdGVtcGVyYXR1cmVNYXRjaFsxXS50cmltKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFeHRyYWN0IG1heCB0b2tlbnNcbiAgICAgICAgY29uc3QgbWF4VG9rZW5zTWF0Y2ggPSBzb3VyY2UubWF0Y2goL01BWF9UT0tFTlNcXHMrKC4rKS8pO1xuICAgICAgICBpZiAobWF4VG9rZW5zTWF0Y2gpIHtcbiAgICAgICAgICAgIG1heFRva2VucyA9IG1heFRva2Vuc01hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEV4dHJhY3QgdGhlIHByb21wdFxuICAgICAgICBjb25zdCBwcm9tcHRNYXRjaCA9IHNvdXJjZS5tYXRjaCgvXig/Ok1PREVMLipcXG58VEVNUEVSQVRVUkUuKlxcbnxNQVhfVE9LRU5TLipcXG4pKihbXFxzXFxTXSo/KSg/PVxccyo8cmVzcG9uc2U+fCQpLyk7XG4gICAgICAgIGxldCBwcm9tcHQgPSAnJztcbiAgICAgICAgaWYgKHByb21wdE1hdGNoKSB7XG4gICAgICAgICAgICBwcm9tcHQgPSBwcm9tcHRNYXRjaFsxXS50cmltKCk7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHByb21wdCBoYXMgY2hhbmdlZFxuICAgICAgICBpZiAocHJvbXB0ICE9PSBwcmV2aW91c1Byb21wdCkge1xuICAgICAgICAgICAgcHJldmlvdXNQcm9tcHQgPSBwcm9tcHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcmV2aW91cyByZXNwb25zZSBjb250ZW50XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlTWF0Y2ggPSBzb3VyY2UubWF0Y2goLzxyZXNwb25zZT4oW1xcc1xcU10qPyk8XFwvcmVzcG9uc2U+Lyk7XG4gICAgICAgIGlmIChyZXNwb25zZU1hdGNoKSB7XG4gICAgICAgICAgICBjb250ZW50VG9SZW5kZXIgPSByZXNwb25zZU1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblxuICAgICAgICBjb25zdCBibW9Db2RlQmxvY2tDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnYm1vQ29kZUJsb2NrQ29udGFpbmVyJyB9KTtcbiAgICAgICAgYm1vQ29kZUJsb2NrQ29udGFpbmVyLmRhdGFzZXQuY2FsbG91dCA9ICdjaGF0JztcbiAgICAgICAgYm1vQ29kZUJsb2NrQ29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHNldHRpbmdzLmFwcGVhcmFuY2UuYm1vR2VuZXJhdGVCYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIGJtb0NvZGVCbG9ja0NvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkICMwYTBmMGEnO1xuICAgICAgICBibW9Db2RlQmxvY2tDb250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzVweCc7XG4gICAgICAgIGJtb0NvZGVCbG9ja0NvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICBibW9Db2RlQmxvY2tDb250YWluZXIuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnO1xuXG4gICAgICAgIGNvbnN0IGJtb0NvZGVCbG9ja0NvbnRlbnQgPSBibW9Db2RlQmxvY2tDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnYm1vQ29kZUJsb2NrQ29udGVudCcgfSk7XG4gICAgICAgIGJtb0NvZGVCbG9ja0NvbnRlbnQuc3R5bGUuY29sb3IgPSBzZXR0aW5ncy5hcHBlYXJhbmNlLmJtb0dlbmVyYXRlRm9udENvbG9yO1xuICAgICAgICBibW9Db2RlQmxvY2tDb250ZW50LnN0eWxlLndoaXRlU3BhY2UgPSAnbm9ybWFsJztcblxuICAgICAgICBjb25zdCBib3R0b21Db250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBib3R0b21Db250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgYm90dG9tQ29udGFpbmVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xuICAgICAgICBib3R0b21Db250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICBib3R0b21Db250YWluZXIuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xuXG4gICAgICAgIGNvbnN0IG1vZGVsVGV4dCA9IGJvdHRvbUNvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICBtb2RlbFRleHQudGV4dENvbnRlbnQgPSBtb2RlbE5hbWU7XG4gICAgICAgIG1vZGVsVGV4dC5zdHlsZS5mb250U2l6ZSA9ICcwLjllbSc7XG4gICAgICAgIG1vZGVsVGV4dC5zdHlsZS5jb2xvciA9ICcjNjY2JztcbiAgICAgICAgbW9kZWxUZXh0LnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG5cbiAgICAgICAgY29uc3QgbG9hZGVyQ2lyY2xlID0gYm90dG9tQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgbG9hZGVyQ2lyY2xlLmNsYXNzTGlzdC5hZGQoJ2xvYWRlci1jaXJjbGUnKTtcbiAgICAgICAgbG9hZGVyQ2lyY2xlLnN0eWxlLndpZHRoID0gJzIwcHgnO1xuICAgICAgICBsb2FkZXJDaXJjbGUuc3R5bGUuaGVpZ2h0ID0gJzIwcHgnO1xuICAgICAgICBsb2FkZXJDaXJjbGUuc3R5bGUuYm9yZGVyID0gJzJweCBzb2xpZCAjNjY2JztcbiAgICAgICAgbG9hZGVyQ2lyY2xlLnN0eWxlLmJvcmRlclRvcENvbG9yID0gJ3RyYW5zcGFyZW50JztcbiAgICAgICAgbG9hZGVyQ2lyY2xlLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc1MCUnO1xuICAgICAgICBsb2FkZXJDaXJjbGUuc3R5bGUuYW5pbWF0aW9uID0gJ3NwaW4gMXMgbGluZWFyIGluZmluaXRlJztcbiAgICAgICAgbG9hZGVyQ2lyY2xlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgY29uc3QgYm1vR2VuZXJhdGlvbk5vdGljZSA9IGJvdHRvbUNvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICBibW9HZW5lcmF0aW9uTm90aWNlLnRleHRDb250ZW50ID0gJ0RvbmUhJztcbiAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS5zdHlsZS5mb250U2l6ZSA9ICcwLjllbSc7XG4gICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuY29sb3IgPSAnIzRjYWY1MCc7IC8vIExpZ2h0IGdyZWVuIGNvbG9yXG4gICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICBjb25zdCBidXR0b24gPSBib3R0b21Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnR2VuZXJhdGUnO1xuXG4gICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGJ1dHRvbi50ZXh0Q29udGVudCA9PT0gJ0NhbmNlbCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJvcnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGFib3J0Q29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnR2VuZXJhdGUnO1xuICAgICAgICAgICAgICAgIGxvYWRlckNpcmNsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2UudGV4dENvbnRlbnQgPSAnQWJvcnRlZC4nO1xuICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuY29sb3IgPSAnI2ZmNjY2Nic7XG4gICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENoYW5nZSBidXR0b24gdGV4dCB0byBcIkNhbmNlbFwiXG4gICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnQ2FuY2VsJztcblxuICAgICAgICAgICAgLy8gVXNlIHRoZSBleGlzdGluZyBBYm9ydENvbnRyb2xsZXJcbiAgICAgICAgICAgIGlmICghYWJvcnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2lnbmFsID0gYWJvcnRDb250cm9sbGVyLnNpZ25hbDtcblxuICAgICAgICAgICAgLy8gU2hvdyB0aGUgbG9hZGVyIGNpcmNsZVxuICAgICAgICAgICAgbG9hZGVyQ2lyY2xlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXG4gICAgICAgICAgICBsZXQgbW9kZWxSZXNwb25zZSA9ICcnO1xuXG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLk9sbGFtYUNvbm5lY3Rpb24ub2xsYW1hTW9kZWxzLmluY2x1ZGVzKG1vZGVsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxSZXNwb25zZSA9IGF3YWl0IGZldGNoT2xsYW1hUmVzcG9uc2VFZGl0b3Ioc2V0dGluZ3MsIHByb21wdCwgbW9kZWxOYW1lLCB0ZW1wZXJhdHVyZSwgbWF4VG9rZW5zLCBzaWduYWwpIHx8IGNvbnRlbnRUb1JlbmRlcjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLlJFU1RBUElVUkxDb25uZWN0aW9uLlJFU1RBUElVUkxNb2RlbHMuaW5jbHVkZXMobW9kZWxOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFJlc3BvbnNlID0gYXdhaXQgZmV0Y2hSRVNUQVBJVVJMRGF0YUVkaXRvcihzZXR0aW5ncywgcHJvbXB0LCBtb2RlbE5hbWUsIHRlbXBlcmF0dXJlLCBtYXhUb2tlbnMsIHNpZ25hbCkgfHwgY29udGVudFRvUmVuZGVyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMuYW50aHJvcGljLmFudGhyb3BpY01vZGVscy5pbmNsdWRlcyhtb2RlbE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsUmVzcG9uc2UgPSBhd2FpdCBmZXRjaEFudGhyb3BpY1Jlc3BvbnNlRWRpdG9yKHNldHRpbmdzLCBwcm9tcHQsIG1vZGVsTmFtZSwgdGVtcGVyYXR1cmUsIG1heFRva2Vucywgc2lnbmFsKSB8fCBjb250ZW50VG9SZW5kZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5nb29nbGVHZW1pbmkuZ2VtaW5pTW9kZWxzLmluY2x1ZGVzKG1vZGVsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxSZXNwb25zZSA9IGF3YWl0IGZldGNoR29vZ2xlR2VtaW5pRGF0YUVkaXRvcihzZXR0aW5ncywgcHJvbXB0LCBtb2RlbE5hbWUsIHRlbXBlcmF0dXJlLCBtYXhUb2tlbnMsIHNpZ25hbCkgfHwgY29udGVudFRvUmVuZGVyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MuQVBJQ29ubmVjdGlvbnMubWlzdHJhbC5taXN0cmFsTW9kZWxzLmluY2x1ZGVzKG1vZGVsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxSZXNwb25zZSA9IGF3YWl0IGZldGNoTWlzdHJhbERhdGFFZGl0b3Ioc2V0dGluZ3MsIHByb21wdCwgbW9kZWxOYW1lLCB0ZW1wZXJhdHVyZSwgbWF4VG9rZW5zLCBzaWduYWwpIHx8IGNvbnRlbnRUb1JlbmRlcjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLkFQSUNvbm5lY3Rpb25zLm9wZW5BSS5vcGVuQUlCYXNlTW9kZWxzLmluY2x1ZGVzKG1vZGVsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxSZXNwb25zZSA9IGF3YWl0IGZldGNoT3BlbkFJQmFzZUFQSVJlc3BvbnNlRWRpdG9yKHNldHRpbmdzLCBwcm9tcHQsIG1vZGVsTmFtZSwgdGVtcGVyYXR1cmUsIG1heFRva2Vucywgc2lnbmFsKSB8fCBjb250ZW50VG9SZW5kZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0aW5ncy5BUElDb25uZWN0aW9ucy5vcGVuUm91dGVyLm9wZW5Sb3V0ZXJNb2RlbHMuaW5jbHVkZXMobW9kZWxOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFJlc3BvbnNlID0gYXdhaXQgZmV0Y2hPcGVuUm91dGVyRWRpdG9yKHNldHRpbmdzLCBwcm9tcHQsIG1vZGVsTmFtZSwgdGVtcGVyYXR1cmUsIG1heFRva2Vucywgc2lnbmFsKSB8fCBjb250ZW50VG9SZW5kZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS50ZXh0Q29udGVudCA9ICdNb2RlbCBub3QgZm91bmQuJztcbiAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS5zdHlsZS5jb2xvciA9ICcjZmY2NjY2JztcbiAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ0dlbmVyYXRlJztcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsUmVzcG9uc2UgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYmFja3RpY2tzIHdpdGggZXNjYXBlZCBiYWNrdGlja3MgaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0XG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kZWxSZXNwb25zZS5pbmNsdWRlcygnXFxcXGAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxSZXNwb25zZSA9IG1vZGVsUmVzcG9uc2UucmVwbGFjZSgvYC9nLCAnXFxcXGAnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIDxyZXNwb25zZT4gdGFncyBleGlzdCBpbiB0aGUgc291cmNlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGFnc0V4aXN0ID0gc291cmNlLmluY2x1ZGVzKCc8cmVzcG9uc2U+JykgJiYgc291cmNlLmluY2x1ZGVzKCc8L3Jlc3BvbnNlPicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVkU291cmNlID0gc291cmNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2VUYWdzRXhpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgPHJlc3BvbnNlPiBjb250ZW50IGluIHRoZSBzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRTb3VyY2UgPSBzb3VyY2UucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPHJlc3BvbnNlPltcXHNcXFNdKj88XFwvcmVzcG9uc2U+LyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPHJlc3BvbnNlPlxcbiR7bW9kZWxSZXNwb25zZX1cXG48L3Jlc3BvbnNlPmBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmQgPHJlc3BvbnNlPiB0YWdzIHRvIHRoZSBzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRTb3VyY2UgPSBgJHtzb3VyY2V9XFxuXFxuPHJlc3BvbnNlPlxcbiR7bW9kZWxSZXNwb25zZX1cXG48L3Jlc3BvbnNlPmA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBFeHRyYWN0IHRoZSBuZXcgY29udGVudCB0byByZW5kZXJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3UmVzcG9uc2VNYXRjaCA9IHVwZGF0ZWRTb3VyY2UubWF0Y2goLzxyZXNwb25zZT4oW1xcc1xcU10qPyk8XFwvcmVzcG9uc2U+Lyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdSZXNwb25zZU1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9SZW5kZXIgPSBuZXdSZXNwb25zZU1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCBmaWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSBmaWxlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBjb2RlIGJsb2NrIGNvbnRlbnQgaW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRGaWxlQ29udGVudCA9IGZpbGVDb250ZW50LnJlcGxhY2Uoc291cmNlLCB1cGRhdGVkU291cmNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV3JpdGUgdGhlIHVwZGF0ZWQgY29udGVudCBiYWNrIHRvIHRoZSBmaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCB1cGRhdGVkRmlsZUNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSGlkZSB0aGUgbG9hZGVyIGNpcmNsZVxuICAgICAgICAgICAgICAgIGxvYWRlckNpcmNsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAgIFxuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0JNTyBHZW5lcmF0ZSBBYm9ydGVkLicpO1xuICAgICAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnR2VuZXJhdGUnO1xuICAgICAgICAgICAgICAgICAgICBsb2FkZXJDaXJjbGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS50ZXh0Q29udGVudCA9ICdBYm9ydGVkLic7XG4gICAgICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuY29sb3IgPSAnI2ZmNjY2Nic7XG4gICAgICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJtb0dlbmVyYXRpb25Ob3RpY2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdHZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgYm1vR2VuZXJhdGlvbk5vdGljZS50ZXh0Q29udGVudCA9ICdFcnJvciBvY2N1cnJlZC4nO1xuICAgICAgICAgICAgICAgICAgICBibW9HZW5lcmF0aW9uTm90aWNlLnN0eWxlLmNvbG9yID0gJyNmZjY2NjYnO1xuICAgICAgICAgICAgICAgICAgICBibW9HZW5lcmF0aW9uTm90aWNlLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJztcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibW9HZW5lcmF0aW9uTm90aWNlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlbmRlciB0aGUgZmlsdGVyZWQgY29udGVudCBhcyBNYXJrZG93blxuICAgICAgICBpZiAoc291cmNlLmluY2x1ZGVzKCc8cmVzcG9uc2U+JykgJiYgc291cmNlLmluY2x1ZGVzKCc8L3Jlc3BvbnNlPicpKSB7XG4gICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcihwbHVnaW4uYXBwLCBjb250ZW50VG9SZW5kZXIsIGJtb0NvZGVCbG9ja0NvbnRlbnQsICcvJywgcGx1Z2luKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHBsdWdpbi5hcHAsIHByb21wdCwgYm1vQ29kZUJsb2NrQ29udGVudCwgJy8nLCBwbHVnaW4pO1xuICAgICAgICB9XG4gICAgfSk7XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsaUJBQUFBO0FBQUEsRUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQyxvQkFBK0M7OztBQ0EvQyxJQUFBQyxtQkFBOEY7OztBQ0E5RixJQUFBQyxtQkFBcUM7OztBQ0M5QixTQUFTLFdBQVcsWUFBNEI7QUFDbkQsTUFBSSxXQUFXLFdBQVcsS0FBSyxHQUFHO0FBRWhDLFVBQU0sUUFBUSxXQUFXLE1BQU0sa0JBQWtCO0FBQ2pELFFBQUksVUFBVSxRQUFRLE1BQU0sU0FBUyxHQUFHO0FBQzVDLFlBQU0sSUFBSSxNQUFNLG1CQUFtQjtBQUFBLElBQ3BDO0FBRUssVUFBTSxJQUFJLFNBQVMsTUFBTSxDQUFDLENBQUMsSUFBSTtBQUMvQixVQUFNLElBQUksU0FBUyxNQUFNLENBQUMsQ0FBQyxJQUFJO0FBQy9CLFVBQU0sSUFBSSxTQUFTLE1BQU0sQ0FBQyxDQUFDLElBQUk7QUFFL0IsVUFBTSxJQUFJLElBQUksTUFBTSxLQUFLLElBQUksS0FBSyxJQUFJLElBQUksSUFBSTtBQUM5QyxVQUFNLElBQUksSUFBSSxJQUFJO0FBQ2xCLFVBQU0sSUFBSSxRQUFRLEdBQUcsR0FBRyxJQUFJLElBQUksQ0FB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QUFBLEVBQ0YsU0FBUyxPQUFQO0FBQ0QsWUFBUSxNQUFNLGlDQUFpQyxLQUFLO0FBQUEsRUFDckQ7QUFDRDsiLAogICJuYW1lcyI6IFsiQk1PR1BUIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImciLCAiaGV4IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbmRleCIsICJfYSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW5kZXgiLCAicmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50IiwgImltcG9ydF9vYnNpZGlhbiIsICJtZXNzYWdlSGlzdG9yeSIsICJpbmRleCIsICJpbmRleCIsICJyZWZlcmVuY2VDdXJyZW50Tm90ZUNvbnRlbnQiLCAiYm90TWVzc2FnZURpdiIsICJtZXNzYWdlQ29udGFpbmVyRWwiLCAibWVzc2FnZUhpc3RvcnkiLCAiY29udmVydGVkTWVzc2FnZUhpc3RvcnkiLCAidGFyZ2V0VXNlck1lc3NhZ2UiLCAidGFyZ2V0Qm90TWVzc2FnZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiSGVhZGVycyIsICJyZXNvbHZlIiwgIlJlcXVlc3QiLCAiUmVzcG9uc2UiLCAiZmV0Y2giLCAiX2EiLCAiZmV0Y2giLCAiX19kZWZQcm9wIiwgIk9sbGFtYSIsICJmcyIsICJfYSIsICJpbmRleCIsICJGaWxlIiwgIl9hIiwgIm9wdHMiLCAiUGFnZSIsICJfYSIsICJQYWdlIiwgInJlc29sdmUiLCAiX2EiLCAiX2EiLCAiVHJhbnNjcmlwdGlvbnMiLCAiVHJhbnNsYXRpb25zIiwgIkF1ZGlvIiwgIl9hIiwgIkNoYXQiLCAiQ29tcGxldGlvbnMiLCAiX2EiLCAiRW1iZWRkaW5ncyIsICJFZGl0cyIsICJfYSIsICJKb2JzIiwgIkZpbmVUdW5pbmciLCAiSW1hZ2VzIiwgIk1vZGVscyIsICJNb2RlcmF0aW9ucyIsICJDb21wbGV0aW9ucyIsICJPcGVuQUkiLCAicmVmZXJlbmNlQ3VycmVudE5vdGVDb250ZW50IiwgIl9hIiwgIk9sbGFtYSIsICJpbmRleCIsICJoZWFkZXIiLCAiY3VycmVudFByb2ZpbGUiLCAiX2EiLCAibWVzc2FnZUhpc3RvcnkiLCAiZmlsZSIsICJpbmRleCIsICJtZXNzYWdlQ29udGFpbmVyIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIk9sbGFtYSIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImJtb0NvZGVCbG9ja0NvbnRlbnRzIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2V0dGluZ1RhYiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2V0dGluZ1RhYiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2V0dGluZ1RhYiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2V0dGluZ1RhYiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2V0dGluZ1RhYiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZXR0aW5nVGFiIiwgImluZGV4IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFib3J0Q29udHJvbGxlciIsICJmaWxlIiwgIkJNT0dQVCIsICJmaWxlIiwgImluZGV4IiwgInByb2ZpbGVGaWxlcyIsICJwcm9maWxlSW5kZXgiLCAibWVzc2FnZUNvbnRhaW5lciJdCn0K
